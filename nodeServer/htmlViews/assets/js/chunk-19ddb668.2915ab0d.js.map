{"version":3,"sources":["webpack:///./node_modules/core-js/internals/string-repeat.js","webpack:///./node_modules/core-js/modules/es.array.reduce.js","webpack:///./src/views/viewDateManagent/fileView.vue?3643","webpack:///./node_modules/core-js/modules/es.string.strike.js","webpack:///./node_modules/core-js/internals/this-number-value.js","webpack:///./node_modules/core-js/modules/es.map.js","webpack:///./node_modules/core-js/internals/collection-strong.js","webpack:///./node_modules/core-js/internals/collection.js","webpack:///./node_modules/core-js/internals/array-fill.js","webpack:///./src/views/viewDateManagent/fileView.vue?6824","webpack:///./node_modules/@babel/runtime/helpers/esm/toArray.js","webpack:///./src/components/xspreadsheet/component/element.js","webpack:///./src/components/xspreadsheet/core/alphabet.js","webpack:///./src/components/xspreadsheet/core/cell_range.js","webpack:///./src/components/xspreadsheet/core/selector.js","webpack:///./src/components/xspreadsheet/core/scroll.js","webpack:///./src/components/xspreadsheet/core/history.js","webpack:///./src/components/xspreadsheet/core/clipboard.js","webpack:///./src/components/xspreadsheet/core/merge.js","webpack:///./src/components/xspreadsheet/core/helper.js","webpack:///./src/components/xspreadsheet/core/row.js","webpack:///./src/components/xspreadsheet/core/col.js","webpack:///./src/components/xspreadsheet/locale/en.js","webpack:///./src/components/xspreadsheet/locale/locale.js","webpack:///./src/components/xspreadsheet/core/validator.js","webpack:///./src/components/xspreadsheet/core/validation.js","webpack:///./src/components/xspreadsheet/core/data_proxy.js","webpack:///./src/components/xspreadsheet/component/event.js","webpack:///./src/components/xspreadsheet/config.js","webpack:///./src/components/xspreadsheet/component/resizer.js","webpack:///./src/components/xspreadsheet/component/scrollbar.js","webpack:///./src/components/xspreadsheet/component/selector.js","webpack:///./src/components/xspreadsheet/component/suggest.js","webpack:///./src/components/xspreadsheet/component/icon.js","webpack:///./src/components/xspreadsheet/component/calendar.js","webpack:///./src/components/xspreadsheet/component/datepicker.js","webpack:///./src/components/xspreadsheet/component/editor.js","webpack:///./src/components/xspreadsheet/component/contextmenu.js","webpack:///./src/components/xspreadsheet/core/font.js","webpack:///./src/components/xspreadsheet/core/cell.js","webpack:///./src/components/xspreadsheet/core/formula.js","webpack:///./src/components/xspreadsheet/core/format.js","webpack:///./src/components/xspreadsheet/canvas/draw.js","webpack:///./src/components/xspreadsheet/component/table.js","webpack:///./src/components/xspreadsheet/component/tooltip.js","webpack:///./src/components/xspreadsheet/component/dropdown.js","webpack:///./src/components/xspreadsheet/component/dropdown_font.js","webpack:///./src/components/xspreadsheet/component/dropdown_fontsize.js","webpack:///./src/components/xspreadsheet/component/dropdown_format.js","webpack:///./src/components/xspreadsheet/component/dropdown_formula.js","webpack:///./src/components/xspreadsheet/component/color_palette.js","webpack:///./src/components/xspreadsheet/component/dropdown_color.js","webpack:///./src/components/xspreadsheet/component/dropdown_align.js","webpack:///./src/components/xspreadsheet/component/dropdown_linetype.js","webpack:///./src/components/xspreadsheet/component/border_palette.js","webpack:///./src/components/xspreadsheet/component/dropdown_border.js","webpack:///./src/components/xspreadsheet/component/toolbar.js","webpack:///./src/components/xspreadsheet/component/modal.js","webpack:///./src/components/xspreadsheet/component/form_input.js","webpack:///./src/components/xspreadsheet/component/form_select.js","webpack:///./src/components/xspreadsheet/component/form_field.js","webpack:///./src/components/xspreadsheet/component/button.js","webpack:///./src/components/xspreadsheet/component/modal_validation.js","webpack:///./src/components/xspreadsheet/component/message.js","webpack:///./src/components/xspreadsheet/component/sheet.js","webpack:///./src/components/xspreadsheet/index.js","webpack:///./src/views/viewDateManagent/fileView.vue","webpack:///./src/views/viewDateManagent/fileView.vue?c389","webpack:///./src/views/viewDateManagent/fileView.vue?6e4f","webpack:///./node_modules/core-js/modules/es.number.to-fixed.js","webpack:///./node_modules/core-js/internals/freezing.js","webpack:///./node_modules/core-js/modules/es.array.fill.js","webpack:///./node_modules/core-js/modules/es.string.bold.js","webpack:///./node_modules/core-js/internals/array-reduce.js","webpack:///./node_modules/core-js/internals/internal-metadata.js"],"names":["toInteger","requireObjectCoercible","module","exports","repeat","count","str","String","this","result","n","Infinity","RangeError","$","$reduce","left","arrayMethodIsStrict","arrayMethodUsesToLength","STRICT_METHOD","USES_TO_LENGTH","1","target","proto","forced","reduce","callbackfn","arguments","length","undefined","createHTML","forcedStringHTMLMethod","strike","classof","value","TypeError","collection","collectionStrong","init","defineProperty","f","create","redefineAll","bind","anInstance","iterate","defineIterator","setSpecies","DESCRIPTORS","fastKey","InternalStateModule","setInternalState","set","internalStateGetterFor","getterFor","getConstructor","wrapper","CONSTRUCTOR_NAME","IS_MAP","ADDER","C","that","iterable","type","index","first","last","size","getInternalState","define","key","previous","state","entry","getEntry","next","removed","prototype","clear","data","prev","forEach","boundFunction","has","get","add","setStrong","ITERATOR_NAME","getInternalCollectionState","getInternalIteratorState","iterated","kind","done","global","isForced","redefine","InternalMetadataModule","isObject","fails","checkCorrectnessOfIteration","setToStringTag","inheritIfRequired","common","indexOf","IS_WEAK","NativeConstructor","NativePrototype","Constructor","exported","fixMethod","KEY","nativeMethod","call","entries","REQUIRED","instance","HASNT_CHAINING","THROWS_ON_PRIMITIVES","ACCEPT_ITERABLES","BUGGY_ZERO","$instance","dummy","constructor","toObject","toAbsoluteIndex","toLength","O","argumentsLength","end","endPos","_vm","_h","$createElement","_c","_self","staticClass","directives","name","rawName","expression","attrs","actionsList","ref","fileTypeForm","rules","model","callback","$$v","$set","_l","item","id","on","createLink","_v","paramsActions","isCompatible","dictFlag","parameterTable","fieldTable","dialogVisible","handelSure","handelCancel","testParameterDialog","handleTestQuery","testParameterCancel","staticRenderFns","_toArray","arr","arrayWithHoles","iterableToArray","unsupportedIterableToArray","nonIterableRest","Element","tag","className","el","document","createElement","eventNames","handler","split","fen","oen","eventName","test","window","navigator","userAgent","addEventListener","evt","i","k","button","stopPropagation","Object","keys","css","offsetTop","offsetLeft","offsetHeight","offsetWidth","top","height","width","v","scrollLeft","scrollTop","getBoundingClientRect","parentNode","eles","childNodes","ele","child","arg","createTextNode","appendChild","contains","classList","remove","cls","toggleClass","toggle","flag","addClass","removeClass","setAttribute","getAttribute","removeAttribute","content","innerHTML","style","removeProperty","getComputedStyle","h","alphabets","stringAt","cindex","parseInt","indexAt","ret","charCodeAt","exponet","expr2xy","src","x","y","charAt","expr2expr","xn","yn","xy2expr","CellRange","sri","sci","eri","eci","w","ri","ci","args","cb","j","other","addRet","push","dsr","dsc","der","dec","multiple","refs","Selector","range","Scroll","History","undoItems","redoItems","JSON","stringify","currentd","canUndo","parse","pop","canRedo","Clipboard","cellRange","Merges","d","_","cr","filter","it","within","includes","intersects","union","deleteWithin","cbWithin","rn","cn","it1","merges","map","merge","valueOf","toString","cloneDeep","obj","mergeDeep","object","sources","source","Array","isArray","equals","obj1","obj2","v1","v2","ai","sum","objOrAry","total","deleteProperty","property","oldv","rangeReduceIf","min","max","inits","initv","ifv","getv","s","rangeSum","rangeEach","arrayEquals","a1","a2","Rows","len","row","getOrNew","helper","getHeight","sumHeight","cells","cell","getCell","what","text","getCellOrNew","srcCellRange","dstCellRange","autofill","dsri","dsci","deri","deci","drn","dcn","isAdd","dn","ii","jj","nri","nci","ncell","replace","word","exec","Number","substring","setCell","ncellmm","each","eachCells","ndata","rndata","deleteCell","assign","Cols","indexWidth","minWidth","col","getWidth","sumWidth","toolbar","undo","redo","paintformat","clearformat","format","font","fontSize","fontBold","fontItalic","underline","textColor","fillColor","border","align","valign","textwrap","freeze","formula","more","contextmenu","copy","cut","paste","pasteValue","pasteFormat","insertRow","insertColumn","deleteRow","deleteColumn","deleteCellText","validation","normal","number","percent","rmb","usd","date","time","datetime","duration","average","concat","required","notMatch","between","notBetween","notIn","equal","notEqual","lessThan","lessThanEqual","greaterThan","greaterThanEqual","error","pasteForMergedCell","calendar","weeks","months","cancel","save","dataValidation","mode","criteria","modeType","column","list","phone","email","operator","be","nbe","lt","lte","gt","gte","eq","neq","$lang","$messages","en","translate","messages","message","t","spreadsheet","tf","locale","lang","returnMessage","Validator","Date","values","parseValue","Validation","validator","nrefs","crs","difference","Validations","errors","Map","validate","delete","getByValidator","addRef","getData","defaultSettings","view","documentElement","clientHeight","clientWidth","showGrid","showToolbar","showContextmenu","bgcolor","color","bold","italic","toolbarHeight","canPaste","dst","clone","srn","scn","copyPaste","rows","deleteCells","cutPaste","clipboard","move","setStyleBorder","bss","styles","cstyle","addStyle","setStyleBorders","selector","isSignleSelected","ns","mergeIndexes","mri","mci","splice","mrl","mcl","bottom","right","getCellMerge","getCellRowByY","scrollOffsety","fsh","freezeTotalHeight","getCellColByX","scrollOffsetx","cols","fsw","freezeTotalWidth","DataProxy","settings","validations","hyperlinks","comments","scroll","history","change","changeData","setData","isClear","isCopy","isCut","srcRange","cri","cci","getFirstIncludes","unmerge","nfont","setCellText","getSelectedRect","x1","y1","getRect","l","cellPosition","left0","top0","totalWidth","totalHeight","cellRect","si","insert","shift","rsize","csize","fci","fri","cellStyle","defaultStyle","getCellStyleOrDefault","setHeight","setWidth","viewHeight","viewWidth","viewRange","filterIntersects","rowHeight","colWidth","nstyle","fn","unbind","removeEventListener","unbindClickoutside","xclickoutside","body","bindClickoutside","hide","detail","mouseMoveUp","movefunc","upfunc","xEvtUp","calTouchDirection","spanx","spany","direction","Math","abs","bindTouch","startx","starty","touches","pageX","pageY","changedTouches","preventDefault","cssPrefix","Resizer","devicePixelRatio","vertical","minDistance","moving","children","hoverEl","mousedownHandler","lineEl","cRect","finishedFn","rect","line","offset","show","startEvt","distance","e","buttons","movementX","movementY","Scrollbar","moveFn","contentEl","contentDistance","cssKey","selectorHeightBorderWidth","startZIndex","SelectorElement","cornerEl","areaEl","clipboardEl","autofillEl","calBRAreaOffset","ftwidth","ftheight","calTAreaOffset","calLAreaOffset","setBRAreaOffset","br","setAreaOffset","setTLAreaOffset","tl","setTAreaOffset","setLAreaOffset","setLClipboardOffset","setClipboardOffset","setBRClipboardOffset","setTLClipboardOffset","setTClipboardOffset","setAllAreaOffset","setAllClipboardOffset","areaOffset","indexes","arange","lastri","lastci","freezeHeight","freezeWidth","setOffset","coffset","getClipboardRect","resetOffset","indexesUpdated","calSelectedRangeByStart","setIndexes","moveIndexes","resetAreaOffset","calSelectedRangeByEnd","setEnd","ern","ecn","showAutofill","hideAutofill","showClipboard","hideClipboard","inputMovePrev","filterItems","itemIndex","inputMoveNext","inputEnter","click","inputKeydownHandler","keyCode","ctrlKey","Suggest","items","itemClick","cssRemoveKeys","parent","search","startsWith","toUpperCase","title","label","html","input","Icon","iconNameEl","addMonth","step","setMonth","getMonth","weekday","setDate","getDay","monthDays","year","month","cdate","startDate","datess","disabled","active","getDate","Calendar","cvalue","headerLeftEl","bodyEl","buildAll","week","selectChange","buildHeaderLeft","buildBody","getFullYear","mDays","trs","tds","Datepicker","setValue","RegExp","resetTextareaSize","inputText","textlineEl","textEl","tlineWidth","maxWidth","viewFn","twidth","h1","inputEventHandler","suggest","start","lastIndexOf","setTextareaRange","position","setTimeout","focus","setSelectionRange","setText","blur","val","suggestItemClick","sit","eit","resetSuggestItems","setItems","formulas","dateFormat","Editor","datepicker","bindInputEvents","suggestPosition","elOffset","sOffset","menuItems","buildMenuItem","buildMenu","ContextMenu","isHide","baseFonts","fontSizes","pt","px","getFontSizePxByPt","infixExprToSuffixExpr","operatorStack","stack","subStrs","fnArgType","fnArgsLen","c","join","c1","ex","ey","sx","sy","rangelen","evalSubExpr","subExpr","cellRender","evalSuffixExpr","srcStack","formulaMap","cellList","params","render","reverse","getCellText","baseFormulas","ary","a","b","formulam","formatStringRender","formatNumberRender","toFixed","parts","baseFormats","formatm","dpr","thinLineWidth","npx","npxLine","DrawBox","padding","borderTop","borderRight","borderBottom","borderLeft","hoffset","drawFontLine","tx","ty","blheight","blwidth","floffset","Draw","ctx","getContext","resize","scale","clearRect","options","beginPath","restore","fillRect","fillText","txt","box","attr","textWrap","textx","textAlign","textBaseline","fillStyle","strokeStyle","txtWidth","measureText","ceil","innerWidth","texty","textLine","lineWidth","setLineDash","moveTo","lineTo","stroke","topxys","rightxys","bottomxys","leftxys","closePath","fill","dtextcb","clip","cellPaddingWidth","tableFixedHeaderCleanStyle","tableGridStyle","tableFixedHeaderStyle","getDrawBox","rindex","renderCellBorders","draw","bboxes","strokeBorders","renderCell","dbox","setBorders","cellText","_cell","getCellTextOrDefault","getError","renderContent","fw","fh","eachMergesInView","r","renderSelectedHeaderCell","renderFixedHeaders","nty","ntx","rowEach","colEach","renderFixedLeftTopCell","renderContentGrid","ch","cw","renderFreezeHighlightLine","ftw","fth","theight","Table","vr","freezeViewRange","tooltip","elBox","removeChild","Dropdown","showArrow","placement","headerEl","DropdownFont","nfonts","setTitle","DropdownFontSize","nfontSizes","DropdownFormat","nformats","slice","DropdownFormula","nformulas","themeColorPlaceHolders","themeColors","standardColors","buildTd","ColorPalette","table","DropdownColor","iconName","icon","colorPalette","buildItemWithIcon","DropdownAlign","aligns","naligns","setName","lineTypes","DropdownLineType","beforei","lineTypeEls","iti","buildTable","BorderPalette","ddColor","ddType","DropdownBorder","borderPalette","buildIcon","buildButton","tooltipdata","buildDivider","buildButtonWithIcon","bindDropdownChange","ddFormat","ddFont","ddFormula","ddFontSize","ddTextColor","ddFillColor","ddAlign","ddVAlign","ddBorder","toggleChange","elName","types","hasClass","DropdownMore","moreBtns","initBtns2","btns2","btnChildren","computedStyle","marginLeft","marginRight","moreResize","btns","moreEl","ddMore","widthFn","sumWidth2","list1","list2","Toolbar","undoEl","redoEl","paintformatEl","clearformatEl","fontBoldEl","fontItalicEl","underlineEl","strikeEl","mergeEl","textwrapEl","reset","getSelectedCellStyle","getSelectedCell","canUnmerge","Modal","dimmer","xkeydownEsc","FormInput","hint","vchange","FormSelect","getTitle","itemEl","patterns","FormField","rule","labelWidth","tip","pattern","Button","fieldLabelWidth","ModalValidation","mf","rf","cf","criteriaSelected","of","criteriaOperatorSelected","minvf","maxvf","svf","vf","btnClick","action","field","isShow","xtoast","scrollbarMove","verticalScrollbar","horizontalScrollbar","tableOffset","getTableOffset","selectorSet","selectorMove","overlayerMousemove","offsetX","offsetY","rowResizer","colResizer","tableEl","tRect","getCellRectByXY","overlayerMousescroll","delta","deltaY","overlayerTouch","verticalScrollbarSet","horizontalScrollbarSet","sheetFreeze","editor","fwidth","fheight","setFreezeLengths","sheetReset","overlayerEl","overlayerCEl","tOffset","vRect","clearClipboard","console","log","msg","toolbarChangePaintformatPaste","paintformatActive","paintformatToggle","overlayerMousedown","isAutofillEl","shiftKey","editorSetOffset","sPosition","editorSet","getSelectedValidator","verticalScrollbarMove","scrolly","resetBRLAreaOffset","horizontalScrollbarMove","scrollx","resetBRTAreaOffset","rowResizerFinished","colResizerFinished","dataSetCellText","setSelectedCellText","insertDeleteRowColumn","toolbarChange","setSelectedCellAttr","sheetInitEvents","contextMenu","modalValidation","xyInSelectedRect","setPosition","itext","addValidation","removeValidation","getSelectedValidation","reload","focusing","which","altKey","metaKey","trigger","Sheet","targetEl","setFreeze","Spreadsheet","selectors","querySelector","rootEl","sheet","loadData","viewName","linkId","path","sheetName","titleLine","startLine","endLine","linkList","code","defaultValue","addButton","edits","testloading","onClick","testQueryButton","updateId","testList","cellLocation","excelData","0","addSure","addCancel","testParameterRules","testParameterList","linkQuery","$route","query","dataViewDetail","page","limit","then","$message","filePath","queryExcelInfo","listItem","showMsg","spreadQuery","$refs","advance","queryParams","res","getElementById","initExcel","success","resetFields","$router","fields","valid","checkFlag","treeLists","parameViewTable","viewData","back","components","parameView","createDialog","testEditor","treeTableList","component","thisNumberValue","nativeToFixed","floor","pow","acc","x2","FORCED","fractionDigits","z","fractDigits","sign","multiply","c2","divide","dataToString","isExtensible","preventExtensions","addToUnscopables","aFunction","IndexedObject","createMethod","IS_RIGHT","memo","self","hiddenKeys","uid","FREEZING","METADATA","setMetadata","objectID","weakData","getWeakData","onFreeze","meta"],"mappings":"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","file":"assets/js/chunk-19ddb668.2915ab0d.js","sourcesContent":["'use strict';\nvar toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.repeat` method implementation\n// https://tc39.github.io/ecma262/#sec-string.prototype.repeat\nmodule.exports = ''.repeat || function repeat(count) {\n  var str = String(requireObjectCoercible(this));\n  var result = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError('Wrong number of repetitions');\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) result += str;\n  return result;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $reduce = require('../internals/array-reduce').left;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('reduce');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('reduce', { 1: 0 });\n\n// `Array.prototype.reduce` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || !USES_TO_LENGTH }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    return $reduce(this, callbackfn, arguments.length, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/sass-resources-loader/lib/loader.js??ref--8-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./fileView.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/sass-resources-loader/lib/loader.js??ref--8-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./fileView.vue?vue&type=style&index=0&lang=scss&\"","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.strike` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.strike\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('strike') }, {\n  strike: function strike() {\n    return createHTML(this, 'strike', '', '');\n  }\n});\n","var classof = require('../internals/classof-raw');\n\n// `thisNumberValue` abstract operation\n// https://tc39.github.io/ecma262/#sec-thisnumbervalue\nmodule.exports = function (value) {\n  if (typeof value != 'number' && classof(value) != 'Number') {\n    throw TypeError('Incorrect invocation');\n  }\n  return +value;\n};\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionStrong = require('../internals/collection-strong');\n\n// `Map` constructor\n// https://tc39.github.io/ecma262/#sec-map-objects\nmodule.exports = collection('Map', function (init) {\n  return function Map() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionStrong);\n","'use strict';\nvar defineProperty = require('../internals/object-define-property').f;\nvar create = require('../internals/object-create');\nvar redefineAll = require('../internals/redefine-all');\nvar bind = require('../internals/function-bind-context');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar defineIterator = require('../internals/define-iterator');\nvar setSpecies = require('../internals/set-species');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar fastKey = require('../internals/internal-metadata').fastKey;\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, CONSTRUCTOR_NAME);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        index: create(null),\n        first: undefined,\n        last: undefined,\n        size: 0\n      });\n      if (!DESCRIPTORS) that.size = 0;\n      if (iterable != undefined) iterate(iterable, that[ADDER], that, IS_MAP);\n    });\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var entry = getEntry(that, key);\n      var previous, index;\n      // change existing entry\n      if (entry) {\n        entry.value = value;\n      // create new entry\n      } else {\n        state.last = entry = {\n          index: index = fastKey(key, true),\n          key: key,\n          value: value,\n          previous: previous = state.last,\n          next: undefined,\n          removed: false\n        };\n        if (!state.first) state.first = entry;\n        if (previous) previous.next = entry;\n        if (DESCRIPTORS) state.size++;\n        else that.size++;\n        // add to index\n        if (index !== 'F') state.index[index] = entry;\n      } return that;\n    };\n\n    var getEntry = function (that, key) {\n      var state = getInternalState(that);\n      // fast case\n      var index = fastKey(key);\n      var entry;\n      if (index !== 'F') return state.index[index];\n      // frozen object case\n      for (entry = state.first; entry; entry = entry.next) {\n        if (entry.key == key) return entry;\n      }\n    };\n\n    redefineAll(C.prototype, {\n      // 23.1.3.1 Map.prototype.clear()\n      // 23.2.3.2 Set.prototype.clear()\n      clear: function clear() {\n        var that = this;\n        var state = getInternalState(that);\n        var data = state.index;\n        var entry = state.first;\n        while (entry) {\n          entry.removed = true;\n          if (entry.previous) entry.previous = entry.previous.next = undefined;\n          delete data[entry.index];\n          entry = entry.next;\n        }\n        state.first = state.last = undefined;\n        if (DESCRIPTORS) state.size = 0;\n        else that.size = 0;\n      },\n      // 23.1.3.3 Map.prototype.delete(key)\n      // 23.2.3.4 Set.prototype.delete(value)\n      'delete': function (key) {\n        var that = this;\n        var state = getInternalState(that);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.next;\n          var prev = entry.previous;\n          delete state.index[entry.index];\n          entry.removed = true;\n          if (prev) prev.next = next;\n          if (next) next.previous = prev;\n          if (state.first == entry) state.first = next;\n          if (state.last == entry) state.last = prev;\n          if (DESCRIPTORS) state.size--;\n          else that.size--;\n        } return !!entry;\n      },\n      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)\n      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        var state = getInternalState(this);\n        var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);\n        var entry;\n        while (entry = entry ? entry.next : state.first) {\n          boundFunction(entry.value, entry.key, this);\n          // revert to the last existing entry\n          while (entry && entry.removed) entry = entry.previous;\n        }\n      },\n      // 23.1.3.7 Map.prototype.has(key)\n      // 23.2.3.7 Set.prototype.has(value)\n      has: function has(key) {\n        return !!getEntry(this, key);\n      }\n    });\n\n    redefineAll(C.prototype, IS_MAP ? {\n      // 23.1.3.6 Map.prototype.get(key)\n      get: function get(key) {\n        var entry = getEntry(this, key);\n        return entry && entry.value;\n      },\n      // 23.1.3.9 Map.prototype.set(key, value)\n      set: function set(key, value) {\n        return define(this, key === 0 ? 0 : key, value);\n      }\n    } : {\n      // 23.2.3.1 Set.prototype.add(value)\n      add: function add(value) {\n        return define(this, value = value === 0 ? 0 : value, value);\n      }\n    });\n    if (DESCRIPTORS) defineProperty(C.prototype, 'size', {\n      get: function () {\n        return getInternalState(this).size;\n      }\n    });\n    return C;\n  },\n  setStrong: function (C, CONSTRUCTOR_NAME, IS_MAP) {\n    var ITERATOR_NAME = CONSTRUCTOR_NAME + ' Iterator';\n    var getInternalCollectionState = internalStateGetterFor(CONSTRUCTOR_NAME);\n    var getInternalIteratorState = internalStateGetterFor(ITERATOR_NAME);\n    // add .keys, .values, .entries, [@@iterator]\n    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11\n    defineIterator(C, CONSTRUCTOR_NAME, function (iterated, kind) {\n      setInternalState(this, {\n        type: ITERATOR_NAME,\n        target: iterated,\n        state: getInternalCollectionState(iterated),\n        kind: kind,\n        last: undefined\n      });\n    }, function () {\n      var state = getInternalIteratorState(this);\n      var kind = state.kind;\n      var entry = state.last;\n      // revert to the last existing entry\n      while (entry && entry.removed) entry = entry.previous;\n      // get next entry\n      if (!state.target || !(state.last = entry = entry ? entry.next : state.state.first)) {\n        // or finish the iteration\n        state.target = undefined;\n        return { value: undefined, done: true };\n      }\n      // return step by kind\n      if (kind == 'keys') return { value: entry.key, done: false };\n      if (kind == 'values') return { value: entry.value, done: false };\n      return { value: [entry.key, entry.value], done: false };\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // add [@@species], 23.1.2.2, 23.2.2.2\n    setSpecies(CONSTRUCTOR_NAME);\n  }\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar iterate = require('../internals/iterate');\nvar anInstance = require('../internals/an-instance');\nvar isObject = require('../internals/is-object');\nvar fails = require('../internals/fails');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar inheritIfRequired = require('../internals/inherit-if-required');\n\nmodule.exports = function (CONSTRUCTOR_NAME, wrapper, common) {\n  var IS_MAP = CONSTRUCTOR_NAME.indexOf('Map') !== -1;\n  var IS_WEAK = CONSTRUCTOR_NAME.indexOf('Weak') !== -1;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var NativeConstructor = global[CONSTRUCTOR_NAME];\n  var NativePrototype = NativeConstructor && NativeConstructor.prototype;\n  var Constructor = NativeConstructor;\n  var exported = {};\n\n  var fixMethod = function (KEY) {\n    var nativeMethod = NativePrototype[KEY];\n    redefine(NativePrototype, KEY,\n      KEY == 'add' ? function add(value) {\n        nativeMethod.call(this, value === 0 ? 0 : value);\n        return this;\n      } : KEY == 'delete' ? function (key) {\n        return IS_WEAK && !isObject(key) ? false : nativeMethod.call(this, key === 0 ? 0 : key);\n      } : KEY == 'get' ? function get(key) {\n        return IS_WEAK && !isObject(key) ? undefined : nativeMethod.call(this, key === 0 ? 0 : key);\n      } : KEY == 'has' ? function has(key) {\n        return IS_WEAK && !isObject(key) ? false : nativeMethod.call(this, key === 0 ? 0 : key);\n      } : function set(key, value) {\n        nativeMethod.call(this, key === 0 ? 0 : key, value);\n        return this;\n      }\n    );\n  };\n\n  // eslint-disable-next-line max-len\n  if (isForced(CONSTRUCTOR_NAME, typeof NativeConstructor != 'function' || !(IS_WEAK || NativePrototype.forEach && !fails(function () {\n    new NativeConstructor().entries().next();\n  })))) {\n    // create collection constructor\n    Constructor = common.getConstructor(wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER);\n    InternalMetadataModule.REQUIRED = true;\n  } else if (isForced(CONSTRUCTOR_NAME, true)) {\n    var instance = new Constructor();\n    // early implementations not supports chaining\n    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;\n    // V8 ~ Chromium 40- weak-collections throws on primitives, but should return false\n    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });\n    // most early implementations doesn't supports iterables, most modern - not close it correctly\n    // eslint-disable-next-line no-new\n    var ACCEPT_ITERABLES = checkCorrectnessOfIteration(function (iterable) { new NativeConstructor(iterable); });\n    // for early implementations -0 and +0 not the same\n    var BUGGY_ZERO = !IS_WEAK && fails(function () {\n      // V8 ~ Chromium 42- fails only with 5+ elements\n      var $instance = new NativeConstructor();\n      var index = 5;\n      while (index--) $instance[ADDER](index, index);\n      return !$instance.has(-0);\n    });\n\n    if (!ACCEPT_ITERABLES) {\n      Constructor = wrapper(function (dummy, iterable) {\n        anInstance(dummy, Constructor, CONSTRUCTOR_NAME);\n        var that = inheritIfRequired(new NativeConstructor(), dummy, Constructor);\n        if (iterable != undefined) iterate(iterable, that[ADDER], that, IS_MAP);\n        return that;\n      });\n      Constructor.prototype = NativePrototype;\n      NativePrototype.constructor = Constructor;\n    }\n\n    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {\n      fixMethod('delete');\n      fixMethod('has');\n      IS_MAP && fixMethod('get');\n    }\n\n    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);\n\n    // weak collections should not contains .clear method\n    if (IS_WEAK && NativePrototype.clear) delete NativePrototype.clear;\n  }\n\n  exported[CONSTRUCTOR_NAME] = Constructor;\n  $({ global: true, forced: Constructor != NativeConstructor }, exported);\n\n  setToStringTag(Constructor, CONSTRUCTOR_NAME);\n\n  if (!IS_WEAK) common.setStrong(Constructor, CONSTRUCTOR_NAME, IS_MAP);\n\n  return Constructor;\n};\n","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toLength = require('../internals/to-length');\n\n// `Array.prototype.fill` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"fileType\"},[_c('base-panel',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.testloading),expression:\"testloading\"}],attrs:{\"title\":\"新增-文件型数据视图\",\"actions\":_vm.actionsList}},[_c('el-form',{ref:\"fileTypeForm\",staticClass:\"formCss labelSuffix\",attrs:{\"model\":_vm.fileTypeForm,\"rules\":_vm.rules,\"label-position\":\"left\",\"label-width\":\"110px\",\"inline\":true}},[_c('el-form-item',{attrs:{\"label\":\"视图名称：\",\"prop\":\"viewName\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入视图名称\"},model:{value:(_vm.fileTypeForm.viewName),callback:function ($$v) {_vm.$set(_vm.fileTypeForm, \"viewName\", $$v)},expression:\"fileTypeForm.viewName\"}})],1),_c('el-form-item',{staticClass:\"labelStyle\",attrs:{\"label\":\"列表题行：\",\"prop\":\"titleLine\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入列表题行\"},model:{value:(_vm.fileTypeForm.titleLine),callback:function ($$v) {_vm.$set(_vm.fileTypeForm, \"titleLine\", $$v)},expression:\"fileTypeForm.titleLine\"}})],1),_c('el-form-item',{attrs:{\"label\":\"文档库连接器：\",\"prop\":\"linkId\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.fileTypeForm.linkId),callback:function ($$v) {_vm.$set(_vm.fileTypeForm, \"linkId\", $$v)},expression:\"fileTypeForm.linkId\"}},_vm._l((_vm.linkList),function(item){return _c('el-option',{key:item.name,attrs:{\"label\":item.name,\"value\":item.id}})}),1),_c('el-button',{staticClass:\"create_button\",attrs:{\"icon\":\"el-icon-plus\"},on:{\"click\":_vm.createLink}},[_vm._v(\"新增\")])],1),_c('el-form-item',{staticClass:\"labelStyle\",attrs:{\"label\":\"数据起始行：\",\"prop\":\"startLine\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入数据起始行\"},model:{value:(_vm.fileTypeForm.startLine),callback:function ($$v) {_vm.$set(_vm.fileTypeForm, \"startLine\", $$v)},expression:\"fileTypeForm.startLine\"}})],1),_c('el-form-item',{attrs:{\"label\":\"文件路径：\",\"prop\":\"path\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入文件路径\"},model:{value:(_vm.fileTypeForm.path),callback:function ($$v) {_vm.$set(_vm.fileTypeForm, \"path\", $$v)},expression:\"fileTypeForm.path\"}})],1),_c('el-form-item',{staticClass:\"labelStyle\",attrs:{\"label\":\"数据结束行：\",\"prop\":\"endLine\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入数据结束行\"},model:{value:(_vm.fileTypeForm.endLine),callback:function ($$v) {_vm.$set(_vm.fileTypeForm, \"endLine\", $$v)},expression:\"fileTypeForm.endLine\"}})],1),_c('el-form-item',{attrs:{\"label\":\"sheet名称：\",\"prop\":\"sheetName\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入sheet名称\"},model:{value:(_vm.fileTypeForm.sheetName),callback:function ($$v) {_vm.$set(_vm.fileTypeForm, \"sheetName\", $$v)},expression:\"fileTypeForm.sheetName\"}})],1),_c('el-form-item',{staticClass:\"labelStyle\",attrs:{\"label\":\"数据字典:\"}},[_c('el-switch',{attrs:{\"active-value\":0,\"inactive-value\":1},model:{value:(_vm.fileTypeForm.dictFlag),callback:function ($$v) {_vm.$set(_vm.fileTypeForm, \"dictFlag\", $$v)},expression:\"fileTypeForm.dictFlag\"}})],1)],1),_c('simple-card',{attrs:{\"actions\":_vm.paramsActions,\"title\":\"参数列表\"}},[_c('parameView',{ref:\"parameViewTable\",attrs:{\"isCompatible\":_vm.isCompatible,\"dictFlag\":_vm.fileTypeForm.dictFlag,\"parameter-data\":_vm.parameterTable}})],1),_c('simple-card',{attrs:{\"title\":\"Excel预览\"}},[_c('div',{attrs:{\"id\":\"spreadsheet-execl\",\"height\":\"300px\"}})]),_c('simple-card',{attrs:{\"title\":\"字段列表\"}},[_c('treeTableList',{ref:\"treeLists\",attrs:{\"isCompatible\":_vm.isCompatible,\"data-list\":_vm.fieldTable}})],1),_c('createDialog',{attrs:{\"dialog-title\":\"新建文档库连接器\",\"dialog-visible\":_vm.dialogVisible,\"dialog-width\":\"500px\",\"botton-show\":\"true\",\"type\":\"2\",\"save-text\":\"保存\",\"cancel-text\":\"取消\"},on:{\"saveEmit\":_vm.handelSure,\"cancelEmit\":_vm.handelCancel}}),_c('testEditor',{ref:\"advance\",attrs:{\"dialog-test-switch\":_vm.testParameterDialog,\"params-list\":_vm.parameterTable},on:{\"saveEmitSwitch\":_vm.handleTestQuery,\"cancelEmitSwitch\":_vm.testParameterCancel}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}","/* global document */\r\n/* global window */\r\n/**\r\n * Element 相当于vue的组件对象\r\n */\r\nclass Element {\r\n  /**\r\n   * 使用doeument.createElemet创建 document的Elementt节点对象\r\n   * @param {*} tag html元素标签 或者一个现成的Element对象\r\n   * @param {*} className 类名\r\n   */\r\n  constructor(tag, className = '') {\r\n    if (typeof tag === 'string') {\r\n      this.el = document.createElement(tag);\r\n      this.el.className = className;\r\n    } else {\r\n      this.el = tag;\r\n    }\r\n    this.data = {};\r\n  }\r\n\r\n  /**\r\n   * 设置对象的自定义属性\r\n   * @param {*} key\r\n   * @param {*} value\r\n   */\r\n  data(key, value) {\r\n    if (value !== undefined) {\r\n      this.data[key] = value;\r\n      return this;\r\n    }\r\n    return this.data[key];\r\n  }\r\n\r\n  on(eventNames, handler) {\r\n    const [fen, ...oen] = eventNames.split('.');\r\n    let eventName = fen;\r\n    if (\r\n      eventName === 'mousewheel' &&\r\n      /Firefox/i.test(window.navigator.userAgent)\r\n    ) {\r\n      eventName = 'DOMMouseScroll';\r\n    }\r\n    this.el.addEventListener(eventName, (evt) => {\r\n      handler(evt);\r\n      for (let i = 0; i < oen.length; i += 1) {\r\n        const k = oen[i];\r\n        if (k === 'left' && evt.button !== 0) {\r\n          return;\r\n        }\r\n        if (k === 'right' && evt.button !== 2) {\r\n          return;\r\n        }\r\n        if (k === 'stop') {\r\n          evt.stopPropagation();\r\n        }\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置 / 获取 当前元素的坐标位置和尺寸\r\n   * @param {*} value\r\n   */\r\n  offset(value) {\r\n    if (value !== undefined) {\r\n      Object.keys(value).forEach((k) => {\r\n        this.css(k, `${value[k]}px`);\r\n      });\r\n      return this;\r\n    }\r\n    const { offsetTop, offsetLeft, offsetHeight, offsetWidth } = this.el;\r\n    return {\r\n      top: offsetTop,\r\n      left: offsetLeft,\r\n      height: offsetHeight,\r\n      width: offsetWidth\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 设置元素滚动条位置，并返回调整之后的值\r\n   * @param {left, top} v\r\n   */\r\n  scroll(v) {\r\n    const { el } = this;\r\n    if (v !== undefined) {\r\n      if (v.left !== undefined) {\r\n        el.scrollLeft = v.left;\r\n      }\r\n      if (v.top !== undefined) {\r\n        el.scrollTop = v.top;\r\n      }\r\n    }\r\n    return { left: el.scrollLeft, top: el.scrollTop };\r\n  }\r\n\r\n  /**\r\n   * 返回元素的DomRect盒对象，该盒数据都相对于视区 viewport\r\n   */\r\n  box() {\r\n    return this.el.getBoundingClientRect();\r\n  }\r\n\r\n  // 返回该元素的对应的父节点的Elememt对象\r\n  parent() {\r\n    return new Element(this.el.parentNode);\r\n  }\r\n\r\n  /**\r\n   * 设置 / 获取 当前元素子节点的对应的Elememt数组\r\n   * @param  {...any} eles\r\n   */\r\n  children(...eles) {\r\n    if (arguments.length === 0) {\r\n      return this.el.childNodes;\r\n    }\r\n    eles.forEach((ele) => this.child(ele));\r\n    return this;\r\n  }\r\n\r\n  /*\r\n  first() {\r\n    return this.el.firstChild;\r\n  }\r\n\r\n  last() {\r\n    return this.el.lastChild;\r\n  }\r\n\r\n  remove(ele) {\r\n    return this.el.removeChild(ele);\r\n  }\r\n\r\n  prepend(ele) {\r\n    const { el } = this;\r\n    if (el.children.length > 0) {\r\n      el.insertBefore(ele, el.firstChild);\r\n    } else {\r\n      el.appendChild(ele);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  prev() {\r\n    return this.el.previousSibling;\r\n  }\r\n\r\n  next() {\r\n    return this.el.nextSibling;\r\n  }\r\n  */\r\n\r\n  // 为当前元素添加子节点\r\n  child(arg) {\r\n    let ele = arg;\r\n    if (typeof arg === 'string') {\r\n      ele = document.createTextNode(arg);\r\n    } else if (arg instanceof Element) {\r\n      ele = arg.el;\r\n    }\r\n    this.el.appendChild(ele);\r\n    return this;\r\n  }\r\n\r\n  // 判断元素是否包含指定子节点\r\n  contains(ele) {\r\n    return this.el.contains(ele);\r\n  }\r\n\r\n  className(v) {\r\n    if (v !== undefined) {\r\n      this.el.className = v;\r\n      return this;\r\n    }\r\n    return this.el.className;\r\n  }\r\n\r\n  addClass(name) {\r\n    this.el.classList.add(name);\r\n    return this;\r\n  }\r\n\r\n  hasClass(name) {\r\n    return this.el.classList.contains(name);\r\n  }\r\n\r\n  removeClass(name) {\r\n    this.el.classList.remove(name);\r\n    return this;\r\n  }\r\n\r\n  toggle(cls = 'active') {\r\n    return this.toggleClass(cls);\r\n  }\r\n\r\n  toggleClass(name) {\r\n    return this.el.classList.toggle(name);\r\n  }\r\n\r\n  active(flag = true) {\r\n    if (flag) this.addClass('active');\r\n    else this.removeClass('active');\r\n    return this;\r\n  }\r\n\r\n  disabled(flag = true) {\r\n    if (flag) this.addClass('disabled');\r\n    else this.removeClass('disabled');\r\n    return this;\r\n  }\r\n\r\n  // key, value\r\n  // key\r\n  // {k, v}...\r\n  attr(key, value) {\r\n    if (value !== undefined) {\r\n      this.el.setAttribute(key, value);\r\n    } else {\r\n      if (typeof key === 'string') {\r\n        return this.el.getAttribute(key);\r\n      }\r\n      Object.keys(key).forEach((k) => {\r\n        this.el.setAttribute(k, key[k]);\r\n      });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  removeAttr(key) {\r\n    this.el.removeAttribute(key);\r\n    return this;\r\n  }\r\n\r\n  html(content) {\r\n    if (content !== undefined) {\r\n      this.el.innerHTML = content;\r\n      return this;\r\n    }\r\n    return this.el.innerHTML;\r\n  }\r\n\r\n  val(v) {\r\n    if (v !== undefined) {\r\n      this.el.value = v;\r\n      return this;\r\n    }\r\n    return this.el.value;\r\n  }\r\n\r\n  cssRemoveKeys(...keys) {\r\n    keys.forEach((k) => this.el.style.removeProperty(k));\r\n    return this;\r\n  }\r\n\r\n  // css( propertyName )\r\n  // css( propertyName, value )\r\n  // css( properties )\r\n  css(name, value) {\r\n    if (value === undefined && typeof name !== 'string') {\r\n      Object.keys(name).forEach((k) => {\r\n        this.el.style[k] = name[k];\r\n      });\r\n      return this;\r\n    }\r\n    if (value !== undefined) {\r\n      this.el.style[name] = value;\r\n      return this;\r\n    }\r\n    return this.el.style[name];\r\n  }\r\n\r\n  computedStyle() {\r\n    return window.getComputedStyle(this.el, null);\r\n  }\r\n\r\n  show() {\r\n    this.css('display', 'block');\r\n    return this;\r\n  }\r\n\r\n  hide() {\r\n    this.css('display', 'none');\r\n    return this;\r\n  }\r\n}\r\n\r\nconst h = (tag, className = '') => new Element(tag, className);\r\n\r\nexport { Element, h };\r\n","const alphabets = [\r\n  'A',\r\n  'B',\r\n  'C',\r\n  'D',\r\n  'E',\r\n  'F',\r\n  'G',\r\n  'H',\r\n  'I',\r\n  'J',\r\n  'K',\r\n  'L',\r\n  'M',\r\n  'N',\r\n  'O',\r\n  'P',\r\n  'Q',\r\n  'R',\r\n  'S',\r\n  'T',\r\n  'U',\r\n  'V',\r\n  'W',\r\n  'X',\r\n  'Y',\r\n  'Z'\r\n];\r\n\r\nexport function stringAt(index) {\r\n  let str = '';\r\n  let cindex = index;\r\n  while (cindex >= alphabets.length) {\r\n    cindex /= alphabets.length;\r\n    cindex -= 1;\r\n    str += alphabets[parseInt(cindex, 10) % alphabets.length];\r\n  }\r\n  const last = index % alphabets.length;\r\n  str += alphabets[last];\r\n  return str;\r\n}\r\n\r\nexport function indexAt(str) {\r\n  let ret = 0;\r\n  for (let i = 0; i < str.length - 1; i += 1) {\r\n    const cindex = str.charCodeAt(i) - 65;\r\n    const exponet = str.length - 1 - i;\r\n    ret += alphabets.length ** exponet + alphabets.length * cindex;\r\n  }\r\n  ret += str.charCodeAt(str.length - 1) - 65;\r\n  return ret;\r\n}\r\n\r\n// B10 => x,y\r\nexport function expr2xy(src) {\r\n  let x = '';\r\n  let y = '';\r\n  for (let i = 0; i < src.length; i += 1) {\r\n    if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\r\n      y += src.charAt(i);\r\n    } else {\r\n      x += src.charAt(i);\r\n    }\r\n  }\r\n  return [indexAt(x), parseInt(y, 10) - 1];\r\n}\r\n\r\nexport function expr2expr(src, xn, yn) {\r\n  const [x, y] = expr2xy(src);\r\n  return stringAt(x + xn) + (y + yn);\r\n}\r\n\r\n// x,y => B10\r\nexport function xy2expr(x, y) {\r\n  return `${stringAt(x)}${y + 1}`;\r\n}\r\n\r\nexport default {\r\n  stringAt,\r\n  indexAt,\r\n  expr2xy,\r\n  xy2expr,\r\n  expr2expr\r\n};\r\n","import { xy2expr, expr2xy } from './alphabet';\r\n\r\n/**\r\n * 合并单元格对象\r\n * 构造函数（开始行标，开始列标、结束行标、结束列标、宽度？、高度？）\r\n */\r\nclass CellRange {\r\n  constructor(sri, sci, eri, eci, w = 0, h = 0) {\r\n    this.sri = sri;\r\n    this.sci = sci;\r\n    this.eri = eri;\r\n    this.eci = eci;\r\n    this.w = w;\r\n    this.h = h;\r\n  }\r\n\r\n  set(sri, sci, eri, eci) {\r\n    this.sri = sri;\r\n    this.sci = sci;\r\n    this.eri = eri;\r\n    this.eci = eci;\r\n  }\r\n\r\n  /**\r\n   * 判断该对象是否由多个单元格组成\r\n   */\r\n  multiple() {\r\n    return this.eri - this.sri > 0 || this.eci - this.sci > 0;\r\n  }\r\n\r\n  // cell-index: ri, ci\r\n  // cell-ref: A10\r\n  // 判断指定坐标是否在当前合并单元格区域内\r\n  includes(...args) {\r\n    let [ri, ci] = [0, 0];\r\n    if (args.length === 1) {\r\n      [ci, ri] = expr2xy(args[0]);\r\n    } else if (args.length === 2) {\r\n      [ri, ci] = args;\r\n    }\r\n    const { sri, sci, eri, eci } = this;\r\n    return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\r\n  }\r\n\r\n  // 为合并区域内的每一个单元格执行回调函数\r\n  each(cb) {\r\n    const { sri, sci, eri, eci } = this;\r\n    for (let i = sri; i <= eri; i += 1) {\r\n      for (let j = sci; j <= eci; j += 1) {\r\n        cb(i, j);\r\n      }\r\n    }\r\n  }\r\n\r\n  // 包含 判断参数区域是否包含在该对象中\r\n  contains(other) {\r\n    return (\r\n      this.sri <= other.sri &&\r\n      this.sci <= other.sci &&\r\n      this.eri >= other.eri &&\r\n      this.eci >= other.eci\r\n    );\r\n  }\r\n\r\n  // 嵌入 判断本单元格是否在参数区域内\r\n  within(other) {\r\n    return (\r\n      this.sri >= other.sri &&\r\n      this.sci >= other.sci &&\r\n      this.eri <= other.eri &&\r\n      this.eci <= other.eci\r\n    );\r\n  }\r\n\r\n  // disjoint 是否完全不沾边\r\n  disjoint(other) {\r\n    return (\r\n      this.sri > other.eri ||\r\n      this.sci > other.eci ||\r\n      other.sri > this.eri ||\r\n      other.sci > this.eci\r\n    );\r\n  }\r\n\r\n  // intersects 判断双方是否存在重叠区域\r\n  intersects(other) {\r\n    return (\r\n      this.sri <= other.eri &&\r\n      this.sci <= other.eci &&\r\n      other.sri <= this.eri &&\r\n      other.sci <= this.eci\r\n    );\r\n  }\r\n\r\n  // union 并集，返回更大的起始坐标组成的区域\r\n  union(other) {\r\n    const { sri, sci, eri, eci } = this;\r\n    return new CellRange(\r\n      other.sri < sri ? other.sri : sri,\r\n      other.sci < sci ? other.sci : sci,\r\n      other.eri > eri ? other.eri : eri,\r\n      other.eci > eci ? other.eci : eci\r\n    );\r\n  }\r\n\r\n  // intersection\r\n  // intersection(other) {}\r\n\r\n  // Returns Array<CellRange> that represents that part of this that does not intersect with other\r\n  // difference 返回重叠区域以外的区域组成的CellRnage对象数组\r\n  difference(other) {\r\n    const ret = [];\r\n    const addRet = (sri, sci, eri, eci) => {\r\n      ret.push(new CellRange(sri, sci, eri, eci));\r\n    };\r\n    const { sri, sci, eri, eci } = this;\r\n    const dsr = other.sri - sri;\r\n    const dsc = other.sci - sci;\r\n    const der = eri - other.eri;\r\n    const dec = eci - other.eci;\r\n    if (dsr > 0) {\r\n      addRet(sri, sci, other.sri - 1, eci);\r\n      if (der > 0) {\r\n        addRet(other.eri + 1, sci, eri, eci);\r\n        if (dsc > 0) {\r\n          addRet(other.sri, sci, other.eri, other.sci - 1);\r\n        }\r\n        if (dec > 0) {\r\n          addRet(other.sri, other.eci + 1, other.eri, eci);\r\n        }\r\n      } else {\r\n        if (dsc > 0) {\r\n          addRet(other.sri, sci, eri, other.sci - 1);\r\n        }\r\n        if (dec > 0) {\r\n          addRet(other.sri, other.eci + 1, eri, eci);\r\n        }\r\n      }\r\n    } else if (der > 0) {\r\n      addRet(other.eri + 1, sci, eri, eci);\r\n      if (dsc > 0) {\r\n        addRet(sri, sci, other.eri, other.sci - 1);\r\n      }\r\n      if (dec > 0) {\r\n        addRet(sri, other.eci + 1, other.eri, eci);\r\n      }\r\n    }\r\n    if (dsc > 0) {\r\n      addRet(sri, sci, eri, other.sci - 1);\r\n      if (dec > 0) {\r\n        addRet(sri, other.eri + 1, eri, eci);\r\n        if (dsr > 0) {\r\n          addRet(sri, other.sci, other.sri - 1, other.eci);\r\n        }\r\n        if (der > 0) {\r\n          addRet(other.sri + 1, other.sci, eri, other.eci);\r\n        }\r\n      } else {\r\n        if (dsr > 0) {\r\n          addRet(sri, other.sci, other.sri - 1, eci);\r\n        }\r\n        if (der > 0) {\r\n          addRet(other.sri + 1, other.sci, eri, eci);\r\n        }\r\n      }\r\n    } else if (dec > 0) {\r\n      addRet(eri, other.eci + 1, eri, eci);\r\n      if (dsr > 0) {\r\n        addRet(sri, sci, other.sri - 1, other.eci);\r\n      }\r\n      if (der > 0) {\r\n        addRet(other.eri + 1, sci, eri, other.eci);\r\n      }\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  size() {\r\n    return [this.eri - this.sri + 1, this.eci - this.sci + 1];\r\n  }\r\n\r\n  toString() {\r\n    const { sri, sci, eri, eci } = this;\r\n    let ref = xy2expr(sci, sri);\r\n    if (this.multiple()) {\r\n      ref = `${ref}:${xy2expr(eci, eri)}`;\r\n    }\r\n    return ref;\r\n  }\r\n\r\n  clone() {\r\n    const { sri, sci, eri, eci, w, h } = this;\r\n    return new CellRange(sri, sci, eri, eci, w, h);\r\n  }\r\n\r\n  /*\r\n  toJSON() {\r\n    return this.toString();\r\n  }\r\n  */\r\n\r\n  equals(other) {\r\n    return (\r\n      this.eri === other.eri &&\r\n      this.eci === other.eci &&\r\n      this.sri === other.sri &&\r\n      this.sci === other.sci\r\n    );\r\n  }\r\n\r\n  static valueOf(ref) {\r\n    // B1:B8, B1 => 1 x 1 cell range\r\n    const refs = ref.split(':');\r\n    const [sci, sri] = expr2xy(refs[0]);\r\n    let [eri, eci] = [sri, sci];\r\n    if (refs.length > 1) {\r\n      [eci, eri] = expr2xy(refs[1]);\r\n    }\r\n    return new CellRange(sri, sci, eri, eci);\r\n  }\r\n}\r\n\r\nexport default CellRange;\r\n\r\nexport { CellRange };\r\n","import { CellRange } from './cell_range';\r\n\r\nexport default class Selector {\r\n  constructor() {\r\n    this.range = new CellRange(0, 0, 0, 0); // 每一个普通单元格都是一个特殊的合并单元格\r\n    this.ri = 0;\r\n    this.ci = 0;\r\n  }\r\n\r\n  multiple() {\r\n    return this.range.multiple();\r\n  }\r\n\r\n  setIndexes(ri, ci) {\r\n    this.ri = ri;\r\n    this.ci = ci;\r\n  }\r\n\r\n  size() {\r\n    return this.range.size();\r\n  }\r\n}\r\n","export default class Scroll {\r\n  constructor() {\r\n    this.x = 0; // left\r\n    this.y = 0; // top\r\n    this.ri = 0; // cell row-index\r\n    this.ci = 0; // cell col-index\r\n  }\r\n}\r\n","// import helper from '../helper';\r\n\r\nexport default class History {\r\n  constructor() {\r\n    this.undoItems = [];\r\n    this.redoItems = [];\r\n  }\r\n\r\n  add(data) {\r\n    this.undoItems.push(JSON.stringify(data));\r\n    this.redoItems = [];\r\n  }\r\n\r\n  canUndo() {\r\n    return this.undoItems.length > 0;\r\n  }\r\n\r\n  canRedo() {\r\n    return this.redoItems.length > 0;\r\n  }\r\n\r\n  undo(currentd, cb) {\r\n    const { undoItems, redoItems } = this;\r\n    if (this.canUndo()) {\r\n      redoItems.push(JSON.stringify(currentd));\r\n      cb(JSON.parse(undoItems.pop()));\r\n    }\r\n  }\r\n\r\n  redo(currentd, cb) {\r\n    const { undoItems, redoItems } = this;\r\n    if (this.canRedo()) {\r\n      undoItems.push(JSON.stringify(currentd));\r\n      cb(JSON.parse(redoItems.pop()));\r\n    }\r\n  }\r\n}\r\n","export default class Clipboard {\r\n  constructor() {\r\n    this.range = null; // CellRange\r\n    this.state = 'clear';\r\n  }\r\n\r\n  copy(cellRange) {\r\n    this.range = cellRange;\r\n    this.state = 'copy';\r\n    return this;\r\n  }\r\n\r\n  cut(cellRange) {\r\n    this.range = cellRange;\r\n    this.state = 'cut';\r\n    return this;\r\n  }\r\n\r\n  isCopy() {\r\n    return this.state === 'copy';\r\n  }\r\n\r\n  isCut() {\r\n    return this.state === 'cut';\r\n  }\r\n\r\n  isClear() {\r\n    return this.state === 'clear';\r\n  }\r\n\r\n  clear() {\r\n    this.range = null;\r\n    this.state = 'clear';\r\n  }\r\n}\r\n","import { CellRange } from './cell_range';\r\n\r\nclass Merges {\r\n  constructor(d = []) {\r\n    this._ = d;\r\n  }\r\n\r\n  forEach(cb) {\r\n    this._.forEach(cb);\r\n  }\r\n\r\n  deleteWithin(cr) {\r\n    this._ = this._.filter((it) => !it.within(cr));\r\n  }\r\n\r\n  getFirstIncludes(ri, ci) {\r\n    for (let i = 0; i < this._.length; i += 1) {\r\n      const it = this._[i];\r\n      if (it.includes(ri, ci)) {\r\n        return it;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  filterIntersects(cellRange) {\r\n    return new Merges(this._.filter((it) => it.intersects(cellRange)));\r\n  }\r\n\r\n  intersects(cellRange) {\r\n    for (let i = 0; i < this._.length; i += 1) {\r\n      const it = this._[i];\r\n      if (it.intersects(cellRange)) {\r\n        // console.log('intersects');\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  union(cellRange) {\r\n    let cr = cellRange;\r\n    this._.forEach((it) => {\r\n      if (it.intersects(cr)) {\r\n        cr = it.union(cr);\r\n      }\r\n    });\r\n    return cr;\r\n  }\r\n\r\n  add(cr) {\r\n    this.deleteWithin(cr);\r\n    this._.push(cr);\r\n  }\r\n\r\n  // type: row | column\r\n  shift(type, index, n, cbWithin) {\r\n    this._.forEach((cellRange) => {\r\n      const { sri, sci, eri, eci } = cellRange;\r\n      const range = cellRange;\r\n      if (type === 'row') {\r\n        if (sri >= index) {\r\n          range.sri += n;\r\n          range.eri += n;\r\n        } else if (sri < index && index <= eri) {\r\n          range.eri += n;\r\n          cbWithin(sri, sci, n, 0);\r\n        }\r\n      } else if (type === 'column') {\r\n        if (sci >= index) {\r\n          range.sci += n;\r\n          range.eci += n;\r\n        } else if (sci < index && index <= eci) {\r\n          range.eci += n;\r\n          cbWithin(sri, sci, 0, n);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  move(cellRange, rn, cn) {\r\n    this._.forEach((it1) => {\r\n      const it = it1;\r\n      if (it.within(cellRange)) {\r\n        it.eri += rn;\r\n        it.sri += rn;\r\n        it.sci += cn;\r\n        it.eci += cn;\r\n      }\r\n    });\r\n  }\r\n\r\n  // 将合并单元格配置转换为合并单元格数组对象\r\n  setData(merges) {\r\n    this._ = merges.map((merge) => CellRange.valueOf(merge));\r\n    return this;\r\n  }\r\n\r\n  getData() {\r\n    return this._.map((merge) => merge.toString());\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport { Merges };\r\n","/* eslint-disable no-param-reassign */\r\nfunction cloneDeep(obj) {\r\n  return JSON.parse(JSON.stringify(obj));\r\n}\r\n\r\nconst mergeDeep = (object = {}, ...sources) => {\r\n  sources.forEach((source) => {\r\n    Object.keys(source).forEach((key) => {\r\n      const v = source[key];\r\n      // console.log('k:', key, ', v:', source[key], typeof v, v instanceof Object);\r\n      if (\r\n        typeof v === 'string' ||\r\n        typeof v === 'number' ||\r\n        typeof v === 'boolean'\r\n      ) {\r\n        object[key] = v;\r\n      } else if (\r\n        typeof v !== 'function' &&\r\n        !Array.isArray(v) &&\r\n        v instanceof Object\r\n      ) {\r\n        object[key] = object[key] || {};\r\n        mergeDeep(object[key], v);\r\n      } else {\r\n        object[key] = v;\r\n      }\r\n    });\r\n  });\r\n  // console.log('::', object);\r\n  return object;\r\n};\r\n\r\nfunction equals(obj1, obj2) {\r\n  const keys = Object.keys(obj1);\r\n  if (keys.length !== Object.keys(obj2).length) return false;\r\n  for (let i = 0; i < keys.length; i += 1) {\r\n    const k = keys[i];\r\n    const v1 = obj1[k];\r\n    const v2 = obj2[k];\r\n    if (v2 === undefined) return false;\r\n    if (\r\n      typeof v1 === 'string' ||\r\n      typeof v1 === 'number' ||\r\n      typeof v1 === 'boolean'\r\n    ) {\r\n      if (v1 !== v2) return false;\r\n    } else if (Array.isArray(v1)) {\r\n      if (v1.length !== v2.length) return false;\r\n      for (let ai = 0; ai < v1.length; ai += 1) {\r\n        if (!equals(v1[ai], v2[ai])) return false;\r\n      }\r\n    } else if (\r\n      typeof v1 !== 'function' &&\r\n      !Array.isArray(v1) &&\r\n      v1 instanceof Object\r\n    ) {\r\n      if (!equals(v1, v2)) return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n/*\r\n  objOrAry: obejct or Array\r\n  cb: (value, index | key) => { return value }\r\n*/\r\nconst sum = (objOrAry, cb = (value) => value) => {\r\n  let total = 0;\r\n  let size = 0;\r\n  Object.keys(objOrAry).forEach((key) => {\r\n    total += cb(objOrAry[key], key);\r\n    size += 1;\r\n  });\r\n  return [total, size];\r\n};\r\n\r\nfunction deleteProperty(obj, property) {\r\n  const oldv = obj[`${property}`];\r\n  delete obj[`${property}`];\r\n  return oldv;\r\n}\r\n\r\nfunction rangeReduceIf(min, max, inits, initv, ifv, getv) {\r\n  let s = inits;\r\n  let v = initv;\r\n  let i = min;\r\n  for (; i < max; i += 1) {\r\n    if (s > ifv) break;\r\n    v = getv(i);\r\n    s += v;\r\n  }\r\n  return [i, s - v, v];\r\n}\r\n\r\nfunction rangeSum(min, max, getv) {\r\n  let s = 0;\r\n  for (let i = min; i < max; i += 1) {\r\n    s += getv(i);\r\n  }\r\n  return s;\r\n}\r\n\r\nfunction rangeEach(min, max, cb) {\r\n  for (let i = min; i < max; i += 1) {\r\n    cb(i);\r\n  }\r\n}\r\n\r\nfunction arrayEquals(a1, a2) {\r\n  if (a1.length === a2.length) {\r\n    for (let i = 0; i < a1.length; i += 1) {\r\n      if (a1[i] !== a2[i]) return false;\r\n    }\r\n  } else return false;\r\n  return true;\r\n}\r\n\r\nexport default {\r\n  cloneDeep,\r\n  merge: (...sources) => mergeDeep({}, ...sources),\r\n  equals,\r\n  arrayEquals,\r\n  sum,\r\n  rangeEach,\r\n  rangeSum,\r\n  rangeReduceIf,\r\n  deleteProperty\r\n};\r\n","import helper from './helper';\r\nimport { expr2expr } from './alphabet';\r\n\r\nclass Rows {\r\n  constructor({ len, height }) {\r\n    this._ = {};\r\n    this.len = len;\r\n    // default row height\r\n    this.height = height;\r\n  }\r\n\r\n  getHeight(ri) {\r\n    const row = this.get(ri);\r\n    if (row && row.height) {\r\n      return row.height;\r\n    }\r\n    return this.height;\r\n  }\r\n\r\n  setHeight(ri, v) {\r\n    const row = this.getOrNew(ri);\r\n    row.height = v;\r\n  }\r\n\r\n  setStyle(ri, style) {\r\n    const row = this.getOrNew(ri);\r\n    row.style = style;\r\n  }\r\n\r\n  sumHeight(min, max) {\r\n    return helper.rangeSum(min, max, (i) => this.getHeight(i));\r\n  }\r\n\r\n  totalHeight() {\r\n    return this.sumHeight(0, this.len);\r\n  }\r\n\r\n  get(ri) {\r\n    return this._[ri];\r\n  }\r\n\r\n  getOrNew(ri) {\r\n    this._[ri] = this._[ri] || { cells: {} };\r\n    return this._[ri];\r\n  }\r\n\r\n  getCell(ri, ci) {\r\n    const row = this.get(ri);\r\n    if (\r\n      row !== undefined &&\r\n      row.cells !== undefined &&\r\n      row.cells[ci] !== undefined\r\n    ) {\r\n      return row.cells[ci];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getCellMerge(ri, ci) {\r\n    const cell = this.getCell(ri, ci);\r\n    if (cell && cell.merge) return cell.merge;\r\n    return [0, 0];\r\n  }\r\n\r\n  getCellOrNew(ri, ci) {\r\n    const row = this.getOrNew(ri);\r\n    row.cells[ci] = row.cells[ci] || {};\r\n    return row.cells[ci];\r\n  }\r\n\r\n  // what: all | text | format\r\n  setCell(ri, ci, cell, what = 'all') {\r\n    const row = this.getOrNew(ri);\r\n    if (what === 'all') {\r\n      row.cells[ci] = cell;\r\n    } else if (what === 'text') {\r\n      row.cells[ci] = row.cells[ci] || {};\r\n      row.cells[ci].text = cell.text;\r\n    } else if (what === 'format') {\r\n      row.cells[ci] = row.cells[ci] || {};\r\n      row.cells[ci].style = cell.style;\r\n      if (cell.merge) row.cells[ci].merge = cell.merge;\r\n    }\r\n  }\r\n\r\n  setCellText(ri, ci, text) {\r\n    const cell = this.getCellOrNew(ri, ci);\r\n    cell.text = text;\r\n  }\r\n\r\n  // what: all | format | text\r\n  copyPaste(srcCellRange, dstCellRange, what, autofill = false, cb = () => {}) {\r\n    const { sri, sci, eri, eci } = srcCellRange;\r\n    const dsri = dstCellRange.sri;\r\n    const dsci = dstCellRange.sci;\r\n    const deri = dstCellRange.eri;\r\n    const deci = dstCellRange.eci;\r\n    const [rn, cn] = srcCellRange.size();\r\n    const [drn, dcn] = dstCellRange.size();\r\n    // console.log(srcIndexes, dstIndexes);\r\n    let isAdd = true;\r\n    let dn = 0;\r\n    if (deri < sri || deci < sci) {\r\n      isAdd = false;\r\n      if (deri < sri) dn = drn;\r\n      else dn = dcn;\r\n    }\r\n    // console.log('drn:', drn, ', dcn:', dcn);\r\n    for (let i = sri; i <= eri; i += 1) {\r\n      if (this._[i]) {\r\n        for (let j = sci; j <= eci; j += 1) {\r\n          if (this._[i].cells && this._[i].cells[j]) {\r\n            for (let ii = dsri; ii <= deri; ii += rn) {\r\n              for (let jj = dsci; jj <= deci; jj += cn) {\r\n                const nri = ii + (i - sri);\r\n                const nci = jj + (j - sci);\r\n                const ncell = helper.cloneDeep(this._[i].cells[j]);\r\n                // ncell.text\r\n                if (autofill && ncell && ncell.text && ncell.text.length > 0) {\r\n                  const { text } = ncell;\r\n                  let n = jj - dsci + (ii - dsri) + 1;\r\n                  // console.log('n:', n);\r\n                  if (!isAdd) {\r\n                    n -= dn + 1;\r\n                  }\r\n                  if (text[0] === '=') {\r\n                    ncell.text = text.replace(/\\w{1,3}\\d/g, (word) => {\r\n                      let [xn, yn] = [0, 0];\r\n                      if (sri === dsri) {\r\n                        xn = n;\r\n                      } else {\r\n                        yn = n;\r\n                      }\r\n                      // console.log('xn:', xn, ', yn:', yn, expr2expr(word, xn, yn));\r\n                      return expr2expr(word, xn, yn);\r\n                    });\r\n                  } else {\r\n                    const result = /[\\\\.\\d]+$/.exec(text);\r\n                    // console.log('result:', result);\r\n                    if (result !== null) {\r\n                      const index = Number(result[0]) + n;\r\n                      ncell.text = text.substring(0, result.index) + index;\r\n                    }\r\n                  }\r\n                }\r\n                // console.log('ncell:', nri, nci, ncell);\r\n                this.setCell(nri, nci, ncell, what);\r\n                cb(nri, nci, ncell);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  cutPaste(srcCellRange, dstCellRange) {\r\n    const ncellmm = {};\r\n    this.each((ri) => {\r\n      this.eachCells(ri, (ci) => {\r\n        let nri = parseInt(ri, 10);\r\n        let nci = parseInt(ci, 10);\r\n        if (srcCellRange.includes(ri, ci)) {\r\n          nri = dstCellRange.sri + (nri - srcCellRange.sri);\r\n          nci = dstCellRange.sci + (nci - srcCellRange.sci);\r\n        }\r\n        ncellmm[nri] = ncellmm[nri] || { cells: {} };\r\n        ncellmm[nri].cells[nci] = this._[ri].cells[ci];\r\n      });\r\n    });\r\n    this._ = ncellmm;\r\n  }\r\n\r\n  insert(sri, n = 1) {\r\n    const ndata = {};\r\n    this.each((ri, row) => {\r\n      let nri = parseInt(ri, 10);\r\n      if (nri >= sri) {\r\n        nri += n;\r\n      }\r\n      ndata[nri] = row;\r\n    });\r\n    this._ = ndata;\r\n    this.len += n;\r\n  }\r\n\r\n  delete(sri, eri) {\r\n    const n = eri - sri + 1;\r\n    const ndata = {};\r\n    this.each((ri, row) => {\r\n      const nri = parseInt(ri, 10);\r\n      if (nri < sri) {\r\n        ndata[nri] = row;\r\n      } else if (ri > eri) {\r\n        ndata[nri - n] = row;\r\n      }\r\n    });\r\n    this._ = ndata;\r\n    this.len -= n;\r\n  }\r\n\r\n  insertColumn(sci, n = 1) {\r\n    this.each((ri, row) => {\r\n      const rndata = {};\r\n      this.eachCells(ri, (ci, cell) => {\r\n        let nci = parseInt(ci, 10);\r\n        if (nci >= sci) {\r\n          nci += n;\r\n        }\r\n        rndata[nci] = cell;\r\n      });\r\n      row.cells = rndata;\r\n    });\r\n  }\r\n\r\n  deleteColumn(sci, eci) {\r\n    const n = eci - sci + 1;\r\n    this.each((ri, row) => {\r\n      const rndata = {};\r\n      this.eachCells(ri, (ci, cell) => {\r\n        const nci = parseInt(ci, 10);\r\n        if (nci < sci) {\r\n          rndata[nci] = cell;\r\n        } else if (nci > eci) {\r\n          rndata[nci - n] = cell;\r\n        }\r\n      });\r\n      row.cells = rndata;\r\n    });\r\n  }\r\n\r\n  // what: all | text | format | merge\r\n  deleteCells(cellRange, what = 'all') {\r\n    cellRange.each((i, j) => {\r\n      this.deleteCell(i, j, what);\r\n    });\r\n  }\r\n\r\n  // what: all | text | format | merge\r\n  deleteCell(ri, ci, what = 'all') {\r\n    const row = this.get(ri);\r\n    if (row !== null) {\r\n      const cell = this.getCell(ri, ci);\r\n      if (cell !== null) {\r\n        if (what === 'all') {\r\n          delete row.cells[ci];\r\n        } else if (what === 'text') {\r\n          if (cell.text) delete cell.text;\r\n          if (cell.value) delete cell.value;\r\n        } else if (what === 'format') {\r\n          if (cell.style !== undefined) delete cell.style;\r\n          if (cell.merge) delete cell.merge;\r\n        } else if (what === 'merge') {\r\n          if (cell.merge) delete cell.merge;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  each(cb) {\r\n    Object.entries(this._).forEach(([ri, row]) => {\r\n      cb(ri, row);\r\n    });\r\n  }\r\n\r\n  eachCells(ri, cb) {\r\n    if (this._[ri] && this._[ri].cells) {\r\n      Object.entries(this._[ri].cells).forEach(([ci, cell]) => {\r\n        cb(ci, cell);\r\n      });\r\n    }\r\n  }\r\n\r\n  setData(d) {\r\n    if (d.len) {\r\n      this.len = d.len;\r\n      delete d.len;\r\n    }\r\n    this._ = d;\r\n  }\r\n\r\n  getData() {\r\n    const { len } = this;\r\n    return Object.assign({ len }, this._);\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport { Rows };\r\n","import helper from './helper';\r\n\r\nclass Cols {\r\n  constructor({ len, width, indexWidth, minWidth }) {\r\n    this._ = {};\r\n    this.len = len;\r\n    this.width = width;\r\n    this.indexWidth = indexWidth;\r\n    this.minWidth = minWidth;\r\n  }\r\n\r\n  setData(d) {\r\n    if (d.len) {\r\n      this.len = d.len;\r\n      delete d.len;\r\n    }\r\n    this._ = d;\r\n  }\r\n\r\n  getData() {\r\n    const { len } = this;\r\n    return Object.assign({ len }, this._);\r\n  }\r\n\r\n  getWidth(i) {\r\n    const col = this._[i];\r\n    if (col && col.width) {\r\n      return col.width;\r\n    }\r\n    return this.width;\r\n  }\r\n\r\n  getOrNew(ci) {\r\n    this._[ci] = this._[ci] || {};\r\n    return this._[ci];\r\n  }\r\n\r\n  setWidth(ci, width) {\r\n    const col = this.getOrNew(ci);\r\n    col.width = width;\r\n  }\r\n\r\n  setStyle(ci, style) {\r\n    const col = this.getOrNew(ci);\r\n    col.style = style;\r\n  }\r\n\r\n  sumWidth(min, max) {\r\n    return helper.rangeSum(min, max, (i) => this.getWidth(i));\r\n  }\r\n\r\n  totalWidth() {\r\n    return this.sumWidth(0, this.len);\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport { Cols };\r\n","export default {\r\n  toolbar: {\r\n    undo: 'Undo',\r\n    redo: 'Redo',\r\n    paintformat: 'Paint format',\r\n    clearformat: 'Clear format',\r\n    format: 'Format',\r\n    font: 'Font',\r\n    fontSize: 'Font size',\r\n    fontBold: 'Font bold',\r\n    fontItalic: 'Font italic',\r\n    underline: 'Underline',\r\n    strike: 'Strike',\r\n    textColor: 'Text color',\r\n    fillColor: 'Fill color',\r\n    border: 'Borders',\r\n    merge: 'Merge cells',\r\n    align: 'Horizontal align',\r\n    valign: 'Vertical align',\r\n    textwrap: 'Text wrapping',\r\n    freeze: 'Freeze cell',\r\n    formula: 'Functions',\r\n    more: 'More'\r\n  },\r\n  contextmenu: {\r\n    copy: 'Copy',\r\n    cut: 'Cut',\r\n    paste: 'Paste',\r\n    pasteValue: 'Paste values only',\r\n    pasteFormat: 'Paste format only',\r\n    insertRow: 'Insert row',\r\n    insertColumn: 'Insert column',\r\n    deleteRow: 'Delete row',\r\n    deleteColumn: 'Delete column',\r\n    deleteCell: 'Delete cell',\r\n    deleteCellText: 'Delete cell text',\r\n    validation: 'Data validations'\r\n  },\r\n  format: {\r\n    normal: 'Normal',\r\n    text: 'Plain Text',\r\n    number: 'Number',\r\n    percent: 'Percent',\r\n    rmb: 'RMB',\r\n    usd: 'USD',\r\n    date: 'Date',\r\n    time: 'Time',\r\n    datetime: 'Date time',\r\n    duration: 'Duration'\r\n  },\r\n  formula: {\r\n    sum: 'Sum',\r\n    average: 'Average',\r\n    max: 'Max',\r\n    min: 'Min',\r\n    concat: 'Concat'\r\n  },\r\n  validation: {\r\n    required: 'it must be required',\r\n    notMatch: 'it not match its validation rule',\r\n    between: 'it is between {} and {}',\r\n    notBetween: 'it is not between {} and {}',\r\n    notIn: 'it is not in list',\r\n    equal: 'it equal to {}',\r\n    notEqual: 'it not equal to {}',\r\n    lessThan: 'it less than {}',\r\n    lessThanEqual: 'it less than or equal to {}',\r\n    greaterThan: 'it greater than {}',\r\n    greaterThanEqual: 'it greater than or equal to {}'\r\n  },\r\n  error: {\r\n    pasteForMergedCell: 'Unable to do this for merged cells'\r\n  },\r\n  calendar: {\r\n    weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\r\n    months: [\r\n      'January',\r\n      'February',\r\n      'March',\r\n      'April',\r\n      'May',\r\n      'June',\r\n      'July',\r\n      'August',\r\n      'September',\r\n      'October',\r\n      'November',\r\n      'December'\r\n    ]\r\n  },\r\n  button: {\r\n    cancel: 'Cancel',\r\n    remove: 'Remove',\r\n    save: 'Save'\r\n  },\r\n  dataValidation: {\r\n    mode: 'Mode',\r\n    range: 'Cell Range',\r\n    criteria: 'Criteria',\r\n    modeType: {\r\n      cell: 'Cell',\r\n      column: 'Colun',\r\n      row: 'Row'\r\n    },\r\n    type: {\r\n      list: 'List',\r\n      number: 'Number',\r\n      date: 'Date',\r\n      phone: 'Phone',\r\n      email: 'Email'\r\n    },\r\n    operator: {\r\n      be: 'between',\r\n      nbe: 'not betwwen',\r\n      lt: 'less than',\r\n      lte: 'less than or equal to',\r\n      gt: 'greater than',\r\n      gte: 'greater than or equal to',\r\n      eq: 'equal to',\r\n      neq: 'not equal to'\r\n    }\r\n  }\r\n};\r\n","/* global window */\r\nimport en from './en';\r\n\r\nlet $lang = 'en';\r\nconst $messages = {\r\n  en\r\n};\r\n\r\nfunction translate(key, messages) {\r\n  if (messages && messages[$lang]) {\r\n    let message = messages[$lang];\r\n    const keys = key.split('.');\r\n    for (let i = 0; i < keys.length; i += 1) {\r\n      const property = keys[i];\r\n      const value = message[property];\r\n      if (i === keys.length - 1) return value;\r\n      if (!value) return undefined;\r\n      message = value;\r\n    }\r\n  }\r\n  return undefined;\r\n}\r\n\r\nfunction t(key) {\r\n  let v = translate(key, $messages);\r\n  if (\r\n    !v &&\r\n    window &&\r\n    window.x &&\r\n    window.x.spreadsheet &&\r\n    window.x.spreadsheet.$messages\r\n  ) {\r\n    v = translate(key, window.x.spreadsheet.$messages);\r\n  }\r\n  return v || '';\r\n}\r\n\r\nfunction tf(key) {\r\n  return () => t(key);\r\n}\r\n\r\nfunction locale(lang, message) {\r\n  $lang = lang;\r\n  if (message) {\r\n    $messages[lang] = message;\r\n  }\r\n}\r\n\r\nexport default {\r\n  t\r\n};\r\n\r\nexport { locale, t, tf };\r\n","import { t } from '../locale/locale';\r\nimport helper from './helper';\r\n\r\nconst rules = {\r\n  phone: /^[1-9]\\d{10}$/,\r\n  email: /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/\r\n};\r\n\r\nfunction returnMessage(flag, key, ...arg) {\r\n  let message = '';\r\n  if (!flag) {\r\n    message = t(`validation.${key}`, ...arg);\r\n  }\r\n  return [flag, message];\r\n}\r\n\r\nexport default class Validator {\r\n  // operator: b|nb|eq|neq|lt|lte|gt|gte\r\n  // type: date|number|list|phone|email\r\n  constructor(type, required, value, operator) {\r\n    this.required = required;\r\n    this.value = value;\r\n    this.type = type;\r\n    this.operator = operator;\r\n    this.message = '';\r\n  }\r\n\r\n  parseValue(v) {\r\n    const { type } = this;\r\n    if (type === 'date') {\r\n      return new Date(v);\r\n    }\r\n    if (type === 'number') {\r\n      return Number(v);\r\n    }\r\n    return v;\r\n  }\r\n\r\n  equals(other) {\r\n    let flag =\r\n      this.type === other.type &&\r\n      this.required === other.required &&\r\n      this.operator === other.operator;\r\n    if (flag) {\r\n      if (Array.isArray(this.value)) {\r\n        flag = helper.arrayEquals(this.value, other.value);\r\n      } else {\r\n        flag = this.value === other.value;\r\n      }\r\n    }\r\n    return flag;\r\n  }\r\n\r\n  values() {\r\n    return this.value.split(',');\r\n  }\r\n\r\n  validate(v) {\r\n    const { required, operator, value, type } = this;\r\n    if (required && /^\\s*$/.test(v)) {\r\n      return returnMessage(false, 'required');\r\n    }\r\n    if (/^\\s*$/.test(v)) return [true];\r\n    if (rules[type] && !rules[type].test(v)) {\r\n      return returnMessage(false, 'notMatch');\r\n    }\r\n    if (type === 'list') {\r\n      return returnMessage(this.values().includes(v), 'notIn');\r\n    }\r\n    if (operator) {\r\n      const v1 = this.parseValue(v);\r\n      if (operator === 'be') {\r\n        const [min, max] = value;\r\n        return returnMessage(\r\n          v1 >= this.parseValue(min) && v1 <= this.parseValue(max),\r\n          'between',\r\n          min,\r\n          max\r\n        );\r\n      }\r\n      if (operator === 'nbe') {\r\n        const [min, max] = value;\r\n        return returnMessage(\r\n          v1 < this.parseValue(min) || v1 > this.parseValue(max),\r\n          'notBetween',\r\n          min,\r\n          max\r\n        );\r\n      }\r\n      if (operator === 'eq') {\r\n        return returnMessage(v1 === this.parseValue(value), 'equal', value);\r\n      }\r\n      if (operator === 'neq') {\r\n        return returnMessage(v1 !== this.parseValue(value), 'notEqual', value);\r\n      }\r\n      if (operator === 'lt') {\r\n        return returnMessage(v1 < this.parseValue(value), 'lessThan', value);\r\n      }\r\n      if (operator === 'lte') {\r\n        return returnMessage(\r\n          v1 <= this.parseValue(value),\r\n          'lessThanEqual',\r\n          value\r\n        );\r\n      }\r\n      if (operator === 'gt') {\r\n        return returnMessage(v1 > this.parseValue(value), 'greaterThan', value);\r\n      }\r\n      if (operator === 'gte') {\r\n        return returnMessage(\r\n          v1 >= this.parseValue(value),\r\n          'greaterThanEqual',\r\n          value\r\n        );\r\n      }\r\n    }\r\n    return [true];\r\n  }\r\n}\r\n","import Validator from './validator';\r\nimport { CellRange } from './cell_range';\r\n\r\nclass Validation {\r\n  constructor(mode, refs, validator) {\r\n    this.refs = refs;\r\n    this.mode = mode; // cell\r\n    this.validator = validator;\r\n  }\r\n\r\n  includes(ri, ci) {\r\n    const { refs } = this;\r\n    for (let i = 0; i < refs.length; i += 1) {\r\n      const cr = CellRange.valueOf(refs[i]);\r\n      if (cr.includes(ri, ci)) return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  addRef(ref) {\r\n    this.remove(CellRange.valueOf(ref));\r\n    this.refs.push(ref);\r\n  }\r\n\r\n  remove(cellRange) {\r\n    const nrefs = [];\r\n    this.refs.forEach((it) => {\r\n      const cr = CellRange.valueOf(it);\r\n      if (cr.intersects(cellRange)) {\r\n        const crs = cr.difference(cellRange);\r\n        crs.forEach((it1) => nrefs.push(it1.toString()));\r\n      } else {\r\n        nrefs.push(it);\r\n      }\r\n    });\r\n    this.refs = nrefs;\r\n  }\r\n\r\n  getData() {\r\n    const { refs, mode, validator } = this;\r\n    const { type, required, operator, value } = validator;\r\n    return {\r\n      refs,\r\n      mode,\r\n      type,\r\n      required,\r\n      operator,\r\n      value\r\n    };\r\n  }\r\n\r\n  static valueOf({ refs, mode, type, required, operator, value }) {\r\n    return new Validation(\r\n      mode,\r\n      refs,\r\n      new Validator(type, required, value, operator)\r\n    );\r\n  }\r\n}\r\nclass Validations {\r\n  constructor() {\r\n    this._ = [];\r\n    // ri_ci: errMessage\r\n    this.errors = new Map();\r\n  }\r\n\r\n  getError(ri, ci) {\r\n    return this.errors.get(`${ri}_${ci}`);\r\n  }\r\n\r\n  validate(ri, ci, text) {\r\n    const v = this.get(ri, ci);\r\n    const key = `${ri}_${ci}`;\r\n    const { errors } = this;\r\n    if (v !== null) {\r\n      const [flag, message] = v.validator.validate(text);\r\n      if (!flag) {\r\n        errors.set(key, message);\r\n      } else {\r\n        errors.delete(key);\r\n      }\r\n    } else {\r\n      errors.delete(key);\r\n    }\r\n    return true;\r\n  }\r\n\r\n  // type: date|number|phone|email|list\r\n  // validator: { required, value, operator }\r\n  add(mode, ref, { type, required, value, operator }) {\r\n    const validator = new Validator(type, required, value, operator);\r\n    const v = this.getByValidator(validator);\r\n    if (v !== null) {\r\n      v.addRef(ref);\r\n    } else {\r\n      this._.push(new Validation(mode, [ref], validator));\r\n    }\r\n  }\r\n\r\n  getByValidator(validator) {\r\n    for (let i = 0; i < this._.length; i += 1) {\r\n      const v = this._[i];\r\n      if (v.validator.equals(validator)) {\r\n        return v;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  get(ri, ci) {\r\n    for (let i = 0; i < this._.length; i += 1) {\r\n      const v = this._[i];\r\n      if (v.includes(ri, ci)) return v;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  remove(cellRange) {\r\n    this.each((it) => {\r\n      it.remove(cellRange);\r\n    });\r\n  }\r\n\r\n  each(cb) {\r\n    this._.forEach((it) => cb(it));\r\n  }\r\n\r\n  getData() {\r\n    return this._.filter((it) => it.refs.length > 0).map((it) => it.getData());\r\n  }\r\n\r\n  setData(d) {\r\n    this._ = d.map((it) => Validation.valueOf(it));\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport { Validations };\r\n","/* global document */\r\n\r\nimport Selector from './selector';\r\nimport Scroll from './scroll';\r\nimport History from './history';\r\nimport Clipboard from './clipboard';\r\nimport { Merges } from './merge';\r\nimport helper from './helper';\r\nimport { Rows } from './row';\r\nimport { Cols } from './col';\r\nimport { Validations } from './validation';\r\nimport { CellRange } from './cell_range';\r\nimport { expr2xy, xy2expr } from './alphabet';\r\nimport { t } from '../locale/locale';\r\n\r\n// private methods\r\n/*\r\n * {\r\n *  name: ''\r\n *  freeze: [0, 0],\r\n *  formats: [],\r\n *  styles: [\r\n *    {\r\n *      bgcolor: '',\r\n *      align: '',\r\n *      valign: '',\r\n *      textwrap: false,\r\n *      strike: false,\r\n *      underline: false,\r\n *      color: '',\r\n *      format: 1,\r\n *      border: {\r\n *        left: [style, color],\r\n *        right: [style, color],\r\n *        top: [style, color],\r\n *        bottom: [style, color],\r\n *      },\r\n *      font: {\r\n *        family: 'Helvetica',\r\n *        size: 10,\r\n *        bold: false,\r\n *        italic: false,\r\n *      }\r\n *    }\r\n *  ],\r\n *  merges: [\r\n *    'A1:F11',\r\n *    ...\r\n *  ],\r\n *  rows: {\r\n *    1: {\r\n *      height: 50,\r\n *      style: 1,\r\n *      cells: {\r\n *        1: {\r\n *          style: 2,\r\n *          type: 'string',\r\n *          text: '',\r\n *          value: '', // cal result\r\n *        }\r\n *      }\r\n *    },\r\n *    ...\r\n *  },\r\n *  cols: {\r\n *    2: { width: 100, style: 1 }\r\n *  }\r\n * }\r\n */\r\nconst defaultSettings = {\r\n  view: {\r\n    height: () => document.documentElement.clientHeight,\r\n    width: () => document.documentElement.clientWidth\r\n  },\r\n  showGrid: true,\r\n  showToolbar: true,\r\n  showContextmenu: true,\r\n  row: {\r\n    len: 100,\r\n    height: 25\r\n  },\r\n  col: {\r\n    len: 26,\r\n    width: 100,\r\n    indexWidth: 60,\r\n    minWidth: 60\r\n  },\r\n  style: {\r\n    bgcolor: '#ffffff',\r\n    align: 'left',\r\n    valign: 'middle',\r\n    textwrap: false,\r\n    strike: false,\r\n    underline: false,\r\n    color: '#0a0a0a',\r\n    font: {\r\n      name: 'Arial',\r\n      size: 10,\r\n      bold: false,\r\n      italic: false\r\n    }\r\n  }\r\n};\r\n\r\nconst toolbarHeight = 41;\r\n\r\n// src: cellRange\r\n// dst: cellRange\r\nfunction canPaste(src, dst, error = () => {}) {\r\n  const { merges } = this;\r\n  const cellRange = dst.clone();\r\n  const [srn, scn] = src.size();\r\n  const [drn, dcn] = dst.size();\r\n  if (srn > drn) {\r\n    cellRange.eri = dst.sri + srn - 1;\r\n  }\r\n  if (scn > dcn) {\r\n    cellRange.eci = dst.sci + scn - 1;\r\n  }\r\n  if (merges.intersects(cellRange)) {\r\n    error(t('error.pasteForMergedCell'));\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction copyPaste(srcCellRange, dstCellRange, what, autofill = false) {\r\n  const { rows, merges } = this;\r\n  // delete dest merge\r\n  if (what === 'all' || what === 'format') {\r\n    rows.deleteCells(dstCellRange, what);\r\n    merges.deleteWithin(dstCellRange);\r\n  }\r\n  rows.copyPaste(srcCellRange, dstCellRange, what, autofill, (ri, ci, cell) => {\r\n    if (cell && cell.merge) {\r\n      // console.log('cell:', ri, ci, cell);\r\n      const [rn, cn] = cell.merge;\r\n      if (rn <= 0 && cn <= 0) return;\r\n      merges.add(new CellRange(ri, ci, ri + rn, ci + cn));\r\n    }\r\n  });\r\n}\r\n\r\nfunction cutPaste(srcCellRange, dstCellRange) {\r\n  const { clipboard, rows, merges } = this;\r\n  rows.cutPaste(srcCellRange, dstCellRange);\r\n  merges.move(\r\n    srcCellRange,\r\n    dstCellRange.sri - srcCellRange.sri,\r\n    dstCellRange.sci - srcCellRange.sci\r\n  );\r\n  clipboard.clear();\r\n}\r\n\r\n// bss: { top, bottom, left, right }\r\nfunction setStyleBorder(ri, ci, bss) {\r\n  const { styles, rows } = this;\r\n  const cell = rows.getCellOrNew(ri, ci);\r\n  let cstyle = {};\r\n  if (cell.style !== undefined) {\r\n    cstyle = helper.cloneDeep(styles[cell.style]);\r\n  }\r\n  Object.assign(cstyle, { border: bss });\r\n  cell.style = this.addStyle(cstyle);\r\n}\r\n\r\nfunction setStyleBorders({ mode, style, color }) {\r\n  const { styles, selector, rows } = this;\r\n  const { sri, sci, eri, eci } = selector.range;\r\n  const multiple = !this.isSignleSelected();\r\n  if (!multiple) {\r\n    if (mode === 'inside' || mode === 'horizontal' || mode === 'vertical') {\r\n      return;\r\n    }\r\n  }\r\n  if (mode === 'outside' && !multiple) {\r\n    setStyleBorder.call(this, sri, sci, {\r\n      top: [style, color],\r\n      bottom: [style, color],\r\n      left: [style, color],\r\n      right: [style, color]\r\n    });\r\n  } else if (mode === 'none') {\r\n    selector.range.each((ri, ci) => {\r\n      const cell = rows.getCell(ri, ci);\r\n      if (cell && cell.style !== undefined) {\r\n        const ns = helper.cloneDeep(styles[cell.style]);\r\n        delete ns.border;\r\n        // ['bottom', 'top', 'left', 'right'].forEach((prop) => {\r\n        //   if (ns[prop]) delete ns[prop];\r\n        // });\r\n        cell.style = this.addStyle(ns);\r\n      }\r\n    });\r\n  } else if (\r\n    mode === 'all' ||\r\n    mode === 'inside' ||\r\n    mode === 'outside' ||\r\n    mode === 'horizontal' ||\r\n    mode === 'vertical'\r\n  ) {\r\n    const merges = [];\r\n    for (let ri = sri; ri <= eri; ri += 1) {\r\n      for (let ci = sci; ci <= eci; ci += 1) {\r\n        // jump merges -- start\r\n        const mergeIndexes = [];\r\n        for (let ii = 0; ii < merges.length; ii += 1) {\r\n          const [mri, mci, rn, cn] = merges[ii];\r\n          if (ri === mri + rn + 1) mergeIndexes.push(ii);\r\n          if (mri <= ri && ri <= mri + rn) {\r\n            if (ci === mci) {\r\n              ci += cn + 1;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        mergeIndexes.forEach((it) => merges.splice(it, 1));\r\n        if (ci > eci) break;\r\n        // jump merges -- end\r\n        const cell = rows.getCell(ri, ci);\r\n        let [rn, cn] = [0, 0];\r\n        if (cell && cell.merge) {\r\n          [rn, cn] = cell.merge;\r\n          merges.push([ri, ci, rn, cn]);\r\n        }\r\n        const mrl = rn > 0 && ri + rn === eri;\r\n        const mcl = cn > 0 && ci + cn === eci;\r\n        let bss = {};\r\n        if (mode === 'all') {\r\n          bss = {\r\n            bottom: [style, color],\r\n            top: [style, color],\r\n            left: [style, color],\r\n            right: [style, color]\r\n          };\r\n        } else if (mode === 'inside') {\r\n          if (!mcl && ci < eci) bss.right = [style, color];\r\n          if (!mrl && ri < eri) bss.bottom = [style, color];\r\n        } else if (mode === 'horizontal') {\r\n          if (!mrl && ri < eri) bss.bottom = [style, color];\r\n        } else if (mode === 'vertical') {\r\n          if (!mcl && ci < eci) bss.right = [style, color];\r\n        } else if (mode === 'outside' && multiple) {\r\n          if (sri === ri) bss.top = [style, color];\r\n          if (mrl || eri === ri) bss.bottom = [style, color];\r\n          if (sci === ci) bss.left = [style, color];\r\n          if (mcl || eci === ci) bss.right = [style, color];\r\n        }\r\n        if (Object.keys(bss).length > 0) {\r\n          setStyleBorder.call(this, ri, ci, bss);\r\n        }\r\n        ci += cn;\r\n      }\r\n    }\r\n  } else if (mode === 'top' || mode === 'bottom') {\r\n    for (let ci = sci; ci <= eci; ci += 1) {\r\n      if (mode === 'top') {\r\n        setStyleBorder.call(this, sri, ci, { top: [style, color] });\r\n        ci += rows.getCellMerge(sri, ci)[1];\r\n      }\r\n      if (mode === 'bottom') {\r\n        setStyleBorder.call(this, eri, ci, { bottom: [style, color] });\r\n        ci += rows.getCellMerge(eri, ci)[1];\r\n      }\r\n    }\r\n  } else if (mode === 'left' || mode === 'right') {\r\n    for (let ri = sri; ri <= eri; ri += 1) {\r\n      if (mode === 'left') {\r\n        setStyleBorder.call(this, ri, sci, { left: [style, color] });\r\n        ri += rows.getCellMerge(ri, sci)[0];\r\n      }\r\n      if (mode === 'right') {\r\n        setStyleBorder.call(this, ri, eci, { right: [style, color] });\r\n        ri += rows.getCellMerge(ri, eci)[0];\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction getCellRowByY(y, scrollOffsety) {\r\n  const { rows } = this;\r\n  const fsh = this.freezeTotalHeight();\r\n  // console.log('y:', y, ', fsh:', fsh);\r\n  let inits = rows.height;\r\n  if (fsh + rows.height < y) inits -= scrollOffsety;\r\n  const [ri, top, height] = helper.rangeReduceIf(\r\n    0,\r\n    rows.len,\r\n    inits,\r\n    rows.height,\r\n    y,\r\n    (i) => rows.getHeight(i)\r\n  );\r\n  if (top <= 0) {\r\n    return { ri: -1, top: 0, height };\r\n  }\r\n  return { ri: ri - 1, top, height };\r\n}\r\n\r\nfunction getCellColByX(x, scrollOffsetx) {\r\n  const { cols } = this;\r\n  const fsw = this.freezeTotalWidth();\r\n  let inits = cols.indexWidth;\r\n  if (fsw + cols.indexWidth < x) inits -= scrollOffsetx;\r\n  const [ci, left, width] = helper.rangeReduceIf(\r\n    0,\r\n    cols.len,\r\n    inits,\r\n    cols.indexWidth,\r\n    x,\r\n    (i) => cols.getWidth(i)\r\n  );\r\n  if (left <= 0) {\r\n    return { ci: -1, left: 0, width: cols.indexWidth };\r\n  }\r\n  return { ci: ci - 1, left, width };\r\n}\r\n\r\nexport default class DataProxy {\r\n  constructor(name, settings) {\r\n    this.settings = helper.merge(defaultSettings, settings || {});\r\n    // save data begin\r\n    this.name = name || 'sheet';\r\n    this.freeze = [0, 0];\r\n    this.styles = []; // Array<Style>\r\n    this.merges = new Merges(); // [CellRange, ...]\r\n    this.rows = new Rows(this.settings.row);\r\n    this.cols = new Cols(this.settings.col);\r\n    this.validations = new Validations();\r\n    this.hyperlinks = {};\r\n    this.comments = {};\r\n    // save data end\r\n\r\n    // don't save object\r\n    this.selector = new Selector();\r\n    this.scroll = new Scroll();\r\n    this.history = new History();\r\n    this.clipboard = new Clipboard();\r\n    this.change = () => {};\r\n  }\r\n\r\n  addValidation(mode, ref, validator) {\r\n    // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);\r\n    this.changeData(() => {\r\n      this.validations.add(mode, ref, validator);\r\n    });\r\n  }\r\n\r\n  removeValidation() {\r\n    const { range } = this.selector;\r\n    this.changeData(() => {\r\n      this.validations.remove(range);\r\n    });\r\n  }\r\n\r\n  getSelectedValidator() {\r\n    const { ri, ci } = this.selector;\r\n    const v = this.validations.get(ri, ci);\r\n    return v ? v.validator : null;\r\n  }\r\n\r\n  getSelectedValidation() {\r\n    const { ri, ci, range } = this.selector;\r\n    const v = this.validations.get(ri, ci);\r\n    const ret = { ref: range.toString() };\r\n    if (v !== null) {\r\n      ret.mode = v.mode;\r\n      ret.validator = v.validator;\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  canUndo() {\r\n    return this.history.canUndo();\r\n  }\r\n\r\n  canRedo() {\r\n    return this.history.canRedo();\r\n  }\r\n\r\n  undo() {\r\n    this.history.undo(this.getData(), (d) => {\r\n      this.setData(d);\r\n    });\r\n  }\r\n\r\n  redo() {\r\n    this.history.redo(this.getData(), (d) => {\r\n      this.setData(d);\r\n    });\r\n  }\r\n\r\n  copy() {\r\n    this.clipboard.copy(this.selector.range);\r\n  }\r\n\r\n  cut() {\r\n    this.clipboard.cut(this.selector.range);\r\n  }\r\n\r\n  // what: all | text | format\r\n  paste(what = 'all', error = () => {}) {\r\n    // console.log('sIndexes:', sIndexes);\r\n    const { clipboard, selector } = this;\r\n    if (clipboard.isClear()) return false;\r\n    if (!canPaste.call(this, clipboard.range, selector.range, error))\r\n      return false;\r\n\r\n    this.changeData(() => {\r\n      if (clipboard.isCopy()) {\r\n        copyPaste.call(this, clipboard.range, selector.range, what);\r\n      } else if (clipboard.isCut()) {\r\n        cutPaste.call(this, clipboard.range, selector.range);\r\n      }\r\n    });\r\n    return true;\r\n  }\r\n\r\n  autofill(cellRange, what, error = () => {}) {\r\n    const srcRange = this.selector.range;\r\n    if (!canPaste.call(this, srcRange, cellRange, error)) return false;\r\n    this.changeData(() => {\r\n      copyPaste.call(this, srcRange, cellRange, what, true);\r\n    });\r\n    return true;\r\n  }\r\n\r\n  clearClipboard() {\r\n    this.clipboard.clear();\r\n  }\r\n\r\n  calSelectedRangeByEnd(ri, ci) {\r\n    const { selector, rows, cols, merges } = this;\r\n    // 获取选择起始区域（一定是一个单一单元格）的坐标\r\n    let { sri, sci, eri, eci } = selector.range;\r\n    const cri = selector.ri;\r\n    const cci = selector.ci;\r\n    // sri == eri == cri，sci == eci == cci\r\n    let [nri, nci] = [ri, ci];\r\n    if (ri < 0) nri = rows.len - 1;\r\n    if (ci < 0) nci = cols.len - 1;\r\n    // row index 判断结束行，有可能区域是上右上方拖动，所以可能出现结束小于开始的情况\r\n    if (nri <= cri) [sri, eri] = [nri, cri];\r\n    else eri = nri;\r\n    // col index\r\n    if (nci <= cci) [sci, eci] = [nci, cci];\r\n    else eci = nci;\r\n    selector.range = merges.union(new CellRange(sri, sci, eri, eci));\r\n    // console.log('selector.range:', selector.range);\r\n    return selector.range;\r\n  }\r\n\r\n  calSelectedRangeByStart(ri, ci) {\r\n    const { selector, rows, cols, merges } = this;\r\n    let cellRange = merges.getFirstIncludes(ri, ci);\r\n    // console.log('cellRange:', cellRange, ri, ci, merges);\r\n    if (cellRange === null) {\r\n      // 使用单一单元格初始化一个合并单元格对象\r\n      cellRange = new CellRange(ri, ci, ri, ci);\r\n      if (ri === -1) {\r\n        // 整列选中\r\n        cellRange.sri = 0;\r\n        cellRange.eri = rows.len - 1;\r\n      }\r\n      if (ci === -1) {\r\n        // 整行选中\r\n        cellRange.sci = 0;\r\n        cellRange.eci = cols.len - 1;\r\n      }\r\n    }\r\n    selector.range = cellRange;\r\n    return cellRange;\r\n  }\r\n\r\n  setSelectedCellAttr(property, value) {\r\n    this.changeData(() => {\r\n      const { selector, styles, rows } = this;\r\n      if (property === 'merge') {\r\n        if (value) this.merge();\r\n        else this.unmerge();\r\n      } else if (property === 'border') {\r\n        setStyleBorders.call(this, value);\r\n      } else if (property === 'formula') {\r\n        const cell = rows.getCellOrNew(selector.ri, selector.ci);\r\n        cell.text = `=${value}()`;\r\n      } else {\r\n        selector.range.each((ri, ci) => {\r\n          const cell = rows.getCellOrNew(ri, ci);\r\n          let cstyle = {};\r\n          if (cell.style !== undefined) {\r\n            cstyle = helper.cloneDeep(styles[cell.style]);\r\n          }\r\n          if (property === 'format') {\r\n            cstyle.format = value;\r\n            cell.style = this.addStyle(cstyle);\r\n          } else if (\r\n            property === 'font-bold' ||\r\n            property === 'font-italic' ||\r\n            property === 'font-name' ||\r\n            property === 'font-size'\r\n          ) {\r\n            const nfont = {};\r\n            nfont[property.split('-')[1]] = value;\r\n            cstyle.font = Object.assign(cstyle.font || {}, nfont);\r\n            cell.style = this.addStyle(cstyle);\r\n          } else if (\r\n            property === 'strike' ||\r\n            property === 'textwrap' ||\r\n            property === 'underline' ||\r\n            property === 'align' ||\r\n            property === 'valign' ||\r\n            property === 'color' ||\r\n            property === 'bgcolor'\r\n          ) {\r\n            cstyle[property] = value;\r\n            cell.style = this.addStyle(cstyle);\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  // state: input | finished\r\n  setSelectedCellText(text, state = 'input') {\r\n    const { ri, ci } = this.selector;\r\n    this.setCellText(ri, ci, text, state);\r\n  }\r\n\r\n  getSelectedCell() {\r\n    const { ri, ci } = this.selector;\r\n    return this.rows.getCell(ri, ci);\r\n  }\r\n\r\n  xyInSelectedRect(x, y) {\r\n    const { left, top, width, height } = this.getSelectedRect();\r\n    const x1 = x - this.cols.indexWidth;\r\n    const y1 = y - this.rows.height;\r\n    // console.log('x:', x, ',y:', y, 'left:', left, 'top:', top);\r\n    return x1 > left && x1 < left + width && y1 > top && y1 < top + height;\r\n  }\r\n\r\n  getSelectedRect() {\r\n    return this.getRect(this.selector.range);\r\n  }\r\n\r\n  getClipboardRect() {\r\n    const { clipboard } = this;\r\n    if (!clipboard.isClear()) {\r\n      return this.getRect(clipboard.range);\r\n    }\r\n    return { left: -100, top: -100 };\r\n  }\r\n\r\n  getRect(cellRange) {\r\n    const { scroll, rows, cols } = this;\r\n    const { sri, sci, eri, eci } = cellRange;\r\n    // console.log('sri:', sri, ',sci:', sci, ', eri:', eri, ', eci:', eci);\r\n    // no selector\r\n    if (sri < 0 && sci < 0) {\r\n      return {\r\n        left: 0,\r\n        l: 0,\r\n        top: 0,\r\n        t: 0,\r\n        scroll\r\n      };\r\n    }\r\n    const { left, top } = this.cellPosition(sri, sci);\r\n    const height = rows.sumHeight(sri, eri + 1);\r\n    const width = cols.sumWidth(sci, eci + 1);\r\n    // console.log('sri:', sri, ', sci:', sci, ', eri:', eri, ', eci:', eci);\r\n    let left0 = left - scroll.x;\r\n    let top0 = top - scroll.y;\r\n    const fsh = this.freezeTotalHeight();\r\n    const fsw = this.freezeTotalWidth();\r\n    if (fsw > 0 && fsw > left) {\r\n      left0 = left;\r\n    }\r\n    if (fsh > 0 && fsh > top) {\r\n      top0 = top;\r\n    }\r\n    return {\r\n      l: left,\r\n      t: top,\r\n      left: left0,\r\n      top: top0,\r\n      height,\r\n      width,\r\n      scroll\r\n    };\r\n  }\r\n\r\n  getCellRectByXY(x, y) {\r\n    const { scroll, merges, rows, cols } = this;\r\n    let { ri, top, height } = getCellRowByY.call(this, y, scroll.y);\r\n    let { ci, left, width } = getCellColByX.call(this, x, scroll.x);\r\n    if (ci === -1) {\r\n      width = cols.totalWidth();\r\n    }\r\n    if (ri === -1) {\r\n      height = rows.totalHeight();\r\n    }\r\n    if (ri >= 0 || ci >= 0) {\r\n      const merge = merges.getFirstIncludes(ri, ci);\r\n      if (merge) {\r\n        ri = merge.sri;\r\n        ci = merge.sci;\r\n        ({ left, top, width, height } = this.cellRect(ri, ci));\r\n      }\r\n    }\r\n    return {\r\n      ri,\r\n      ci,\r\n      left,\r\n      top,\r\n      width,\r\n      height\r\n    };\r\n  }\r\n\r\n  isSignleSelected() {\r\n    const { sri, sci, eri, eci } = this.selector.range;\r\n    const cell = this.getCell(sri, sci);\r\n    if (cell && cell.merge) {\r\n      const [rn, cn] = cell.merge;\r\n      if (sri + rn === eri && sci + cn === eci) return true;\r\n    }\r\n    return !this.selector.multiple();\r\n  }\r\n\r\n  canUnmerge() {\r\n    const { sri, sci, eri, eci } = this.selector.range;\r\n    const cell = this.getCell(sri, sci);\r\n    if (cell && cell.merge) {\r\n      const [rn, cn] = cell.merge;\r\n      if (sri + rn === eri && sci + cn === eci) return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  merge() {\r\n    const { selector, rows } = this;\r\n    if (this.isSignleSelected()) return;\r\n    const [rn, cn] = selector.size();\r\n    // console.log('merge:', rn, cn);\r\n    if (rn > 1 || cn > 1) {\r\n      const { sri, sci } = selector.range;\r\n      this.changeData(() => {\r\n        const cell = rows.getCellOrNew(sri, sci);\r\n        cell.merge = [rn - 1, cn - 1];\r\n        this.merges.add(selector.range);\r\n        // delete merge cells\r\n        this.rows.deleteCells(selector.range);\r\n        // console.log('cell:', cell, this.d);\r\n        this.rows.setCell(sri, sci, cell);\r\n      });\r\n    }\r\n  }\r\n\r\n  unmerge() {\r\n    const { selector } = this;\r\n    if (!this.isSignleSelected()) return;\r\n    const { sri, sci } = selector.range;\r\n    this.changeData(() => {\r\n      this.rows.deleteCell(sri, sci, 'merge');\r\n      this.merges.deleteWithin(selector.range);\r\n    });\r\n  }\r\n\r\n  deleteCell(what = 'all') {\r\n    const { selector } = this;\r\n    this.changeData(() => {\r\n      this.rows.deleteCells(selector.range, what);\r\n      if (what === 'all' || what === 'format') {\r\n        this.merges.deleteWithin(selector.range);\r\n      }\r\n    });\r\n  }\r\n\r\n  // type: row | column\r\n  insert(type, n = 1) {\r\n    this.changeData(() => {\r\n      const { sri, sci } = this.selector.range;\r\n      const { rows, merges, cols } = this;\r\n      let si = sri;\r\n      if (type === 'row') {\r\n        rows.insert(sri, n);\r\n      } else if (type === 'column') {\r\n        rows.insertColumn(sci, n);\r\n        si = sci;\r\n        cols.len += 1;\r\n      }\r\n      merges.shift(type, si, n, (ri, ci, rn, cn) => {\r\n        const cell = rows.getCell(ri, ci);\r\n        cell.merge[0] += rn;\r\n        cell.merge[1] += cn;\r\n      });\r\n    });\r\n  }\r\n\r\n  // type: row | column\r\n  delete(type) {\r\n    this.changeData(() => {\r\n      const { rows, merges, selector, cols } = this;\r\n      const { range } = selector;\r\n      const { sri, sci, eri, eci } = selector.range;\r\n      const [rsize, csize] = selector.range.size();\r\n      let si = sri;\r\n      let size = rsize;\r\n      if (type === 'row') {\r\n        rows.delete(sri, eri);\r\n      } else if (type === 'column') {\r\n        rows.deleteColumn(sci, eci);\r\n        si = range.sci;\r\n        size = csize;\r\n        cols.len -= 1;\r\n      }\r\n      // console.log('type:', type, ', si:', si, ', size:', size);\r\n      merges.shift(type, si, -size, (ri, ci, rn, cn) => {\r\n        // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);\r\n        const cell = rows.getCell(ri, ci);\r\n        cell.merge[0] += rn;\r\n        cell.merge[1] += cn;\r\n        if (cell.merge[0] === 0 && cell.merge[1] === 0) {\r\n          delete cell.merge;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  scrollx(x, cb) {\r\n    const { scroll, freeze, cols } = this;\r\n    const [, fci] = freeze;\r\n    const [ci, left, width] = helper.rangeReduceIf(\r\n      fci,\r\n      cols.len,\r\n      0,\r\n      0,\r\n      x,\r\n      (i) => cols.getWidth(i)\r\n    );\r\n    // console.log('fci:', fci, ', ci:', ci);\r\n    let x1 = left;\r\n    if (x > 0) x1 += width;\r\n    if (scroll.x !== x1) {\r\n      scroll.ci = x > 0 ? ci : 0;\r\n      scroll.x = x1;\r\n      cb();\r\n    }\r\n  }\r\n\r\n  scrolly(y, cb) {\r\n    const { scroll, freeze, rows } = this;\r\n    const [fri] = freeze;\r\n    const [ri, top, height] = helper.rangeReduceIf(\r\n      fri,\r\n      rows.len,\r\n      0,\r\n      0,\r\n      y,\r\n      (i) => rows.getHeight(i)\r\n    );\r\n    let y1 = top;\r\n    if (y > 0) y1 += height;\r\n    // console.log('ri:', ri, ' ,y:', y1);\r\n    if (scroll.y !== y1) {\r\n      scroll.ri = y > 0 ? ri : 0;\r\n      scroll.y = y1;\r\n      cb();\r\n    }\r\n  }\r\n\r\n  cellRect(ri, ci) {\r\n    const { rows, cols } = this;\r\n    const { left, top } = this.cellPosition(ri, ci);\r\n    const cell = rows.getCell(ri, ci);\r\n    let width = cols.getWidth(ci);\r\n    let height = rows.getHeight(ri);\r\n    if (cell !== null) {\r\n      if (cell.merge) {\r\n        const [rn, cn] = cell.merge;\r\n        // console.log('cell.merge:', cell.merge);\r\n        if (rn > 0) {\r\n          for (let i = 1; i <= rn; i += 1) {\r\n            height += rows.getHeight(ri + i);\r\n          }\r\n        }\r\n        if (cn > 0) {\r\n          for (let i = 1; i <= cn; i += 1) {\r\n            width += cols.getWidth(ci + i);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // console.log('data:', this.d);\r\n    return {\r\n      left,\r\n      top,\r\n      width,\r\n      height,\r\n      cell\r\n    };\r\n  }\r\n\r\n  cellPosition(ri, ci) {\r\n    const { cols, rows } = this;\r\n    const left = cols.sumWidth(0, ci);\r\n    const top = rows.sumHeight(0, ri);\r\n    return {\r\n      left,\r\n      top\r\n    };\r\n  }\r\n\r\n  getCell(ri, ci) {\r\n    return this.rows.getCell(ri, ci);\r\n  }\r\n\r\n  getCellTextOrDefault(ri, ci) {\r\n    const cell = this.getCell(ri, ci);\r\n    return cell && cell.text ? cell.text : '';\r\n  }\r\n\r\n  getCellStyle(ri, ci) {\r\n    const cell = this.getCell(ri, ci);\r\n    if (cell && cell.style !== undefined) {\r\n      return this.styles[cell.style];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getCellStyleOrDefault(ri, ci) {\r\n    const { styles, rows } = this;\r\n    const cell = rows.getCell(ri, ci);\r\n    const cellStyle =\r\n      cell && cell.style !== undefined ? styles[cell.style] : {};\r\n    return helper.merge(this.defaultStyle(), cellStyle);\r\n  }\r\n\r\n  getSelectedCellStyle() {\r\n    const { ri, ci } = this.selector;\r\n    return this.getCellStyleOrDefault(ri, ci);\r\n  }\r\n\r\n  // state: input | finished\r\n  setCellText(ri, ci, text, state) {\r\n    const { rows, history, validations } = this;\r\n    if (state === 'finished') {\r\n      rows.setCellText(ri, ci, '');\r\n      history.add(this.getData());\r\n      rows.setCellText(ri, ci, text);\r\n    } else {\r\n      rows.setCellText(ri, ci, text);\r\n      this.change(this.getData());\r\n    }\r\n    // validator\r\n    validations.validate(ri, ci, text);\r\n  }\r\n\r\n  freezeIsActive() {\r\n    const [ri, ci] = this.freeze;\r\n    return ri > 0 || ci > 0;\r\n  }\r\n\r\n  setFreeze(ri, ci) {\r\n    this.changeData(() => {\r\n      this.freeze = [ri, ci];\r\n    });\r\n  }\r\n\r\n  freezeTotalWidth() {\r\n    return this.cols.sumWidth(0, this.freeze[1]);\r\n  }\r\n\r\n  freezeTotalHeight() {\r\n    return this.rows.sumHeight(0, this.freeze[0]);\r\n  }\r\n\r\n  setRowHeight(ri, height) {\r\n    this.changeData(() => {\r\n      this.rows.setHeight(ri, height);\r\n    });\r\n  }\r\n\r\n  setColWidth(ci, width) {\r\n    this.changeData(() => {\r\n      this.cols.setWidth(ci, width);\r\n    });\r\n  }\r\n\r\n  viewHeight() {\r\n    const { view, showToolbar } = this.settings;\r\n    let h = view.height();\r\n    if (showToolbar) {\r\n      h -= toolbarHeight;\r\n    }\r\n    return h;\r\n  }\r\n\r\n  viewWidth() {\r\n    return this.settings.view.width();\r\n  }\r\n\r\n  freezeViewRange() {\r\n    const [ri, ci] = this.freeze;\r\n    return new CellRange(\r\n      0,\r\n      0,\r\n      ri - 1,\r\n      ci - 1,\r\n      this.freezeTotalWidth(),\r\n      this.freezeTotalHeight()\r\n    );\r\n  }\r\n\r\n  viewRange() {\r\n    const { scroll, rows, cols, freeze } = this;\r\n    let { ri, ci } = scroll;\r\n    if (ri <= 0) [ri] = freeze;\r\n    if (ci <= 0) [, ci] = freeze;\r\n\r\n    let [x, y] = [0, 0];\r\n    let [eri, eci] = [rows.len, cols.len];\r\n    for (let i = ri; i < rows.len; i += 1) {\r\n      y += rows.getHeight(i);\r\n      eri = i;\r\n      if (y > this.viewHeight()) break;\r\n    }\r\n    for (let j = ci; j < cols.len; j += 1) {\r\n      x += cols.getWidth(j);\r\n      eci = j;\r\n      if (x > this.viewWidth()) break;\r\n    }\r\n    // console.log(ri, ci, eri, eci, x, y);\r\n    return new CellRange(ri, ci, eri, eci, x, y);\r\n  }\r\n\r\n  eachMergesInView(viewRange, cb) {\r\n    this.merges.filterIntersects(viewRange).forEach((it) => cb(it));\r\n  }\r\n\r\n  rowEach(min, max, cb) {\r\n    let y = 0;\r\n    const { rows } = this;\r\n    // console.log('min:', min, ', max:', max, ', scroll:', scroll);\r\n    for (let i = min; i <= max; i += 1) {\r\n      const rowHeight = rows.getHeight(i);\r\n      cb(i, y, rowHeight);\r\n      y += rowHeight;\r\n      if (y > this.viewHeight()) break;\r\n    }\r\n  }\r\n\r\n  colEach(min, max, cb) {\r\n    let x = 0;\r\n    const { cols } = this;\r\n    for (let i = min; i <= max; i += 1) {\r\n      const colWidth = cols.getWidth(i);\r\n      cb(i, x, colWidth);\r\n      x += colWidth;\r\n      if (x > this.viewWidth()) break;\r\n    }\r\n  }\r\n\r\n  defaultStyle() {\r\n    return this.settings.style;\r\n  }\r\n\r\n  addStyle(nstyle) {\r\n    const { styles } = this;\r\n    // console.log('old.styles:', styles, nstyle);\r\n    for (let i = 0; i < styles.length; i += 1) {\r\n      const style = styles[i];\r\n      if (helper.equals(style, nstyle)) return i;\r\n    }\r\n    styles.push(nstyle);\r\n    return styles.length - 1;\r\n  }\r\n\r\n  changeData(cb) {\r\n    this.history.add(this.getData());\r\n    cb();\r\n    this.change(this.getData());\r\n  }\r\n\r\n  setData(d) {\r\n    Object.keys(d).forEach((property) => {\r\n      if (\r\n        property === 'merges' ||\r\n        property === 'rows' ||\r\n        property === 'cols' ||\r\n        property === 'validations'\r\n      ) {\r\n        this[property].setData(d[property]);\r\n      } else if (property === 'freeze') {\r\n        const [x, y] = expr2xy(d[property]);\r\n        this.freeze = [y, x];\r\n      } else if (d[property] !== undefined) {\r\n        this[property] = d[property];\r\n      }\r\n    });\r\n    return this;\r\n  }\r\n\r\n  getData() {\r\n    const { name, freeze, styles, merges, rows, cols, validations } = this;\r\n    return {\r\n      name,\r\n      freeze: xy2expr(freeze[1], freeze[0]),\r\n      styles,\r\n      merges: merges.getData(),\r\n      rows: rows.getData(),\r\n      cols: cols.getData(),\r\n      validations: validations.getData()\r\n    };\r\n  }\r\n}\r\n","/* global window */\r\nexport function bind(target, name, fn) {\r\n  target.addEventListener(name, fn);\r\n}\r\nexport function unbind(target, name, fn) {\r\n  target.removeEventListener(name, fn);\r\n}\r\nexport function unbindClickoutside(el) {\r\n  if (el.xclickoutside) {\r\n    unbind(window.document.body, 'click', el.xclickoutside);\r\n    delete el.xclickoutside;\r\n  }\r\n}\r\n\r\n// the left mouse button: mousedown → mouseup → click\r\n// the right mouse button: mousedown → contenxtmenu → mouseup\r\n// the right mouse button in firefox(>65.0): mousedown → contenxtmenu → mouseup → click on window\r\n/**\r\n * 为 body标签注册点击事件，触发指定节点的cb函数，默认会造成该节点隐藏\r\n * 事件触发之后，立即终止该事件的监听（一次性事件）\r\n * 如果事件由子节点冒泡产生，则不做处理，其实就是该节点及以上的所有节点的点击，都会引发这个cn函数被执行\r\n * @param {*} el\r\n * @param {*} cb\r\n */\r\nexport function bindClickoutside(\r\n  el,\r\n  cb = (t) => {\r\n    t.hide();\r\n  }\r\n) {\r\n  el.xclickoutside = (evt) => {\r\n    // ignore double click\r\n    if (evt.detail === 2 || el.contains(evt.target)) return;\r\n    cb(el);\r\n    unbindClickoutside(el);\r\n  };\r\n  bind(window.document.body, 'click', el.xclickoutside);\r\n}\r\n\r\n/**\r\n * 执行该方法会引发：\r\n * 1、为目标注册一个mousemove事件的监听，执行movefunc函数。\r\n * 2、为目标注册一个mouseup 事件监听，该事件在鼠标键抬起时，执行upfunc，然后取消掉刚才的mousemove与mouseup监听。\r\n * 也就是说，该方法为目标元素注册了一次性的拖动-放下事件处理\r\n * 但为什么要是临时一次性的呢？\r\n * 事实上，该函数只在sheet对象的overlayerMousedown函数中被执行\r\n * 执行的目的是在鼠标被按下的时候，为window对象（最外层的对象）注册一个鼠标移动事件\r\n * 用于实现excel表格的区域选中操作。\r\n * 所以可以看出，这个函数其实是与mousedown配套的3个连续事件处理机制，完整实现鼠标的南下，拖动，放开操作，是孤立拖动操作的绝佳处理形式。\r\n * @param {*} target\r\n * @param {*} movefunc\r\n * @param {*} upfunc\r\n */\r\nexport function mouseMoveUp(target, movefunc, upfunc) {\r\n  bind(target, 'mousemove', movefunc);\r\n  const t = target;\r\n  t.xEvtUp = (evt) => {\r\n    // console.log('mouseup>>>');\r\n    unbind(target, 'mousemove', movefunc);\r\n    unbind(target, 'mouseup', target.xEvtUp);\r\n    upfunc(evt);\r\n  };\r\n  bind(target, 'mouseup', target.xEvtUp);\r\n}\r\n\r\nfunction calTouchDirection(spanx, spany, evt, cb) {\r\n  let direction = '';\r\n  // console.log('spanx:', spanx, ', spany:', spany);\r\n  if (Math.abs(spanx) > Math.abs(spany)) {\r\n    // horizontal\r\n    direction = spanx > 0 ? 'right' : 'left';\r\n    cb(direction, spanx, evt);\r\n  } else {\r\n    // vertical\r\n    direction = spany > 0 ? 'down' : 'up';\r\n    cb(direction, spany, evt);\r\n  }\r\n}\r\n// cb = (direction, distance) => {}\r\nexport function bindTouch(target, { move, end }) {\r\n  let startx = 0;\r\n  let starty = 0;\r\n  bind(target, 'touchstart', (evt) => {\r\n    const { pageX, pageY } = evt.touches[0];\r\n    startx = pageX;\r\n    starty = pageY;\r\n  });\r\n  bind(target, 'touchmove', (evt) => {\r\n    if (!move) return;\r\n    const { pageX, pageY } = evt.changedTouches[0];\r\n    const spanx = pageX - startx;\r\n    const spany = pageY - starty;\r\n    if (Math.abs(spanx) > 10 || Math.abs(spany) > 10) {\r\n      // console.log('spanx:', spanx, ', spany:', spany);\r\n      calTouchDirection(spanx, spany, evt, move);\r\n      startx = pageX;\r\n      starty = pageY;\r\n    }\r\n    evt.preventDefault();\r\n  });\r\n  bind(target, 'touchend', (evt) => {\r\n    if (!end) return;\r\n    const { pageX, pageY } = evt.changedTouches[0];\r\n    const spanx = pageX - startx;\r\n    const spany = pageY - starty;\r\n    calTouchDirection(spanx, spany, evt, end);\r\n  });\r\n}\r\n","/* global window */\r\nexport const cssPrefix = 'x-spreadsheet';\r\nexport const dpr = window.devicePixelRatio || 1;\r\nexport default {\r\n  cssPrefix,\r\n  dpr\r\n};\r\n","/* global window */\r\nimport { h } from './element';\r\nimport { mouseMoveUp } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Resizer {\r\n  constructor(vertical = false, minDistance) {\r\n    this.moving = false;\r\n    this.vertical = vertical;\r\n    this.el = h(\r\n      'div',\r\n      `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`\r\n    )\r\n      .children(\r\n        (this.hoverEl = h(\r\n          'div',\r\n          `${cssPrefix}-resizer-hover`\r\n        ).on('mousedown.stop', (evt) => this.mousedownHandler(evt))),\r\n        (this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide())\r\n      )\r\n      .hide();\r\n    // cell rect\r\n    this.cRect = null;\r\n    this.finishedFn = null;\r\n    this.minDistance = minDistance;\r\n  }\r\n\r\n  // rect : {top, left, width, height}\r\n  // line : {width, height}\r\n  show(rect, line) {\r\n    const { moving, vertical, hoverEl, lineEl, el } = this;\r\n    if (moving) return;\r\n    this.cRect = rect;\r\n    const { left, top, width, height } = rect;\r\n    el.offset({\r\n      left: vertical ? left + width - 5 : left,\r\n      top: vertical ? top : top + height - 5\r\n    }).show();\r\n    hoverEl.offset({\r\n      width: vertical ? 5 : width,\r\n      height: vertical ? height : 5\r\n    });\r\n    lineEl.offset({\r\n      width: vertical ? 0 : line.width,\r\n      height: vertical ? line.height : 0\r\n    });\r\n  }\r\n\r\n  hide() {\r\n    this.el\r\n      .offset({\r\n        left: 0,\r\n        top: 0\r\n      })\r\n      .hide();\r\n  }\r\n\r\n  mousedownHandler(evt) {\r\n    let startEvt = evt;\r\n    const { el, lineEl, cRect, vertical, minDistance } = this;\r\n    let distance = vertical ? cRect.width : cRect.height;\r\n    // console.log('distance:', distance);\r\n    lineEl.show();\r\n    mouseMoveUp(\r\n      window,\r\n      (e) => {\r\n        this.moving = true;\r\n        if (startEvt !== null && e.buttons === 1) {\r\n          // console.log('top:', top, ', left:', top, ', cRect:', cRect);\r\n          if (vertical) {\r\n            distance += e.movementX;\r\n            if (distance > minDistance) {\r\n              el.css('left', `${cRect.left + distance}px`);\r\n            }\r\n          } else {\r\n            distance += e.movementY;\r\n            if (distance > minDistance) {\r\n              el.css('top', `${cRect.top + distance}px`);\r\n            }\r\n          }\r\n          startEvt = e;\r\n        }\r\n      },\r\n      () => {\r\n        startEvt = null;\r\n        lineEl.hide();\r\n        this.moving = false;\r\n        this.hide();\r\n        if (this.finishedFn) {\r\n          if (distance < minDistance) distance = minDistance;\r\n          this.finishedFn(cRect, distance);\r\n        }\r\n      }\r\n    );\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\n/**\r\n * 自定义滚动条组件\r\n */\r\nexport default class Scrollbar {\r\n  constructor(vertical) {\r\n    this.vertical = vertical;\r\n    this.moveFn = null;\r\n    this.el = h(\r\n      'div',\r\n      `${cssPrefix}-scrollbar ${vertical ? 'vertical' : 'horizontal'}`\r\n    )\r\n      .child((this.contentEl = h('div', '')))\r\n      .on('mousemove.stop', () => {})\r\n      .on('scroll.stop', (evt) => {\r\n        const { scrollTop, scrollLeft } = evt.target;\r\n        // console.log('scrollTop:', scrollTop);\r\n        if (this.moveFn) {\r\n          this.moveFn(this.vertical ? scrollTop : scrollLeft, evt);\r\n        }\r\n        // console.log('evt:::', evt);\r\n      });\r\n  }\r\n\r\n  move(v) {\r\n    this.el.scroll(v);\r\n    return this;\r\n  }\r\n\r\n  scroll() {\r\n    return this.el.scroll();\r\n  }\r\n\r\n  set(distance, contentDistance) {\r\n    const d = distance - 1;\r\n    // console.log('distance:', distance, ', contentDistance:', contentDistance);\r\n    if (contentDistance > d) {\r\n      const cssKey = this.vertical ? 'height' : 'width';\r\n      this.el.css(cssKey, `${d}px`).show();\r\n      this.contentEl\r\n        .css(this.vertical ? 'width' : 'height', '1px')\r\n        .css(cssKey, `${contentDistance}px`);\r\n    } else {\r\n      this.el.hide();\r\n    }\r\n    return this;\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport { CellRange } from '../core/cell_range';\r\n\r\nconst selectorHeightBorderWidth = 2 * 2 - 1;\r\nlet startZIndex = 10;\r\n/**\r\n * 选中区域对象\r\n * sheet中单元格或者区域被选中呈现出的效果，其实是定位在div.overlayer之上的一个div.-selector-area\r\n */\r\nclass SelectorElement {\r\n  constructor() {\r\n    this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\r\n    this.areaEl = h('div', `${cssPrefix}-selector-area`)\r\n      .child(this.cornerEl)\r\n      .hide();\r\n    this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\r\n    this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\r\n    this.el = h('div', `${cssPrefix}-selector`)\r\n      .css('z-index', `${startZIndex}`)\r\n      .children(this.areaEl, this.clipboardEl, this.autofillEl)\r\n      .hide();\r\n    startZIndex += 1;\r\n  }\r\n\r\n  /**\r\n   * 设置选中区域（并设置区域范围）\r\n   * @param { top, left, width, height} v\r\n   */\r\n  setOffset(v) {\r\n    this.el.offset(v).show();\r\n    return this;\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n    return this;\r\n  }\r\n\r\n  setAreaOffset(v) {\r\n    const { left, top, width, height } = v;\r\n    this.areaEl\r\n      .offset({\r\n        width: width - selectorHeightBorderWidth + 0.8,\r\n        height: height - selectorHeightBorderWidth + 0.8,\r\n        left: left - 0.8,\r\n        top: top - 0.8\r\n      })\r\n      .show();\r\n  }\r\n\r\n  setClipboardOffset(v) {\r\n    const { left, top, width, height } = v;\r\n    this.clipboardEl.offset({\r\n      left,\r\n      top,\r\n      width: width - 5,\r\n      height: height - 5\r\n    });\r\n  }\r\n\r\n  showAutofill(v) {\r\n    const { left, top, width, height } = v;\r\n    this.autofillEl\r\n      .offset({\r\n        width: width - selectorHeightBorderWidth,\r\n        height: height - selectorHeightBorderWidth,\r\n        left,\r\n        top\r\n      })\r\n      .show();\r\n  }\r\n\r\n  hideAutofill() {\r\n    this.autofillEl.hide();\r\n  }\r\n\r\n  showClipboard() {\r\n    this.clipboardEl.show();\r\n  }\r\n\r\n  hideClipboard() {\r\n    this.clipboardEl.hide();\r\n  }\r\n}\r\n\r\n// 计算单元格选中区域,参数来源暂未知\r\nfunction calBRAreaOffset(offset) {\r\n  const { data } = this;\r\n  const { left, top, width, height, scroll, l, t } = offset;\r\n  const ftwidth = data.freezeTotalWidth();\r\n  const ftheight = data.freezeTotalHeight();\r\n  let left0 = left - ftwidth;\r\n  if (ftwidth > l) left0 -= scroll.x;\r\n  let top0 = top - ftheight;\r\n  if (ftheight > t) top0 -= scroll.y;\r\n  return {\r\n    left: left0,\r\n    top: top0,\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\n// 计算上部列标选中区域offset\r\nfunction calTAreaOffset(offset) {\r\n  const { data } = this;\r\n  const { left, width, height, l, t, scroll } = offset;\r\n  const ftwidth = data.freezeTotalWidth();\r\n  let left0 = left - ftwidth;\r\n  if (ftwidth > l) left0 -= scroll.x;\r\n  return {\r\n    left: left0,\r\n    top: t,\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\n// 计算左侧行标选中区域offset\r\nfunction calLAreaOffset(offset) {\r\n  const { data } = this;\r\n  const { top, width, height, l, t, scroll } = offset;\r\n  const ftheight = data.freezeTotalHeight();\r\n  let top0 = top - ftheight;\r\n  // console.log('ftheight:', ftheight, ', t:', t);\r\n  if (ftheight > t) top0 -= scroll.y;\r\n  return {\r\n    left: l,\r\n    top: top0,\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\n// 设置单元格选中区域\r\nfunction setBRAreaOffset(offset) {\r\n  const { br } = this;\r\n  br.setAreaOffset(calBRAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setTLAreaOffset(offset) {\r\n  const { tl } = this;\r\n  tl.setAreaOffset(offset);\r\n}\r\n\r\nfunction setTAreaOffset(offset) {\r\n  const { t } = this;\r\n  t.setAreaOffset(calTAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setLAreaOffset(offset) {\r\n  const { l } = this;\r\n  l.setAreaOffset(calLAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setLClipboardOffset(offset) {\r\n  const { l } = this;\r\n  l.setClipboardOffset(calLAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setBRClipboardOffset(offset) {\r\n  const { br } = this;\r\n  br.setClipboardOffset(calBRAreaOffset.call(this, offset));\r\n}\r\n\r\nfunction setTLClipboardOffset(offset) {\r\n  const { tl } = this;\r\n  tl.setClipboardOffset(offset);\r\n}\r\n\r\nfunction setTClipboardOffset(offset) {\r\n  const { t } = this;\r\n  t.setClipboardOffset(calTAreaOffset.call(this, offset));\r\n}\r\n\r\n/**\r\n * 设置选中区域的offset\r\n * @param {*} offset 数据来源：data.getSelectedRect()\r\n */\r\nfunction setAllAreaOffset(offset) {\r\n  setBRAreaOffset.call(this, offset);\r\n  setTLAreaOffset.call(this, offset);\r\n  setTAreaOffset.call(this, offset);\r\n  setLAreaOffset.call(this, offset);\r\n}\r\n\r\nfunction setAllClipboardOffset(offset) {\r\n  setBRClipboardOffset.call(this, offset);\r\n  setTLClipboardOffset.call(this, offset);\r\n  setTClipboardOffset.call(this, offset);\r\n  setLClipboardOffset.call(this, offset);\r\n}\r\n\r\n/**\r\n * 选中区域模型\r\n * 包含4个选中区域对象：\r\n * br - 单元格选中区域\r\n * t - 列选中区域\r\n * l - 行选中区域\r\n * tl - ？\r\n */\r\nexport default class Selector {\r\n  constructor(data) {\r\n    this.data = data;\r\n    this.br = new SelectorElement();\r\n    this.t = new SelectorElement();\r\n    this.l = new SelectorElement();\r\n    this.tl = new SelectorElement();\r\n    this.br.el.show();\r\n    this.offset = null;\r\n    this.areaOffset = null;\r\n    this.indexes = null;\r\n    this.range = null;\r\n    this.arange = null;\r\n    this.el = h('div', `${cssPrefix}-selectors`)\r\n      .children(this.tl.el, this.t.el, this.l.el, this.br.el)\r\n      .hide();\r\n\r\n    // for performance\r\n    this.lastri = -1;\r\n    this.lastci = -1;\r\n\r\n    startZIndex += 1;\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n  }\r\n\r\n  resetOffset() {\r\n    const { data, tl, t, l, br } = this;\r\n    const freezeHeight = data.freezeTotalHeight();\r\n    const freezeWidth = data.freezeTotalWidth();\r\n    if (freezeHeight > 0 || freezeWidth > 0) {\r\n      tl.setOffset({ width: freezeWidth, height: freezeHeight });\r\n      t.setOffset({ left: freezeWidth, height: freezeHeight });\r\n      l.setOffset({ top: freezeHeight, width: freezeWidth });\r\n      br.setOffset({ left: freezeWidth, top: freezeHeight });\r\n    } else {\r\n      tl.hide();\r\n      t.hide();\r\n      l.hide();\r\n      br.setOffset({ left: 0, top: 0 });\r\n    }\r\n  }\r\n\r\n  resetAreaOffset() {\r\n    // console.log('offset:', offset);\r\n    const offset = this.data.getSelectedRect();\r\n    const coffset = this.data.getClipboardRect();\r\n    setAllAreaOffset.call(this, offset);\r\n    setAllClipboardOffset.call(this, coffset);\r\n    this.resetOffset();\r\n  }\r\n\r\n  resetBRTAreaOffset() {\r\n    const offset = this.data.getSelectedRect();\r\n    const coffset = this.data.getClipboardRect();\r\n    setBRAreaOffset.call(this, offset);\r\n    setTAreaOffset.call(this, offset);\r\n    setBRClipboardOffset.call(this, coffset);\r\n    setTClipboardOffset.call(this, coffset);\r\n    this.resetOffset();\r\n  }\r\n\r\n  resetBRLAreaOffset() {\r\n    const offset = this.data.getSelectedRect();\r\n    const coffset = this.data.getClipboardRect();\r\n    setBRAreaOffset.call(this, offset);\r\n    setLAreaOffset.call(this, offset);\r\n    setBRClipboardOffset.call(this, coffset);\r\n    setLClipboardOffset.call(this, coffset);\r\n    this.resetOffset();\r\n  }\r\n\r\n  /**\r\n   * 开始选中区域设置，重置所有设置\r\n   * 又是鼠标点击拖拽放开3连的配套动作\r\n   * @param {*} ri\r\n   * @param {*} ci\r\n   * @param {*} indexesUpdated\r\n   */\r\n  set(ri, ci, indexesUpdated = true) {\r\n    const { data } = this;\r\n    const cellRange = data.calSelectedRangeByStart(ri, ci);\r\n    const { sri, sci } = cellRange;\r\n    if (indexesUpdated) {\r\n      let [cri, cci] = [ri, ci];\r\n      if (ri < 0) cri = 0;\r\n      if (ci < 0) cci = 0;\r\n      data.selector.setIndexes(cri, cci);\r\n      this.indexes = [cri, cci];\r\n    }\r\n\r\n    this.moveIndexes = [sri, sci];\r\n    // this.sIndexes = sIndexes;\r\n    // this.eIndexes = eIndexes;\r\n    this.range = cellRange;\r\n    this.resetAreaOffset();\r\n    this.el.show();\r\n  }\r\n\r\n  /**\r\n   * 结束选中区域设置\r\n   * @param {*} ri\r\n   * @param {*} ci\r\n   * @param {*} moving\r\n   */\r\n  setEnd(ri, ci, moving = true) {\r\n    const { data, lastri, lastci } = this;\r\n    if (moving) {\r\n      if (ri === lastri && ci === lastci) return;\r\n      this.lastri = ri;\r\n      this.lastci = ci;\r\n    }\r\n    this.range = data.calSelectedRangeByEnd(ri, ci);\r\n    setAllAreaOffset.call(this, this.data.getSelectedRect());\r\n  }\r\n\r\n  reset() {\r\n    // console.log('::::', this.data);\r\n    const { eri, eci } = this.data.selector.range;\r\n    this.setEnd(eri, eci);\r\n  }\r\n\r\n  showAutofill(ri, ci) {\r\n    if (ri === -1 && ci === -1) return;\r\n    // console.log('ri:', ri, ', ci:', ci);\r\n    // const [sri, sci] = this.sIndexes;\r\n    // const [eri, eci] = this.eIndexes;\r\n    const { sri, sci, eri, eci } = this.range;\r\n    const [nri, nci] = [ri, ci];\r\n    // const rn = eri - sri;\r\n    // const cn = eci - sci;\r\n    const srn = sri - ri;\r\n    const scn = sci - ci;\r\n    const ern = eri - ri;\r\n    const ecn = eci - ci;\r\n    if (scn > 0) {\r\n      // left\r\n      // console.log('left');\r\n      this.arange = new CellRange(sri, nci, eri, sci - 1);\r\n      // this.saIndexes = [sri, nci];\r\n      // this.eaIndexes = [eri, sci - 1];\r\n      // data.calRangeIndexes2(\r\n    } else if (srn > 0) {\r\n      // top\r\n      // console.log('top');\r\n      // nri = sri;\r\n      this.arange = new CellRange(nri, sci, sri - 1, eci);\r\n      // this.saIndexes = [nri, sci];\r\n      // this.eaIndexes = [sri - 1, eci];\r\n    } else if (ecn < 0) {\r\n      // right\r\n      // console.log('right');\r\n      // nci = eci;\r\n      this.arange = new CellRange(sri, eci + 1, eri, nci);\r\n      // this.saIndexes = [sri, eci + 1];\r\n      // this.eaIndexes = [eri, nci];\r\n    } else if (ern < 0) {\r\n      // bottom\r\n      // console.log('bottom');\r\n      // nri = eri;\r\n      this.arange = new CellRange(eri + 1, sci, nri, eci);\r\n      // this.saIndexes = [eri + 1, sci];\r\n      // this.eaIndexes = [nri, eci];\r\n    } else {\r\n      // console.log('else:');\r\n      this.arange = null;\r\n      // this.saIndexes = null;\r\n      // this.eaIndexes = null;\r\n      return;\r\n    }\r\n    if (this.arange !== null) {\r\n      // console.log(this.saIndexes, ':', this.eaIndexes);\r\n      const offset = this.data.getRect(this.arange);\r\n      offset.width += 2;\r\n      offset.height += 2;\r\n      const { br, l, t, tl } = this;\r\n      br.showAutofill(calBRAreaOffset.call(this, offset));\r\n      l.showAutofill(calLAreaOffset.call(this, offset));\r\n      t.showAutofill(calTAreaOffset.call(this, offset));\r\n      tl.showAutofill(offset);\r\n    }\r\n  }\r\n\r\n  hideAutofill() {\r\n    ['br', 'l', 't', 'tl'].forEach((property) => {\r\n      this[property].hideAutofill();\r\n    });\r\n  }\r\n\r\n  showClipboard() {\r\n    const coffset = this.data.getClipboardRect();\r\n    setAllClipboardOffset.call(this, coffset);\r\n    ['br', 'l', 't', 'tl'].forEach((property) => {\r\n      this[property].showClipboard();\r\n    });\r\n  }\r\n\r\n  hideClipboard() {\r\n    ['br', 'l', 't', 'tl'].forEach((property) => {\r\n      this[property].hideClipboard();\r\n    });\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nfunction inputMovePrev(evt) {\r\n  evt.preventDefault();\r\n  evt.stopPropagation();\r\n  const { filterItems } = this;\r\n  if (filterItems.length <= 0) return;\r\n  if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\r\n  this.itemIndex -= 1;\r\n  if (this.itemIndex < 0) {\r\n    this.itemIndex = filterItems.length - 1;\r\n  }\r\n  filterItems[this.itemIndex].toggle();\r\n}\r\n\r\nfunction inputMoveNext(evt) {\r\n  evt.stopPropagation();\r\n  const { filterItems } = this;\r\n  if (filterItems.length <= 0) return;\r\n  if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\r\n  this.itemIndex += 1;\r\n  if (this.itemIndex > filterItems.length - 1) {\r\n    this.itemIndex = 0;\r\n  }\r\n  filterItems[this.itemIndex].toggle();\r\n}\r\n\r\nfunction inputEnter(evt) {\r\n  evt.preventDefault();\r\n  const { filterItems } = this;\r\n  if (filterItems.length <= 0) return;\r\n  evt.stopPropagation();\r\n  if (this.itemIndex < 0) this.itemIndex = 0;\r\n  filterItems[this.itemIndex].el.click();\r\n  this.hide();\r\n}\r\n\r\nfunction inputKeydownHandler(evt) {\r\n  const { keyCode } = evt;\r\n  if (evt.ctrlKey) {\r\n    evt.stopPropagation();\r\n  }\r\n  switch (keyCode) {\r\n    case 37: // left\r\n      evt.stopPropagation();\r\n      break;\r\n    case 38: // up\r\n      inputMovePrev.call(this, evt);\r\n      break;\r\n    case 39: // right\r\n      evt.stopPropagation();\r\n      break;\r\n    case 40: // down\r\n      inputMoveNext.call(this, evt);\r\n      break;\r\n    case 13: // enter\r\n      inputEnter.call(this, evt);\r\n      break;\r\n    case 9:\r\n      inputEnter.call(this, evt);\r\n      break;\r\n    default:\r\n      evt.stopPropagation();\r\n      break;\r\n  }\r\n}\r\n\r\nexport default class Suggest {\r\n  constructor(items, itemClick, width = '200px') {\r\n    this.filterItems = [];\r\n    this.items = items;\r\n    this.el = h('div', `${cssPrefix}-suggest`)\r\n      .css('width', width)\r\n      .hide();\r\n    this.itemClick = itemClick;\r\n    this.itemIndex = -1;\r\n  }\r\n\r\n  setOffset(v) {\r\n    this.el.cssRemoveKeys('top', 'bottom').offset(v);\r\n  }\r\n\r\n  hide() {\r\n    const { el } = this;\r\n    this.filterItems = [];\r\n    this.itemIndex = -1;\r\n    el.hide();\r\n    unbindClickoutside(this.el.parent());\r\n  }\r\n\r\n  setItems(items) {\r\n    this.items = items;\r\n    this.search('');\r\n  }\r\n\r\n  search(word) {\r\n    let { items } = this;\r\n    if (!/^\\s*$/.test(word)) {\r\n      items = items.filter((it) =>\r\n        (it.key || it).startsWith(word.toUpperCase())\r\n      );\r\n    }\r\n    items = items.map((it) => {\r\n      let { title } = it;\r\n      if (title) {\r\n        if (typeof title === 'function') {\r\n          title = title();\r\n        }\r\n      } else {\r\n        title = it;\r\n      }\r\n      const item = h('div', `${cssPrefix}-item`)\r\n        .child(title)\r\n        .on('click.stop', () => {\r\n          this.itemClick(it);\r\n          this.hide();\r\n        });\r\n      if (it.label) {\r\n        item.child(h('div', 'label').html(it.label));\r\n      }\r\n      return item;\r\n    });\r\n    this.filterItems = items;\r\n    if (items.length <= 0) {\r\n      return;\r\n    }\r\n    const { el } = this;\r\n    // items[0].toggle();\r\n    el.html('')\r\n      .children(...items)\r\n      .show();\r\n    bindClickoutside(el.parent(), () => {\r\n      this.hide();\r\n    });\r\n  }\r\n\r\n  bindInputEvents(input) {\r\n    input.on('keydown', (evt) => inputKeydownHandler.call(this, evt));\r\n  }\r\n}\r\n","import { Element, h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Icon extends Element {\r\n  constructor(name) {\r\n    super('div', `${cssPrefix}-icon`);\r\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${name}`);\r\n    this.child(this.iconNameEl);\r\n  }\r\n\r\n  setName(name) {\r\n    this.iconNameEl.className(`${cssPrefix}-icon-img ${name}`);\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport Icon from './icon';\r\nimport { t } from '../locale/locale';\r\n\r\nfunction addMonth(date, step) {\r\n  date.setMonth(date.getMonth() + step);\r\n}\r\n\r\nfunction weekday(date, index) {\r\n  const d = new Date(date);\r\n  d.setDate(index - date.getDay() + 1);\r\n  return d;\r\n}\r\n\r\nfunction monthDays(year, month, cdate) {\r\n  // the first day of month\r\n  const startDate = new Date(year, month, 1, 23, 59, 59);\r\n  const datess = [[], [], [], [], [], []];\r\n  for (let i = 0; i < 6; i += 1) {\r\n    for (let j = 0; j < 7; j += 1) {\r\n      const index = i * 7 + j;\r\n      const d = weekday(startDate, index);\r\n      const disabled = d.getMonth() !== month;\r\n      // console.log('d:', d, ', cdate:', cdate);\r\n      const active =\r\n        d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();\r\n      datess[i][j] = { d, disabled, active };\r\n    }\r\n  }\r\n  return datess;\r\n}\r\n\r\nexport default class Calendar {\r\n  constructor(value) {\r\n    this.value = value;\r\n    this.cvalue = new Date(value);\r\n\r\n    this.headerLeftEl = h('div', 'calendar-header-left');\r\n    this.bodyEl = h('tbody', '');\r\n    this.buildAll();\r\n    this.el = h('div', 'x-spreadsheet-calendar').children(\r\n      h('div', 'calendar-header').children(\r\n        this.headerLeftEl,\r\n        h('div', 'calendar-header-right').children(\r\n          h('a', 'calendar-prev')\r\n            .on('click.stop', () => this.prev())\r\n            .child(new Icon('chevron-left')),\r\n          h('a', 'calendar-next')\r\n            .on('click.stop', () => this.next())\r\n            .child(new Icon('chevron-right'))\r\n        )\r\n      ),\r\n      h('table', 'calendar-body').children(\r\n        h('thead', '').child(\r\n          h('tr', '').children(\r\n            ...t('calendar.weeks').map((week) => h('th', 'cell').child(week))\r\n          )\r\n        ),\r\n        this.bodyEl\r\n      )\r\n    );\r\n    this.selectChange = () => {};\r\n  }\r\n\r\n  setValue(value) {\r\n    this.value = value;\r\n    this.cvalue = new Date(value);\r\n    this.buildAll();\r\n  }\r\n\r\n  prev() {\r\n    const { value } = this;\r\n    addMonth(value, -1);\r\n    this.buildAll();\r\n  }\r\n\r\n  next() {\r\n    const { value } = this;\r\n    addMonth(value, 1);\r\n    this.buildAll();\r\n  }\r\n\r\n  buildAll() {\r\n    this.buildHeaderLeft();\r\n    this.buildBody();\r\n  }\r\n\r\n  buildHeaderLeft() {\r\n    const { value } = this;\r\n    this.headerLeftEl.html(\r\n      `${t('calendar.months')[value.getMonth()]} ${value.getFullYear()}`\r\n    );\r\n  }\r\n\r\n  buildBody() {\r\n    const { value, cvalue, bodyEl } = this;\r\n    const mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);\r\n    const trs = mDays.map((it) => {\r\n      const tds = it.map((it1) => {\r\n        let cls = 'cell';\r\n        if (it1.disabled) cls += ' disabled';\r\n        if (it1.active) cls += ' active';\r\n        return h('td', '').child(\r\n          h('div', cls)\r\n            .on('click.stop', () => {\r\n              this.selectChange(it1.d);\r\n            })\r\n            .child(it1.d.getDate().toString())\r\n        );\r\n      });\r\n      return h('tr', '').children(...tds);\r\n    });\r\n    bodyEl.html('').children(...trs);\r\n  }\r\n}\r\n","import Calendar from './calendar';\r\nimport { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Datepicker {\r\n  constructor() {\r\n    this.calendar = new Calendar(new Date());\r\n    this.el = h('div', `${cssPrefix}-datepicker`)\r\n      .child(this.calendar.el)\r\n      .hide();\r\n  }\r\n\r\n  setValue(date) {\r\n    // console.log(':::::::', date, typeof date, date instanceof string);\r\n    const { calendar } = this;\r\n    if (typeof date === 'string') {\r\n      // console.log(/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date));\r\n      if (/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date)) {\r\n        calendar.setValue(new Date(date.replace(new RegExp('-', 'g'), '/')));\r\n      }\r\n    } else if (date instanceof Date) {\r\n      calendar.setValue(date);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  change(cb) {\r\n    this.calendar.selectChange = (d) => {\r\n      cb(d);\r\n      this.hide();\r\n    };\r\n  }\r\n\r\n  show() {\r\n    this.el.show();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n  }\r\n}\r\n","//* global window */\r\nimport { h } from './element';\r\nimport Suggest from './suggest';\r\nimport Datepicker from './datepicker';\r\nimport { cssPrefix } from '../config';\r\n\r\nfunction resetTextareaSize() {\r\n  if (!/^\\s*$/.test(this.inputText)) {\r\n    const { textlineEl, textEl, areaOffset } = this;\r\n    const tlineWidth = textlineEl.offset().width + 9;\r\n    const maxWidth = this.viewFn().width - areaOffset.left - 9;\r\n    // console.log('tlineWidth:', tlineWidth, ':', maxWidth);\r\n    if (tlineWidth > areaOffset.width) {\r\n      let twidth = tlineWidth;\r\n      if (tlineWidth > maxWidth) {\r\n        twidth = maxWidth;\r\n        let h1 = parseInt(tlineWidth / maxWidth, 10);\r\n        h1 += tlineWidth % maxWidth > 0 ? 1 : 0;\r\n        h1 *= this.rowHeight;\r\n        if (h1 > areaOffset.height) {\r\n          textEl.css('height', `${h1}px`);\r\n        }\r\n      }\r\n      textEl.css('width', `${twidth}px`);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * input事件代理器（切面）\r\n * 1、设置editor元素对象的 inputText 属性值为输入框的值\r\n * 2、检查是否有关键字\r\n * 3、设置子节点 textlineEl 的innerHtml的值为输入框的值\r\n * 4、根据内容重置当前编辑中单元格的尺寸\r\n * 5、对外发出input事件\r\n * @param {*} evt\r\n */\r\nfunction inputEventHandler(evt) {\r\n  const v = evt.target.value;\r\n  // console.log(evt, 'v:', v);\r\n  const { suggest, textlineEl, validator } = this;\r\n  this.inputText = v;\r\n  if (validator) {\r\n    if (validator.type === 'list') {\r\n      suggest.search(v);\r\n    } else {\r\n      suggest.hide();\r\n    }\r\n  } else {\r\n    const start = v.lastIndexOf('=');\r\n    if (start !== -1) {\r\n      suggest.search(v.substring(start + 1));\r\n    } else {\r\n      suggest.hide();\r\n    }\r\n  }\r\n  textlineEl.html(v);\r\n  resetTextareaSize.call(this);\r\n  this.change('input', v);\r\n}\r\n\r\nfunction setTextareaRange(position) {\r\n  const { el } = this.textEl;\r\n  setTimeout(() => {\r\n    el.focus();\r\n    el.setSelectionRange(position, position);\r\n  }, 0);\r\n}\r\n\r\nfunction setText(text, position) {\r\n  const { textEl, textlineEl } = this;\r\n  // firefox bug\r\n  textEl.el.blur();\r\n\r\n  textEl.val(text);\r\n  textlineEl.html(text);\r\n  setTextareaRange.call(this, position);\r\n}\r\n\r\nfunction suggestItemClick(it) {\r\n  const { inputText, validator } = this;\r\n  let position = 0;\r\n  if (validator && validator.type === 'list') {\r\n    this.inputText = it;\r\n    position = this.inputText.length;\r\n  } else {\r\n    const start = inputText.lastIndexOf('=');\r\n    const sit = inputText.substring(0, start + 1);\r\n    let eit = inputText.substring(start + 1);\r\n    if (eit.indexOf(')') !== -1) {\r\n      eit = eit.substring(eit.indexOf(')'));\r\n    } else {\r\n      eit = '';\r\n    }\r\n    this.inputText = `${sit + it.key}(`;\r\n    // console.log('inputText:', this.inputText);\r\n    position = this.inputText.length;\r\n    this.inputText += `)${eit}`;\r\n  }\r\n  setText.call(this, this.inputText, position);\r\n}\r\n\r\nfunction resetSuggestItems() {\r\n  this.suggest.setItems(this.formulas);\r\n}\r\n\r\nfunction dateFormat(d) {\r\n  let month = d.getMonth() + 1;\r\n  let date = d.getDate();\r\n  if (month < 10) month = `0${month}`;\r\n  if (date < 10) date = `0${date}`;\r\n  return `${d.getFullYear()}-${month}-${date}`;\r\n}\r\n\r\n/**\r\n * 编辑器\r\n * 单元格被选中之后的输入状态，实际由定位在div.overlayer-content之上的div.editer(this.el)提供<br/>\r\n * div.editer的offset与overlayer-content完全相同<br/>\r\n * editer 的输入能力由其子节点div.editor-area(this.areaEl)中的textarea(this.textEl)输入框提供<br/>\r\n * editor-area的offset与选中的单元格相同\r\n * editor-area还有一个专门用于存储输入值的div.textline(this.texllineEl)<br/>\r\n * --------------------\r\n * div.editer全局只有一个，默认是隐藏的\r\n */\r\nexport default class Editor {\r\n  constructor(formulas, viewFn, rowHeight) {\r\n    this.viewFn = viewFn;\r\n    this.rowHeight = rowHeight;\r\n    this.formulas = formulas;\r\n    this.suggest = new Suggest(formulas, (it) => {\r\n      suggestItemClick.call(this, it);\r\n    });\r\n    this.datepicker = new Datepicker();\r\n    this.datepicker.change((d) => {\r\n      // console.log('d:', d);\r\n      this.setText(dateFormat(d));\r\n      this.clear();\r\n    });\r\n    this.areaEl = h('div', `${cssPrefix}-editor-area`)\r\n      .children(\r\n        (this.textEl = h('textarea', '').on('input', (evt) =>\r\n          inputEventHandler.call(this, evt)\r\n        )),\r\n        (this.textlineEl = h('div', 'textline')),\r\n        this.suggest.el,\r\n        this.datepicker.el\r\n      )\r\n      .on('mousemove.stop', () => {})\r\n      .on('mousedown.stop', () => {});\r\n    this.el = h('div', `${cssPrefix}-editor`)\r\n      .child(this.areaEl)\r\n      .hide();\r\n    this.suggest.bindInputEvents(this.textEl);\r\n\r\n    this.areaOffset = null;\r\n    this.freeze = { w: 0, h: 0 };\r\n    this.cell = null;\r\n    this.inputText = '';\r\n    this.change = () => {};\r\n  }\r\n\r\n  setFreezeLengths(width, height) {\r\n    this.freeze.w = width;\r\n    this.freeze.h = height;\r\n  }\r\n\r\n  clear() {\r\n    // const { cell } = this;\r\n    // const cellText = (cell && cell.text) || '';\r\n    if (this.inputText !== '') {\r\n      this.change('finished', this.inputText);\r\n    }\r\n    this.cell = null;\r\n    this.areaOffset = null;\r\n    this.inputText = '';\r\n    this.el.hide();\r\n    this.textEl.val('');\r\n    this.textlineEl.html('');\r\n    resetSuggestItems.call(this);\r\n    this.datepicker.hide();\r\n  }\r\n\r\n  setOffset(offset, suggestPosition = 'top') {\r\n    const { textEl, areaEl, suggest, freeze, el } = this;\r\n    if (offset) {\r\n      this.areaOffset = offset;\r\n      const { left, top, width, height, l, t } = offset;\r\n      // console.log('left:', left, ',top:', top, ', freeze:', freeze);\r\n      const elOffset = { left: 0, top: 0 };\r\n      // top left\r\n      if (freeze.w > l && freeze.h > t) {\r\n        //\r\n      } else if (freeze.w < l && freeze.h < t) {\r\n        elOffset.left = freeze.w;\r\n        elOffset.top = freeze.h;\r\n      } else if (freeze.w > l) {\r\n        elOffset.top = freeze.h;\r\n      } else if (freeze.h > t) {\r\n        elOffset.left = freeze.w;\r\n      }\r\n      el.offset(elOffset);\r\n      areaEl.offset({\r\n        left: left - elOffset.left - 0.8,\r\n        top: top - elOffset.top - 0.8\r\n      });\r\n      textEl.offset({ width: width - 9 + 0.8, height: height - 3 + 0.8 });\r\n      const sOffset = { left: 0 };\r\n      sOffset[suggestPosition] = height;\r\n      suggest.setOffset(sOffset);\r\n      suggest.hide();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 设置编辑器当前所在的单元格\r\n   * @param {*} cell\r\n   * @param {*} validator\r\n   */\r\n  setCell(cell, validator) {\r\n    // console.log('::', validator);\r\n    const { el, datepicker, suggest } = this;\r\n    el.show();\r\n    this.cell = cell;\r\n    const text = (cell && cell.text) || '';\r\n    this.setText(text);\r\n\r\n    this.validator = validator;\r\n    if (validator) {\r\n      const { type } = validator;\r\n      if (type === 'date') {\r\n        datepicker.show();\r\n        if (!/^\\s*$/.test(text)) {\r\n          datepicker.setValue(text);\r\n        }\r\n      }\r\n      if (type === 'list') {\r\n        suggest.setItems(validator.values());\r\n      }\r\n    }\r\n  }\r\n\r\n  setText(text) {\r\n    this.inputText = text;\r\n    // console.log('text>>:', text);\r\n    setText.call(this, text, text.length);\r\n    resetTextareaSize.call(this);\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\nimport { tf } from '../locale/locale';\r\n\r\nconst menuItems = [\r\n  { key: 'copy', title: tf('contextmenu.copy'), label: 'Ctrl+C' },\r\n  { key: 'cut', title: tf('contextmenu.cut'), label: 'Ctrl+X' },\r\n  { key: 'paste', title: tf('contextmenu.paste'), label: 'Ctrl+V' },\r\n  {\r\n    key: 'paste-value',\r\n    title: tf('contextmenu.pasteValue'),\r\n    label: 'Ctrl+Shift+V'\r\n  },\r\n  {\r\n    key: 'paste-format',\r\n    title: tf('contextmenu.pasteFormat'),\r\n    label: 'Ctrl+Alt+V'\r\n  },\r\n  { key: 'divider' },\r\n  { key: 'insert-row', title: tf('contextmenu.insertRow') },\r\n  { key: 'insert-column', title: tf('contextmenu.insertColumn') },\r\n  { key: 'divider' },\r\n  { key: 'delete-row', title: tf('contextmenu.deleteRow') },\r\n  { key: 'delete-column', title: tf('contextmenu.deleteColumn') },\r\n  { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },\r\n  { key: 'divider' },\r\n  { key: 'validation', title: tf('contextmenu.validation') }\r\n];\r\n\r\nfunction buildMenuItem(item) {\r\n  if (item.key === 'divider') {\r\n    return h('div', `${cssPrefix}-item divider`);\r\n  }\r\n  return h('div', `${cssPrefix}-item`)\r\n    .on('click', () => {\r\n      this.itemClick(item.key);\r\n      this.hide();\r\n    })\r\n    .children(item.title(), h('div', 'label').child(item.label || ''));\r\n}\r\n\r\nfunction buildMenu() {\r\n  return menuItems.map((it) => buildMenuItem.call(this, it));\r\n}\r\n\r\nexport default class ContextMenu {\r\n  constructor(viewFn, isHide = false) {\r\n    this.el = h('div', `${cssPrefix}-contextmenu`)\r\n      .children(...buildMenu.call(this))\r\n      .hide();\r\n    this.viewFn = viewFn;\r\n    this.itemClick = () => {};\r\n    this.isHide = isHide;\r\n  }\r\n\r\n  hide() {\r\n    const { el } = this;\r\n    el.hide();\r\n    unbindClickoutside(el);\r\n  }\r\n\r\n  setPosition(x, y) {\r\n    if (this.isHide) return;\r\n    const { el } = this;\r\n    const { height, width } = el.show().offset();\r\n    const view = this.viewFn();\r\n    let top = y;\r\n    let left = x;\r\n    if (view.height - y <= height) {\r\n      top -= height;\r\n    }\r\n    if (view.width - x <= width) {\r\n      left -= width;\r\n    }\r\n    el.offset({ left, top });\r\n    bindClickoutside(el);\r\n  }\r\n}\r\n","const baseFonts = [\r\n  { key: 'Arial', title: 'Arial' },\r\n  { key: 'Helvetica', title: 'Helvetica' },\r\n  { key: 'Source Sans Pro', title: 'Source Sans Pro' },\r\n  { key: 'Comic Sans MS', title: 'Comic Sans MS' },\r\n  { key: 'Courier New', title: 'Courier New' },\r\n  { key: 'Verdana', title: 'Verdana' },\r\n  { key: 'Lato', title: 'Lato' }\r\n];\r\n\r\nconst fontSizes = [\r\n  { pt: 7.5, px: 10 },\r\n  { pt: 8, px: 11 },\r\n  { pt: 9, px: 12 },\r\n  { pt: 10, px: 13 },\r\n  { pt: 10.5, px: 14 },\r\n  { pt: 11, px: 15 },\r\n  { pt: 12, px: 16 },\r\n  { pt: 14, px: 18.7 },\r\n  { pt: 15, px: 20 },\r\n  { pt: 16, px: 21.3 },\r\n  { pt: 18, px: 24 },\r\n  { pt: 22, px: 29.3 },\r\n  { pt: 24, px: 32 },\r\n  { pt: 26, px: 34.7 },\r\n  { pt: 36, px: 48 },\r\n  { pt: 42, px: 56 }\r\n  // { pt: 54, px: 71.7 },\r\n  // { pt: 63, px: 83.7 },\r\n  // { pt: 72, px: 95.6 },\r\n];\r\n\r\nfunction getFontSizePxByPt(pt) {\r\n  for (let i = 0; i < fontSizes.length; i += 1) {\r\n    const fontSize = fontSizes[i];\r\n    if (fontSize.pt === pt) {\r\n      return fontSize.px;\r\n    }\r\n  }\r\n  return pt;\r\n}\r\n\r\nconst fonts = (ary = []) => {\r\n  const map = {};\r\n  baseFonts.concat(ary).forEach((f) => {\r\n    map[f.key] = f;\r\n  });\r\n  return map;\r\n};\r\n\r\nexport default {};\r\nexport { fontSizes, fonts, baseFonts, getFontSizePxByPt };\r\n","import { expr2xy, xy2expr } from './alphabet';\r\n\r\n// Converting infix expression to a suffix expression\r\n// src: AVERAGE(SUM(A1,A2), B1) + 50 + B20\r\n// return: [A1, A2], SUM[, B1],AVERAGE,50,+,B20,+\r\nconst infixExprToSuffixExpr = (src) => {\r\n  const operatorStack = [];\r\n  const stack = [];\r\n  let subStrs = []; // SUM, A1, B2, 50 ...\r\n  let fnArgType = 0; // 1 => , 2 => :\r\n  let fnArgsLen = 1; // A1,A2,A3...\r\n  for (let i = 0; i < src.length; i += 1) {\r\n    const c = src.charAt(i);\r\n    // console.log('c:', c);\r\n    if (c !== ' ') {\r\n      if (c >= 'a' && c <= 'z') {\r\n        subStrs.push(c.toUpperCase());\r\n      } else if (\r\n        (c >= '0' && c <= '9') ||\r\n        (c >= 'A' && c <= 'Z') ||\r\n        c === '.'\r\n      ) {\r\n        subStrs.push(c);\r\n      } else if (c === '\"') {\r\n        i += 1;\r\n        while (src.charAt(i) !== '\"') {\r\n          subStrs.push(src.charAt(i));\r\n          i += 1;\r\n        }\r\n        stack.push(`\"${subStrs.join('')}`);\r\n        subStrs = [];\r\n      } else {\r\n        // console.log('subStrs:', subStrs.join(''), stack);\r\n        if (c !== '(' && subStrs.length > 0) {\r\n          stack.push(subStrs.join(''));\r\n        }\r\n        if (c === ')') {\r\n          let c1 = operatorStack.pop();\r\n          if (fnArgType === 2) {\r\n            // fn argument range => A1:B5\r\n            try {\r\n              const [ex, ey] = expr2xy(stack.pop());\r\n              const [sx, sy] = expr2xy(stack.pop());\r\n              // console.log('::', sx, sy, ex, ey);\r\n              let rangelen = 0;\r\n              for (let x = sx; x <= ex; x += 1) {\r\n                for (let y = sy; y <= ey; y += 1) {\r\n                  stack.push(xy2expr(x, y));\r\n                  rangelen += 1;\r\n                }\r\n              }\r\n              stack.push([c1, rangelen]);\r\n            } catch (e) {\r\n              // console.log(e);\r\n            }\r\n          } else if (fnArgType === 1) {\r\n            // fn argument => A1,A2,B5\r\n            stack.push([c1, fnArgsLen]);\r\n            fnArgsLen = 1;\r\n          } else {\r\n            // console.log('c1:', c1, fnArgType, stack, operatorStack);\r\n            while (c1 !== '(') {\r\n              stack.push(c1);\r\n              if (operatorStack.length <= 0) break;\r\n              c1 = operatorStack.pop();\r\n            }\r\n          }\r\n          fnArgType = 0;\r\n        } else if (c === ':') {\r\n          fnArgType = 2;\r\n        } else if (c === ',') {\r\n          fnArgType = 1;\r\n          fnArgsLen += 1;\r\n        } else if (c === '(' && subStrs.length > 0) {\r\n          // function\r\n          operatorStack.push(subStrs.join(''));\r\n        } else {\r\n          // priority: */ > +-\r\n          // console.log(operatorStack, c, stack);\r\n          if (operatorStack.length > 0 && (c === '+' || c === '-')) {\r\n            let top = operatorStack[operatorStack.length - 1];\r\n            if (top !== '(') stack.push(operatorStack.pop());\r\n            if (top === '*' || top === '/') {\r\n              while (operatorStack.length > 0) {\r\n                top = operatorStack[operatorStack.length - 1];\r\n                if (top !== '(') stack.push(operatorStack.pop());\r\n                else break;\r\n              }\r\n            }\r\n          }\r\n          operatorStack.push(c);\r\n        }\r\n        subStrs = [];\r\n      }\r\n    }\r\n  }\r\n  if (subStrs.length > 0) {\r\n    stack.push(subStrs.join(''));\r\n  }\r\n  while (operatorStack.length > 0) {\r\n    stack.push(operatorStack.pop());\r\n  }\r\n  return stack;\r\n};\r\n\r\nconst evalSubExpr = (subExpr, cellRender) => {\r\n  if (subExpr[0] >= '0' && subExpr[0] <= '9') {\r\n    return Number(subExpr);\r\n  }\r\n  if (subExpr[0] === '\"') {\r\n    return subExpr.substring(1);\r\n  }\r\n  const [x, y] = expr2xy(subExpr);\r\n  return cellRender(x, y);\r\n};\r\n\r\n// evaluate the suffix expression\r\n// srcStack: <= infixExprToSufixExpr\r\n// formulaMap: {'SUM': {}, ...}\r\n// cellRender: (x, y) => {}\r\nconst evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) => {\r\n  const stack = [];\r\n  // console.log(':::::formulaMap:', formulaMap);\r\n  for (let i = 0; i < srcStack.length; i += 1) {\r\n    // console.log(':::>>>', srcStack[i]);\r\n    if (srcStack[i] === '+') {\r\n      const top = stack.pop();\r\n      stack.push(Number(stack.pop()) + Number(top));\r\n    } else if (srcStack[i] === '-') {\r\n      const top = stack.pop();\r\n      stack.push(Number(stack.pop()) - Number(top));\r\n    } else if (srcStack[i] === '*') {\r\n      stack.push(Number(stack.pop()) * Number(stack.pop()));\r\n    } else if (srcStack[i] === '/') {\r\n      const top = stack.pop();\r\n      stack.push(Number(stack.pop()) / Number(top));\r\n    } else if (Array.isArray(srcStack[i])) {\r\n      const [formula, len] = srcStack[i];\r\n      const params = [];\r\n      for (let j = 0; j < len; j += 1) {\r\n        params.push(stack.pop());\r\n      }\r\n      stack.push(formulaMap[formula].render(params.reverse()));\r\n    } else {\r\n      if (cellList.includes(srcStack[i])) {\r\n        return 0;\r\n      }\r\n      cellList.push(srcStack[i]);\r\n      stack.push(evalSubExpr(srcStack[i], cellRender));\r\n    }\r\n    // console.log('stack:', stack);\r\n  }\r\n  return stack[0];\r\n};\r\n\r\nconst cellRender = (src, formulaMap, getCellText, cellList = []) => {\r\n  if (src[0] === '=') {\r\n    const stack = infixExprToSuffixExpr(src.substring(1));\r\n    if (stack.length <= 0) return src;\r\n    return evalSuffixExpr(\r\n      stack,\r\n      formulaMap,\r\n      (x, y) =>\r\n        cellRender(getCellText(x, y), formulaMap, getCellText, cellList),\r\n      cellList\r\n    );\r\n  }\r\n  return src;\r\n};\r\n\r\nexport default {\r\n  render: cellRender\r\n};\r\nexport { infixExprToSuffixExpr };\r\n","/**\r\n  formula:\r\n    key\r\n    title\r\n    render\r\n*/\r\nimport { tf } from '../locale/locale';\r\n\r\nconst baseFormulas = [\r\n  {\r\n    key: 'SUM',\r\n    title: tf('formula.sum'),\r\n    render: (ary) => ary.reduce((a, b) => Number(a) + Number(b), 0)\r\n  },\r\n  {\r\n    key: 'AVERAGE',\r\n    title: tf('formula.average'),\r\n    render: (ary) => ary.reduce((a, b) => Number(a) + Number(b), 0) / ary.length\r\n  },\r\n  {\r\n    key: 'MAX',\r\n    title: tf('formula.max'),\r\n    render: (ary) => Math.max(...ary.map((v) => Number(v)))\r\n  },\r\n  {\r\n    key: 'MIN',\r\n    title: tf('formula.min'),\r\n    render: (ary) => Math.min(...ary.map((v) => Number(v)))\r\n  },\r\n  {\r\n    key: 'CONCAT',\r\n    title: tf('formula.concat'),\r\n    render: (ary) => ary.join('')\r\n  }\r\n];\r\n\r\nconst formulas = baseFormulas;\r\n\r\n// const formulas = (formulaAry = []) => {\r\n//   const formulaMap = {};\r\n//   baseFormulas.concat(formulaAry).forEach((f) => {\r\n//     formulaMap[f.key] = f;\r\n//   });\r\n//   return formulaMap;\r\n// };\r\nconst formulam = {};\r\nbaseFormulas.forEach((f) => {\r\n  formulam[f.key] = f;\r\n});\r\n\r\nexport default {};\r\n\r\nexport { formulam, formulas, baseFormulas };\r\n","import { tf } from '../locale/locale';\r\n\r\nconst formatStringRender = (v) => v;\r\n\r\nconst formatNumberRender = (v) => {\r\n  if (/^(-?\\d*.?\\d*)$/.test(v)) {\r\n    const v1 = Number(v)\r\n      .toFixed(2)\r\n      .toString();\r\n    const [first, ...parts] = v1.split('\\\\.');\r\n    return [first.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,'), ...parts];\r\n  }\r\n  return v;\r\n};\r\n\r\nconst baseFormats = [\r\n  {\r\n    key: 'normal',\r\n    title: tf('format.normal'),\r\n    type: 'string',\r\n    render: formatStringRender\r\n  },\r\n  {\r\n    key: 'text',\r\n    title: tf('format.text'),\r\n    type: 'string',\r\n    render: formatStringRender\r\n  },\r\n  {\r\n    key: 'number',\r\n    title: tf('format.number'),\r\n    type: 'number',\r\n    label: '1,000.12',\r\n    render: formatNumberRender\r\n  },\r\n  {\r\n    key: 'percent',\r\n    title: tf('format.percent'),\r\n    type: 'number',\r\n    label: '10.12%',\r\n    render: (v) => `${v}%`\r\n  },\r\n  {\r\n    key: 'rmb',\r\n    title: tf('format.rmb'),\r\n    type: 'number',\r\n    label: '￥10.00',\r\n    render: (v) => `￥${formatNumberRender(v)}`\r\n  },\r\n  {\r\n    key: 'usd',\r\n    title: tf('format.usd'),\r\n    type: 'number',\r\n    label: '$10.00',\r\n    render: (v) => `$${formatNumberRender(v)}`\r\n  },\r\n  {\r\n    key: 'date',\r\n    title: tf('format.date'),\r\n    type: 'date',\r\n    label: '26/09/2008',\r\n    render: formatStringRender\r\n  },\r\n  {\r\n    key: 'time',\r\n    title: tf('format.time'),\r\n    type: 'date',\r\n    label: '15:59:00',\r\n    render: formatStringRender\r\n  },\r\n  {\r\n    key: 'datetime',\r\n    title: tf('format.datetime'),\r\n    type: 'date',\r\n    label: '26/09/2008 15:59:00',\r\n    render: formatStringRender\r\n  },\r\n  {\r\n    key: 'duration',\r\n    title: tf('format.duration'),\r\n    type: 'date',\r\n    label: '24:01:00',\r\n    render: formatStringRender\r\n  }\r\n];\r\n\r\n// const formats = (ary = []) => {\r\n//   const map = {};\r\n//   baseFormats.concat(ary).forEach((f) => {\r\n//     map[f.key] = f;\r\n//   });\r\n//   return map;\r\n// };\r\nconst formatm = {};\r\nbaseFormats.forEach((f) => {\r\n  formatm[f.key] = f;\r\n});\r\n\r\nexport default {};\r\nexport { formatm, baseFormats };\r\n","/* global window */\r\nfunction dpr() {\r\n  return window.devicePixelRatio || 1;\r\n}\r\n\r\nfunction thinLineWidth() {\r\n  return dpr() - 0.5;\r\n}\r\n\r\nfunction npx(px) {\r\n  return parseInt(px * dpr(), 10);\r\n}\r\n\r\nfunction npxLine(px) {\r\n  const n = npx(px);\r\n  return n > 0 ? n - 0.5 : 0.5;\r\n}\r\n\r\nclass DrawBox {\r\n  constructor(x, y, w, h, padding = 0) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = w;\r\n    this.height = h;\r\n    this.padding = padding;\r\n    this.bgcolor = '#ffffff';\r\n    // border: [width, style, color]\r\n    this.borderTop = null;\r\n    this.borderRight = null;\r\n    this.borderBottom = null;\r\n    this.borderLeft = null;\r\n  }\r\n\r\n  setBorders({ top, bottom, left, right }) {\r\n    if (top) this.borderTop = top;\r\n    if (right) this.borderRight = right;\r\n    if (bottom) this.borderBottom = bottom;\r\n    if (left) this.borderLeft = left;\r\n  }\r\n\r\n  innerWidth() {\r\n    return this.width - this.padding * 2;\r\n  }\r\n\r\n  innerHeight() {\r\n    return this.height - this.padding * 2;\r\n  }\r\n\r\n  textx(align) {\r\n    const { width, padding } = this;\r\n    let { x } = this;\r\n    if (align === 'left') {\r\n      x += padding;\r\n    } else if (align === 'center') {\r\n      x += width / 2;\r\n    } else if (align === 'right') {\r\n      x += width - padding;\r\n    }\r\n    return x;\r\n  }\r\n\r\n  texty(align, fontSize, hoffset) {\r\n    const { height, padding } = this;\r\n    let { y } = this;\r\n    if (align === 'top') {\r\n      y += padding;\r\n    } else if (align === 'middle') {\r\n      y = y + height / 2 - hoffset;\r\n      // y = y1;\r\n      // const y2 = y + padding + fontSize / 2 + 1;\r\n      // if (y1 < y2) y = y2;\r\n      // else y = y1;\r\n    } else if (align === 'bottom') {\r\n      y += height - hoffset * 2 - padding;\r\n    }\r\n    return y;\r\n  }\r\n\r\n  topxys() {\r\n    const { x, y, width } = this;\r\n    return [\r\n      [x, y],\r\n      [x + width, y]\r\n    ];\r\n  }\r\n\r\n  rightxys() {\r\n    const { x, y, width, height } = this;\r\n    return [\r\n      [x + width, y],\r\n      [x + width, y + height]\r\n    ];\r\n  }\r\n\r\n  bottomxys() {\r\n    const { x, y, width, height } = this;\r\n    return [\r\n      [x, y + height],\r\n      [x + width, y + height]\r\n    ];\r\n  }\r\n\r\n  leftxys() {\r\n    const { x, y, height } = this;\r\n    return [\r\n      [x, y],\r\n      [x, y + height]\r\n    ];\r\n  }\r\n}\r\n\r\nfunction drawFontLine(type, tx, ty, align, valign, blheight, blwidth) {\r\n  const floffset = { x: 0, y: 0 };\r\n  if (type === 'underline') {\r\n    if (valign === 'bottom') {\r\n      floffset.y = 0;\r\n    } else if (valign === 'top') {\r\n      floffset.y = -(blheight + 2);\r\n    } else {\r\n      floffset.y = -blheight / 2;\r\n    }\r\n  } else if (type === 'strike') {\r\n    if (valign === 'bottom') {\r\n      floffset.y = blheight / 2;\r\n    } else if (valign === 'top') {\r\n      floffset.y = -(blheight / 2 + 2);\r\n    }\r\n  }\r\n\r\n  if (align === 'center') {\r\n    floffset.x = blwidth / 2;\r\n  } else if (align === 'right') {\r\n    floffset.x = blwidth;\r\n  }\r\n  this.line(\r\n    [tx - floffset.x, ty - floffset.y],\r\n    [tx - floffset.x + blwidth, ty - floffset.y]\r\n  );\r\n}\r\n\r\nclass Draw {\r\n  constructor(el, width, height) {\r\n    this.el = el;\r\n    this.ctx = el.getContext('2d');\r\n    this.resize(width, height);\r\n    this.ctx.scale(dpr(), dpr());\r\n  }\r\n\r\n  resize(width, height) {\r\n    // console.log('dpr:', dpr);\r\n    this.el.style.width = `${width}px`;\r\n    this.el.style.height = `${height}px`;\r\n    this.el.width = npx(width);\r\n    this.el.height = npx(height);\r\n  }\r\n\r\n  clear() {\r\n    const { width, height } = this.el;\r\n    this.ctx.clearRect(0, 0, width, height);\r\n    return this;\r\n  }\r\n\r\n  attr(options) {\r\n    Object.assign(this.ctx, options);\r\n    return this;\r\n  }\r\n\r\n  save() {\r\n    this.ctx.save();\r\n    this.ctx.beginPath();\r\n    return this;\r\n  }\r\n\r\n  restore() {\r\n    this.ctx.restore();\r\n    return this;\r\n  }\r\n\r\n  beginPath() {\r\n    this.ctx.beginPath();\r\n    return this;\r\n  }\r\n\r\n  translate(x, y) {\r\n    this.ctx.translate(npx(x), npx(y));\r\n    return this;\r\n  }\r\n\r\n  clearRect(x, y, w, h) {\r\n    this.ctx.clearRect(x, y, w, h);\r\n    return this;\r\n  }\r\n\r\n  fillRect(x, y, w, h) {\r\n    this.ctx.fillRect(npx(x) - 0.5, npx(y) - 0.5, npx(w), npx(h));\r\n    return this;\r\n  }\r\n\r\n  fillText(text, x, y) {\r\n    this.ctx.fillText(text, npx(x), npx(y));\r\n    return this;\r\n  }\r\n\r\n  /*\r\n    txt: render text\r\n    box: DrawBox\r\n    attr: {\r\n      align: left | center | right\r\n      valign: top | middle | bottom\r\n      color: '#333333',\r\n      strike: false,\r\n      font: {\r\n        name: 'Arial',\r\n        size: 14,\r\n        bold: false,\r\n        italic: false,\r\n      }\r\n    }\r\n    textWrap: text wrapping\r\n  */\r\n  text(txt, box, attr = {}, textWrap = true) {\r\n    const { ctx } = this;\r\n    const { align, valign, font, color, strike, underline } = attr;\r\n    const tx = box.textx(align);\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    this.attr({\r\n      textAlign: align,\r\n      textBaseline: valign,\r\n      font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(\r\n        font.size\r\n      )}px ${font.name}`,\r\n      fillStyle: color,\r\n      strokeStyle: color\r\n    });\r\n    const txtWidth = ctx.measureText(txt).width;\r\n    let hoffset = 0;\r\n    if (textWrap) {\r\n      const n = Math.ceil(txtWidth / box.innerWidth());\r\n      hoffset = ((n - 1) * font.size) / 2;\r\n    }\r\n    let ty = box.texty(valign, font.size, hoffset);\r\n    // console.log('tx: ', tx, ', ty:', ty);\r\n    if (textWrap && txtWidth > box.innerWidth()) {\r\n      const textLine = { len: 0, start: 0 };\r\n      for (let i = 0; i < txt.length; i += 1) {\r\n        if (textLine.len >= box.innerWidth()) {\r\n          this.fillText(txt.substring(textLine.start, i), tx, ty);\r\n          if (strike) {\r\n            drawFontLine.call(\r\n              this,\r\n              'strike',\r\n              tx,\r\n              ty,\r\n              align,\r\n              valign,\r\n              font.size,\r\n              textLine.len\r\n            );\r\n          }\r\n          if (underline) {\r\n            drawFontLine.call(\r\n              this,\r\n              'underline',\r\n              tx,\r\n              ty,\r\n              align,\r\n              valign,\r\n              font.size,\r\n              textLine.len\r\n            );\r\n          }\r\n          ty += font.size + 2;\r\n          textLine.len = 0;\r\n          textLine.start = i;\r\n        }\r\n        textLine.len += ctx.measureText(txt[i]).width;\r\n      }\r\n      if (textWrap && textLine.len > 0) {\r\n        this.fillText(txt.substring(textLine.start), tx, ty);\r\n        if (strike) {\r\n          drawFontLine.call(\r\n            this,\r\n            'strike',\r\n            tx,\r\n            ty,\r\n            align,\r\n            valign,\r\n            font.size,\r\n            textLine.len\r\n          );\r\n        }\r\n        if (underline) {\r\n          drawFontLine.call(\r\n            this,\r\n            'underline',\r\n            tx,\r\n            ty,\r\n            align,\r\n            valign,\r\n            font.size,\r\n            textLine.len\r\n          );\r\n        }\r\n      }\r\n    } else {\r\n      this.fillText(txt, tx, ty);\r\n      if (strike) {\r\n        drawFontLine.call(\r\n          this,\r\n          'striket',\r\n          tx,\r\n          ty,\r\n          align,\r\n          valign,\r\n          font.size,\r\n          txtWidth\r\n        );\r\n      }\r\n      if (underline) {\r\n        drawFontLine.call(\r\n          this,\r\n          'underline',\r\n          tx,\r\n          ty,\r\n          align,\r\n          valign,\r\n          font.size,\r\n          txtWidth\r\n        );\r\n      }\r\n    }\r\n    ctx.restore();\r\n    return this;\r\n  }\r\n\r\n  border(style, color) {\r\n    const { ctx } = this;\r\n    ctx.lineWidth = thinLineWidth;\r\n    ctx.strokeStyle = color;\r\n    // console.log('style:', style);\r\n    if (style === 'medium') {\r\n      ctx.lineWidth = npx(2) - 0.5;\r\n    } else if (style === 'thick') {\r\n      ctx.lineWidth = npx(3);\r\n    } else if (style === 'dashed') {\r\n      ctx.setLineDash([npx(3), npx(2)]);\r\n    } else if (style === 'dotted') {\r\n      ctx.setLineDash([npx(1), npx(1)]);\r\n    } else if (style === 'double') {\r\n      ctx.setLineDash([npx(2), 0]);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  line(...xys) {\r\n    const { ctx } = this;\r\n    if (xys.length > 1) {\r\n      const [x, y] = xys[0];\r\n      ctx.moveTo(npxLine(x), npxLine(y));\r\n      for (let i = 1; i < xys.length; i += 1) {\r\n        const [x1, y1] = xys[i];\r\n        ctx.lineTo(npxLine(x1), npxLine(y1));\r\n      }\r\n      ctx.stroke();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  strokeBorders(box) {\r\n    const { ctx } = this;\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    // border\r\n    const { borderTop, borderRight, borderBottom, borderLeft } = box;\r\n    if (borderTop) {\r\n      this.border(...borderTop);\r\n      // console.log('box.topxys:', box.topxys());\r\n      this.line(...box.topxys());\r\n    }\r\n    if (borderRight) {\r\n      this.border(...borderRight);\r\n      this.line(...box.rightxys());\r\n    }\r\n    if (borderBottom) {\r\n      this.border(...borderBottom);\r\n      this.line(...box.bottomxys());\r\n    }\r\n    if (borderLeft) {\r\n      this.border(...borderLeft);\r\n      this.line(...box.leftxys());\r\n    }\r\n    ctx.restore();\r\n  }\r\n\r\n  error(box) {\r\n    const { ctx } = this;\r\n    const { x, y, width } = box;\r\n    const sx = x + width - 1;\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.moveTo(npx(sx - 8), npx(y - 1));\r\n    ctx.lineTo(npx(sx), npx(y - 1));\r\n    ctx.lineTo(npx(sx), npx(y + 8));\r\n    ctx.closePath();\r\n    ctx.fillStyle = 'rgba(255, 0, 0, .65)';\r\n    ctx.fill();\r\n    ctx.restore();\r\n  }\r\n\r\n  rect(box, dtextcb) {\r\n    const { ctx } = this;\r\n    const { x, y, width, height, bgcolor } = box;\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.fillStyle = bgcolor || '#fff';\r\n    ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\r\n    ctx.clip();\r\n    ctx.fill();\r\n    dtextcb();\r\n    ctx.restore();\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport { Draw, DrawBox, thinLineWidth, npx };\r\n","import { stringAt } from '../core/alphabet';\r\nimport { getFontSizePxByPt } from '../core/font';\r\nimport _cell from '../core/cell';\r\nimport { formulam } from '../core/formula';\r\nimport { formatm } from '../core/format';\r\n\r\nimport { Draw, DrawBox, thinLineWidth, npx } from '../canvas/draw';\r\n// gobal var\r\nconst cellPaddingWidth = 5;\r\nconst tableFixedHeaderCleanStyle = { fillStyle: '#f4f5f8' };\r\nconst tableGridStyle = {\r\n  fillStyle: '#fff',\r\n  lineWidth: thinLineWidth,\r\n  strokeStyle: '#e6e6e6'\r\n};\r\nfunction tableFixedHeaderStyle() {\r\n  return {\r\n    textAlign: 'center',\r\n    textBaseline: 'middle',\r\n    font: `500 ${npx(12)}px Source Sans Pro`,\r\n    fillStyle: '#585757',\r\n    lineWidth: thinLineWidth(),\r\n    strokeStyle: '#e6e6e6'\r\n  };\r\n}\r\n\r\nfunction getDrawBox(rindex, cindex) {\r\n  const { data } = this;\r\n  const { left, top, width, height } = data.cellRect(rindex, cindex);\r\n  return new DrawBox(left, top, width, height, cellPaddingWidth);\r\n}\r\n\r\nfunction renderCellBorders() {\r\n  const { draw, bboxes } = this;\r\n  if (bboxes) {\r\n    bboxes.forEach((box) => draw.strokeBorders(box));\r\n  }\r\n}\r\n\r\n// 在canvas面板上绘制指定坐标的单元格\r\nfunction renderCell(rindex, cindex) {\r\n  const { draw, data } = this;\r\n  // 从data中获取指定坐标的单元格（配置）对象\r\n  const cell = data.getCell(rindex, cindex);\r\n  if (cell === null) return;\r\n\r\n  // 从data中获取指定坐标单元格的样式（配置）对象\r\n  const style = data.getCellStyleOrDefault(rindex, cindex);\r\n  // console.log('style:', style);\r\n  // 创建指定坐标单元格绘制器，如style中包含边框配置，则设置到绘制器中\r\n  const dbox = getDrawBox.call(this, rindex, cindex);\r\n  dbox.bgcolor = style.bgcolor;\r\n  if (style.border !== undefined) {\r\n    dbox.setBorders(style.border);\r\n    // 集中绘制单元格边框\r\n    this.bboxes.push(dbox);\r\n  }\r\n\r\n  draw.rect(dbox, () => {\r\n    // render text\r\n    let cellText = _cell.render(cell.text || '', formulam, (y, x) =>\r\n      data.getCellTextOrDefault(x, y)\r\n    );\r\n    if (style.format) {\r\n      // console.log(data.formatm, '>>', cell.format);\r\n      cellText = formatm[style.format].render(cellText);\r\n    }\r\n    const font = Object.assign({}, style.font);\r\n    font.size = getFontSizePxByPt(font.size);\r\n    // console.log('style:', style);\r\n    draw.text(\r\n      cellText,\r\n      dbox,\r\n      {\r\n        align: style.align,\r\n        valign: style.valign,\r\n        font,\r\n        color: style.color,\r\n        strike: style.strike,\r\n        underline: style.underline\r\n      },\r\n      style.textwrap\r\n    );\r\n    // error\r\n    const error = data.validations.getError(rindex, cindex);\r\n    if (error) {\r\n      // console.log('error:', rindex, cindex, error);\r\n      draw.error(dbox);\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * 绘制面板可视区域内的所有单元格\r\n * 以为sheet面板可能含有滚动条，所以可视区域并不一定包含了所有有内容的单元格\r\n * @param {*} viewRange\r\n * @param {*} fw\r\n * @param {*} fh\r\n * @param {*} tx\r\n * @param {*} ty\r\n */\r\nfunction renderContent(viewRange, fw, fh, tx, ty) {\r\n  const { draw, data } = this;\r\n  draw.save();\r\n  draw.translate(fw, fh).translate(tx, ty);\r\n\r\n  // 1 render cell 绘制所有单元格box\r\n  this.bboxes = [];\r\n  viewRange.each((ri, ci) => {\r\n    renderCell.call(this, ri, ci);\r\n  });\r\n  // 2 render cell border 集中绘制所有单元格的边框\r\n  renderCellBorders.call(this);\r\n  this.bboxes = [];\r\n  // 3 render mergeCell 重新（覆盖）绘制全部合并单元格区域\r\n  data.eachMergesInView(viewRange, (r) => {\r\n    renderCell.call(this, r.sri, r.sci);\r\n  });\r\n  // 4 render mergeCell border 重新绘制所有合并单元格区域的边框\r\n  renderCellBorders.call(this);\r\n\r\n  draw.restore();\r\n}\r\n\r\nfunction renderSelectedHeaderCell(x, y, w, h) {\r\n  const { draw } = this;\r\n  draw.save();\r\n  draw.attr({ fillStyle: 'rgba(75, 137, 255, 0.08)' }).fillRect(x, y, w, h);\r\n  draw.restore();\r\n}\r\n\r\n// viewRange\r\n// type: all | left | top\r\n// w: the fixed width of header\r\n// h: the fixed height of header\r\n// tx: moving distance on x-axis\r\n// ty: moving distance on y-axis\r\nfunction renderFixedHeaders(type, viewRange, w, h, tx, ty) {\r\n  const { draw, data } = this;\r\n  const sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);\r\n  const sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);\r\n  const nty = ty + h;\r\n  const ntx = tx + w;\r\n\r\n  draw.save();\r\n  // draw rect background\r\n  draw.attr(tableFixedHeaderCleanStyle);\r\n  if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);\r\n  if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);\r\n\r\n  const { sri, sci, eri, eci } = data.selector.range;\r\n  // console.log(data.selectIndexes);\r\n  // draw text\r\n  // text font, align...\r\n  draw.attr(tableFixedHeaderStyle());\r\n  // y-header-text\r\n  if (type === 'all' || type === 'left') {\r\n    data.rowEach(viewRange.sri, viewRange.eri, (i, y1, rowHeight) => {\r\n      const y = nty + y1;\r\n      const ii = i;\r\n      draw.line([0, y], [w, y]);\r\n      if (sri <= ii && ii < eri + 1) {\r\n        renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);\r\n      }\r\n      draw.fillText(ii + 1, w / 2, y + rowHeight / 2);\r\n    });\r\n    draw.line([0, sumHeight + nty], [w, sumHeight + nty]);\r\n    draw.line([w, nty], [w, sumHeight + nty]);\r\n  }\r\n  // x-header-text\r\n  if (type === 'all' || type === 'top') {\r\n    data.colEach(viewRange.sci, viewRange.eci, (i, x1, colWidth) => {\r\n      const x = ntx + x1;\r\n      const ii = i;\r\n      draw.line([x, 0], [x, h]);\r\n      if (sci <= ii && ii < eci + 1) {\r\n        renderSelectedHeaderCell.call(this, x, 0, colWidth, h);\r\n      }\r\n      draw.fillText(stringAt(ii), x + colWidth / 2, h / 2);\r\n    });\r\n    draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);\r\n    draw.line([0, h], [sumWidth + ntx, h]);\r\n  }\r\n  draw.restore();\r\n}\r\n\r\nfunction renderFixedLeftTopCell(fw, fh) {\r\n  const { draw } = this;\r\n  draw.save();\r\n  // left-top-cell\r\n  draw.attr({ fillStyle: '#f4f5f8' }).fillRect(0, 0, fw, fh);\r\n  draw.restore();\r\n}\r\n\r\n// 绘制面板区的网格线\r\nfunction renderContentGrid({ sri, sci, eri, eci, w, h }, fw, fh, tx, ty) {\r\n  const { draw, data } = this;\r\n  const { settings } = data;\r\n\r\n  draw.save();\r\n  draw.attr(tableGridStyle).translate(fw + tx, fh + ty);\r\n  // const sumWidth = cols.sumWidth(sci, eci + 1);\r\n  // const sumHeight = rows.sumHeight(sri, eri + 1);\r\n  // console.log('sumWidth:', sumWidth);\r\n  draw.clearRect(0, 0, w, h);\r\n  if (!settings.showGrid) {\r\n    draw.restore();\r\n    return;\r\n  }\r\n  // console.log('rowStart:', rowStart, ', rowLen:', rowLen);\r\n  data.rowEach(sri, eri, (i, y, ch) => {\r\n    // console.log('y:', y);\r\n    if (i !== sri) draw.line([0, y], [w, y]);\r\n    if (i === eri) draw.line([0, y + ch], [w, y + ch]);\r\n  });\r\n  data.colEach(sci, eci, (i, x, cw) => {\r\n    if (i !== sci) draw.line([x, 0], [x, h]);\r\n    if (i === eci) draw.line([x + cw, 0], [x + cw, h]);\r\n  });\r\n  draw.restore();\r\n}\r\n\r\nfunction renderFreezeHighlightLine(fw, fh, ftw, fth) {\r\n  const { draw, data } = this;\r\n  const twidth = data.viewWidth() - fw;\r\n  const theight = data.viewHeight() - fh;\r\n  draw\r\n    .save()\r\n    .translate(fw, fh)\r\n    .attr({ strokeStyle: 'rgba(75, 137, 255, .6)' });\r\n  draw.line([0, fth], [twidth, fth]);\r\n  draw.line([ftw, 0], [ftw, theight]);\r\n  draw.restore();\r\n}\r\n\r\n/** end */\r\nclass Table {\r\n  constructor(el, data) {\r\n    this.el = el;\r\n    this.draw = new Draw(el, data.viewWidth(), data.viewHeight());\r\n    this.data = data;\r\n  }\r\n\r\n  render() {\r\n    // resize canvas\r\n    const { data } = this;\r\n    const { rows, cols } = data;\r\n    // fixed width of header\r\n    const fw = cols.indexWidth;\r\n    // fixed height of header\r\n    const fh = rows.height;\r\n\r\n    this.draw.resize(data.viewWidth(), data.viewHeight());\r\n    this.clear();\r\n\r\n    const viewRange = data.viewRange();\r\n    // renderAll.call(this, viewRange, data.scroll);\r\n    const tx = data.freezeTotalWidth();\r\n    const ty = data.freezeTotalHeight();\r\n    const { x, y } = data.scroll;\r\n    // 1 先绘制可视区域内的网格线，后绘制可视区域内的所有单元格\r\n    renderContentGrid.call(this, viewRange, fw, fh, tx, ty);\r\n    renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);\r\n    renderContent.call(this, viewRange, fw, fh, -x, -y);\r\n    renderFixedLeftTopCell.call(this, fw, fh);\r\n    const [fri, fci] = data.freeze;\r\n    if (fri > 0 || fci > 0) {\r\n      // 2\r\n      if (fri > 0) {\r\n        const vr = viewRange.clone();\r\n        vr.sri = 0;\r\n        vr.eri = fri - 1;\r\n        vr.h = ty;\r\n        renderContentGrid.call(this, vr, fw, fh, tx, 0);\r\n        renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);\r\n        renderContent.call(this, vr, fw, fh, -x, 0);\r\n      }\r\n      // 3\r\n      if (fci > 0) {\r\n        const vr = viewRange.clone();\r\n        vr.sci = 0;\r\n        vr.eci = fci - 1;\r\n        vr.w = tx;\r\n        renderContentGrid.call(this, vr, fw, fh, 0, ty);\r\n        renderFixedHeaders.call(this, 'left', vr, fw, fh, 0, ty);\r\n        renderContent.call(this, vr, fw, fh, 0, -y);\r\n      }\r\n      // 4\r\n      const freezeViewRange = data.freezeViewRange();\r\n      renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);\r\n      renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);\r\n      renderContent.call(this, freezeViewRange, fw, fh, 0, 0);\r\n      // 5\r\n      renderFreezeHighlightLine.call(this, fw, fh, tx, ty);\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    this.draw.clear();\r\n  }\r\n}\r\n\r\nexport default Table;\r\n","/* global document */\r\nimport { h } from './element';\r\nimport { bind } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default function tooltip(html, target) {\r\n  if (target.classList.contains('active')) {\r\n    return;\r\n  }\r\n  const { left, top, width, height } = target.getBoundingClientRect();\r\n  const el = h('div', `${cssPrefix}-tooltip`)\r\n    .html(html)\r\n    .show();\r\n  document.body.appendChild(el.el);\r\n  const elBox = el.box();\r\n  // console.log('elBox:', elBox);\r\n  el.css('left', `${left + width / 2 - elBox.width / 2}px`).css(\r\n    'top',\r\n    `${top + height + 2}px`\r\n  );\r\n\r\n  bind(target, 'mouseleave', () => {\r\n    if (document.body.contains(el.el)) {\r\n      document.body.removeChild(el.el);\r\n    }\r\n  });\r\n\r\n  bind(target, 'click', () => {\r\n    if (document.body.contains(el.el)) {\r\n      document.body.removeChild(el.el);\r\n    }\r\n  });\r\n}\r\n","import { Element, h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class Dropdown extends Element {\r\n  constructor(title, width, showArrow, placement, ...children) {\r\n    super('div', `${cssPrefix}-dropdown ${placement}`);\r\n    this.title = title;\r\n    this.change = () => {};\r\n    if (typeof title === 'string') {\r\n      this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);\r\n    } else if (showArrow) {\r\n      this.title.addClass('arrow-left');\r\n    }\r\n    this.contentEl = h('div', `${cssPrefix}-dropdown-content`)\r\n      .children(...children)\r\n      .css('width', width)\r\n      .hide();\r\n\r\n    this.headerEl = h('div', `${cssPrefix}-dropdown-header`);\r\n    this.headerEl\r\n      .on('click', () => {\r\n        if (this.contentEl.css('display') !== 'block') {\r\n          this.show();\r\n        } else {\r\n          this.hide();\r\n        }\r\n      })\r\n      .children(\r\n        this.title,\r\n        showArrow\r\n          ? h('div', `${cssPrefix}-icon arrow-right`).child(\r\n              h('div', `${cssPrefix}-icon-img arrow-down`)\r\n            )\r\n          : ''\r\n      );\r\n    this.children(this.headerEl, this.contentEl);\r\n  }\r\n\r\n  setTitle(title) {\r\n    this.title.html(title);\r\n    this.hide();\r\n  }\r\n\r\n  show() {\r\n    const { contentEl } = this;\r\n    contentEl.show();\r\n    this.parent().active();\r\n    bindClickoutside(this.parent(), () => {\r\n      this.hide();\r\n    });\r\n  }\r\n\r\n  hide() {\r\n    this.parent().active(false);\r\n    this.contentEl.hide();\r\n    unbindClickoutside(this.parent());\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport { baseFonts } from '../core/font';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFont extends Dropdown {\r\n  constructor() {\r\n    const nfonts = baseFonts.map((it) =>\r\n      h('div', `${cssPrefix}-item`)\r\n        .on('click', () => {\r\n          this.setTitle(it.title);\r\n          this.change(it);\r\n        })\r\n        .child(it.title)\r\n    );\r\n    super(baseFonts[0].title, '160px', true, 'bottom-left', ...nfonts);\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport { fontSizes } from '../core/font';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFontSize extends Dropdown {\r\n  constructor() {\r\n    const nfontSizes = fontSizes.map((it) =>\r\n      h('div', `${cssPrefix}-item`)\r\n        .on('click', () => {\r\n          this.setTitle(`${it.pt}`);\r\n          this.change(it);\r\n        })\r\n        .child(`${it.pt}`)\r\n    );\r\n    super('10', '60px', true, 'bottom-left', ...nfontSizes);\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport { baseFormats } from '../core/format';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFormat extends Dropdown {\r\n  constructor() {\r\n    let nformats = baseFormats.slice(0);\r\n    nformats.splice(2, 0, { key: 'divider' });\r\n    nformats.splice(7, 0, { key: 'divider' });\r\n    nformats = nformats.map((it) => {\r\n      const item = h('div', `${cssPrefix}-item`);\r\n      if (it.key === 'divider') {\r\n        item.addClass('divider');\r\n      } else {\r\n        item.child(it.title()).on('click', () => {\r\n          this.setTitle(it.title());\r\n          this.change(it);\r\n        });\r\n        if (it.label) item.child(h('div', 'label').html(it.label));\r\n      }\r\n      return item;\r\n    });\r\n    super('Normal', '220px', true, 'bottom-left', ...nformats);\r\n  }\r\n\r\n  setTitle(key) {\r\n    for (let i = 0; i < baseFormats.length; i += 1) {\r\n      if (baseFormats[i].key === key) {\r\n        this.title.html(baseFormats[i].title);\r\n      }\r\n    }\r\n    this.hide();\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport Icon from './icon';\r\nimport { h } from './element';\r\nimport { baseFormulas } from '../core/formula';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class DropdownFormula extends Dropdown {\r\n  constructor() {\r\n    const nformulas = baseFormulas.map((it) =>\r\n      h('div', `${cssPrefix}-item`)\r\n        .on('click', () => {\r\n          this.hide();\r\n          this.change(it);\r\n        })\r\n        .child(it.key)\r\n    );\r\n    super(new Icon('formula'), '180px', true, 'bottom-left', ...nformulas);\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nconst themeColorPlaceHolders = [\r\n  '#ffffff',\r\n  '#000100',\r\n  '#e7e5e6',\r\n  '#445569',\r\n  '#5b9cd6',\r\n  '#ed7d31',\r\n  '#a5a5a5',\r\n  '#ffc001',\r\n  '#4371c6',\r\n  '#71ae47'\r\n];\r\n\r\nconst themeColors = [\r\n  [\r\n    '#f2f2f2',\r\n    '#7f7f7f',\r\n    '#d0cecf',\r\n    '#d5dce4',\r\n    '#deeaf6',\r\n    '#fce5d5',\r\n    '#ededed',\r\n    '#fff2cd',\r\n    '#d9e2f3',\r\n    '#e3efd9'\r\n  ],\r\n  [\r\n    '#d8d8d8',\r\n    '#595959',\r\n    '#afabac',\r\n    '#adb8ca',\r\n    '#bdd7ee',\r\n    '#f7ccac',\r\n    '#dbdbdb',\r\n    '#ffe59a',\r\n    '#b3c6e7',\r\n    '#c5e0b3'\r\n  ],\r\n  [\r\n    '#bfbfbf',\r\n    '#3f3f3f',\r\n    '#756f6f',\r\n    '#8596b0',\r\n    '#9cc2e6',\r\n    '#f4b184',\r\n    '#c9c9c9',\r\n    '#fed964',\r\n    '#8eaada',\r\n    '#a7d08c'\r\n  ],\r\n  [\r\n    '#a5a5a5',\r\n    '#262626',\r\n    '#3a3839',\r\n    '#333f4f',\r\n    '#2e75b5',\r\n    '#c45a10',\r\n    '#7b7b7b',\r\n    '#bf8e01',\r\n    '#2f5596',\r\n    '#538136'\r\n  ],\r\n  [\r\n    '#7f7f7f',\r\n    '#0c0c0c',\r\n    '#171516',\r\n    '#222a35',\r\n    '#1f4e7a',\r\n    '#843c0a',\r\n    '#525252',\r\n    '#7e6000',\r\n    '#203864',\r\n    '#365624'\r\n  ]\r\n];\r\n\r\nconst standardColors = [\r\n  '#c00000',\r\n  '#fe0000',\r\n  '#fdc101',\r\n  '#ffff01',\r\n  '#93d051',\r\n  '#00b04e',\r\n  '#01b0f1',\r\n  '#0170c1',\r\n  '#012060',\r\n  '#7030a0'\r\n];\r\n\r\nfunction buildTd(bgcolor) {\r\n  return h('td', '').child(\r\n    h('div', `${cssPrefix}-color-palette-cell`)\r\n      .on('click.stop', () => this.change(bgcolor))\r\n      .css('background-color', bgcolor)\r\n  );\r\n}\r\n\r\nexport default class ColorPalette {\r\n  constructor() {\r\n    this.el = h('div', `${cssPrefix}-color-palette`);\r\n    this.change = () => {};\r\n    const table = h('table', '').children(\r\n      h('tbody', '').children(\r\n        h('tr', `${cssPrefix}-theme-color-placeholders`).children(\r\n          ...themeColorPlaceHolders.map((color) => buildTd.call(this, color))\r\n        ),\r\n        ...themeColors.map((it) =>\r\n          h('tr', `${cssPrefix}-theme-colors`).children(\r\n            ...it.map((color) => buildTd.call(this, color))\r\n          )\r\n        ),\r\n        h('tr', `${cssPrefix}-standard-colors`).children(\r\n          ...standardColors.map((color) => buildTd.call(this, color))\r\n        )\r\n      )\r\n    );\r\n    this.el.child(table);\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport Icon from './icon';\r\nimport ColorPalette from './color_palette';\r\n\r\nexport default class DropdownColor extends Dropdown {\r\n  constructor(iconName, color) {\r\n    const icon = new Icon(iconName)\r\n      .css('height', '16px')\r\n      .css('border-bottom', `3px solid ${color}`);\r\n    const colorPalette = new ColorPalette();\r\n    colorPalette.change = (v) => {\r\n      this.setTitle(v);\r\n      this.change(v);\r\n    };\r\n    super(icon, 'auto', false, 'bottom-left', colorPalette.el);\r\n  }\r\n\r\n  setTitle(color) {\r\n    this.title.css('border-color', color);\r\n    this.hide();\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\n\r\nfunction buildItemWithIcon(iconName) {\r\n  return h('div', `${cssPrefix}-item`).child(new Icon(iconName));\r\n}\r\n\r\nexport default class DropdownAlign extends Dropdown {\r\n  constructor(aligns, align) {\r\n    const icon = new Icon(`align-${align}`);\r\n    const naligns = aligns.map((it) =>\r\n      buildItemWithIcon(`align-${it}`).on('click', () => {\r\n        this.setTitle(it);\r\n        this.change(it);\r\n      })\r\n    );\r\n    super(icon, 'auto', true, 'bottom-left', ...naligns);\r\n  }\r\n\r\n  setTitle(align) {\r\n    this.title.setName(`align-${align}`);\r\n    this.hide();\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\n\r\nconst lineTypes = [\r\n  [\r\n    'thin',\r\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'\r\n  ],\r\n  [\r\n    'medium',\r\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"2\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.0\" x2=\"50\" y2=\"1.0\" stroke-width=\"2\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'\r\n  ],\r\n  [\r\n    'thick',\r\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.5\" x2=\"50\" y2=\"1.5\" stroke-width=\"3\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'\r\n  ],\r\n  [\r\n    'dashed',\r\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"2\" style=\"user-select: none;\"></line></svg>'\r\n  ],\r\n  [\r\n    'dotted',\r\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"1\" style=\"user-select: none;\"></line></svg>'\r\n  ]\r\n  // ['double', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line><line x1=\"0\" y1=\"2.5\" x2=\"50\" y2=\"2.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\r\n];\r\n\r\nexport default class DropdownLineType extends Dropdown {\r\n  constructor(type) {\r\n    const icon = new Icon('line-type');\r\n    let beforei = 0;\r\n    const lineTypeEls = lineTypes.map((it, iti) =>\r\n      h('div', `${cssPrefix}-item state ${type === it[0] ? 'checked' : ''}`)\r\n        .on('click', () => {\r\n          lineTypeEls[beforei].toggle('checked');\r\n          lineTypeEls[iti].toggle('checked');\r\n          beforei = iti;\r\n          this.hide();\r\n          this.change(it);\r\n        })\r\n        .child(h('div', `${cssPrefix}-line-type`).html(it[1]))\r\n    );\r\n\r\n    super(icon, 'auto', false, 'bottom-left', ...lineTypeEls);\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport Icon from './icon';\r\nimport DropdownColor from './dropdown_color';\r\nimport DropdownLineType from './dropdown_linetype';\r\nimport { cssPrefix } from '../config';\r\n\r\nfunction buildTable(...trs) {\r\n  return h('table', '').child(h('tbody', '').children(...trs));\r\n}\r\n\r\nfunction buildTd(iconName) {\r\n  return h('td', '').child(\r\n    h('div', `${cssPrefix}-border-palette-cell`)\r\n      .child(new Icon(`border-${iconName}`))\r\n      .on('click', () => {\r\n        this.mode = iconName;\r\n        const { mode, style, color } = this;\r\n        this.change({ mode, style, color });\r\n      })\r\n  );\r\n}\r\n\r\nexport default class BorderPalette {\r\n  constructor() {\r\n    this.color = '#000';\r\n    this.style = 'thin';\r\n    this.mode = 'all';\r\n    this.change = () => {};\r\n    this.ddColor = new DropdownColor('line-color', this.color);\r\n    this.ddColor.change = (color) => {\r\n      this.color = color;\r\n    };\r\n    this.ddType = new DropdownLineType(this.style);\r\n    this.ddType.change = ([s]) => {\r\n      this.style = s;\r\n    };\r\n    this.el = h('div', `${cssPrefix}-border-palette`);\r\n    const table = buildTable(\r\n      h('tr', '').children(\r\n        h('td', `${cssPrefix}-border-palette-left`).child(\r\n          buildTable(\r\n            h('tr', '').children(\r\n              ...[\r\n                'all',\r\n                'inside',\r\n                'horizontal',\r\n                'vertical',\r\n                'outside'\r\n              ].map((it) => buildTd.call(this, it))\r\n            ),\r\n            h('tr', '').children(\r\n              ...['left', 'top', 'right', 'bottom', 'none'].map((it) =>\r\n                buildTd.call(this, it)\r\n              )\r\n            )\r\n          )\r\n        ),\r\n        h('td', `${cssPrefix}-border-palette-right`).children(\r\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddColor.el),\r\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddType.el)\r\n        )\r\n      )\r\n    );\r\n    this.el.child(table);\r\n  }\r\n}\r\n","import Dropdown from './dropdown';\r\nimport Icon from './icon';\r\nimport BorderPalette from './border_palette';\r\n\r\nexport default class DropdownBorder extends Dropdown {\r\n  constructor() {\r\n    const icon = new Icon('border-all');\r\n    const borderPalette = new BorderPalette();\r\n    borderPalette.change = (v) => {\r\n      this.change(v);\r\n      this.hide();\r\n    };\r\n    super(icon, 'auto', false, 'bottom-left', borderPalette.el);\r\n  }\r\n}\r\n","/* global window */\r\nimport { h } from './element';\r\nimport { bind } from './event';\r\nimport tooltip from './tooltip';\r\nimport DropdownFont from './dropdown_font';\r\nimport DropdownFontSize from './dropdown_fontsize';\r\nimport DropdownFormat from './dropdown_format';\r\nimport DropdownFormula from './dropdown_formula';\r\nimport DropdownColor from './dropdown_color';\r\nimport DropdownAlign from './dropdown_align';\r\nimport DropdownBorder from './dropdown_border';\r\nimport Dropdown from './dropdown';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\nimport { t } from '../locale/locale';\r\n\r\nfunction buildIcon(name) {\r\n  return new Icon(name);\r\n}\r\n\r\nfunction buildButton(tooltipdata) {\r\n  return h('div', `${cssPrefix}-toolbar-btn`)\r\n    .on('mouseenter', (evt) => {\r\n      tooltip(tooltipdata, evt.target);\r\n    })\r\n    .attr('data-tooltip', tooltipdata);\r\n}\r\n\r\nfunction buildDivider() {\r\n  return h('div', `${cssPrefix}-toolbar-divider`);\r\n}\r\n\r\nfunction buildButtonWithIcon(tooltipdata, iconName, change = () => {}) {\r\n  return buildButton(tooltipdata)\r\n    .child(buildIcon(iconName))\r\n    .on('click', () => change());\r\n}\r\n\r\nfunction bindDropdownChange() {\r\n  this.ddFormat.change = (it) => this.change('format', it.key);\r\n  this.ddFont.change = (it) => this.change('font-name', it.key);\r\n  this.ddFormula.change = (it) => this.change('formula', it.key);\r\n  this.ddFontSize.change = (it) => this.change('font-size', it.pt);\r\n  this.ddTextColor.change = (it) => this.change('color', it);\r\n  this.ddFillColor.change = (it) => this.change('bgcolor', it);\r\n  this.ddAlign.change = (it) => this.change('align', it);\r\n  this.ddVAlign.change = (it) => this.change('valign', it);\r\n  this.ddBorder.change = (it) => this.change('border', it);\r\n}\r\n\r\nfunction toggleChange(type) {\r\n  let elName = type;\r\n  const types = type.split('-');\r\n  if (types.length > 1) {\r\n    types.forEach((it, i) => {\r\n      if (i === 0) elName = it;\r\n      else elName += it[0].toUpperCase() + it.substring(1);\r\n    });\r\n  }\r\n  const el = this[`${elName}El`];\r\n  el.toggle();\r\n  this.change(type, el.hasClass('active'));\r\n}\r\n\r\nclass DropdownMore extends Dropdown {\r\n  constructor() {\r\n    const icon = new Icon('ellipsis');\r\n    const moreBtns = h('div', `${cssPrefix}-toolbar-more`);\r\n    super(icon, 'auto', false, 'bottom-right', moreBtns);\r\n    this.moreBtns = moreBtns;\r\n    this.contentEl.css('max-width', '420px');\r\n  }\r\n}\r\n\r\nfunction initBtns2() {\r\n  this.btns2 = this.btnChildren.map((it) => {\r\n    const rect = it.box();\r\n    const { marginLeft, marginRight } = it.computedStyle();\r\n    return [\r\n      it,\r\n      rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)\r\n    ];\r\n  });\r\n}\r\n\r\nfunction moreResize() {\r\n  const { el, btns, moreEl, ddMore, btns2 } = this;\r\n  const { moreBtns, contentEl } = ddMore;\r\n  el.css('width', `${this.widthFn() - 60}px`);\r\n  const elBox = el.box();\r\n\r\n  let sumWidth = 160;\r\n  let sumWidth2 = 12;\r\n  const list1 = [];\r\n  const list2 = [];\r\n  btns2.forEach(([it, w], index) => {\r\n    sumWidth += w;\r\n    if (index === btns2.length - 1 || sumWidth < elBox.width) {\r\n      list1.push(it);\r\n    } else {\r\n      sumWidth2 += w;\r\n      list2.push(it);\r\n    }\r\n  });\r\n  btns.html('').children(...list1);\r\n  moreBtns.html('').children(...list2);\r\n  contentEl.css('width', `${sumWidth2}px`);\r\n  if (list2.length > 0) {\r\n    moreEl.show();\r\n  } else {\r\n    moreEl.hide();\r\n  }\r\n}\r\n\r\nexport default class Toolbar {\r\n  constructor(data, widthFn, isHide = false) {\r\n    this.data = data;\r\n    this.change = () => {};\r\n    this.widthFn = widthFn;\r\n    const style = data.defaultStyle();\r\n    // console.log('data:', data);\r\n    this.ddFormat = new DropdownFormat();\r\n    this.ddFont = new DropdownFont();\r\n    this.ddFormula = new DropdownFormula();\r\n    this.ddFontSize = new DropdownFontSize();\r\n    this.ddTextColor = new DropdownColor('text-color', style.color);\r\n    this.ddFillColor = new DropdownColor('fill-color', style.bgcolor);\r\n    this.ddAlign = new DropdownAlign(['left', 'center', 'right'], style.align);\r\n    this.ddVAlign = new DropdownAlign(\r\n      ['top', 'middle', 'bottom'],\r\n      style.valign\r\n    );\r\n    this.ddBorder = new DropdownBorder();\r\n    this.ddMore = new DropdownMore();\r\n    this.btnChildren = [\r\n      (this.undoEl = buildButtonWithIcon(\r\n        `${t('toolbar.undo')} (Ctrl+Z)`,\r\n        'undo',\r\n        () => this.change('undo')\r\n      )),\r\n      (this.redoEl = buildButtonWithIcon(\r\n        `${t('toolbar.undo')} (Ctrl+Y)`,\r\n        'redo',\r\n        () => this.change('redo')\r\n      )),\r\n      // this.printEl = buildButtonWithIcon('Print (Ctrl+P)', 'print', () => this.change('print')),\r\n      (this.paintformatEl = buildButtonWithIcon(\r\n        `${t('toolbar.paintformat')}`,\r\n        'paintformat',\r\n        () => toggleChange.call(this, 'paintformat')\r\n      )),\r\n      (this.clearformatEl = buildButtonWithIcon(\r\n        `${t('toolbar.clearformat')}`,\r\n        'clearformat',\r\n        () => this.change('clearformat')\r\n      )),\r\n      buildDivider(),\r\n      buildButton(`${t('toolbar.format')}`).child(this.ddFormat.el),\r\n      buildDivider(),\r\n      buildButton(`${t('toolbar.font')}`).child(this.ddFont.el),\r\n      buildButton(`${t('toolbar.fontSize')}`).child(this.ddFontSize.el),\r\n      buildDivider(),\r\n      (this.fontBoldEl = buildButtonWithIcon(\r\n        `${t('toolbar.fontBold')} (Ctrl+B)`,\r\n        'bold',\r\n        () => toggleChange.call(this, 'font-bold')\r\n      )),\r\n      (this.fontItalicEl = buildButtonWithIcon(\r\n        `${t('toolbar.fontItalic')} (Ctrl+I)`,\r\n        'italic',\r\n        () => toggleChange.call(this, 'font-italic')\r\n      )),\r\n      (this.underlineEl = buildButtonWithIcon(\r\n        `${t('toolbar.underline')} (Ctrl+U)`,\r\n        'underline',\r\n        () => toggleChange.call(this, 'underline')\r\n      )),\r\n      (this.strikeEl = buildButtonWithIcon(\r\n        `${t('toolbar.strike')}`,\r\n        'strike',\r\n        () => toggleChange.call(this, 'strike')\r\n      )),\r\n      buildButton(`${t('toolbar.textColor')}`).child(this.ddTextColor.el),\r\n      buildDivider(),\r\n      buildButton(`${t('toolbar.fillColor')}`).child(this.ddFillColor.el),\r\n      buildButton(`${t('toolbar.border')}`).child(this.ddBorder.el),\r\n      (this.mergeEl = buildButtonWithIcon(\r\n        `${t('toolbar.merge')}`,\r\n        'merge',\r\n        () => toggleChange.call(this, 'merge')\r\n      )),\r\n      buildDivider(),\r\n      buildButton(`${t('toolbar.align')}`).child(this.ddAlign.el),\r\n      buildButton(`${t('toolbar.valign')}`).child(this.ddVAlign.el),\r\n      (this.textwrapEl = buildButtonWithIcon(\r\n        `${t('toolbar.textwrap')}`,\r\n        'textwrap',\r\n        () => toggleChange.call(this, 'textwrap')\r\n      )),\r\n      buildDivider(),\r\n      // this.linkEl = buildButtonWithIcon('Insert link', 'link'),\r\n      // this.chartEl = buildButtonWithIcon('Insert chart', 'chart'),\r\n      // this.autofilterEl = buildButtonWithIcon('Filter', 'autofilter'),\r\n      // this.freezeEl = buildButtonWithIcon(`${t('toolbar.freeze')}`, 'freeze', () => toggleChange.call(this, 'freeze')),\r\n      buildButton(`${t('toolbar.formula')}`).child(this.ddFormula.el),\r\n      // buildDivider(),\r\n      (this.moreEl = buildButton(`${t('toolbar.more')}`)\r\n        .child(this.ddMore.el)\r\n        .hide())\r\n    ];\r\n    this.el = h('div', `${cssPrefix}-toolbar`);\r\n    this.btns = h('div', `${cssPrefix}-toolbar-btns`).children(\r\n      ...this.btnChildren\r\n    );\r\n    this.el.child(this.btns);\r\n    if (isHide) this.el.hide();\r\n    bindDropdownChange.call(this);\r\n    this.reset();\r\n    setTimeout(() => {\r\n      initBtns2.call(this);\r\n      moreResize.call(this);\r\n    }, 0);\r\n    bind(window, 'resize', () => {\r\n      moreResize.call(this);\r\n    });\r\n  }\r\n\r\n  paintformatActive() {\r\n    return this.paintformatEl.hasClass('active');\r\n  }\r\n\r\n  paintformatToggle() {\r\n    this.paintformatEl.toggle();\r\n  }\r\n\r\n  trigger(type) {\r\n    toggleChange.call(this, type);\r\n  }\r\n\r\n  reset() {\r\n    const { data } = this;\r\n    const style = data.getSelectedCellStyle();\r\n    const cell = data.getSelectedCell();\r\n    // console.log('canUndo:', data.canUndo());\r\n    this.undoEl.disabled(!data.canUndo());\r\n    this.redoEl.disabled(!data.canRedo());\r\n    this.mergeEl.active(data.canUnmerge()).disabled(!data.selector.multiple());\r\n    // this.mergeEl.disabled();\r\n    // console.log('selectedCell:', style, cell);\r\n    const { font } = style;\r\n    this.ddFont.setTitle(font.name);\r\n    this.ddFontSize.setTitle(font.size);\r\n    this.fontBoldEl.active(font.bold);\r\n    this.fontItalicEl.active(font.italic);\r\n    this.underlineEl.active(style.underline);\r\n    this.strikeEl.active(style.strike);\r\n    this.ddTextColor.setTitle(style.color);\r\n    this.ddFillColor.setTitle(style.bgcolor);\r\n    this.ddAlign.setTitle(style.align);\r\n    this.ddVAlign.setTitle(style.valign);\r\n    this.textwrapEl.active(style.textwrap);\r\n    // console.log('freeze is Active:', data.freezeIsActive());\r\n    // this.freezeEl.active(data.freezeIsActive());\r\n    if (cell) {\r\n      if (cell.format) {\r\n        this.ddFormat.setTitle(cell.format);\r\n      }\r\n    }\r\n  }\r\n}\r\n","/* global document */\r\n/* global window */\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\nimport { bind, unbind } from './event';\r\n\r\nexport default class Modal {\r\n  constructor(title, content, width = '600px') {\r\n    this.title = title;\r\n    this.el = h('div', `${cssPrefix}-modal`)\r\n      .css('width', width)\r\n      .children(\r\n        h('div', `${cssPrefix}-modal-header`).children(\r\n          new Icon('close').on('click.stop', () => this.hide()),\r\n          this.title\r\n        ),\r\n        h('div', `${cssPrefix}-modal-content`).children(...content)\r\n      )\r\n      .hide();\r\n  }\r\n\r\n  show() {\r\n    // dimmer\r\n    this.dimmer = h('div', `${cssPrefix}-dimmer active`);\r\n    document.body.appendChild(this.dimmer.el);\r\n    const { width, height } = this.el.show().box();\r\n    const { clientHeight, clientWidth } = document.documentElement;\r\n    this.el.offset({\r\n      left: (clientWidth - width) / 2,\r\n      top: (clientHeight - height) / 3\r\n    });\r\n    window.xkeydownEsc = (evt) => {\r\n      if (evt.keyCode === 27) {\r\n        this.hide();\r\n      }\r\n    };\r\n    bind(window, 'keydown', window.xkeydownEsc);\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n    document.body.removeChild(this.dimmer.el);\r\n    unbind(window, 'keydown', window.xkeydownEsc);\r\n    delete window.xkeydownEsc;\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class FormInput {\r\n  constructor(width, hint) {\r\n    this.vchange = () => {};\r\n    this.el = h('div', `${cssPrefix}-form-input`);\r\n    this.input = h('input', '')\r\n      .css('width', width)\r\n      .on('input', (evt) => this.vchange(evt))\r\n      .attr('placeholder', hint);\r\n    this.el.child(this.input);\r\n  }\r\n\r\n  hint(v) {\r\n    this.input.attr('placeholder', v);\r\n  }\r\n\r\n  val(v) {\r\n    return this.input.val(v);\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport Suggest from './suggest';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport default class FormSelect {\r\n  constructor(key, items, width, getTitle = (it) => it, change = () => {}) {\r\n    this.key = key;\r\n    this.getTitle = getTitle;\r\n    this.vchange = () => {};\r\n    this.el = h('div', `${cssPrefix}-form-select`);\r\n    this.suggest = new Suggest(\r\n      items.map((it) => ({ key: it, title: this.getTitle(it) })),\r\n      (it) => {\r\n        this.itemClick(it.key);\r\n        change(it.key);\r\n        this.vchange(it.key);\r\n      },\r\n      width,\r\n      this.el\r\n    );\r\n    this.el\r\n      .children(\r\n        (this.itemEl = h('div', 'input-text').html(this.getTitle(key))),\r\n        this.suggest.el\r\n      )\r\n      .on('click', () => this.show());\r\n  }\r\n\r\n  show() {\r\n    this.suggest.search('');\r\n  }\r\n\r\n  itemClick(it) {\r\n    this.key = it;\r\n    this.itemEl.html(this.getTitle(it));\r\n  }\r\n\r\n  val(v) {\r\n    if (v !== undefined) {\r\n      this.key = v;\r\n      this.itemEl.html(this.getTitle(v));\r\n      return this;\r\n    }\r\n    return this.key;\r\n  }\r\n}\r\n","import { h } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport { t } from '../locale/locale';\r\n\r\nconst patterns = {\r\n  number: /(^\\d+$)|(^\\d+(\\.\\d{0,4})?$)/,\r\n  date: /^\\d{4}-\\d{1,2}-\\d{1,2}$/\r\n};\r\n\r\n// rule: { required: false, type, pattern: // }\r\nexport default class FormField {\r\n  constructor(input, rule, label, labelWidth) {\r\n    this.label = '';\r\n    this.rule = rule;\r\n    if (label) {\r\n      this.label = h('label', 'label')\r\n        .css('width', `${labelWidth}px`)\r\n        .html(label);\r\n    }\r\n    this.tip = h('div', 'tip')\r\n      .child('tip')\r\n      .hide();\r\n    this.input = input;\r\n    this.input.vchange = () => this.validate();\r\n    this.el = h('div', `${cssPrefix}-form-field`).children(\r\n      this.label,\r\n      input.el,\r\n      this.tip\r\n    );\r\n  }\r\n\r\n  isShow() {\r\n    return this.el.css('display') !== 'none';\r\n  }\r\n\r\n  show() {\r\n    this.el.show();\r\n  }\r\n\r\n  hide() {\r\n    this.el.hide();\r\n    return this;\r\n  }\r\n\r\n  val(v) {\r\n    return this.input.val(v);\r\n  }\r\n\r\n  hint(hint) {\r\n    this.input.hint(hint);\r\n  }\r\n\r\n  validate() {\r\n    const { input, rule, tip, el } = this;\r\n    const v = input.val();\r\n    if (rule.required) {\r\n      if (/^\\s*$/.test(v)) {\r\n        tip.html(t('validation.required'));\r\n        el.addClass('error');\r\n        return false;\r\n      }\r\n    }\r\n    if (rule.type || rule.pattern) {\r\n      const pattern = rule.pattern || patterns[rule.type];\r\n      if (!pattern.test(v)) {\r\n        tip.html(t('validation.notMatch'));\r\n        el.addClass('error');\r\n        return false;\r\n      }\r\n    }\r\n    el.removeClass('error');\r\n    return true;\r\n  }\r\n}\r\n","import { Element } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport { t } from '../locale/locale';\r\n\r\nexport default class Button extends Element {\r\n  // type: primary\r\n  constructor(title, type = '') {\r\n    super('div', `${cssPrefix}-button ${type}`);\r\n    this.child(t(`button.${title}`));\r\n  }\r\n}\r\n","import Modal from './modal';\r\nimport FormInput from './form_input';\r\nimport FormSelect from './form_select';\r\nimport FormField from './form_field';\r\nimport Button from './button';\r\nimport { t } from '../locale/locale';\r\nimport { h } from './element';\r\nimport { cssPrefix } from '../config';\r\n\r\nconst fieldLabelWidth = 100;\r\n\r\nexport default class ModalValidation extends Modal {\r\n  constructor() {\r\n    const mf = new FormField(\r\n      new FormSelect(\r\n        'cell',\r\n        ['cell'], // cell|row|column\r\n        '100%',\r\n        (it) => t(`dataValidation.modeType.${it}`)\r\n      ),\r\n      { required: true },\r\n      `${t('dataValidation.range')}:`,\r\n      fieldLabelWidth\r\n    );\r\n    const rf = new FormField(new FormInput('120px', 'E3 or E3:F12'), {\r\n      required: true,\r\n      pattern: /^([A-Z]{1,2}[1-9]\\d*)(:[A-Z]{1,2}[1-9]\\d*)?$/\r\n    });\r\n    const cf = new FormField(\r\n      new FormSelect(\r\n        'list',\r\n        ['list', 'number', 'date', 'phone', 'email'],\r\n        '100%',\r\n        (it) => t(`dataValidation.type.${it}`),\r\n        (it) => this.criteriaSelected(it)\r\n      ),\r\n      { required: true },\r\n      `${t('dataValidation.criteria')}:`,\r\n      fieldLabelWidth\r\n    );\r\n\r\n    // operator\r\n    const of = new FormField(\r\n      new FormSelect(\r\n        'be',\r\n        ['be', 'nbe', 'eq', 'neq', 'lt', 'lte', 'gt', 'gte'],\r\n        '160px',\r\n        (it) => t(`dataValidation.operator.${it}`),\r\n        (it) => this.criteriaOperatorSelected(it)\r\n      ),\r\n      { required: true }\r\n    ).hide();\r\n    // min, max\r\n    const minvf = new FormField(new FormInput('70px', '10'), {\r\n      required: true\r\n    }).hide();\r\n    const maxvf = new FormField(new FormInput('70px', '100'), {\r\n      required: true,\r\n      type: 'number'\r\n    }).hide();\r\n    // value\r\n    const svf = new FormField(new FormInput('120px', 'a,b,c'), {\r\n      required: true\r\n    });\r\n    const vf = new FormField(new FormInput('70px', '10'), {\r\n      required: true,\r\n      type: 'number'\r\n    }).hide();\r\n\r\n    super(t('contextmenu.validation'), [\r\n      h('div', `${cssPrefix}-form-fields`).children(mf.el, rf.el),\r\n      h('div', `${cssPrefix}-form-fields`).children(\r\n        cf.el,\r\n        of.el,\r\n        minvf.el,\r\n        maxvf.el,\r\n        vf.el,\r\n        svf.el\r\n      ),\r\n      h('div', `${cssPrefix}-buttons`).children(\r\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\r\n        new Button('remove').on('click', () => this.btnClick('remove')),\r\n        new Button('save', 'primary').on('click', () => this.btnClick('save'))\r\n      )\r\n    ]);\r\n    this.mf = mf;\r\n    this.rf = rf;\r\n    this.cf = cf;\r\n    this.of = of;\r\n    this.minvf = minvf;\r\n    this.maxvf = maxvf;\r\n    this.vf = vf;\r\n    this.svf = svf;\r\n    this.change = () => {};\r\n  }\r\n\r\n  showVf(it) {\r\n    const hint = it === 'date' ? '2018-11-12' : '10';\r\n    const { vf } = this;\r\n    vf.input.hint(hint);\r\n    vf.show();\r\n  }\r\n\r\n  criteriaSelected(it) {\r\n    const { of, minvf, maxvf, vf, svf } = this;\r\n    if (it === 'date' || it === 'number') {\r\n      of.show();\r\n      minvf.rule.type = it;\r\n      maxvf.rule.type = it;\r\n      if (it === 'date') {\r\n        minvf.hint('2018-11-12');\r\n        maxvf.hint('2019-11-12');\r\n      } else {\r\n        minvf.hint('10');\r\n        maxvf.hint('100');\r\n      }\r\n      minvf.show();\r\n      maxvf.show();\r\n      vf.hide();\r\n      svf.hide();\r\n    } else {\r\n      if (it === 'list') {\r\n        svf.show();\r\n      } else {\r\n        svf.hide();\r\n      }\r\n      vf.hide();\r\n      of.hide();\r\n      minvf.hide();\r\n      maxvf.hide();\r\n    }\r\n  }\r\n\r\n  criteriaOperatorSelected(it) {\r\n    if (!it) return;\r\n    const { minvf, maxvf, vf } = this;\r\n    if (it === 'be' || it === 'nbe') {\r\n      minvf.show();\r\n      maxvf.show();\r\n      vf.hide();\r\n    } else {\r\n      const type = this.cf.val();\r\n      vf.rule.type = type;\r\n      if (type === 'date') {\r\n        vf.hint('2018-11-12');\r\n      } else {\r\n        vf.hint('10');\r\n      }\r\n      vf.show();\r\n      minvf.hide();\r\n      maxvf.hide();\r\n    }\r\n  }\r\n\r\n  btnClick(action) {\r\n    if (action === 'cancel') {\r\n      this.hide();\r\n    } else if (action === 'remove') {\r\n      this.change('remove');\r\n      this.hide();\r\n    } else if (action === 'save') {\r\n      // validate\r\n      const attrs = ['mf', 'rf', 'cf', 'of', 'svf', 'vf', 'minvf', 'maxvf'];\r\n      for (let i = 0; i < attrs.length; i += 1) {\r\n        const field = this[attrs[i]];\r\n        // console.log('field:', field);\r\n        if (field.isShow()) {\r\n          // console.log('it:', it);\r\n          if (!field.validate()) return;\r\n        }\r\n      }\r\n\r\n      const mode = this.mf.val();\r\n      const ref = this.rf.val();\r\n      const type = this.cf.val();\r\n      const operator = this.of.val();\r\n      let value = this.svf.val();\r\n      if (type === 'number' || type === 'date') {\r\n        if (operator === 'be' || operator === 'nbe') {\r\n          value = [this.minvf.val(), this.maxvf.val()];\r\n        } else {\r\n          value = this.vf.val();\r\n        }\r\n      }\r\n      // console.log(mode, ref, type, operator, value);\r\n      this.change('save', mode, ref, {\r\n        type,\r\n        operator,\r\n        required: false,\r\n        value\r\n      });\r\n      this.hide();\r\n    }\r\n  }\r\n\r\n  // validation: { mode, ref, validator }\r\n  setValue(v) {\r\n    if (v) {\r\n      const { mf, rf, cf, of, svf, vf, minvf, maxvf } = this;\r\n      const { mode, ref, validator } = v;\r\n      const { type, operator, value } = validator || { type: 'list' };\r\n      mf.val(mode || 'cell');\r\n      rf.val(ref);\r\n      cf.val(type);\r\n      of.val(operator);\r\n      if (Array.isArray(value)) {\r\n        minvf.val(value[0]);\r\n        maxvf.val(value[1]);\r\n      } else {\r\n        svf.val(value || '');\r\n        vf.val(value || '');\r\n      }\r\n      this.criteriaSelected(type);\r\n      this.criteriaOperatorSelected(operator);\r\n    }\r\n    this.show();\r\n  }\r\n}\r\n","/* global document */\r\nimport { h } from './element';\r\nimport Icon from './icon';\r\nimport { cssPrefix } from '../config';\r\n\r\nexport function xtoast(title, content) {\r\n  const el = h('div', `${cssPrefix}-toast`);\r\n  const dimmer = h('div', `${cssPrefix}-dimmer active`);\r\n  const remove = () => {\r\n    document.body.removeChild(el.el);\r\n    document.body.removeChild(dimmer.el);\r\n  };\r\n\r\n  el.children(\r\n    h('div', `${cssPrefix}-toast-header`).children(\r\n      new Icon('close').on('click.stop', () => remove()),\r\n      title\r\n    ),\r\n    h('div', `${cssPrefix}-toast-content`).html(content)\r\n  );\r\n  document.body.appendChild(el.el);\r\n  document.body.appendChild(dimmer.el);\r\n  // set offset\r\n  const { width, height } = el.box();\r\n  const { clientHeight, clientWidth } = document.documentElement;\r\n  el.offset({\r\n    left: (clientWidth - width) / 2,\r\n    top: (clientHeight - height) / 3\r\n  });\r\n}\r\n\r\nexport default {};\r\n","/* global window */\r\nimport { h } from './element';\r\nimport { bind, mouseMoveUp, bindTouch } from './event';\r\nimport Resizer from './resizer';\r\nimport Scrollbar from './scrollbar';\r\nimport Selector from './selector';\r\nimport Editor from './editor';\r\nimport ContextMenu from './contextmenu';\r\nimport Table from './table';\r\nimport Toolbar from './toolbar';\r\nimport ModalValidation from './modal_validation';\r\nimport { xtoast } from './message';\r\nimport { cssPrefix } from '../config';\r\nimport { formulas } from '../core/formula';\r\n\r\nfunction scrollbarMove() {\r\n  const { data, verticalScrollbar, horizontalScrollbar } = this;\r\n  const { l, t, left, top, width, height } = data.getSelectedRect();\r\n  const tableOffset = this.getTableOffset();\r\n  // console.log(',l:', l, ', left:', left, ', tOffset.left:', tableOffset.width);\r\n  if (Math.abs(left) + width > tableOffset.width) {\r\n    horizontalScrollbar.move({ left: l + width - tableOffset.width });\r\n  } else {\r\n    const fsw = data.freezeTotalWidth();\r\n    if (left < fsw) {\r\n      horizontalScrollbar.move({ left: l - 1 - fsw });\r\n    }\r\n  }\r\n  // console.log('top:', top, ', height:', height, ', tof.height:', tableOffset.height);\r\n  if (Math.abs(top) + height > tableOffset.height) {\r\n    verticalScrollbar.move({ top: t + height - tableOffset.height - 1 });\r\n  } else {\r\n    const fsh = data.freezeTotalHeight();\r\n    if (top < fsh) {\r\n      verticalScrollbar.move({ top: t - 1 - fsh });\r\n    }\r\n  }\r\n}\r\n\r\nfunction selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false) {\r\n  if (ri === -1 && ci === -1) return;\r\n  // console.log(multiple, ', ri:', ri, ', ci:', ci);\r\n  const { table, selector, toolbar } = this;\r\n  if (multiple) {\r\n    selector.setEnd(ri, ci, moving);\r\n  } else {\r\n    selector.set(ri, ci, indexesUpdated);\r\n  }\r\n  toolbar.reset();\r\n  table.render();\r\n}\r\n\r\n// multiple: boolean\r\n// direction: left | right | up | down | row-first | row-last | col-first | col-last\r\nfunction selectorMove(multiple, direction) {\r\n  const { selector, data } = this;\r\n  const { rows, cols } = data;\r\n  let [ri, ci] = selector.indexes;\r\n  const { eri, eci } = selector.range;\r\n  if (multiple) {\r\n    [ri, ci] = selector.moveIndexes;\r\n  }\r\n  // console.log('selector.move:', ri, ci);\r\n  if (direction === 'left') {\r\n    if (ci > 0) ci -= 1;\r\n  } else if (direction === 'right') {\r\n    if (eci !== ci) ci = eci;\r\n    if (ci < cols.len - 1) ci += 1;\r\n  } else if (direction === 'up') {\r\n    if (ri > 0) ri -= 1;\r\n  } else if (direction === 'down') {\r\n    if (eri !== ri) ri = eri;\r\n    if (ri < rows.len - 1) ri += 1;\r\n  } else if (direction === 'row-first') {\r\n    ci = 0;\r\n  } else if (direction === 'row-last') {\r\n    ci = cols.len - 1;\r\n  } else if (direction === 'col-first') {\r\n    ri = 0;\r\n  } else if (direction === 'col-last') {\r\n    ri = rows.len - 1;\r\n  }\r\n  if (multiple) {\r\n    selector.moveIndexes = [ri, ci];\r\n  }\r\n  selectorSet.call(this, multiple, ri, ci);\r\n  scrollbarMove.call(this);\r\n}\r\n\r\n// private methods\r\nfunction overlayerMousemove(evt) {\r\n  // console.log('x:', evt.offsetX, ', y:', evt.offsetY);\r\n  if (evt.buttons !== 0) return;\r\n  if (evt.target.className === `${cssPrefix}-resizer-hover`) return;\r\n  const { offsetX, offsetY } = evt;\r\n  const { rowResizer, colResizer, tableEl, data } = this;\r\n  const { rows, cols } = data;\r\n  if (offsetX > cols.indexWidth && offsetY > rows.height) {\r\n    rowResizer.hide();\r\n    colResizer.hide();\r\n    return;\r\n  }\r\n  const tRect = tableEl.box();\r\n  const cRect = data.getCellRectByXY(evt.offsetX, evt.offsetY);\r\n  if (cRect.ri >= 0 && cRect.ci === -1) {\r\n    cRect.width = cols.indexWidth;\r\n    rowResizer.show(cRect, {\r\n      width: tRect.width\r\n    });\r\n  } else {\r\n    rowResizer.hide();\r\n  }\r\n  if (cRect.ri === -1 && cRect.ci >= 0) {\r\n    cRect.height = rows.height;\r\n    colResizer.show(cRect, {\r\n      height: tRect.height\r\n    });\r\n  } else {\r\n    colResizer.hide();\r\n  }\r\n}\r\n\r\nfunction overlayerMousescroll(evt) {\r\n  const { verticalScrollbar, data } = this;\r\n  const { top } = verticalScrollbar.scroll();\r\n  // console.log('evt:::', evt.wheelDelta, evt.detail * 40);\r\n  let delta = evt.deltaY;\r\n  const { rows } = data;\r\n  if (evt.detail) delta = evt.detail * 40;\r\n  if (delta > 0) {\r\n    // up\r\n    const ri = data.scroll.ri + 1;\r\n    if (ri < rows.len) {\r\n      verticalScrollbar.move({ top: top + rows.getHeight(ri) - 1 });\r\n    }\r\n  } else {\r\n    // down\r\n    const ri = data.scroll.ri - 1;\r\n    if (ri >= 0) {\r\n      verticalScrollbar.move({ top: ri === 0 ? 0 : top - rows.getHeight(ri) });\r\n    }\r\n  }\r\n}\r\n\r\nfunction overlayerTouch(direction, distance) {\r\n  const { verticalScrollbar, horizontalScrollbar } = this;\r\n  const { top } = verticalScrollbar.scroll();\r\n  const { left } = horizontalScrollbar.scroll();\r\n  // console.log('direction:', direction, ', distance:', distance, left);\r\n  if (direction === 'left' || direction === 'right') {\r\n    horizontalScrollbar.move({ left: left - distance });\r\n  } else if (direction === 'up' || direction === 'down') {\r\n    verticalScrollbar.move({ top: top - distance });\r\n  }\r\n}\r\n\r\nfunction verticalScrollbarSet() {\r\n  const { data, verticalScrollbar } = this;\r\n  const { height } = this.getTableOffset();\r\n  verticalScrollbar.set(height, data.rows.totalHeight());\r\n}\r\n\r\nfunction horizontalScrollbarSet() {\r\n  const { data, horizontalScrollbar } = this;\r\n  const { width } = this.getTableOffset();\r\n  if (data) {\r\n    horizontalScrollbar.set(width, data.cols.totalWidth());\r\n  }\r\n}\r\n\r\nfunction sheetFreeze() {\r\n  const { selector, data, editor } = this;\r\n  const [ri, ci] = data.freeze;\r\n  if (ri > 0 || ci > 0) {\r\n    const fwidth = data.freezeTotalWidth();\r\n    const fheight = data.freezeTotalHeight();\r\n    editor.setFreezeLengths(fwidth, fheight);\r\n  }\r\n  selector.resetAreaOffset();\r\n}\r\n\r\nfunction sheetReset() {\r\n  const {\r\n    tableEl,\r\n    overlayerEl,\r\n    overlayerCEl,\r\n    table,\r\n    toolbar,\r\n    selector,\r\n    el\r\n  } = this;\r\n  const tOffset = this.getTableOffset();\r\n  const vRect = this.getRect();\r\n  tableEl.attr(vRect);\r\n  overlayerEl.offset(vRect);\r\n  overlayerCEl.offset(tOffset);\r\n  el.css('width', `${vRect.width}px`);\r\n  verticalScrollbarSet.call(this);\r\n  horizontalScrollbarSet.call(this);\r\n  sheetFreeze.call(this);\r\n  table.render();\r\n  toolbar.reset();\r\n  selector.reset();\r\n}\r\n\r\nfunction clearClipboard() {\r\n  const { data, selector } = this;\r\n  data.clearClipboard();\r\n  selector.hideClipboard();\r\n}\r\n\r\nfunction copy() {\r\n  const { data, selector } = this;\r\n  console.log('data.copy', data.copy);\r\n  data.copy();\r\n  selector.showClipboard();\r\n}\r\n\r\nfunction cut() {\r\n  const { data, selector } = this;\r\n  data.cut();\r\n  selector.showClipboard();\r\n}\r\n\r\nfunction paste(what) {\r\n  const { data } = this;\r\n  if (data.paste(what, (msg) => xtoast('Tip', msg))) {\r\n    sheetReset.call(this);\r\n  }\r\n}\r\n\r\nfunction toolbarChangePaintformatPaste() {\r\n  const { toolbar } = this;\r\n  if (toolbar.paintformatActive()) {\r\n    paste.call(this, 'format');\r\n    clearClipboard.call(this);\r\n    toolbar.paintformatToggle();\r\n  }\r\n}\r\n\r\nfunction overlayerMousedown(evt) {\r\n  // console.log(':::::overlayer.mousedown:', evt.detail, evt.button, evt.buttons, evt.shiftKey);\r\n  // console.log('evt.target.className:', evt.target.className);\r\n  const { selector, data, table } = this;\r\n  const isAutofillEl = evt.target.className === `${cssPrefix}-selector-corner`;\r\n  let { ri, ci } = data.getCellRectByXY(evt.offsetX, evt.offsetY);\r\n  // console.log('ri:', ri, ', ci:', ci);\r\n  if (!evt.shiftKey) {\r\n    // console.log('selectorSetStart:::');\r\n    if (isAutofillEl) {\r\n      selector.showAutofill(ri, ci);\r\n    } else {\r\n      selectorSet.call(this, false, ri, ci);\r\n    }\r\n\r\n    // mouse move up\r\n    mouseMoveUp(\r\n      window,\r\n      (e) => {\r\n        // console.log('mouseMoveUp::::');\r\n        ({ ri, ci } = data.getCellRectByXY(e.offsetX, e.offsetY));\r\n        if (isAutofillEl) {\r\n          selector.showAutofill(ri, ci);\r\n        } else if (e.buttons === 1 && !e.shiftKey) {\r\n          selectorSet.call(this, true, ri, ci, true, true);\r\n        }\r\n      },\r\n      () => {\r\n        if (isAutofillEl) {\r\n          if (\r\n            data.autofill(selector.arange, 'all', (msg) => xtoast('Tip', msg))\r\n          ) {\r\n            table.render();\r\n          }\r\n        }\r\n        selector.hideAutofill();\r\n        toolbarChangePaintformatPaste.call(this);\r\n      }\r\n    );\r\n  }\r\n\r\n  if (!isAutofillEl && evt.buttons === 1) {\r\n    if (evt.shiftKey) {\r\n      // console.log('shiftKey::::');\r\n      selectorSet.call(this, true, ri, ci);\r\n    }\r\n  }\r\n}\r\n\r\nfunction editorSetOffset() {\r\n  const { editor, data } = this;\r\n  const sOffset = data.getSelectedRect();\r\n  const tOffset = this.getTableOffset();\r\n  let sPosition = 'top';\r\n  // console.log('sOffset:', sOffset, ':', tOffset);\r\n  if (sOffset.top > tOffset.height / 2) {\r\n    sPosition = 'bottom';\r\n  }\r\n  editor.setOffset(sOffset, sPosition);\r\n}\r\n\r\nfunction editorSet() {\r\n  const { editor, data } = this;\r\n  editorSetOffset.call(this);\r\n  editor.setCell(data.getSelectedCell(), data.getSelectedValidator());\r\n  clearClipboard.call(this);\r\n}\r\n\r\nfunction verticalScrollbarMove(distance) {\r\n  const { data, table, selector } = this;\r\n  data.scrolly(distance, () => {\r\n    selector.resetBRLAreaOffset();\r\n    editorSetOffset.call(this);\r\n    table.render();\r\n  });\r\n}\r\n\r\nfunction horizontalScrollbarMove(distance) {\r\n  const { data, table, selector } = this;\r\n  data.scrollx(distance, () => {\r\n    selector.resetBRTAreaOffset();\r\n    editorSetOffset.call(this);\r\n    table.render();\r\n  });\r\n}\r\n\r\nfunction rowResizerFinished(cRect, distance) {\r\n  const { ri } = cRect;\r\n  const { table, selector, data } = this;\r\n  data.rows.setHeight(ri, distance);\r\n  table.render();\r\n  selector.resetAreaOffset();\r\n  verticalScrollbarSet.call(this);\r\n  editorSetOffset.call(this);\r\n}\r\n\r\nfunction colResizerFinished(cRect, distance) {\r\n  const { ci } = cRect;\r\n  const { table, selector, data } = this;\r\n  data.cols.setWidth(ci, distance);\r\n  // console.log('data:', data);\r\n  table.render();\r\n  selector.resetAreaOffset();\r\n  horizontalScrollbarSet.call(this);\r\n  editorSetOffset.call(this);\r\n}\r\n\r\nfunction dataSetCellText(text, state = 'finished') {\r\n  const { data, table } = this;\r\n  // const [ri, ci] = selector.indexes;\r\n  data.setSelectedCellText(text, state);\r\n  if (state === 'finished') table.render();\r\n}\r\n\r\nfunction insertDeleteRowColumn(type) {\r\n  const { data } = this;\r\n  if (type === 'insert-row') {\r\n    data.insert('row');\r\n  } else if (type === 'delete-row') {\r\n    data.delete('row');\r\n  } else if (type === 'insert-column') {\r\n    data.insert('column');\r\n  } else if (type === 'delete-column') {\r\n    data.delete('column');\r\n  } else if (type === 'delete-cell') {\r\n    data.deleteCell();\r\n  } else if (type === 'delete-cell-format') {\r\n    data.deleteCell('format');\r\n  } else if (type === 'delete-cell-text') {\r\n    data.deleteCell('text');\r\n  }\r\n  clearClipboard.call(this);\r\n  sheetReset.call(this);\r\n}\r\n\r\nfunction toolbarChange(type, value) {\r\n  const { data } = this;\r\n  if (type === 'undo') {\r\n    this.undo();\r\n  } else if (type === 'redo') {\r\n    this.redo();\r\n  } else if (type === 'print') {\r\n    // print\r\n  } else if (type === 'paintformat') {\r\n    if (value === true) copy.call(this);\r\n    else clearClipboard.call(this);\r\n  } else if (type === 'clearformat') {\r\n    insertDeleteRowColumn.call(this, 'delete-cell-format');\r\n  } else if (type === 'link') {\r\n    // link\r\n  } else if (type === 'chart') {\r\n    // chart\r\n  } else if (type === 'filter') {\r\n    // filter\r\n  } else if (type === 'freeze') {\r\n    if (value) {\r\n      const { ri, ci } = data.selector;\r\n      this.freeze(ri, ci);\r\n    } else {\r\n      this.freeze(0, 0);\r\n    }\r\n  } else {\r\n    data.setSelectedCellAttr(type, value);\r\n    if (type === 'formula') {\r\n      editorSet.call(this);\r\n    }\r\n    sheetReset.call(this);\r\n  }\r\n}\r\n\r\nfunction sheetInitEvents() {\r\n  const {\r\n    overlayerEl,\r\n    rowResizer,\r\n    colResizer,\r\n    verticalScrollbar,\r\n    horizontalScrollbar,\r\n    editor,\r\n    contextMenu,\r\n    data,\r\n    toolbar,\r\n    modalValidation\r\n  } = this;\r\n  // overlayer\r\n  overlayerEl\r\n    .on('mousemove', (evt) => {\r\n      overlayerMousemove.call(this, evt);\r\n    })\r\n    .on('mousedown', (evt) => {\r\n      // the left mouse button: mousedown → mouseup → click\r\n      // the right mouse button: mousedown → contenxtmenu → mouseup\r\n      if (evt.buttons === 2) {\r\n        if (data.xyInSelectedRect(evt.offsetX, evt.offsetY)) {\r\n          contextMenu.setPosition(evt.offsetX, evt.offsetY);\r\n          evt.stopPropagation();\r\n        } else {\r\n          contextMenu.hide();\r\n        }\r\n      } else if (evt.detail === 2) {\r\n        editorSet.call(this);\r\n      } else {\r\n        editor.clear();\r\n        overlayerMousedown.call(this, evt);\r\n      }\r\n    })\r\n    .on('mousewheel.stop', (evt) => {\r\n      overlayerMousescroll.call(this, evt);\r\n    });\r\n\r\n  // slide on mobile\r\n  bindTouch(overlayerEl.el, {\r\n    move: (direction, d) => {\r\n      overlayerTouch.call(this, direction, d);\r\n    }\r\n  });\r\n\r\n  // toolbar change\r\n  toolbar.change = (type, value) => toolbarChange.call(this, type, value);\r\n\r\n  // resizer finished callback\r\n  rowResizer.finishedFn = (cRect, distance) => {\r\n    rowResizerFinished.call(this, cRect, distance);\r\n  };\r\n  colResizer.finishedFn = (cRect, distance) => {\r\n    colResizerFinished.call(this, cRect, distance);\r\n  };\r\n  // scrollbar move callback\r\n  verticalScrollbar.moveFn = (distance, evt) => {\r\n    verticalScrollbarMove.call(this, distance, evt);\r\n  };\r\n  horizontalScrollbar.moveFn = (distance, evt) => {\r\n    horizontalScrollbarMove.call(this, distance, evt);\r\n  };\r\n  // editor\r\n  editor.change = (state, itext) => {\r\n    dataSetCellText.call(this, itext, state);\r\n  };\r\n  // modal validation\r\n  modalValidation.change = (action, ...args) => {\r\n    if (action === 'save') {\r\n      data.addValidation(...args);\r\n    } else {\r\n      data.removeValidation();\r\n    }\r\n  };\r\n  // contextmenu\r\n  contextMenu.itemClick = (type) => {\r\n    // console.log('type:', type);\r\n    if (type === 'validation') {\r\n      modalValidation.setValue(data.getSelectedValidation());\r\n    } else if (type === 'copy') {\r\n      copy.call(this);\r\n    } else if (type === 'cut') {\r\n      cut.call(this);\r\n    } else if (type === 'paste') {\r\n      paste.call(this, 'all');\r\n    } else if (type === 'paste-value') {\r\n      paste.call(this, 'text');\r\n    } else if (type === 'paste-format') {\r\n      paste.call(this, 'format');\r\n    } else {\r\n      insertDeleteRowColumn.call(this, type);\r\n    }\r\n  };\r\n\r\n  bind(window, 'resize', () => {\r\n    this.reload();\r\n  });\r\n\r\n  bind(window, 'click', (evt) => {\r\n    this.focusing = overlayerEl.contains(evt.target);\r\n  });\r\n\r\n  // for selector\r\n  bind(window, 'keydown', (evt) => {\r\n    if (!this.focusing) return;\r\n    const keyCode = evt.keyCode || evt.which;\r\n    const { key, ctrlKey, shiftKey, altKey, metaKey } = evt;\r\n    // console.log('keydown.evt: ', keyCode);\r\n    if (ctrlKey || metaKey) {\r\n      // const { sIndexes, eIndexes } = selector;\r\n      let what = 'all';\r\n      if (shiftKey) what = 'text';\r\n      if (altKey) what = 'format';\r\n      switch (keyCode) {\r\n        case 90:\r\n          // undo: ctrl + z\r\n          this.undo();\r\n          evt.preventDefault();\r\n          break;\r\n        case 89:\r\n          // redo: ctrl + y\r\n          this.redo();\r\n          evt.preventDefault();\r\n          break;\r\n        case 67:\r\n          // ctrl + c\r\n          copy.call(this);\r\n          evt.preventDefault();\r\n          break;\r\n        case 88:\r\n          // ctrl + x\r\n          cut.call(this);\r\n          evt.preventDefault();\r\n          break;\r\n        case 85:\r\n          // ctrl + u\r\n          toolbar.trigger('underline');\r\n          evt.preventDefault();\r\n          break;\r\n        case 86:\r\n          // ctrl + v\r\n          paste.call(this, what);\r\n          evt.preventDefault();\r\n          break;\r\n        case 37:\r\n          // ctrl + left\r\n          selectorMove.call(this, shiftKey, 'row-first');\r\n          evt.preventDefault();\r\n          break;\r\n        case 38:\r\n          // ctrl + up\r\n          selectorMove.call(this, shiftKey, 'col-first');\r\n          evt.preventDefault();\r\n          break;\r\n        case 39:\r\n          // ctrl + right\r\n          selectorMove.call(this, shiftKey, 'row-last');\r\n          evt.preventDefault();\r\n          break;\r\n        case 40:\r\n          // ctrl + down\r\n          selectorMove.call(this, shiftKey, 'col-last');\r\n          evt.preventDefault();\r\n          break;\r\n        case 32:\r\n          // ctrl + space, all cells in col\r\n          selectorSet.call(this, false, -1, data.selector.ci, false);\r\n          evt.preventDefault();\r\n          break;\r\n        case 66:\r\n          // ctrl + B\r\n          toolbar.trigger('font-bold');\r\n          break;\r\n        case 73:\r\n          // ctrl + I\r\n          toolbar.trigger('font-italic');\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    } else {\r\n      // console.log('evt.keyCode:', evt.keyCode);\r\n      switch (keyCode) {\r\n        case 32:\r\n          if (shiftKey) {\r\n            // shift + space, all cells in row\r\n            selectorSet.call(this, false, data.selector.ri, -1, false);\r\n          }\r\n          break;\r\n        case 27: // esc\r\n          contextMenu.hide();\r\n          clearClipboard.call(this);\r\n          break;\r\n        case 37: // left\r\n          selectorMove.call(this, shiftKey, 'left');\r\n          evt.preventDefault();\r\n          break;\r\n        case 38: // up\r\n          selectorMove.call(this, shiftKey, 'up');\r\n          evt.preventDefault();\r\n          break;\r\n        case 39: // right\r\n          selectorMove.call(this, shiftKey, 'right');\r\n          evt.preventDefault();\r\n          break;\r\n        case 40: // down\r\n          selectorMove.call(this, shiftKey, 'down');\r\n          evt.preventDefault();\r\n          break;\r\n        case 9: // tab\r\n          editor.clear();\r\n          // shift + tab => move left\r\n          // tab => move right\r\n          selectorMove.call(this, false, shiftKey ? 'left' : 'right');\r\n          evt.preventDefault();\r\n          break;\r\n        case 13: // enter\r\n          editor.clear();\r\n          // shift + enter => move up\r\n          // enter => move down\r\n          selectorMove.call(this, false, shiftKey ? 'up' : 'down');\r\n          evt.preventDefault();\r\n          break;\r\n        case 8: // backspace\r\n          insertDeleteRowColumn.call(this, 'delete-cell-text');\r\n          evt.preventDefault();\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n\r\n      if (key === 'Delete') {\r\n        insertDeleteRowColumn.call(this, 'delete-cell-text');\r\n        evt.preventDefault();\r\n      } else if (\r\n        (keyCode >= 65 && keyCode <= 90) ||\r\n        (keyCode >= 48 && keyCode <= 57) ||\r\n        (keyCode >= 96 && keyCode <= 105) ||\r\n        evt.key === '='\r\n      ) {\r\n        dataSetCellText.call(this, evt.key, 'input');\r\n        editorSet.call(this);\r\n      } else if (keyCode === 113) {\r\n        // F2\r\n        editorSet.call(this);\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nexport default class Sheet {\r\n  constructor(targetEl, data) {\r\n    const { view, showToolbar, showContextmenu } = data.settings;\r\n    this.el = h('div', `${cssPrefix}-sheet`);\r\n    this.toolbar = new Toolbar(data, view.width, !showToolbar);\r\n    targetEl.children(this.toolbar.el, this.el);\r\n    this.data = data;\r\n    // table\r\n    this.tableEl = h('canvas', `${cssPrefix}-table`);\r\n    // resizer\r\n    this.rowResizer = new Resizer(false, data.rows.height);\r\n    this.colResizer = new Resizer(true, data.cols.minWidth);\r\n    // scrollbar\r\n    this.verticalScrollbar = new Scrollbar(true);\r\n    this.horizontalScrollbar = new Scrollbar(false);\r\n    // editor\r\n    this.editor = new Editor(\r\n      formulas,\r\n      () => this.getTableOffset(),\r\n      data.rows.height\r\n    );\r\n    // data validation\r\n    this.modalValidation = new ModalValidation();\r\n    // contextMenu\r\n    this.contextMenu = new ContextMenu(\r\n      () => this.getTableOffset(),\r\n      !showContextmenu\r\n    );\r\n    // selector\r\n    this.selector = new Selector(data);\r\n    this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`).children(\r\n      this.editor.el,\r\n      this.selector.el\r\n    );\r\n    this.overlayerEl = h('div', `${cssPrefix}-overlayer`).child(\r\n      this.overlayerCEl\r\n    );\r\n    // root element\r\n    this.el.children(\r\n      this.tableEl,\r\n      this.overlayerEl.el,\r\n      this.rowResizer.el,\r\n      this.colResizer.el,\r\n      this.verticalScrollbar.el,\r\n      this.horizontalScrollbar.el,\r\n      this.contextMenu.el,\r\n      this.modalValidation.el\r\n    );\r\n    // table\r\n    this.table = new Table(this.tableEl.el, data);\r\n    sheetInitEvents.call(this);\r\n    sheetReset.call(this);\r\n    // init selector [0, 0]\r\n    selectorSet.call(this, false, 0, 0);\r\n  }\r\n\r\n  loadData(data) {\r\n    this.data.setData(data);\r\n    sheetReset.call(this);\r\n    return this;\r\n  }\r\n\r\n  // freeze rows or cols\r\n  freeze(ri, ci) {\r\n    const { data } = this;\r\n    data.setFreeze(ri, ci);\r\n    sheetReset.call(this);\r\n    return this;\r\n  }\r\n\r\n  undo() {\r\n    this.data.undo();\r\n    sheetReset.call(this);\r\n  }\r\n\r\n  redo() {\r\n    this.data.redo();\r\n    sheetReset.call(this);\r\n  }\r\n\r\n  reload() {\r\n    sheetReset.call(this);\r\n    return this;\r\n  }\r\n\r\n  getRect() {\r\n    const { data } = this;\r\n    return { width: data.viewWidth(), height: data.viewHeight() };\r\n  }\r\n\r\n  getTableOffset() {\r\n    const { rows, cols } = this.data;\r\n    const { width, height } = this.getRect();\r\n    return {\r\n      width: width - cols.indexWidth,\r\n      height: height - rows.height,\r\n      left: cols.indexWidth,\r\n      top: rows.height\r\n    };\r\n  }\r\n}\r\n","/* global window, document */\r\nimport { h } from './component/element';\r\nimport DataProxy from './core/data_proxy';\r\nimport Sheet from './component/sheet';\r\nimport { cssPrefix } from './config';\r\nimport { locale } from './locale/locale';\r\nimport './index.less';\r\n\r\nclass Spreadsheet {\r\n  constructor(selectors, options = {}) {\r\n    let targetEl = selectors;\r\n    if (typeof selectors === 'string') {\r\n      targetEl = document.querySelector(selectors);\r\n    }\r\n    this.data = new DataProxy('sheet1', options);\r\n    const rootEl = h('div', `${cssPrefix}`).on('contextmenu', (evt) =>\r\n      evt.preventDefault()\r\n    );\r\n    // create canvas element\r\n    targetEl.appendChild(rootEl.el);\r\n    this.sheet = new Sheet(rootEl, this.data);\r\n  }\r\n\r\n  loadData(data) {\r\n    this.sheet.loadData(data);\r\n    return this;\r\n  }\r\n\r\n  getData() {\r\n    return this.data.getData();\r\n  }\r\n\r\n  validate() {\r\n    const { validations } = this.data;\r\n    return validations.errors.size <= 0;\r\n  }\r\n\r\n  change(cb) {\r\n    this.data.change = cb;\r\n    this.getData();\r\n    return this;\r\n  }\r\n\r\n  static locale(lang, message) {\r\n    locale(lang, message);\r\n  }\r\n}\r\n\r\nconst spreadsheet = (el, options = {}) => new Spreadsheet(el, options);\r\n\r\nif (window) {\r\n  window.x = window.x || {};\r\n  window.x.spreadsheet = spreadsheet;\r\n  window.x.spreadsheet.locale = (lang, message) => locale(lang, message);\r\n}\r\n\r\nexport default Spreadsheet;\r\nexport { spreadsheet };\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue } from 'vue-property-decorator';\r\nimport Spreadsheet from '../../components/xspreadsheet';\r\nimport testEditor from './component/editTest.vue';\r\nimport createDialog from './component/createDialog.vue';\r\nimport parameView from './component/parameView.vue';\r\nimport { statementChange } from './component/conditional.js';\r\nimport treeTableList from './component/treeTableList.vue';\r\nimport {\r\n  linkList,\r\n  addCombin,\r\n  viewDataEdit,\r\n  dataViewAdd,\r\n  dataViewDetail,\r\n  excelInfoQuery\r\n} from '@api/viewData';\r\n\r\n@Component({\r\n  components: { parameView, createDialog, testEditor, treeTableList }\r\n})\r\nexport default class FileType extends Vue {\r\n  private fileTypeForm: any = {\r\n    viewName: '',\r\n    linkId: '',\r\n    path: '',\r\n    sheetName: '',\r\n    titleLine: '',\r\n    startLine: '',\r\n    endLine: '',\r\n    dictFlag: 1\r\n  };\r\n  private rules: any = {\r\n    viewName: [{ required: true, message: '请填写视图名称', trigger: 'blur' }],\r\n    linkId: [\r\n      { required: true, message: '请选择文档库连接器', trigger: 'change' }\r\n    ],\r\n    path: [{ required: true, message: '请填写文件路径', trigger: 'blur' }],\r\n    sheetName: [{ required: true, message: '请填写sheet名称', trigger: 'blur' }]\r\n  };\r\n  private linkList: Array<any> = [];\r\n  private parameterTable: Array<any> = [\r\n    {\r\n      id: 1,\r\n      code: '',\r\n      name: '',\r\n      type: '',\r\n      required: '',\r\n      defaultValue: '',\r\n      addButton: true,\r\n      edits: [0, 1, 1, 1, 1, 1, 0]\r\n    }\r\n  ];\r\n  private isCompatible: any = '';\r\n  private fieldTable: Array<any> = [];\r\n  private testloading = false;\r\n  private paramsActions: Array<any> = [\r\n    {\r\n      title: '测试查询',\r\n      icon: 'stack-line',\r\n      onClick: this.testQueryButton\r\n    }\r\n  ];\r\n\r\n  private sheet: any = null;\r\n  private updateId: any = '';\r\n  private testList: Array<any> = [];\r\n  private cellLocation: any = {};\r\n  private cellList: Array<any> = [];\r\n  private excelData: any = {\r\n    styles: [\r\n      {\r\n        bgcolor: '#f4f5f8',\r\n        textwrap: true,\r\n        color: '#900b09',\r\n        border: {\r\n          // top: ['thin', '#000000'],\r\n          // bottom: ['thin', '#000000'],\r\n          right: ['thin', '#000000'],\r\n          left: ['thin', '#0366d6']\r\n        }\r\n      },\r\n      {\r\n        textwrap: false,\r\n        bgcolor: '#366092',\r\n        color: '#fff',\r\n        align: 'center',\r\n        width: 200\r\n      },\r\n      {\r\n        textwrap: false,\r\n        bgcolor: '#c5d9f1',\r\n        color: '#000',\r\n        align: 'center',\r\n        width: 200\r\n      },\r\n      {\r\n        bgcolor: '#ffffff',\r\n        color: '#000',\r\n        align: 'center'\r\n      },\r\n      {\r\n        bgcolor: '#dce6f1',\r\n        color: '#000',\r\n        align: 'center'\r\n      }\r\n    ],\r\n    rows: {\r\n      0: {\r\n        cells: {\r\n          0: { text: 'test1' },\r\n          1: { text: 'test2' }\r\n        }\r\n      },\r\n      1: {\r\n        cells: {\r\n          0: { text: 'rows2-test1' },\r\n          1: { text: 'rows3-test2' }\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  private dialogVisible = false;\r\n  private actionsList: Array<any> = [\r\n    {\r\n      icon: '',\r\n      type: 'primary',\r\n      onClick: this.addSure,\r\n      title: '确定'\r\n    },\r\n    {\r\n      icon: '',\r\n      type: '',\r\n      onClick: this.addCancel,\r\n      title: '取消'\r\n    }\r\n  ];\r\n  private testParameterDialog = false;\r\n  private testParameterRules: any = {};\r\n  private testParameterList: Array<any> = [];\r\n\r\n  // 数据初始化\r\n  created() {\r\n    this.linkQuery();\r\n    const id = this.$route.query.id;\r\n    if (id) {\r\n      this.dataViewDetail();\r\n    }\r\n  }\r\n  // excel预览\r\n  initExcel() {\r\n    this.sheet = new Spreadsheet('#spreadsheet-execl', {\r\n      view: {\r\n        width: () => 1000,\r\n        height: () => 240\r\n      },\r\n      rows: {\r\n        len: 10,\r\n        height: 20\r\n      },\r\n      col: {\r\n        len: 26,\r\n        width: 100,\r\n        indexWidth: 60,\r\n        minWidth: 50\r\n      }\r\n    }).loadData(this.excelData);\r\n  }\r\n  // 文档连接器列表查询\r\n  linkQuery() {\r\n    linkList({\r\n      page: 1,\r\n      limit: 10000,\r\n      type: '2'\r\n    }).then(({ data }: any) => {\r\n      this.linkList = data.rows;\r\n    });\r\n  }\r\n  // 测试查询按钮\r\n  testQueryButton() {\r\n    if (!this.fileTypeForm.linkId) {\r\n      this.$message.error('请选择文档库连接器');\r\n      return false;\r\n    }\r\n    if (!this.fileTypeForm.path) {\r\n      this.$message.error('请填写文件路径');\r\n      return false;\r\n    }\r\n    if (!this.fileTypeForm.sheetName) {\r\n      this.$message.error('请填写sheet名称');\r\n      return false;\r\n    }\r\n    if (this.parameterTable.length > 0 && this.parameterTable[0].code) {\r\n      this.testParameterDialog = true;\r\n    } else {\r\n      const params = {\r\n        ...this.fileTypeForm,\r\n        filePath: this.fileTypeForm.path\r\n      };\r\n      this.queryExcelInfo(params);\r\n    }\r\n  }\r\n  changeValue(val: any, item: any) {\r\n    this.testParameterList.forEach((listItem) => {\r\n      if (listItem.code === item.code) {\r\n        if (listItem.required === '1' && listItem.value === '') {\r\n          listItem.showMsg = true;\r\n        } else {\r\n          listItem.showMsg = false;\r\n        }\r\n      }\r\n    });\r\n  }\r\n  // 测试参数编辑器 - 确定按钮\r\n  handleTestQuery() {\r\n    this.testloading = true;\r\n    let spreadQuery: Array<any> = [];\r\n    if (this.$refs.advance['spread'].model) {\r\n      for (const i in this.$refs.advance['spread'].model) {\r\n        spreadQuery.push({\r\n          code: i,\r\n          value: this.$refs.advance['spread'].model[i]\r\n        });\r\n      }\r\n    } else {\r\n      spreadQuery = [];\r\n    }\r\n    const params = {\r\n      ...this.fileTypeForm,\r\n      filePath: this.fileTypeForm.path,\r\n      queryParams: spreadQuery\r\n    };\r\n    this.queryExcelInfo(params);\r\n  }\r\n  queryExcelInfo(params) {\r\n    this.testloading = true;\r\n    excelInfoQuery(params).then((res) => {\r\n      this.testloading = false;\r\n      this.testParameterDialog = false;\r\n      if (res.data) {\r\n        this.excelData = res.data;\r\n        const a = document.getElementById('spreadsheet-execl');\r\n        if (a !== null) {\r\n          a.innerHTML = '';\r\n        }\r\n        this.initExcel();\r\n        this.$message.success('测试查询成功');\r\n      } else {\r\n        this.$message.error('测试查询失败：' + res.error.message);\r\n      }\r\n    });\r\n  }\r\n  // 测试参数编辑器 - 取消按钮\r\n  testParameterCancel() {\r\n    this.$refs.advance['spread'].model = '';\r\n    this.testParameterDialog = false;\r\n  }\r\n  // 新建 按钮\r\n  createLink() {\r\n    this.dialogVisible = true;\r\n  }\r\n  // 文档连接器弹框 保存\r\n  handelSure(params) {\r\n    addCombin(params).then((res) => {\r\n      if (res.data) {\r\n        this.fileTypeForm.linkId = res.data.linkId;\r\n        this.$message.success('文档连接器添加成功');\r\n        this.dialogVisible = false;\r\n        this.linkQuery();\r\n      } else {\r\n        this.$message.error('文档库连接器新增失败：' + res.error.message);\r\n      }\r\n    });\r\n  }\r\n  // 弹框 取消\r\n  handelCancel() {\r\n    this.dialogVisible = false;\r\n  }\r\n  // 新增数据视图 取消按钮\r\n  addCancel() {\r\n    const fileTypeForm: any = this.$refs.fileTypeForm;\r\n    fileTypeForm.resetFields();\r\n    this.$router.push('/sysSupport/dataService/viewDateManagent');\r\n  }\r\n  // 数据视图详情接口\r\n  dataViewDetail() {\r\n    this.isCompatible = this.$route.query.isCompatible;\r\n    this.updateId = this.$route.query.id;\r\n    const id = this.$route.query.id;\r\n    dataViewDetail(id).then(({ data }: any) => {\r\n      this.fileTypeForm.viewName = data.name;\r\n      this.fileTypeForm.titleLine = data.titleLine;\r\n      this.fileTypeForm.linkId = data.linkId;\r\n      this.fileTypeForm.path = data.path;\r\n      this.fileTypeForm.startLine = data.startLine;\r\n      this.fileTypeForm.endLine = data.endLine;\r\n      this.fileTypeForm.sheetName = data.sheetName;\r\n      this.fileTypeForm.dictFlag = data.dictFlag;\r\n      if (data.queryParams) {\r\n        this.parameterTable = data.queryParams;\r\n      }\r\n      this.fieldTable = data.fields;\r\n    });\r\n  }\r\n  // 新增数据视图 确定按钮\r\n  addSure() {\r\n    const fileTypeForm: any = this.$refs.fileTypeForm;\r\n    fileTypeForm.validate((valid: any) => {\r\n      let checkFlag = false;\r\n      if (valid) {\r\n        this.fieldTable = this.$refs.treeLists['treeDataList'];\r\n        console.log(' this.fieldTable', this.fieldTable);\r\n        this.parameterTable = this.$refs.parameViewTable['parameterData'];\r\n        checkFlag = statementChange(this.parameterTable, this.fieldTable);\r\n        console.log('checkFlag', checkFlag);\r\n        // this.parameterTable.forEach((key, index) => {\r\n        //   if (\r\n        //     !key.code &&\r\n        //     !key.name &&\r\n        //     !key.type &&\r\n        //     !key.required &&\r\n        //     !key.defaultValue\r\n        //   ) {\r\n        //     this.parameterTable.splice(index, 1);\r\n        //   }\r\n        // });\r\n        if (checkFlag === false) {\r\n          const params: any = {\r\n            name: this.fileTypeForm.viewName,\r\n            type: 0,\r\n            kind: 2,\r\n            dictFlag: this.fileTypeForm.dictFlag,\r\n            linkId: this.fileTypeForm.linkId,\r\n            path: this.fileTypeForm.path,\r\n            fields: this.fieldTable,\r\n            sheetName: this.fileTypeForm.sheetName,\r\n            titleLine: this.fileTypeForm.titleLine,\r\n            startLine: this.fileTypeForm.startLine,\r\n            endLine: this.fileTypeForm.endLine\r\n          };\r\n          if (this.parameterTable.length > 0 && this.parameterTable[0].code) {\r\n            params.queryParams = this.parameterTable;\r\n          } else {\r\n            params.queryParams = [];\r\n          }\r\n          if (\r\n            (this.isCompatible === '0' && this.updateId) ||\r\n            (this.isCompatible === '1' && this.updateId)\r\n          ) {\r\n            params.id = this.updateId;\r\n            params.isCompatible = this.isCompatible;\r\n            viewDataEdit(params).then(({ data, error }) => {\r\n              if (!error) {\r\n                this.$message.success('保存成功');\r\n                fileTypeForm.resetFields();\r\n                this.$router.back();\r\n              } else {\r\n                this.$message.error('保存失败:' + error.message);\r\n              }\r\n            });\r\n          } else {\r\n            dataViewAdd(params).then(({ data, error }) => {\r\n              if (!error) {\r\n                this.$message.success('保存成功');\r\n                fileTypeForm.resetFields();\r\n                this.$router.back();\r\n              } else {\r\n                this.$message.error('保存失败:' + error.message);\r\n              }\r\n            });\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./fileView.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./fileView.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./fileView.vue?vue&type=template&id=c09518bc&\"\nimport script from \"./fileView.vue?vue&type=script&lang=ts&\"\nexport * from \"./fileView.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./fileView.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar $ = require('../internals/export');\nvar toInteger = require('../internals/to-integer');\nvar thisNumberValue = require('../internals/this-number-value');\nvar repeat = require('../internals/string-repeat');\nvar fails = require('../internals/fails');\n\nvar nativeToFixed = 1.0.toFixed;\nvar floor = Math.floor;\n\nvar pow = function (x, n, acc) {\n  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);\n};\n\nvar log = function (x) {\n  var n = 0;\n  var x2 = x;\n  while (x2 >= 4096) {\n    n += 12;\n    x2 /= 4096;\n  }\n  while (x2 >= 2) {\n    n += 1;\n    x2 /= 2;\n  } return n;\n};\n\nvar FORCED = nativeToFixed && (\n  0.00008.toFixed(3) !== '0.000' ||\n  0.9.toFixed(0) !== '1' ||\n  1.255.toFixed(2) !== '1.25' ||\n  1000000000000000128.0.toFixed(0) !== '1000000000000000128'\n) || !fails(function () {\n  // V8 ~ Android 4.3-\n  nativeToFixed.call({});\n});\n\n// `Number.prototype.toFixed` method\n// https://tc39.github.io/ecma262/#sec-number.prototype.tofixed\n$({ target: 'Number', proto: true, forced: FORCED }, {\n  // eslint-disable-next-line max-statements\n  toFixed: function toFixed(fractionDigits) {\n    var number = thisNumberValue(this);\n    var fractDigits = toInteger(fractionDigits);\n    var data = [0, 0, 0, 0, 0, 0];\n    var sign = '';\n    var result = '0';\n    var e, z, j, k;\n\n    var multiply = function (n, c) {\n      var index = -1;\n      var c2 = c;\n      while (++index < 6) {\n        c2 += n * data[index];\n        data[index] = c2 % 1e7;\n        c2 = floor(c2 / 1e7);\n      }\n    };\n\n    var divide = function (n) {\n      var index = 6;\n      var c = 0;\n      while (--index >= 0) {\n        c += data[index];\n        data[index] = floor(c / n);\n        c = (c % n) * 1e7;\n      }\n    };\n\n    var dataToString = function () {\n      var index = 6;\n      var s = '';\n      while (--index >= 0) {\n        if (s !== '' || index === 0 || data[index] !== 0) {\n          var t = String(data[index]);\n          s = s === '' ? t : s + repeat.call('0', 7 - t.length) + t;\n        }\n      } return s;\n    };\n\n    if (fractDigits < 0 || fractDigits > 20) throw RangeError('Incorrect fraction digits');\n    // eslint-disable-next-line no-self-compare\n    if (number != number) return 'NaN';\n    if (number <= -1e21 || number >= 1e21) return String(number);\n    if (number < 0) {\n      sign = '-';\n      number = -number;\n    }\n    if (number > 1e-21) {\n      e = log(number * pow(2, 69, 1)) - 69;\n      z = e < 0 ? number * pow(2, -e, 1) : number / pow(2, e, 1);\n      z *= 0x10000000000000;\n      e = 52 - e;\n      if (e > 0) {\n        multiply(0, z);\n        j = fractDigits;\n        while (j >= 7) {\n          multiply(1e7, 0);\n          j -= 7;\n        }\n        multiply(pow(10, j, 1), 0);\n        j = e - 1;\n        while (j >= 23) {\n          divide(1 << 23);\n          j -= 23;\n        }\n        divide(1 << j);\n        multiply(1, 1);\n        divide(2);\n        result = dataToString();\n      } else {\n        multiply(0, z);\n        multiply(1 << -e, 0);\n        result = dataToString() + repeat.call('0', fractDigits);\n      }\n    }\n    if (fractDigits > 0) {\n      k = result.length;\n      result = sign + (k <= fractDigits\n        ? '0.' + repeat.call('0', fractDigits - k) + result\n        : result.slice(0, k - fractDigits) + '.' + result.slice(k - fractDigits));\n    } else {\n      result = sign + result;\n    } return result;\n  }\n});\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  return Object.isExtensible(Object.preventExtensions({}));\n});\n","var $ = require('../internals/export');\nvar fill = require('../internals/array-fill');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.fill` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.fill\n$({ target: 'Array', proto: true }, {\n  fill: fill\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('fill');\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.bold` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.bold\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('bold') }, {\n  bold: function bold() {\n    return createHTML(this, 'b', '', '');\n  }\n});\n","var aFunction = require('../internals/a-function');\nvar toObject = require('../internals/to-object');\nvar IndexedObject = require('../internals/indexed-object');\nvar toLength = require('../internals/to-length');\n\n// `Array.prototype.{ reduce, reduceRight }` methods implementation\nvar createMethod = function (IS_RIGHT) {\n  return function (that, callbackfn, argumentsLength, memo) {\n    aFunction(callbackfn);\n    var O = toObject(that);\n    var self = IndexedObject(O);\n    var length = toLength(O.length);\n    var index = IS_RIGHT ? length - 1 : 0;\n    var i = IS_RIGHT ? -1 : 1;\n    if (argumentsLength < 2) while (true) {\n      if (index in self) {\n        memo = self[index];\n        index += i;\n        break;\n      }\n      index += i;\n      if (IS_RIGHT ? index < 0 : length <= index) {\n        throw TypeError('Reduce of empty array with no initial value');\n      }\n    }\n    for (;IS_RIGHT ? index >= 0 : length > index; index += i) if (index in self) {\n      memo = callbackfn(memo, self[index], index, O);\n    }\n    return memo;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.reduce` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n  left: createMethod(false),\n  // `Array.prototype.reduceRight` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.reduceright\n  right: createMethod(true)\n};\n","var hiddenKeys = require('../internals/hidden-keys');\nvar isObject = require('../internals/is-object');\nvar has = require('../internals/has');\nvar defineProperty = require('../internals/object-define-property').f;\nvar uid = require('../internals/uid');\nvar FREEZING = require('../internals/freezing');\n\nvar METADATA = uid('meta');\nvar id = 0;\n\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\n\nvar setMetadata = function (it) {\n  defineProperty(it, METADATA, { value: {\n    objectID: 'O' + ++id, // object ID\n    weakData: {}          // weak collections IDs\n  } });\n};\n\nvar fastKey = function (it, create) {\n  // return a primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMetadata(it);\n  // return object ID\n  } return it[METADATA].objectID;\n};\n\nvar getWeakData = function (it, create) {\n  if (!has(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMetadata(it);\n  // return the store of weak collections IDs\n  } return it[METADATA].weakData;\n};\n\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZING && meta.REQUIRED && isExtensible(it) && !has(it, METADATA)) setMetadata(it);\n  return it;\n};\n\nvar meta = module.exports = {\n  REQUIRED: false,\n  fastKey: fastKey,\n  getWeakData: getWeakData,\n  onFreeze: onFreeze\n};\n\nhiddenKeys[METADATA] = true;\n"],"sourceRoot":""}