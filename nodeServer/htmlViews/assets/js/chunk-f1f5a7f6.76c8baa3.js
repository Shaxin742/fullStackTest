(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f1f5a7f6"],{"09c1":function(e,t,i){"use strict";var r=i("74c3"),n=i.n(r);n.a},"4b25":function(e,t,i){"use strict";i("d3b7");var r=i("5530"),n=(i("0644"),i("fd85")),s=i("d547"),o=i("2f62");t["a"]={data:function(){return{trees:[],actionFlag:{},roleLoading:!1,roleList:[],roleTotal:null,roleQueryStr:"",roleCurrpage:1,rolePageSize:10,deptId:"",departAll:"",departments:[],offices:[],office:"",deptProps:{value:"id",label:"deptName"},locked:"",userQueryStr:"",userType:"个人",userCurrpage:1,userPageSize:10,userTotal:null,userList:[],userLoading:!1,isOne:!0,roleGroupId:""}},computed:Object(r["a"])({},Object(o["e"])({userId:function(e){return e.user.userInfo.id}})),methods:{getRoleList:function(){var e=this;this.roleLoading=!0;var t={page:this.roleCurrpage,limit:this.rolePageSize};return this.roleQueryStr&&""!==this.roleQueryStr&&(t.queryStr=this.roleQueryStr),new Promise((function(i,r){Object(n["J"])(t).then((function(t){var r=t.data,n=t.error;e.roleLoading=!1,n?e.$message.error({message:"查询角色失败!".concat(n.message)}):(e.roleList=r.rows,e.roleTotal=r.total,i())}))}))},getUsers:function(){var e=this;this.userLoading=!0;var t={page:this.userCurrpage,limit:this.userPageSize};return this.deptId&&""!==this.deptId&&(t.deptId=this.deptId),""!==this.locked&&(t.locked=this.locked),""!==this.userQueryStr&&(t.keyWord=this.userQueryStr),new Promise((function(i){Object(n["P"])(t).then((function(t){var r=t.data;e.userLoading=!1,e.userList=r.rows,e.userTotal=r.total,i()}))}))},handleClick:function(e){this.userCurrpage=e,this.getUsers()},handleSizeChange:function(e){this.userPageSize=e,this.getUsers()},handleRoleSearchChange:function(){this.roleCurrpage=1,this.getRoleList()},handleDeptChange:function(e){var t=Object(s["b"])(this.departments,"id",e[0]);t&&t.children?this.offices=t.children:this.offices=[],this.office=""},initDeptments:function(){var e=this;Object(n["k"])().then((function(t){var i=t.data;e.departments=i}))}}}},6062:function(e,t,i){"use strict";var r=i("6d61"),n=i("6566");e.exports=r("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n)},6566:function(e,t,i){"use strict";var r=i("9bf2").f,n=i("7c73"),s=i("e2cc"),o=i("0366"),a=i("19aa"),l=i("2266"),c=i("7dd0"),u=i("2626"),d=i("83ab"),h=i("f183").fastKey,f=i("69f3"),p=f.set,g=f.getterFor;e.exports={getConstructor:function(e,t,i,c){var u=e((function(e,r){a(e,u,t),p(e,{type:t,index:n(null),first:void 0,last:void 0,size:0}),d||(e.size=0),void 0!=r&&l(r,e[c],e,i)})),f=g(t),v=function(e,t,i){var r,n,s=f(e),o=m(e,t);return o?o.value=i:(s.last=o={index:n=h(t,!0),key:t,value:i,previous:r=s.last,next:void 0,removed:!1},s.first||(s.first=o),r&&(r.next=o),d?s.size++:e.size++,"F"!==n&&(s.index[n]=o)),e},m=function(e,t){var i,r=f(e),n=h(t);if("F"!==n)return r.index[n];for(i=r.first;i;i=i.next)if(i.key==t)return i};return s(u.prototype,{clear:function(){var e=this,t=f(e),i=t.index,r=t.first;while(r)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete i[r.index],r=r.next;t.first=t.last=void 0,d?t.size=0:e.size=0},delete:function(e){var t=this,i=f(t),r=m(t,e);if(r){var n=r.next,s=r.previous;delete i.index[r.index],r.removed=!0,s&&(s.next=n),n&&(n.previous=s),i.first==r&&(i.first=n),i.last==r&&(i.last=s),d?i.size--:t.size--}return!!r},forEach:function(e){var t,i=f(this),r=o(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:i.first){r(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!m(this,e)}}),s(u.prototype,i?{get:function(e){var t=m(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),d&&r(u.prototype,"size",{get:function(){return f(this).size}}),u},setStrong:function(e,t,i){var r=t+" Iterator",n=g(t),s=g(r);c(e,t,(function(e,t){p(this,{type:r,target:e,state:n(e),kind:t,last:void 0})}),(function(){var e=s(this),t=e.kind,i=e.last;while(i&&i.removed)i=i.previous;return e.target&&(e.last=i=i?i.next:e.state.first)?"keys"==t?{value:i.key,done:!1}:"values"==t?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),i?"entries":"values",!i,!0),u(t)}}},"6d61":function(e,t,i){"use strict";var r=i("23e7"),n=i("da84"),s=i("94ca"),o=i("6eeb"),a=i("f183"),l=i("2266"),c=i("19aa"),u=i("861d"),d=i("d039"),h=i("1c7e"),f=i("d44e"),p=i("7156");e.exports=function(e,t,i){var g=-1!==e.indexOf("Map"),v=-1!==e.indexOf("Weak"),m=g?"set":"add",b=n[e],y=b&&b.prototype,x=b,w={},k=function(e){var t=y[e];o(y,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(v&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!u(e))&&t.call(this,0===e?0:e)}:function(e,i){return t.call(this,0===e?0:e,i),this})};if(s(e,"function"!=typeof b||!(v||y.forEach&&!d((function(){(new b).entries().next()})))))x=i.getConstructor(t,e,g,m),a.REQUIRED=!0;else if(s(e,!0)){var O=new x,S=O[m](v?{}:-0,1)!=O,C=d((function(){O.has(1)})),F=h((function(e){new b(e)})),E=!v&&d((function(){var e=new b,t=5;while(t--)e[m](t,t);return!e.has(-0)}));F||(x=t((function(t,i){c(t,x,e);var r=p(new b,t,x);return void 0!=i&&l(i,r[m],r,g),r})),x.prototype=y,y.constructor=x),(C||E)&&(k("delete"),k("has"),g&&k("get")),(E||S)&&k(m),v&&y.clear&&delete y.clear}return w[e]=x,r({global:!0,forced:x!=b},w),f(x,e),v||i.setStrong(x,e,g),x}},"74c3":function(e,t,i){},bb2f:function(e,t,i){var r=i("d039");e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},d547:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return s}));i("99af"),i("4de4"),i("4160"),i("a630"),i("d81d"),i("d3b7"),i("ac1f"),i("25f0"),i("6062"),i("3ca3"),i("5319"),i("159b"),i("ddb0"),i("c1df"),i("ca00"),i("c24f");function r(e,t,i){for(var r=0;r<e.length;r+=1)if(e[r][t]===i)return e[r]}function n(e,t,i){for(var r=0;r<e.length;r+=1){var s=e[r];if(s.children){var o=n(s.children,t,i);if(o)return o}else if(e[r][t]===i)return e[r]}}function s(e,t){var i=new Set(t),r=Array.from(new Set(e.filter((function(e){return i.has(e)}))));return r}},ddec:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"roleDialog"},[i("simple-dialog",{attrs:{bottonShow:e.bottonShow,"dialog-title":e.dialogTitle,"dialog-visible":e.dialogVisible,"dialog-width":"1000px","save-text":"确 定","cancel-text":"取 消","botton-show":"true"},on:{"update:dialogVisible":function(t){e.dialogVisible=t},"update:dialog-visible":function(t){e.dialogVisible=t},saveEmit:e.setRoleAdd,cancelEmit:e.cancelRoleAdd}},[i("el-form",{ref:"numberValidateForm",staticClass:"form-data-wrap",attrs:{model:e.roleUser,"label-width":"100px",rules:e.roleRules,disabled:e.disableEdit}},["3"!==e.roleOperType&&"4"!==e.roleOperType?i("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"角色名称：",prop:"name"}},[i("el-input",{staticClass:"input",staticStyle:{width:"100%"},attrs:{placeholder:"请填写角色名称"},model:{value:e.roleUser.name,callback:function(t){e.$set(e.roleUser,"name",t)},expression:"roleUser.name"}})],1):e._e(),"3"!==e.roleOperType&&"4"!==e.roleOperType?i("el-form-item",{attrs:{prop:"description",label:"角色描述："}},[i("el-input",{staticClass:"input",staticStyle:{width:"100%"},attrs:{placeholder:"请填写角色描述"},model:{value:e.roleUser.description,callback:function(t){e.$set(e.roleUser,"description",t)},expression:"roleUser.description"}})],1):e._e(),i("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{prop:"actions",label:"角色授权："}},[i("div",{staticClass:"form-tree-wrap"},[i("el-tree",{key:"tree",ref:"tree",attrs:{data:e.trees,"show-checkbox":"","node-key":"id","default-checked-keys":e.menus,"render-after-expand":!1,props:e.defaultProps},on:{"check-change":e.handleActionsChange},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,n=t.data;return i("div",{staticClass:"info-item"},[i("div",{staticClass:"label"},[i("span",{staticClass:"menu-title"},[e._v(e._s(r.label))])]),0===n.children.length&&0!==n.actions.length?i("div",{staticClass:"content action"},[i("el-checkbox-group",{on:{change:function(e){return n.doOperateChange(e,n.id)}},model:{value:e.actionFlag["menu_"+n.id],callback:function(t){e.$set(e.actionFlag,"menu_"+n.id,t)},expression:"actionFlag[`menu_${data.id}`]"}},[n&&n.actions?i("el-row",e._l(n.actions,(function(t){return i("el-col",{key:t.id,staticClass:"box-col",attrs:{span:6}},[i("el-checkbox",{attrs:{checked:t.checked,label:t.id}},[e._v(e._s(t.name))])],1)})),1):e._e()],1)],1):e._e()])}}])})],1)])],1)],1)],1)},n=[],s=(i("a4d3"),i("e01a"),i("99af"),i("4160"),i("c975"),i("a434"),i("b0c0"),i("b64b"),i("159b"),i("5530")),o=i("2909"),a=i("4b25"),l=i("0644"),c=i.n(l),u=i("fd85"),d={name:"RoleDetail",mixins:[a["a"]],props:["roleOperType"],data:function(){return{status:!1,dialogTitle:"新增角色",dialogVisible:!1,roleUser:{name:"",description:""},roleRules:{name:[{required:!0,trigger:"change",message:"角色名称不能为空"},{max:20,trigger:["blur","change"],message:"角色名称长度不能超过20个字符"}],description:[{required:!0,trigger:"change",message:"角色描述不能为空"},{max:200,trigger:["blur","change"],message:"角色描述长度不能超过200字符"}]},menus:[],defaultProps:{children:"children",label:"title",disabled:this.treeDisabledFn},parentIdList:[],bottonShow:!0,opering:!1,disableEdit:!1}},created:function(){this.initMenu()},methods:{handleOperateChange:function(e,t){var i=this.menus.indexOf(t);e&&e.length>0?-1===i&&(this.opering=!0,this.$refs.tree.setChecked(t,!0,!1)):-1!==i&&(this.opering=!0,this.$refs.tree.setChecked(t,!1,!1))},queryRoleAuth:function(e){var t=this;Object(u["D"])({roleId:e.id}).then((function(i){var r=i.data,n=i.error;if(n)t.$message.error("获取角色授权信息失败：".concat(n.message,";"));else{t.roleUser.name=r.name,t.roleUser.description=r.description,t.roleUser.id=e.id;var s=[];r.roleRegionVoList.forEach((function(e){s.push.apply(s,Object(o["a"])(e.actions))})),t.initActionFlag(s)}}))},showAddInfo:function(e,t,i){var r=this;this.dialogVisible=!0,e&&"1"===i?(this.dialogTitle="编辑角色",this.bottonShow=!0,this.queryRoleAuth(t)):e&&"2"===i?(this.bottonShow=!1,this.dialogTitle="查看详情",this.disableEdit=!0,this.queryRoleAuth(t)):e&&"4"===i?(this.dialogTitle="角色授权-修改",this.bottonShow=!0,this.queryRoleAuth(t)):e||"0"!==i?e||"3"!==i||(this.dialogTitle="角色授权",t.id?this.queryRoleAuth(t):(this.roleUser.name=t.name,this.roleUser.description="岗位".concat(name,"的内置角色")),this.bottonShow=!0):(this.dialogTitle="新增角色",this.bottonShow=!0),setTimeout((function(){r.status=!0}),1e3)},setRoleAdd:function(){var e=this;this.$refs.numberValidateForm.validate((function(t){if(!t)return!1;var i=Object(s["a"])({},e.roleUser),r=[];Object.keys(e.actionFlag).forEach((function(t){r.push.apply(r,Object(o["a"])(e.actionFlag[t]))})),i.actions=r;var n=u["I"],a="修改";"新增角色"===e.dialogTitle&&(n=u["G"],a="新增"),"3"===e.roleOperType&&(i.type=2,n=e.roleUser.id?u["I"]:u["G"],a="授权"),n(i).then((function(t){var i=t.error,r=t.data;i?e.$message.error("角色".concat(a,"失败：").concat(i.message)):(e.$message.success("角色".concat(a,"成功")),"3"===e.roleOperType?e.$emit("complated",r):e.$emit("refresh"),e.cancelRoleAdd())}))}))},cancelRoleAdd:function(){this.dialogVisible=!1,this.status=!1,this.roleUser.name="",this.roleUser.description="",this.$refs.numberValidateForm.resetFields(),this.$refs.tree.setCheckedKeys([]),this.initActionFlag()},initMenu:function(){var e=this;Object(u["s"])().then((function(t){var i=t.data,r=t.error;r?e.$message.error("获取菜单信息失败：".concat(r.message,";")):(e.trees=i,e.initActionFlag())}))},initActionFlag:function(e){var t=this,i={},r=[];function n(s){s.forEach((function(s){if(s.children&&s.children.length>0)n(s.children);else{s.doOperateChange=t.handleOperateChange;var o=[];s.actions&&e&&(s.actions.forEach((function(t){e.indexOf(t.id)>-1&&o.push(t.id)})),o.length>0&&r.push(s.id)),i["menu_".concat(s.id)]=o}}))}n(this.trees),this.menus=r,this.actionFlag=c()(i)},getParentNode:function(e){1!==e.level&&(this.parentIdList.push(e.parent.data.id),this.getParentNode(e.parent))},treeDisabledFn:function(e,t){if(1===t.level)return!e.children||!e.children.length},handleActionsChange:function(e,t,i){if(this.status)if(t){if(0===e.children.length)if(this.menus.push(e.id),this.opering)this.opering=!1;else{var r=[];e.actions&&(e.actions.forEach((function(e){return r.push(e.id)})),this.actionFlag["menu_".concat(e.id)]=r)}}else{var n=this.menus.indexOf(e.id);n>-1&&(this.menus.splice(n,1),this.opering?this.opering=!1:this.actionFlag["menu_".concat(e.id)]=[])}}}},h=d,f=(i("09c1"),i("2877")),p=Object(f["a"])(h,r,n,!1,null,null,null);t["a"]=p.exports},f183:function(e,t,i){var r=i("d012"),n=i("861d"),s=i("5135"),o=i("9bf2").f,a=i("90e3"),l=i("bb2f"),c=a("meta"),u=0,d=Object.isExtensible||function(){return!0},h=function(e){o(e,c,{value:{objectID:"O"+ ++u,weakData:{}}})},f=function(e,t){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,c)){if(!d(e))return"F";if(!t)return"E";h(e)}return e[c].objectID},p=function(e,t){if(!s(e,c)){if(!d(e))return!0;if(!t)return!1;h(e)}return e[c].weakData},g=function(e){return l&&v.REQUIRED&&d(e)&&!s(e,c)&&h(e),e},v=e.exports={REQUIRED:!1,fastKey:f,getWeakData:p,onFreeze:g};r[c]=!0}}]);
//# sourceMappingURL=chunk-f1f5a7f6.76c8baa3.js.map