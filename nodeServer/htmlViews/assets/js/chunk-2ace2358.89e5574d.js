(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ace2358","chunk-3e904856"],{"05de":function(e,t,a){"use strict";var i=a("215e"),r=a.n(i);r.a},"0a50":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"preivew-grid-layout"},e._l(e.previewGrid,(function(t){return a("div",{directives:[{name:"show",rawName:"v-show",value:!t.empty,expression:"!block.empty"}],key:t.id,staticClass:"grid-item",style:{gridColumn:t.gridColumnStart+" / "+t.gridColumnEnd,gridRow:t.gridRowStart+" / "+t.gridRowEnd,margin:t.gridColumnEnd-1!==e.COLUMNS?"0 20px 20px 0":"0 0 20px 0"}},[a("TemplateBlock",{attrs:{preview:!0,"data-source":e.multipleData[t.id],block:t,beRelatedFromItemList:e.beRelatedFromItemList},on:{getRealContentById:e.getRealContentById,queryRelationDataset:e.queryRelationDataset,getDataByCard:e.getDataByCard}})],1)})),0)},r=[],o=(a("4de4"),a("4160"),a("c975"),a("d81d"),a("159b"),a("d4ec")),n=a("bee2"),l=a("262e"),s=a("2caf"),u=a("9ab4"),c=a("60a3"),d=a("ed5d"),_=a("4242"),f=a("cb9b"),p=a("ca00"),h=a("82d3"),m=a("2ef0"),b=a("8be5"),v=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.previewGrid=null,e.multipleData={},e.loading=!1,e}return Object(n["a"])(a,[{key:"initBlockParamsAndContent",value:function(e){var t=this;this.previewGrid.forEach((function(a){if(e){var i=Object(p["a"])(e,"blockId",a.goods);"table"===i.type&&i.columns.forEach((function(e){e.format&&(e.formatter=Object(b["b"])(e.format))})),a.goods=i}t.getRealContentById(a)}))}},{key:"initPreviewTemplate",value:function(){this.templateId?this.getTemplateDetail():(this.previewGrid=Object(m["cloneDeep"])(this.currentGrid),this.initBlockParamsAndContent())}},{key:"getTemplateDetail",value:function(){var e=this;this.loading=!0,Object(_["f"])({id:this.templateId}).then((function(t){var a=t.data,i=t.error;if(e.loading=!1,i)e.$message.error(i.message||"获取数据失败");else{var r=JSON.parse(d["a"].decode(a.style)),o=a.blocks;e.previewGrid=r,e.initBlockParamsAndContent(o)}}))}},{key:"getRealContentById",value:function(e){var t=this;if(e.goods&&"monitorSteps"!==e.goods.type){if(!e.goods||!e.goods.dataSetId)return;for(var a={viewId:e.goods.dataSetId},i=[],r=0,o=e.goods.queryParams.length;r<o;r++){var n=e.goods.queryParams[r];if(0===n.required&&!n.value)return;i.push({code:n.code,type:n.type,value:n.value})}a.queryParams=i,Object(f["f"])(a).then((function(a){var i=a.data,r=a.error;r?t.$message.error(r.message||"获取数据失败"):("table"===e.goods.type&&i.rows.forEach((function(e){e.isEdit=!0})),t.$set(t.multipleData,e.id,i.rows))}))}else{var l=e.goods?e.goods.stepsList:[];l.forEach((function(a,i){if(a.dataSetId){var r={viewId:a.dataSetId},o=[];e.goods.queryParams&&e.goods.queryParams.forEach((function(t){"monitorName"===t.code&&(t.value=e.goods.queryName),o.push({code:t.code,type:t.type,value:t.value})})),r.previewParams=o,Object(f["f"])(r).then((function(a){var r=a.data,o=a.error;if(o)t.$message.error(o.message||"获取数据失败");else{var n=Object(m["cloneDeep"])(t.multipleData);t.multipleData[e.id]?(n[e.id][i]=r.rows,t.multipleData=n):(n[e.id]=[],n[e.id][i]=r.rows,t.multipleData=n)}}))}}))}}},{key:"queryRelationDataset",value:function(e){var t=this;this.previewGrid&&this.previewGrid.forEach((function(a){if(a.goods&&a.goods.queryParams){var i=!1;a.goods.queryParams.forEach((function(a){if("chart"===e.type&&"3"===a.valueBy&&a.relationChart===e.relationBlock&&(i=!0,t.$set(a,"value",e[a.relationChartField])),"formItem"===e.type&&"2"===a.valueBy)for(var r=0,o=e.formItems.length;r<o;r++){var n=e.formItems[r];if(a.relationFormItem===n.formItemKey){i=!0,t.$set(a,"value",n.formItemValue);break}}})),i&&t.getRealContentById(a)}}))}},{key:"getDataByCard",value:function(e){var t=this;this.previewGrid&&this.previewGrid.forEach((function(a){if(a.goods&&"table"===a.goods.type&&a.goods.dataSetId){var i={viewId:a.goods.dataSetId,monitorName:e.monitorName};Object(f["f"])(i).then((function(e){var i=e.data,r=e.error;r?t.$message.error(r.message||"获取数据失败"):(i.rows.forEach((function(e){e.isEdit=!0})),t.$set(t.multipleData,a.id,i.rows))}))}}))}},{key:"COLUMNS",get:function(){return Object(b["c"])(this.previewGrid)}},{key:"beRelatedFromItemList",get:function(){var e=[];return this.previewGrid&&this.previewGrid.map((function(t){if(t&&t.goods&&t.goods.queryParams){var a=t.goods.queryParams.filter((function(e){return"2"===e.valueBy}));a.map((function(t){-1===e.indexOf(t.relationFormItem)&&e.push(t.relationFormItem)}))}})),e}}]),a}(c["e"]);Object(u["a"])([Object(c["c"])()],v.prototype,"templateId",void 0),Object(u["a"])([Object(c["c"])()],v.prototype,"currentGrid",void 0),v=Object(u["a"])([Object(c["a"])({components:{TemplateBlock:h["a"]}})],v);var y=v,g=y,O=(a("2ccc"),a("2877")),E=Object(O["a"])(g,i,r,!1,null,"f2968642",null);t["a"]=E.exports},1108:function(e,t,a){"use strict";var i=a("7c35"),r=a.n(i);r.a},"13d5":function(e,t,a){"use strict";var i=a("23e7"),r=a("d58f").left,o=a("a640"),n=a("ae40"),l=o("reduce"),s=n("reduce",{1:0});i({target:"Array",proto:!0,forced:!l||!s},{reduce:function(e){return r(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"187f":function(e,t,a){},"1c0e":function(e,t,a){},"215e":function(e,t,a){},"246a":function(e,t,a){},"255f":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit_container",staticStyle:{height:"158px"}},[a("quill-editor",{ref:"myQuillEditor",staticClass:"quillEditor",attrs:{options:e.editorOption,disabled:e.disable},on:{blur:function(t){return e.onEditBlur(e.itemValue.value)},focus:function(t){return e.onEditorFocus(t)},ready:function(t){return e.onEditorReady(t)},change:function(t){return e.alertValue(t,400,e.decimalNum)}},model:{value:e.itemValue.value,callback:function(t){e.$set(e.itemValue,"value",t)},expression:"itemValue.value"}})],1)},r=[],o=a("953d"),n=(a("a7539"),a("8096"),a("14e1"),{name:"QuillEditor",components:{quillEditor:o["quillEditor"]},data:function(){return{content:"<p>hello world</p>",editorOption:{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}][{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}][{size:["small",!1,"large","huge"]}]]},theme:"snow"}}},props:{onEditBlur:{type:Function,default:function(){return""}},itemValue:{type:Object,default:function(){}},disable:{type:Boolean,default:!1}},computed:{editor:function(){return this.$refs.myQuillEditor.quill}},methods:{onEditorBlur:function(e){console.log(e,"itemValue"),this.$emit("onEditorBlur",e)},onEditorFocus:function(){},onEditorReady:function(){},saveHtml:function(e){alert(this.itemValue)},alertValue:function(e,t,a){}}}),l=n,s=a("2877"),u=Object(s["a"])(l,i,r,!1,null,null,null);t["a"]=u.exports},2827:function(e,t,a){},"2ccc":function(e,t,a){"use strict";var i=a("1c0e"),r=a.n(i);r.a},"3e81":function(e,t,a){"use strict";var i=a("c0aa"),r=a.n(i);r.a},"3ef9":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PreviewFormMixin}));var core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("99af"),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_every__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("a623"),core_js_modules_es_array_every__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_every__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("4de4"),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_find_index__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("c740"),core_js_modules_es_array_find_index__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_find_index__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("4160"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_array_from__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("a630"),core_js_modules_es_array_from__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_array_from__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("c975"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("a15b"),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_array_last_index_of__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("baa5"),core_js_modules_es_array_last_index_of__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_array_last_index_of__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("d81d"),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_array_some__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("45fc"),core_js_modules_es_array_some__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_array_some__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("a434"),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("b0c0"),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("a9e3"),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("b64b"),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_15__),core_js_modules_es_regexp_constructor__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("4d63"),core_js_modules_es_regexp_constructor__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(core_js_modules_es_regexp_constructor__WEBPACK_IMPORTED_MODULE_16__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("ac1f"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_17__),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("25f0"),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_18__),core_js_modules_es_set__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("6062"),core_js_modules_es_set__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(core_js_modules_es_set__WEBPACK_IMPORTED_MODULE_19__),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("3ca3"),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_20__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("5319"),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_21__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("1276"),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_22__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_23__),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("ddb0"),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_24__),D_projects_cjhx_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("53ca"),D_projects_cjhx_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("2909"),D_projects_cjhx_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("ade3"),D_projects_cjhx_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("5530"),D_projects_cjhx_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("d4ec"),D_projects_cjhx_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("bee2"),D_projects_cjhx_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__("262e"),D_projects_cjhx_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__("2caf"),tslib__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__("9ab4"),vue_property_decorator__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__("60a3"),moment__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__("c1df"),moment__WEBPACK_IMPORTED_MODULE_35___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_35__),lodash__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__("2ef0"),lodash__WEBPACK_IMPORTED_MODULE_36___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_36__),_utils_util__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__("ca00"),_utils_storage__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__("5d2d"),_api_processAssignment__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__("5bd2"),_api_viewData__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__("cb9b"),PreviewFormMixin=function(_Vue){Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_31__["a"])(PreviewFormMixin,_Vue);var _super=Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_32__["a"])(PreviewFormMixin);function PreviewFormMixin(){var e;return Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_29__["a"])(this,PreviewFormMixin),e=_super.apply(this,arguments),e.formAttributeAlert={},e.userCode="",e.fileList=[],e.modifysVisible=!1,e.dialogSwitch=!1,e.dialogTitle="新增",e.labelTable="",e.modifyHistoryList=[],e.modifyColumns=[],e.addTableList=[],e.formConfig={},e.tableCompareContainer=[],e.tableCompareColumns=[],e.historyLoading=!1,e.editMarks={},e.nameScript="",e.scriptList={},e.uploadHeader={Authorization:Object(_utils_storage__WEBPACK_IMPORTED_MODULE_38__["a"])("auth_token")},e.childFromExist=!1,e.importFiles=[],e.importDialogVisible=!1,e.loading=!1,e.uploadTableKey="",e.lastCall=null,e.commonHistoryColumns=[{prop:"taskName",label:"修改节点","header-align":"left",align:"left"},{prop:"value",label:"修改结果","header-align":"left",align:"left"},{prop:"handler",label:"修改人","header-align":"left",align:"left"},{prop:"taskTime",label:"修改时间","header-align":"left",align:"left"}],e}return Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_30__["a"])(PreviewFormMixin,[{key:"getVisible",value:function(e){var t="";try{t=JSON.stringify(this.formConfig)}catch(a){console.log(a)}JSON.stringify(e)!==t&&e&&e.formList&&("preview"!==this.mode?this.renderView(e):this.refreshView(e))}},{key:"refreshView",value:function(e){this.formConfig=e}},{key:"renderView",value:function(e){var t=this;this.formConfig=Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_28__["a"])({},e),this.formConfig.formList.forEach((function(e){1!==e.editable&&1!==e.readable||("table"!==e.type?(t.registerChangeListeners(e),e.filterText&&e.filterText.length>0&&e.filterText.forEach((function(a){return t.addFormLinkFields(e,a.textLinkValue)}))):t.loadTableCols(e),t.defaultValueBind(e),t.loadShowConfig(e))})),this.formConfig.formList.forEach((function(e){1!==e.editable&&1!==e.readable||("select"===e.type||"checkboxGroup"===e.type||"radioGroup"===e.type||"transfer"===e.type?(t.$set(e,"optionsList",[]),t.$set(e,"optionsType",""),"dataView"===e.sourceDataType?setTimeout((function(){e.dataQueryList.length>0?t.listQueryHandle(e,e.dataQueryList,e.dataSetVal,"selectView"):t.dataViewQueryHandle(e.dataSetVal,e,"selectView")}),500):"variable"===e.sourceDataType?e.flowVisibleCode&&t.getFlowVariablehttp("variableChange",e):"static"===e.sourceDataType&&e.value&&setTimeout((function(){e.listeners&&e.listeners.change&&e.listeners.change(e.value,"auto")}),500)):"table"===e.type&&(!e.refreshLoading&&e.datas&&e.datas.length>0?t.loadTableData(e,e.datas):(e.datas=[],Object.prototype.hasOwnProperty.call(e,"defaultValue")&&e.defaultValue.valueShow?t.scriptComputHandle(e,e.defaultValue,"tableDefault"):e.mutexSetList&&e.mutexSetList.length>0?t.mutexTableLoading(e):e.flowVisibleCode?t.getFlowVariablehttp("table",e):e.dataQueryList.length>0?t.listQueryHandle(e,e.dataQueryList,e.dataSetVal,"table"):t.dataViewQueryHandle(e.dataSetVal,e,"table"))))}))}},{key:"debunceInput",value:function(e,t,a,i){var r=this;this.lastCall&&clearTimeout(this.lastCall),this.lastCall=setTimeout((function(){r.handleDoInput(e,t,a,i,!1)}),500)}},{key:"handleDoInput",value:function(e,t,a,i,r){var o=this.editMarks[i],n={prop:t};if(r?n["preValue"]=a:n["value"]=a,o){var l=o[e];if(l){var s=l.findIndex((function(e){return e.prop===t}));-1===s?l.push(n):l[s]["value"]=a}else this.$set(o,e,[n]);r||this.handleTableColScript(e,t,i)}else this.$set(this.editMarks,i,Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_27__["a"])({},e,[n]))}},{key:"handleTableColScript",value:function(e,t,a){var i=this,r=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(this.formConfig.formList,"key",a);r.scriptObservers&&r.scriptObservers.forEach((function(a){"staticDefaultValue"!==a.handleType&&"hiddenDatas"!==a.handleType||a.extendObj2.dataItem.editMarkIndex===e&&a.extendObj.value===t&&i.scriptComputHandle(a.item,a.scriptConfig,a.handleType,a.extendObj,a.extendObj2),"defaultValue"===a.handleType&&i.scriptComputHandle(a.item,a.scriptConfig,a.handleType,a.extendObj,a.extendObj2)}))}},{key:"handleTableDatasChange",value:function(e){var t=this;this.computTableColEditControl(e),this.staticColumnDefaultValue(e),e.listeners&&e.scriptObservers&&e.scriptObservers.forEach((function(a){"staticDefaultValue"!==a.handleType&&"hiddenDatas"!==a.handleType&&(a.extendObj.resultValue=e.datas,t.scriptComputHandle(a.item,a.scriptConfig,a.handleType,a.extendObj,a.extendObj2))}))}},{key:"loadTableCols",value:function(e){var t=this;e.addSetList&&e.addSetList.length>0&&e.addSetList.forEach((function(a){if(a.showValueConfig)if(e.oriCols||(e.oriCols=e.cols),"form"===a.showValueConfig.showType){var i=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(t.formConfig.formList,"key",a.showValueConfig.valueShow);if(i){i.expandObservers||(i.expandObservers=[]);for(var r=!0,o=0;o<i.expandObservers.length;o++){var n=i.expandObservers[o];if(n.childKey===e.key&&n.extendColName===a.extendColName){r=!1;break}}r&&i.expandObservers.push(Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_28__["a"])(Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_28__["a"])({},a),{},{childKey:e.key})),i.listeners||t.registerChangeListeners(i),a.showValueConfig.bindField&&t.addFormLinkFields(i,a.showValueConfig.bindField),(i.value||!1===i.value)&&t.computeColsShowHide(i)}}else"variable"===a.showValueConfig.showType?t.doFlowVariableQuery(a.showValueConfig.valueShow).then((function(i){if(i||""===i){var r="none";t.computVaild(a.showValueConfig.symbolShow,i?Array.isArray(i)?i.join(","):i:"",a.showValueConfig.inputValue,a.showValueConfig)&&(r="show"),a.showForm=r,t.doExtendColsHidden(e,a)}})):"script"===a.showValueConfig.showType&&t.scriptComputHandle(e,a.showValueConfig,"tableCols",null,a)}))}},{key:"computeColsShowHide",value:function(e){var t=this;e.expandObservers&&e.expandObservers.forEach((function(a){t.$set(a,"showForm",t.vaildFormShow(a.showValueConfig,e,e.value));var i=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(t.formConfig.formList,"key",a.childKey);t.doExtendColsHidden(i,a)}))}},{key:"doExtendColsHidden",value:function(e,t){var a=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(e.addSetList,"extendColName",t.extendColName);if(a){var i=Object(lodash__WEBPACK_IMPORTED_MODULE_36__["cloneDeep"])(e.cols);a.colsAdd.forEach((function(a){var r=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(i,"fieldCode",a.fieldCode);if(r)if("none"===t.showForm)r.hidden=!0;else{var o=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(e.oriCols,"fieldCode",a.fieldCode);o&&(r.hidden=o.hidden)}})),e.cols=i}}},{key:"loadShowConfig",value:function(e){var t=this;if(!e.showValueConfig&&e.valueShow&&(e.showValueConfig={showType:e.showType,valueShow:e.valueShow,targetType:e.targetType,bindField:e.bindField,symbolShow:e.symbolShow,inputValue:e.inputValue,parameterList:e.parameterList}),e.showValueConfig){var a=e.showValueConfig;if("form"===a.showType){var i=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(this.formConfig.formList,"key",a.valueShow);i&&(i.value&&(e.showForm=this.vaildFormShow(a,i,i.value)),i.showObservers||(i.showObservers=[]),Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(i.showObservers,"key",e.key)||i.showObservers.push(e),i.listeners||this.registerChangeListeners(i),a.bindField&&this.addFormLinkFields(i,a.bindField))}else"variable"===a.showType?this.doFlowVariableQuery(a.valueShow).then((function(i){if(i||""===i){var r="none";t.computVaild(a.symbolShow,i?Array.isArray(i)?i.join(","):i:"",a.inputValue,a)&&(r="show"),t.$set(e,"showForm",r)}})):"script"===a.showType&&this.scriptComputHandle(e,a,"showAndHidden")}}},{key:"addFormLinkFields",value:function(e,t){e.linkFields?e.linkFields instanceof Array&&(e.linkFields=new Set(e.linkFields)):e.linkFields=new Set,e.linkFields.add(t)}},{key:"registerChangeListeners",value:function(e){var t=this;this.$set(e,"listeners",{change:function(a,i){"auto"!==i&&"table"!==e.type&&t.$set(t.editMarks,e.key,a),e.filterObservers&&e.filterObservers.forEach((function(e){t.datasFilter(e)})),e.showObservers&&e.showObservers.forEach((function(i){t.$set(i,"showForm",t.vaildFormShow(i.showValueConfig,e,a))})),e.queryObservers&&e.queryObservers.forEach((function(a){a.linkSetItem.resultValue=t.getFormLinkValue(e,a.linkSetItem),t.listQueryHandle(a.item,a.dataQueryList,a.viewsId,a.typeData,a.extendObj)})),t.emitDVEvent(e),e.scriptObservers&&e.scriptObservers.forEach((function(a){a.extendObj.resultValue=t.getFormLinkValue(e,a.extendObj),"staticDefaultValue"!==a.handleType&&"hiddenDatas"!==a.handleType?t.scriptComputHandle(a.item,a.scriptConfig,a.handleType,a.extendObj,a.extendObj2):t.doStaticColumnComput(a.item,a.extendObj2.def,a.extendObj,a.handleType,a.extendObj2.headIndex)})),t.computeColsShowHide(e),e.internalObservers&&e.internalObservers.forEach((function(e){t.buttonChange(e)}))}})}},{key:"emitDVEvent",value:function(e){var t=this;e.dvObservers&&e.dvObservers.forEach((function(a){if("table"===a.type)a.cols.forEach((function(i){var r="",o="";if(0===i.fieldType?o="string":1===i.fieldType?o="number":2===i.fieldType?o="date":3===i.fieldType&&(o="boolean"),i.defaultList&&"bind"===i.defaultList.cfgType)if("tableSta"===i.defaultList.bindType)a.datas.forEach((function(e){var r=a.datas.some((function(e){return""===e[i.prop]}));!0===r&&a.datas.forEach((function(e){e[i.prop]=t.computDefaultValue(e[i.defaultList.bindTarget],o,i.defaultList.bindExpress)}))}));else{r=t.getFormLinkValue(e,i.defaultList);var n=t.computDefaultValue(r,o,i.defaultList.bindExpress),l=a.datas.some((function(e){return""===e[i.prop]}));!0===l&&a.datas.forEach((function(e){e[i.prop]=n}))}}));else{var i=a.defaultValue,r=t.getFormLinkValue(e,i);a.value=t.computDefaultValue(r,a.type,i.bindExpress),Object.prototype.hasOwnProperty.call(a,"realValue")&&t.setFormatWapper(a)}(a.value||""===e.entity)&&a.listeners&&a.listeners.change&&a.listeners.change(a.value,"auto")}))}},{key:"doFlowVariableQuery",value:function(e){var t=this;return new Promise((function(a,i){var r=e;Array.isArray(e)||(r=[e]),Object(_api_processAssignment__WEBPACK_IMPORTED_MODULE_39__["p"])({taskId:t.taskId,expresses:r}).then((function(i){var r=i.data,o=i.error;if(o)t.$message.error(o.message);else if(Array.isArray(e))a(r);else{var n=r[e];n&&0!==n.length||(n=null),a(n)}}))}))}},{key:"getFlowVariablehttp",value:function(e,t){var a=this;this.doFlowVariableQuery(t.flowVisibleCode).then((function(i){if(i)if("variableChange"===e){var r=[];i.forEach((function(e){r.push({value:e[t.dataValue],label:e[t.dataLabel]})})),a.$set(t,"optionsList",r),a.$set(t,"textListLabel",i),a.$set(t,"optionsType","viewsData"),t.value&&t.listeners&&t.listeners.change(t.value),"select"!==t.type&&"transfer"!==t.type||a.datasFilter(t)}else"table"===e&&i.length>0&&(t.cols.some((function(e){return e.prop&&e.prop.indexOf(".")>-1}))?a.loadTableData(t,i):a.loadTableData(t,a.washTableFlowVariable(i)))}))}},{key:"mutexTableLoading",value:function(e){var t=this,a=[e.flowVisibleCode].concat(Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_26__["a"])(e.mutexSetList.map((function(e){return e.addDataSetVal}))));this.doFlowVariableQuery(a).then((function(i){if(i)for(var r=0;r<a.length;r++){var o=i[a[r]];if(o&&o.length>0){a[r]!==e.flowVisibleCode?function(){o=t.washTableFlowVariable(o);var i=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(e.mutexSetList,"addDataSetVal",a[r]);i.addViewDataLists&&i.addViewDataLists.length>0&&o.forEach((function(e){i.addViewDataLists.forEach((function(t){e[t["prop"]]=e[t["bindProp"]]}))})),t.loadTableData(e,o)}():e.cols.some((function(e){return e.prop&&e.prop.indexOf(".")>-1}))?t.loadTableData(e,o):t.loadTableData(e,t.washTableFlowVariable(o));break}}}))}},{key:"washTableFlowVariable",value:function(e){return e.map((function(e){var t={};return Object.keys(e).forEach((function(a){t[a.substring(a.lastIndexOf(".")+1)]=e[a]})),t}))}},{key:"defaultValueBind",value:function(e){var t=this;if(e.defaultValue){if(!e.value||0===e.value.length||e.defaultValue.ignoreCurrVal){var a=e.defaultValue;if("script"===a.cfgType)this.scriptComputHandle(e,a,"defaultValue");else if("form"===a.bindType){var i=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(this.formConfig.formList,"key",a.bindTarget);if(i){if(a.bindField&&this.addFormLinkFields(i,a.bindField),i.value){var r=this.getFormLinkValue(i,a);e.value=this.computDefaultValue(r,e.type,a.bindExpress),(e.value||""===e.value)&&e.listeners&&e.listeners.change&&e.listeners.change(e.value,"auto")}i.dvObservers||(i.dvObservers=[]),Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(i.dvObservers,"key",e.key)||i.dvObservers.push(e),i.listeners||this.registerChangeListeners(i)}}else"variable"===a.bindType?this.doFlowVariableQuery(a.bindTarget).then((function(i){i&&(e.value=t.computDefaultValue(Array.isArray(i)?i.join(","):i,e.type,a.bindExpress),(e.value||""===e.value)&&e.listeners&&e.listeners.change&&e.listeners.change(e.value,"auto"),Object.prototype.hasOwnProperty.call(e,"realValue")&&t.setFormatWapper(e))})):"static"===a.bindType?a.bindTarget&&("date"!==e.type||a.bindTarget||(a.bindTarget=moment__WEBPACK_IMPORTED_MODULE_35___default()().format("YYYY-MM-DD")),e.value=this.computDefaultValue(a.bindTarget,e.type,a.bindExpress),(e.value||""===e.value)&&e.listeners&&e.listeners.change&&e.listeners.change(e.value),Object.prototype.hasOwnProperty.call(e,"realValue")&&this.setFormatWapper(e)):"dataViews"===a.bindType&&this.buttonChange(e)}}else"childFrom"===e.type&&this.childFromChange(e);"number"===e.type&&(this.setFormatWapper(e),this.$set(e,"listeners",Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_28__["a"])(Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_28__["a"])({},e.listeners),{},{focus:function(){t.$set(e,"type","number"),t.$set(e,"value",e.realValue)},blur:function(){t.setFormatWapper(e)}})))}},{key:"setFormatWapper",value:function(e){var t;this.$set(e,"realValue",e.value),this.$set(e,"type","text"),t=e.accuracy||0===e.accuracy?Number(e.accuracy):2,this.$set(e,"value",Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["d"])(e.value,t))}},{key:"childFromChange",value:function(e){var t=!1;e.value&&e.value.formList&&e.value.formList.some((function(e){e.value&&e.value.length>0&&(t=!0)})),!1===t&&this.buttonChange(e)}},{key:"registerFormScriptParam",value:function(e,t,a,i,r){var o=null;if(r.resultValue&&0!==r.resultValue.length)o=r.resultValue;else{var n=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(this.formConfig.formList,"key",r.value);if(n){n.scriptObservers||(n.scriptObservers=[]);var l=!0;if("paramsButtonValue"===a||"resultButtonValue"===a)l=!1;else for(var s=0;s<n.scriptObservers.length;s++){var u=n.scriptObservers[s];if(u.item.key===e.key&&u.handleType===a){i?"tableCols"===a?u.extendObj2.extendColName===i.extendColName&&(l=!1):"staticDefaultValue"!==a&&"hiddenDatas"!==a||u.extendObj2.def.fieldCode===i.def.fieldCode&&(l=!1):l=!1;break}}l&&n.scriptObservers.push({item:e,scriptConfig:t,handleType:a,extendObj:r,extendObj2:i}),n.listeners||this.registerChangeListeners(n),r.bindField&&this.addFormLinkFields(n,r.bindField),"table"===n.type&&n.datas.length>0?o=n.datas:n.value&&(o=this.getFormLinkValue(n,r))}o&&(r.resultValue=o)}return o}},{key:"listQueryHandle",value:function(e,t,a,i){var r=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;t.length>0&&Promise.all(t.map((function(n){return new Promise((function(l,s){var u={};if(u["type"]=n.type,u["code"]=n.code,u["required"]=n.required,"fixed"===n.valueType)u["value"]=n.value,l(u);else if("form"===n.valueType)if(n.resultValue)u["value"]=n.resultValue,l(u);else{var c=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(r.formConfig.formList,"key",n.value);c&&(c.queryObservers||(c.queryObservers=[]),c.queryObservers.push({item:e,dataQueryList:t,viewsId:a,typeData:i,extendObj:o,linkSetItem:n}),c.listeners||r.registerChangeListeners(c),c.value?(u["value"]=r.getFormLinkValue(c,n),l(u)):s())}else"variable"===n.valueType?n.relationVal?(u["value"]=n.relationVal,l(u)):r.doFlowVariableQuery(n.value).then((function(e){e?(n.relationVal=Array.isArray(e)?e.join(","):e,u["value"]=n.relationVal,l(u)):s()})):l({})}))}))).then((function(t){t.every((function(e){var t=!0;return 0!==e.required||e.value&&0!==e.value.length||(t=!1),t}))&&r.dataViewQueryHandle(a,e,i,t.filter((function(e){return e["code"]})),o)})).catch((function(){}))}},{key:"scriptComputHandle",value:function scriptComputHandle(item,scriptConfig,handleType){var _this16=this,extendObj=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,extendObj2=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Promise.all(scriptConfig.parameterList.map((function(e){return new Promise((function(t,a){var i={label:e.label};if("fixed"===e.valueType)i["value"]=e.value,t(i);else if("form"===e.valueType){var r=_this16.registerFormScriptParam(item,scriptConfig,handleType,extendObj2,e);i["value"]=r||"",t(i)}else if("variable"===e.valueType)e.resultValue?(i["value"]=e.resultValue,t(i)):_this16.doFlowVariableQuery(e.value).then((function(a){a?(e.resultValue=Array.isArray(a)&&"object"!==Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_25__["a"])(a[0])?a.join(","):a,i["value"]=e.resultValue,t(i)):(e.resultValue="",i["value"]="",t(i))}));else if("tableSta"===e.valueType){var o=!1;if("paramsButtonValue"===handleType)i["value"]=extendObj2["row"][e.value];else{var n=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(item.datas,"editMarkIndex",extendObj2.dataItem["editMarkIndex"]);if(n){var l=n[e.value];l&&(i["value"]=l)}extendObj2["scriptFlag"]&&extendObj2["scriptFlag"]["".concat(handleType,"_").concat(e.value)]||(item.scriptObservers||(item.scriptObservers=[]),item.scriptObservers.push({item:item,scriptConfig:scriptConfig,handleType:handleType,extendObj:e,extendObj2:extendObj2}),item.listeners||_this16.registerChangeListeners(item),extendObj2["scriptFlag"]||(extendObj2["scriptFlag"]={}),extendObj2["scriptFlag"]["".concat(handleType,"_").concat(e.value)]=!0,"static"!==extendObj2.def.type&&(o=!0))}!o||extendObj2.ignoreFlag?t(i):a()}else if("serviceResponse"===e.valueType){if(e.value){var s=scriptConfig.returnData.map((function(t){return t[e.value]}));i["value"]=Array.isArray(s)?s.join(","):s}else i["value"]=scriptConfig.returnData;i["value"]?t(i):a()}}))}))).then((function(paramsValues){new Promise((function(resolve,reject){if("javascript"!==scriptConfig.scriptType&&scriptConfig.scriptType){if("meteorShower"===scriptConfig.scriptType){var meteorShower=scriptConfig.valueShow;paramsValues.forEach((function(e){meteorShower=meteorShower.replace(new RegExp(e["label"],"g"),'"'.concat(e["value"],'"'))})),Object(_api_processAssignment__WEBPACK_IMPORTED_MODULE_39__["q"])({script:meteorShower,taskId:_this16.taskId}).then((function(e){var t=e.data;resolve(t?Array.isArray(t)?t.join(","):t:"")}))}}else{var paramsList=paramsValues.map((function(e){return e.value}));if(scriptConfig.valueShow){var methodChage=eval("window.dealFormScript = ".concat(scriptConfig.valueShow));if("tableDefault"===handleType)for(var i=0;i<paramsList.length;i++)Array.isArray(paramsList[i])&&(paramsList[i]=_this16.washTableFlowVariable(paramsList[i]));resolve(methodChage.apply(void 0,Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_26__["a"])(paramsList)))}else reject()}})).then((function(e){if("defaultValue"===handleType)item.value=e,item.listeners&&item.listeners.change(item.value),Object.prototype.hasOwnProperty.call(item,"realValue")&&_this16.setFormatWapper(item);else if("showAndHidden"===handleType)_this16.$set(item,"showForm","none"),!0===e&&_this16.$set(item,"showForm","show");else if("tableCols"===handleType){var t="show";e&&"false"!==e||(t="none"),extendObj2.showForm=t,_this16.doExtendColsHidden(item,extendObj2)}else if("staticDefaultValue"===handleType){var a=Object(lodash__WEBPACK_IMPORTED_MODULE_36__["cloneDeep"])(Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(item.datas,"editMarkIndex",extendObj2.dataItem["editMarkIndex"]));if(a){a[scriptConfig.fieldCode]=e,item.datas.splice(extendObj2.ind,1,a);var i=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(item.oriDatas,"editMarkIndex",extendObj2.dataItem["editMarkIndex"]),r=!!e;if(i){var o=i[scriptConfig.fieldCode];i[scriptConfig.fieldCode]=e,r&&o==e&&(r=!1)}r&&_this16.handleDoInput(extendObj2.dataItem["editMarkIndex"],scriptConfig.fieldCode,e,item.key,!1)}}else if("hiddenDatas"===handleType)e?_this16.$set(extendObj.disable,extendObj2.headIndex,1):_this16.$set(extendObj.disable,extendObj2.headIndex,0);else if("paramsButtonValue"===handleType)scriptConfig.reqBody=e,_this16.fetchBtnService(extendObj2.row,extendObj2.btn,item);else if("ordinaryButtonParams"===handleType)scriptConfig.reqBody=e,_this16.fetchOrdinaryBtnService(extendObj2.linkPromise,item,extendObj2.linkDef);else if("resultButtonValue"===handleType)_this16.$set(extendObj2,scriptConfig.targetCol,e);else if("ordinaryButtonValue"===handleType){var n=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(_this16.formConfig.formList,"key",item.setLink.targetObjectBut.targetCol);_this16.formConfig.formList.forEach((function(t){t.key===n.key&&(t.value=e,item.setLink.targetObjectBut.targetTableCol?t.datas.forEach((function(t){t[item.setLink.targetObjectBut.targetTableCol]=e})):t.value=e)}))}else"defScriptValue"===handleType?item.value=e:"tableDefault"===handleType?_this16.loadTableData(item,e):"datasfilter"===handleType&&("table"===item.type?item.datas=e:item.optionsList=e.map((function(e){return{value:e[item.dataValue],label:e[item.dataLabel]}})))})).catch((function(){}))})).catch((function(){}))}},{key:"getViewQueryFields",value:function(e,t,a){var i=[];if("selectView"===t)e.linkFields&&Array.isArray(e.linkFields)?e.linkFields=new Set(e.linkFields):e.linkFields=new Set,e.linkFields.add(e.dataValue),e.linkFields.add(e.dataLabel),i=Array.from(e.linkFields);else if("tableChild"===t){var r=new Set(a.addViewDataLists.map((function(e){return e.addViewData})));a.addDataValue.forEach((function(e){return r.add(e)})),i=Array.from(r)}else if("table"===t){var o=new Set(e.associatedNodeList);e.addSetList&&e.addSetList.length>0&&e.addSetList.forEach((function(e){"addList"!==e.addSetType&&e.addViewDataLists.forEach((function(e){return e.addDataLink.indexOf("yss")>-1&&o.add(e.addDataLink)}))})),i=Array.from(o)}return i}},{key:"dataViewQueryHandle",value:function(e,t,a){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(e){var n={viewId:e,queryParams:r||[],authStationAndUsers:[{stationId:this.taskDealStationId,userCode:this.userCode}]};Object(_api_viewData__WEBPACK_IMPORTED_MODULE_40__["g"])(n).then((function(e){var r=e.data,n=e.error;if(n)return i.$message.error("查询数据视图结果失败:"+n.message),!1;if(r.rows&&r.rows.length>0)if("tableChild"===a)i.mergeExtendColsView(r.rows,o.addViewDataLists,o,t);else if("selectView"===a){var l=[];r.rows.forEach((function(e){if(Array.isArray(t.dataLabel)){var a=[];t.dataLabel.forEach((function(t,i){a.push(e[t])})),Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(l,"value",e[t.dataValue])||l.push({value:e[t.dataValue],label:a.join("-")})}else l.push({value:e[t.dataValue],label:e[t.dataLabel]})})),Array.isArray(t.dataLabel)&&t.dataLabel.length>1&&l.sort((function(e,t){return e["label"]>t["label"]?1:-1})),i.$set(t,"textListLabel",r.rows),i.$set(t,"optionsList",l),i.$set(t,"optionsType","viewsData"),t.value&&t.listeners&&t.listeners.change(t.value,"auto"),"select"!==t.type&&"transfer"!==t.type||i.datasFilter(t)}else"table"===a&&i.loadTableData(t,r.rows)}))}}},{key:"loadTableData",value:function(e,t){var a=this;if(t&&t.length>0){if(t.forEach((function(t,i){var r=null;e.refreshLoading&&e.loadingPrimKey.length>0?r=e.loadingPrimKey.map((function(e){return t[e]})).join("_"):t["editMarkIndex"]||(r="r".concat(i)),r&&a.$set(t,"editMarkIndex",r)})),e.oriDatas=t,this.datasFilter(e),"historyDetail"===this.mode)return!1;e.history&&this.queryItemImprint(e),e.addSetList&&e.addSetList.length>0&&e.addSetList.forEach((function(t){a.doExtendColsQuery(t,e)})),e.value&&e.listeners&&e.listeners.change(e.value)}}},{key:"doExtendColsQuery",value:function(e,t){var a=t.oriDatas;if("addList"===e.addSetType){if(e.tabList.length>0||e.colsAdd.length>0){var i=e.colsAdd.length>0?e.colsAdd:e.tabList;this.recordsHanle(a,t,i)}this.datasFilter(t)}else"addViewList"===e.addSetType?e.addDataQueryList.length>0?this.listQueryHandle(t,e.addDataQueryList,e.addDataSetVal,"tableChild",e):this.dataViewQueryHandle(e.addDataSetVal,t,"tableChild",[],e):"addFlowVariables"===e.addSetType&&this.addFlowVariablesLink(e,e.addViewDataLists,t,a)}},{key:"getFormLinkValue",value:function(e,t){var a="";if(t.bindField){if(e.textListLabel&&e.textListLabel.length>0){var i=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(e.textListLabel,e.dataValue,e.value);i&&(a=i[t.bindField])}this.addFormLinkFields(e,t.bindField)}else a=e.realValue?e.realValue:e.value;return a}},{key:"doStaticColumnComput",value:function(e,t,a,i,r){var o=this;e.datas.forEach((function(n,l){if("hiddenDatas"===i&&(n.disable=new Array(e.cols.length)),"static"===t.type&&"staticDefaultValue"===i&&n[t.fieldCode]);else{var s={dataItem:n,def:t,ind:l,headIndex:r,ignoreFlag:!0};o.scriptComputHandle(e,t.defaultList,i,a,s)}}))}},{key:"staticColumnDefaultValue",value:function(e){var t=this,a="";e.cols.forEach((function(i){if(i.defaultList)if(0===i.fieldType?a="string":1===i.fieldType?a="number":2===i.fieldType?a="date":3===i.fieldType&&(a="boolean"),"script"===i.defaultList.cfgType)if("static"!==i.type&&1!==i.editable);else{var r=[];i.defaultList.parameterList.forEach((function(a){a.resultValue||("variable"===a.valueType?r.push(a.value):"form"===a.valueType&&(a.resultValue=t.registerFormScriptParam(e,i.defaultList,"staticDefaultValue",{def:i},a)))})),new Promise((function(e){r.length>0?t.doFlowVariableQuery(r).then((function(t){t&&i.defaultList.parameterList.forEach((function(e){"variable"!==e.valueType||e.resultValue||(e["resultValue"]=t[e.value])})),e()})):e()})).then((function(){t.doStaticColumnComput(e,i,null,"staticDefaultValue",null)}))}else if("static"===i.defaultList.bindType){if(2!==i.fieldType||i.defaultList.bindTarget||(i.defaultList.bindTarget=moment__WEBPACK_IMPORTED_MODULE_35___default()().format("YYYY-MM-DD")),i.defaultList.bindTarget){var o=t.computDefaultValue(i.defaultList.bindTarget,a,i.defaultList.bindExpress),n=e.datas.some((function(e){return""===e[i.prop]}));!0===n&&e.datas.forEach((function(e){e[i.prop]=o}))}}else if("variable"===i.defaultList.bindType)new Promise((function(e){i.defaultList.resultValue?e():t.doFlowVariableQuery(i.defaultList.bindTarget).then((function(t){t&&(i.defaultList.resultValue=Array.isArray(t)?t.join(","):t),e()}))})).then((function(){var r=t.computDefaultValue(i.defaultList.resultValue,a,i.defaultList.bindExpress),o=e.datas.some((function(e){return""===e[i.prop]}));!0===o&&e.datas.forEach((function(e){e[i.prop]=r}))}));else if("form"===i.defaultList.bindType){var l=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(t.formConfig.formList,"key",i.defaultList.bindTarget);if(l){if(i.defaultList.bindField&&t.addFormLinkFields(l,i.defaultList.bindField),l.value){var s=t.getFormLinkValue(l,i.defaultList),u=t.computDefaultValue(s,a,i.defaultList.bindExpress),c=e.datas.some((function(e){return""===e[i.prop]}));!0===c&&e.datas.forEach((function(e){e[i.prop]=u}))}l.dvObservers||(l.dvObservers=[]),Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(l.dvObservers,"key",e.key)||l.dvObservers.push(e),l.listeners||t.registerChangeListeners(l)}}else"tableSta"===i.defaultList.bindType&&e.datas.forEach((function(r){var o=e.datas.some((function(e){return""===e[i.prop]}));!0===o&&e.datas.forEach((function(e){e[i.prop]=t.computDefaultValue(e[i.defaultList.bindTarget],a,i.defaultList.bindExpress)}))}))}))}},{key:"computTableColEditControl",value:function(e){var t=this;e.cols.forEach((function(a,i){if(a.staticList)if("script"===a.staticList.staticType){var r=a.staticList.showValueConfig,o=[];r.parameterList.forEach((function(n){n.resultValue||("variable"===n.valueType?o.push(n.value):"form"===n.valueType&&(n.resultValue=t.registerFormScriptParam(e,r,"hiddenDatas",{def:a,headIndex:i},n)))})),new Promise((function(e){o.length>0?t.doFlowVariableQuery(o).then((function(t){t&&r.parameterList.parameterList.forEach((function(e){"variable"!==e.valueType||e.resultValue||(e["resultValue"]=t[e.value])})),e()})):e()})).then((function(){t.doStaticColumnComput(e,a,null,"hiddenDatas",null)}))}else"tableSta"===a.staticList.staticType&&e.datas.forEach((function(r,o){r.disable=new Array(e.cols.length),a.staticList.staticDataList.forEach((function(e){t.computVaild(e.staticFilter,r[e.staticCheck]?r[e.staticCheck]:"",e.staticText,"")||t.$set(r.disable,i,0)}))}))})),e.datas.forEach((function(t,a){t.disable=new Array(e.cols.length)}))}},{key:"computDefaultValue",value:function(e,t,a){if(e){var i=e;if("date"===t)i=moment__WEBPACK_IMPORTED_MODULE_35___default()(e),a.year&&0!==a.year&&(1===a.yearSign&&(a.year=0-a.year),i=i.add(a.year,"years")),a.month&&0!==a.month&&(1===a.monthSign&&(a.month=0-a.month),i=i.add(a.month,"months")),a.day&&0!==a.day&&(1===a.daySign&&(a.day=0-a.day),i=i.add(a.day,"days")),i=i.format("YYYY-MM-DD");else if("number"===t&&(i=parseFloat(e),a.offset)){var r=parseFloat(a.offset);switch(a.sign){case 0:i+=r;break;case 1:i-=r;break;case 2:i*=r;break;case 3:i/=r;break}}return i}return""}},{key:"doDatasfilter",value:function(e,t,a,i){var r=this;return e.filter((function(e){var o=e[t];return r.computVaild(i,o,a,"")}))}},{key:"computVaild",value:function(e,t,a,i){var r=this;return"2"===i.relationship&&"variable"===i.showType?t.split(",").some((function(t){return r.targetFun(e,t,a,"item")})):"1"===i.relationship&&"variable"===i.showType?t.split(",").every((function(t){return r.targetFun(e,t,a,"item")})):this.targetFun(e,t,a,"all")}},{key:"targetFun",value:function(e,t,a,i){if("boolean"===typeof t?t="".concat(t):isNaN(t)||(t=parseFloat(t),a=parseFloat(a)),"1"===e||!e)return"item"===i?t===a:!t||"string"!==typeof t&&"object"!==Object(D_projects_cjhx_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_25__["a"])(t)||-1===t.indexOf(",")?t==a:t.indexOf(a)>-1;if("0"===e)return t>a;if("2"===e)return t<a;if("3"===e)return t!==a;if("4"===e)return t>=a;if("5"===e)return t<=a;if("6"===e){if(t)return t.indexOf(a)>-1}else if("7"===e&&t)return-1===t.indexOf(a)}},{key:"datasFilter",value:function(e){var t=this;e.filterText&&e.filterText.length>0&&(e.filterConfig={cfgType:"bind",filterText:e.filterText,strategy:"and"},e.filterText=null),e.filterConfig?"bind"===e.filterConfig.cfgType?e.filterConfig.filterText&&e.filterConfig.filterText.length>0&&Promise.all(e.filterConfig.filterText.map((function(a){return new Promise((function(i,r){var o={};if(a.textLinkValue)if("form"===a.filterType){var n=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(t.formConfig.formList,"key",a.textLink);n&&(o["textLinkValue"]=a.textLinkValue,o["textLinkMethod"]=a.textLinkMethod,o["value"]=n.value,i(o),n.filterObservers||(n.filterObservers=[]),Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(n.filterObservers,"key",e.key)||n.filterObservers.push(e),n.listeners||t.registerChangeListeners(n))}else"variable"===a.filterType?a.filterValue&&a.filterValue.length>0?(o["textLinkValue"]=a.textLinkValue,o["textLinkMethod"]=a.textLinkMethod,o["value"]=a.filterValue,i(o)):t.doFlowVariableQuery(a.textLink).then((function(e){e&&(e instanceof String||e.length>0)?(t.$set(a,"filterValue",e),o["textLinkValue"]=a.textLinkValue,o["textLinkMethod"]=a.textLinkMethod,o["value"]=e,i(o)):(t.$set(a,"filterValue",""),o["textLinkValue"]=a.textLinkValue,o["textLinkMethod"]=a.textLinkMethod,o["value"]="",i(o))})):"static"===a.filterType&&a.textLink&&(o["textLinkValue"]=a.textLinkValue,o["textLinkMethod"]=a.textLinkMethod,o["value"]=a.textLink,i(o))}))}))).then((function(a){var i="or"===e.filterConfig.strategy,r=function(e){return function(a){return a.value&&a.value instanceof Array?t.computVaild(a.textLinkMethod,e[a.textLinkValue],a.value.join(","),""):t.computVaild(a.textLinkMethod,e[a.textLinkValue],a.value,"")}};if("table"===e.type){var o=[];e.oriDatas.forEach((function(e){var t=r(e),n=i?a.some(t):a.every(t);!0===n&&o.push(e)})),e.datas=o,t.handleTableDatasChange(e)}else{var n=[];e.textListLabel.forEach((function(t){var o=r(t),l=i?a.some(o):a.every(o);!0===l&&n.push({value:t[e.dataValue],label:t[e.dataLabel]})})),t.$set(e,"optionsList",n)}})):(e.datas=e.oriDatas,e.filterConfig.pushDatas||(e.filterConfig.parameterList.push({label:"beFilterDatas",valueType:"fixed",value:"table"===e.type?e.oriDatas:e.textListLabel}),e.filterConfig.pushDatas=!0),this.scriptComputHandle(e,e.filterConfig,"datasfilter")):"table"===e.type&&(e.datas=e.oriDatas,this.handleTableDatasChange(e))}},{key:"recordsHanle",value:function(e,t,a){e.forEach((function(e,t){a.forEach((function(t){var a=t.fieldCode?t.fieldCode:t.prop;e[a]||(t.value?e[a]=t.value:e[a]="")}))})),t.datas=e}},{key:"addFlowVariablesLink",value:function(e,t,a,i){var r=this;e.addDataSetVal&&this.doFlowVariableQuery(e.addDataSetVal).then((function(i){if(i&&i.length>0){var o=i;a.cols.some((function(e){return e.prop&&e.prop.indexOf(".")>-1}))||(o=r.washTableFlowVariable(i)),r.mergeExtendColsView(o,t,e,a)}}))}},{key:"mergeExtendColsView",value:function(e,t,a,i){a.datas||(a.datas=e);var r=e;if(r){var o=Object(lodash__WEBPACK_IMPORTED_MODULE_36__["cloneDeep"])(i.oriDatas);o.forEach((function(e){var i=null;if(t.length>1)for(var o=function(a){var o=r[a];if(t.every((function(t){return o[t.addViewData]===e[t.addDataLink]})))return i=o,"break"},n=0;n<r.length;n++){var l=o(n);if("break"===l)break}else i=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(r,t[0].addViewData,e[t[0].addDataLink]);i&&a.addDataValue.forEach((function(t){e[t]||(e[t]=i[t])}))})),i.oriDatas=o,this.datasFilter(i)}}},{key:"computeCellClass",value:function(e){var t=e.row,a=(e.columnIndex,e.column);if(t.beModified&&Array.from(t.beModified).indexOf(a.property)>-1)return"red-alert"}},{key:"fileType",value:function(e){if(e){var t=e.lastIndexOf("."),a=e.length,i=e.substring(t+1,a);return"xlsx"===i||"xls"===i?"excel":"doc"===i||"docx"===i?"doc":"html"===i?"html":"pdf"===i?"pdf":"txt"===i?"txt":"jpg"===i||"jpeg"===i||"svg"===i||"png"===i||"bmp"===i||"gif"===i?"tupian":"wenjian"}}},{key:"download",value:function(e){Object(_api_processAssignment__WEBPACK_IMPORTED_MODULE_39__["a"])(e)}},{key:"showHistoryCompare",value:function(e){this.modifysVisible=!0,this.queryItemImprint(e)}},{key:"queryItemImprint",value:function(e){var t=this;this.historyLoading=!0,Object(_api_processAssignment__WEBPACK_IMPORTED_MODULE_39__["A"])(this.processInstanceId,e["key"]).then((function(a){var i=a.error,r=a.data;t.historyLoading=!1,!i&&r.length>0&&("table"===e["type"]?e["tableCompareContainer"]?(t.tableCompareContainer=e["tableCompareContainer"],t.tableCompareColumns=e["cols"].filter((function(e){return"操作"!==e.label&&!e.hidden}))):t.compareTableDatas(e,r):(t.tableCompareColumns=t.commonHistoryColumns,t.tableCompareContainer=r))}))}},{key:"compareTableDatas",value:function(e,t){var a=this,i=[];t.reverse(),t.forEach((function(t){Object.keys(t.value).forEach((function(r){var o=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(e.datas,"editMarkIndex",r);if(o){var n=null,l=null;o.beModified?(n=Object(lodash__WEBPACK_IMPORTED_MODULE_36__["cloneDeep"])(o.beModified),l=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(i,"editMarkIndex",r)):(n=new Set,l=Object(lodash__WEBPACK_IMPORTED_MODULE_36__["cloneDeep"])(o),i.push(l));var s=t["value"][r];s.forEach((function(t){t.value&&(n.add(t["prop"]),t.preValue?l[t["prop"]]=t.preValue:l[t["prop"]]="",l[t["prop"]]+=" -> ".concat(t.value),e.refreshLoading&&(o[t["prop"]]=t.value))})),a.$set(o,"beModified",n),l.beModified=n}}))})),i.length>0&&(e.tableCompareContainer=i,this.tableCompareContainer=e["tableCompareContainer"],this.tableCompareColumns=e["cols"].filter((function(e){return"操作"!==e.label&&!e.hidden})))}},{key:"uploadTable",value:function(e){this.uploadTableKey=e.key,this.importFiles=[],this.importDialogVisible=!this.importDialogVisible}},{key:"doUpload",value:function(){var e=this;0===this.importFiles.length?this.$message.error("请先选择要导入或上传的文件！"):this.$confirm("该操作可能会覆盖其余数据，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0;var t=new FormData;e.importFiles.forEach((function(e){return t.append("file",e.raw)})),Object(_api_processAssignment__WEBPACK_IMPORTED_MODULE_39__["P"])(t).then((function(t){var a=t.data,i=t.error;if(i)e.loading=!1,e.$message.error("导入失败：".concat(i.message));else{e.loading=!1,e.importDialogVisible=!e.importDialogVisible,e.$message.success("导入成功！"),e.editMarks[e.uploadTableKey]&&e.$delete(e.editMarks,e.uploadTableKey);var r=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(e.formConfig.formList,"key",e.uploadTableKey),o=Object(lodash__WEBPACK_IMPORTED_MODULE_36__["cloneDeep"])(r.cols),n=[];a.forEach((function(t){var a={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(o,"fieldName",i);r&&e.$set(a,r.prop,t[i])}n.push(a)})),e.loadTableData(r,n)}}))})).catch((function(){}))}},{key:"closeDialog",value:function(){var e=this.$refs.netUpload;e.clearFiles(),this.importDialogVisible=!this.importDialogVisible,this.loading=!1}},{key:"handleUploadFileChange",value:function(e,t){this.importFiles=t}},{key:"onRemove",value:function(e,t){this.importFiles=t}},{key:"exportTable",value:function(e){var t={headers:e.cols.filter((function(e){return!e.hidden})),rows:e.datas};Object(_api_processAssignment__WEBPACK_IMPORTED_MODULE_39__["O"])(t,"".concat(e.label,".xls"))}},{key:"vaildFormShow",value:function(e,t,a){var i="show";return e.bindField?this.computVaild(e.symbolShow,this.getFormLinkValue(t,e),e.inputValue,e)||(i="none"):this.computVaild(e.symbolShow,a,e.inputValue,e)||(i="none"),i}},{key:"addChange",value:function(e){var t=this;if(this.labelTable=e.key,e.addTemplate&&e.addTemplate.formList&&e.addTemplate.formList.length>0)this.childFromExist=!0,this.formAttributeAlert=Object(lodash__WEBPACK_IMPORTED_MODULE_36__["cloneDeep"])(e.addTemplate),this.formAttributeAlert.formList.forEach((function(e){t.$set(e,"showForm","show"),t.$set(e,"editable",1),"checkboxGroup"===e.type||"transfer"===e.type?t.$set(e,"value",[]):t.$set(e,"value","")}));else{this.childFromExist=!1;var a=Object(lodash__WEBPACK_IMPORTED_MODULE_36__["cloneDeep"])(e.cols);this.addTableList=a.filter((function(e){return"操作"!==e.label&&!e.hidden}))}this.dialogSwitch=!0;var i=Object(lodash__WEBPACK_IMPORTED_MODULE_36__["cloneDeep"])(e.cols);this.addTableList=i.filter((function(e){return"操作"!==e.label&&"index"!==e.type&&!e.hidden}))}},{key:"treeDataTest",value:function(){var e={};e=this.$refs.advance["spread"].model;var t=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(this.formAttribute.formList,"key",this.labelTable);t&&this.doTableRowAdd(t,[e]),this.dialogSwitch=!1,this.cancelSwitch()}},{key:"doTableRowAdd",value:function(e,t){var a=this;t.forEach((function(t){var i="r".concat(e.oriDatas?e.oriDatas.length:e.datas.length);e.refreshLoading&&e.loadingPrimKey.length>0&&(i=e.loadingPrimKey.map((function(e){return t[e]})).join("_")),a.$set(t,"editMarkIndex",i),e.oriDatas?e.oriDatas.push(t):e.datas.push(t)})),this.loadTableData(e,e.oriDatas?e.oriDatas:e.datas)}},{key:"handleFileRemove",value:function(e,t){var a=this.$refs.upload[0].uploadFiles,i=a.findIndex((function(t){return t.uid===e.uid}));a.splice(i,1);var r=this.formConfig.formList[t].value.findIndex((function(t){return t.uid===e.uid}));this.formConfig.formList[t].value.splice(r,1)}},{key:"successList",value:function(e,t,a,i){e.data&&e.data.path?(this.formConfig.formList[i].value||(this.formConfig.formList[i].value=[]),this.formConfig.formList[i].value.push({name:t.name,url:t.response["data"]["path"],uid:t.uid})):this.$message.warning("文件上传失败:"+e.message)}},{key:"buttonChange",value:function(e){var t=[],a={};e.setLink?(a=e.setLink,t=e.setLink.associatedLink):e.defaultValue&&(a=e.defaultValue,t=e.defaultValue.associatedLink),a.scriptLinkConfig&&a.scriptLinkConfig.valueShow&&!a.scriptLinkConfig.reqBody?this.scriptComputHandle(e,a.scriptLinkConfig,"ordinaryButtonParams",null,{linkPromise:t,linkDef:a}):this.fetchOrdinaryBtnService(t,e,a)}},{key:"fetchOrdinaryBtnService",value:function(e,t,a){var i=this;e.length>0?Promise.all(e.map((function(e){return new Promise((function(a,r){var o={code:e.code,type:e.type};if(e.valueType)if("fixed"===e.valueType)o["value"]=e.value,o["value"]?a(o):r();else if("form"===e.valueType){var n=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(i.formConfig.formList,"key",e.value);n&&(n.internalObservers||(n.internalObservers=[]),Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(n.internalObservers,"key",t.key)||n.internalObservers.push(t),n.listeners||i.registerChangeListeners(n),o["value"]=n.value,o["value"]&&o["value"].length>0?a(o):r())}else"variable"===e.valueType?e.resultValue?(o["value"]=e.resultValue,a(o)):i.doFlowVariableQuery(e.value).then((function(t){t?(e.resultValue=Array.isArray(t)?t.join(","):t,o["value"]=e.resultValue):(e.resultValue="",o["value"]="",a(o)),o["value"]?a(o):r()})):a(o);else a(o)}))}))).then((function(e){i.doOrdinaryButtonQuery(t,e.filter((function(e){return e["value"]})),a.scriptLinkConfig.reqBody)})):a&&a.scriptLinkConfig&&this.doOrdinaryButtonQuery(t,[],a.scriptLinkConfig.reqBody)}},{key:"doOrdinaryButtonQuery",value:function(e,t,a){var i=this,r=[],o={};if(a&&(o.reqBody=JSON.stringify(a)),e.setLink){this.$set(o,"viewId",e.setLink.linkedSerVal),this.$set(o,"queryParams",t),this.$set(o,"authStationAndUsers",[{stationId:this.taskDealStationId,userCode:this.userCode}]);var n=_api_viewData__WEBPACK_IMPORTED_MODULE_40__["g"];"button"===e.type&&(n=_api_viewData__WEBPACK_IMPORTED_MODULE_40__["m"]),n(o).then((function(t){var a=t.data,o=t.error;if(a)if("bind"===e.setLink.targetObjectBut.setWay){r=a.rows.map((function(t){return t[e.setLink.targetObjectBut.bindingTargets]}));var n=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(i.formConfig.formList,"key",e.setLink.targetObjectBut.targetCol);i.formConfig.formList.forEach((function(t){t.key===n.key&&(e.setLink.targetObjectBut.targetTableCol?t.datas.forEach((function(t){t[e.setLink.targetObjectBut.targetTableCol]=r.join(",")})):t.value=r.join(","))}))}else"script"===e.setLink.targetObjectBut.setWay&&(e.setLink.targetObjectBut.scriptTargets.returnData=a.rows,e.setLink.targetObjectBut.scriptTargets.targetCol=e.setLink.targetObjectBut.targetCol,i.scriptComputHandle(e,e.setLink.targetObjectBut.scriptTargets,"ordinaryButtonValue",null,null));else i.$message.error(o.message)}))}else{var l=e.defaultValue;this.$set(o,"viewId",e.defaultValue.bindTarget),this.$set(o,"queryParams",t.filter((function(e){return e["value"]}))),this.$set(o,"authStationAndUsers",[{stationId:this.taskDealStationId,userCode:this.userCode}]),Object(_api_viewData__WEBPACK_IMPORTED_MODULE_40__["g"])(o).then((function(t){var a=t.data,o=t.error;"childFrom"===e.type?e.value.formList.forEach((function(e){l.paramDefList.forEach((function(t){e.key===t.key&&(r=a.rows.map((function(e){return e[t.value]})),e.value=r.join(","))}))})):a?"bind"===l.targetObjectBut.setWay?(r=a.rows.map((function(e){return e[l.targetObjectBut.bindingTargets]})),i.$set(e,"value",r.join(",")),e.value=r.join(",")):(l.targetObjectBut.scriptTargets.returnData=a.rows,l.targetObjectBut.scriptTargets.targetCol=l.targetObjectBut.targetCol,i.scriptComputHandle(e,l.targetObjectBut.scriptTargets,"defScriptValue",null,null)):i.$message.error(o.message)}))}}},{key:"buttonParameter",value:function(e,t,a){t.scriptLinkConfig&&t.scriptLinkConfig.valueShow&&!t.scriptLinkConfig.reqBody?this.scriptComputHandle(a,t.scriptLinkConfig,"paramsButtonValue",null,{row:e,btn:t}):this.fetchBtnService(e,t,a)}},{key:"fetchBtnService",value:function(e,t,a){var i=this,r=t.associatedLink;r&&r.length>0?Promise.all(r.map((function(t){return new Promise((function(a){var r={code:t.code,type:t.type};if(t.valueType)if("fixed"===t.valueType)r["value"]=t.value,a(r);else if("form"===t.valueType){var o=Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["a"])(i.formConfig.formList,"key",t.value);r["value"]=o.value,a(r)}else"variable"===t.valueType?t.resultValue?(r["value"]=t.resultValue,a(r)):i.doFlowVariableQuery(t.value).then((function(e){e?(t.resultValue=Array.isArray(e)?e.join(","):e,r["value"]=t.resultValue,a(r)):(t.resultValue="",r["value"]="",a(r))})):"tableSta"===t.valueType&&(r["value"]=e[t.value],a(r))}))}))).then((function(r){i.doTableCellBtn(t,r,t.targetObjectBut,e,a)})):this.doTableCellBtn(t,[],t.targetObjectBut,e,a)}},{key:"doTableCellBtn",value:function(e,t,a,i,r){var o=this,n=[],l={viewId:e.linkedSerVal,queryParams:t};e.scriptLinkConfig.reqBody&&(l.reqBody=JSON.stringify(e.scriptLinkConfig.reqBody)),Object(_api_viewData__WEBPACK_IMPORTED_MODULE_40__["m"])(l).then((function(e){var t=e.data,l=e.error;t?"bind"===a.setWay?(n=t.rows.map((function(e){return e[a.bindingTargets]})),o.$set(i,a.targetCol,n.join(","))):"script"===a.setWay&&(a.scriptTargets.returnData=t.rows,a.scriptTargets.targetCol=a.targetCol,o.scriptComputHandle(r,a.scriptTargets,"resultButtonValue",null,i)):o.$message.error(l.message)}))}},{key:"changeClickBut",value:function(e,t,a){t.setLink&&this.buttonParameter(e,t.setLink,a)}},{key:"loadingColumns",value:function(e,t){var a=this;return e.filter((function(e){var i=e.tableFormConfig;if(e.editable){var r=i?i.formType:"input";"select"!==r&&"checkboxGroup"!==r&&"radioGroup"!==r||(a.$set(i,"optionsList",[]),a.$set(i,"optionsType",""),"dataView"===i.sourceDataType?setTimeout((function(){i.dataQueryList.length>0?a.listQueryHandle(i,i.dataQueryList,i.dataSetVal,"selectView"):a.dataViewQueryHandle(i.dataSetVal,i,"selectView")}),500):"variable"===i.sourceDataType?i.flowVisibleCode&&a.getFlowVariablehttp("variableChange",i):"static"===i.sourceDataType&&i.value&&setTimeout((function(){i.listeners&&i.listeners.change&&i.listeners.change(i.value,"auto")}),500)),e.editer={key:e.prop,type:e.tableFormConfig?e.tableFormConfig.formType:"input",config:e.tableFormConfig}}return!e.hidden&&e.format&&a.configFormatCol(e),"操作"===e.label&&(e.actions=[],e.buttonAdd&&(e.actions=e.buttonAdd.map((function(e){return{code:e.fieldCode,type:e.fieldType,text:e.fieldName,onClick:function(i){return a.changeClickBut(i,e,t)}}}))),1===t.editable&&t.addLine&&e.actions.push({code:"deleteRequired",text:"删除",onClick:a.deleteEdit})),!e.hidden}))}},{key:"configFormatCol",value:function(e){if(!e.formatter)switch(e.format){case"thousand":e.formatter=function(t,a,i){return Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["d"])(i,e.accuracy)};break;case"thousandPercent":e.formatter=function(t,a,i){return Object(_utils_util__WEBPACK_IMPORTED_MODULE_37__["d"])(100*i,e.accuracy)+"%"}}}}]),PreviewFormMixin}(vue_property_decorator__WEBPACK_IMPORTED_MODULE_34__["e"]);Object(tslib__WEBPACK_IMPORTED_MODULE_33__["a"])([Object(vue_property_decorator__WEBPACK_IMPORTED_MODULE_34__["c"])({default:{}})],PreviewFormMixin.prototype,"formAttribute",void 0),Object(tslib__WEBPACK_IMPORTED_MODULE_33__["a"])([Object(vue_property_decorator__WEBPACK_IMPORTED_MODULE_34__["c"])({default:"task"})],PreviewFormMixin.prototype,"mode",void 0),Object(tslib__WEBPACK_IMPORTED_MODULE_33__["a"])([Object(vue_property_decorator__WEBPACK_IMPORTED_MODULE_34__["c"])({default:""})],PreviewFormMixin.prototype,"taskId",void 0),Object(tslib__WEBPACK_IMPORTED_MODULE_33__["a"])([Object(vue_property_decorator__WEBPACK_IMPORTED_MODULE_34__["c"])({default:""})],PreviewFormMixin.prototype,"processInstanceId",void 0),Object(tslib__WEBPACK_IMPORTED_MODULE_33__["a"])([Object(vue_property_decorator__WEBPACK_IMPORTED_MODULE_34__["c"])({default:""})],PreviewFormMixin.prototype,"taskDealStationId",void 0),Object(tslib__WEBPACK_IMPORTED_MODULE_33__["a"])([Object(vue_property_decorator__WEBPACK_IMPORTED_MODULE_34__["f"])("formAttribute",{deep:!0,immediate:!0})],PreviewFormMixin.prototype,"getVisible",null)},"4bb5":function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var i=a("2fe1"),r=a("2f62"),o=c("computed",r["e"]),n=c("computed",r["c"]),l=c("methods",r["b"]),s=c("methods",r["d"]);function u(e,t){function a(t){function a(a,i){if("string"===typeof i){var r=i,o=a;return t(r,{namespace:e})(o,r)}var n=a,l=_(i||{},{namespace:e});return t(n,l)}return a}return t?(console.warn("[vuex-class] passing the 2nd argument to `namespace` function is deprecated. pass only namespace string instead."),a(t)):{State:a(o),Getter:a(n),Mutation:a(s),Action:a(l)}}function c(e,t){function a(a,r){return Object(i["a"])((function(i,o){i[e]||(i[e]={});var n,l=(n={},n[o]=a,n);i[e][o]=void 0!==r?t(r,l)[o]:t(l)[o]}))}function r(e,t){if("string"===typeof t){var i=t,r=e;return a(i,void 0)(r,i)}var o=d(t),n=e;return a(n,o)}return r}function d(e){var t=e&&e.namespace;if("string"===typeof t)return"/"!==t[t.length-1]?t+"/":t}function _(e,t){var a={};return[e,t].forEach((function(e){Object.keys(e).forEach((function(t){a[t]=e[t]}))})),a}},"559a":function(e,t,a){"use strict";var i=a("6096"),r=a.n(i);r.a},"55fb":function(e,t,a){},5764:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"previewForm"},[a("el-form",{attrs:{model:e.formAttribute,"label-width":e.formConfig.labelWidth+"px","label-position":e.formConfig.labelPosition}},[a("el-row",{attrs:{gutter:20}},e._l(e.formConfig.formList,(function(t,i){return a("el-col",{key:t,staticClass:"itemBox",attrs:{span:"hidden"===t.type?0:t.span}},[t.showForm&&"show"!==t.showForm?e._e():a("div",[1===t.editable||1===t.readable?a("div",["task"===e.mode&&1===t.editable&&"table"===t.type&&!0===t.addLine?a("el-row",{staticClass:"button_style"},[a("el-button",{on:{click:function(a){return e.exportTable(t)}}},[e._v("导出")]),a("el-button",{on:{click:function(a){return e.uploadTable(t)}}},[e._v("导入")]),a("el-button",{on:{click:function(a){return e.addChange(t)}}},[e._v("新增")])],1):e._e(),"task"===e.mode&&t.history?a("div",{staticClass:"history-badge"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showHistoryCompare(t)}}},[a("svg-icon",{staticClass:"icon",attrs:{"icon-class":"red_dot"}})],1)],1):e._e(),a("el-form-item",{key:t.key,staticStyle:{"margin-bottom":"20px"},attrs:{prop:"formList["+i+"].value",label:t.label,rules:t.rules}},["table"===t.type?a("base-table",{staticClass:"formTable",attrs:{"data-source":t.datas,"border-style":!0,cellClassName:e.computeCellClass,border:"",columns:e.loadingColumns(t.cols,t),"can-edit":""},on:{doHandleInput:function(a,i,r){return e.debunceInput(a["editMarkIndex"],i,r,t.key)},doEdit:function(a,i,r){return e.handleDoInput(a["editMarkIndex"],r.prop,a[r.prop],t.key,!0)}}}):"ueditor"===t.type?a("ueditor",{staticClass:"ueditor",attrs:{onEditBlur:t.onEditBlur,itemValue:t,disable:1===t.readable}}):"childFrom"===t.type?a("previewFormChild",{attrs:{formAttribute:t.value,taskId:e.taskId,processInstanceId:e.processInstanceId,taskDealStationId:e.taskDealStationId}}):"button"===t.type?a("el-button",{attrs:{type:t.buttonType,disabled:"task"!==e.mode},on:{click:function(a){return e.buttonChange(t)}}},[e._v(e._s(t.value))]):"alert"===t.type?a("el-alert",{attrs:{title:t.value,type:t.alertType,center:t.centerFont,description:t.description,closable:!1,"show-icon":t.showIcon}}):"upload"===t.type?a("el-upload",{ref:"upload",refInFor:!0,staticClass:"uploadList",attrs:{drag:"",action:"/api/file-service/file/upload","list-type":"picture-card","auto-upload":"task"===e.mode,headers:e.uploadHeader,"file-list":t.value,disabled:1===t.readable,"on-success":function(t,a,r){return e.successList(t,a,r,i)}},scopedSlots:e._u([{key:"file",fn:function(t){var r=t.file;return a("div",{staticClass:"filestyle-li"},[a("svg-icon",{staticClass:"file-img",attrs:{"icon-class":e.fileType(r.name)}}),a("p",[a("span",{staticClass:"file-name"},[e._v(e._s(r.name))]),a("span",{staticClass:"file-delete",on:{click:function(t){return e.handleFileRemove(r,i)}}},[e._v("删除")]),a("span",{staticClass:"file-delete",on:{click:function(t){return e.download(r.url)}}},[e._v("下载")])]),a("p",["success"===r.status?a("span",{staticClass:"flie-suc"},[e._v("上传完成")]):e._e(),"error"===r.status?a("span",{staticClass:"flie-error"},[e._v("上传失败")]):e._e()])],1)}}],null,!0)},[1===t.editable?a("i",{staticClass:"el-icon-plus"}):e._e()]):a("customItemRender",{attrs:{type:t.type,config:{placeholder:t.placeholder||"",key:t.key,value:t.value,goods:t,multiple:t.itemMultiple,options:"viewsData"===t.optionsType?t.optionsList:t.options||[],listeners:t.listeners}}})],1)],1):e._e()])])})),1)],1),a("simple-dialog",{attrs:{"dialog-title":"变更历史","dialog-visible":e.modifysVisible,"dialog-width":"66%","save-text":"确 定","cancel-text":"取 消","botton-show":"true"},on:{"update:dialogVisible":function(t){e.modifysVisible=t},"update:dialog-visible":function(t){e.modifysVisible=t},saveEmit:e.certain,cancelEmit:function(t){e.modifysVisible=!1}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.historyLoading,expression:"historyLoading"}]},[a("base-table",{attrs:{"data-source":e.tableCompareContainer,columns:e.tableCompareColumns,cellClassName:e.computeCellClass,"border-style":!0,border:""}})],1)]),!0===e.childFromExist&&e.dialogSwitch?a("simple-dialog",{attrs:{"dialog-title":"新增","dialog-visible":e.dialogSwitch,"dialog-width":"870px","save-text":"确 定","cancel-text":"取 消","botton-show":"true"},on:{"update:dialogVisible":function(t){e.dialogSwitch=t},"update:dialog-visible":function(t){e.dialogSwitch=t},saveEmit:function(){return e.tableFormSave(e.formAttributeAlert)},cancelEmit:function(){return e.cancelSwitch()}}},[a("previewFormChild",{attrs:{formAttribute:e.formAttributeAlert,taskId:e.taskId,processInstanceId:e.processInstanceId,taskDealStationId:e.taskDealStationId}})],1):e._e(),!1===e.childFromExist&&e.dialogSwitch?a("addContent",{ref:"advance",attrs:{"dialog-title":e.dialogTitle,"dialog-test-switch":e.dialogSwitch,"params-list":e.addTableList},on:{saveEmitSwitch:function(){return e.treeDataTest()},cancelEmitSwitch:function(){return e.cancelSwitch()}}}):e._e(),a("simple-dialog",{attrs:{dialogTitle:"文件导入","dialog-visible":e.importDialogVisible,"botton-show":"true",dialogWidth:"500px"},on:{saveEmit:function(){return e.doUpload()},cancelEmit:function(){return e.closeDialog()}}},[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{gutter:10,"element-loading-text":"上传中...","element-loading-spinner":"el-icon-loading"}},[a("el-col",{attrs:{md:24}},[a("el-upload",{ref:"netUpload",staticClass:"netVal-import",attrs:{name:"files",action:"importApi",multiple:"","file-list":e.importFiles,"on-change":function(t,a){return e.handleUploadFileChange(t,a)},"on-remove":function(t,a){return e.onRemove(t,a)},"auto-upload":!1}},[a("el-button",{staticClass:"defaultBtn",attrs:{size:"small",type:"primary"}},[e._v("选择文件")])],1)],1)],1)],1)],1)},r=[],o=(a("4160"),a("a15b"),a("13d5"),a("a434"),a("ac1f"),a("1276"),a("159b"),a("d4ec")),n=a("bee2"),l=a("262e"),s=a("2caf"),u=a("9ab4"),c=a("60a3"),d=a("ca00"),_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"previewForm"},[a("el-form",{attrs:{model:e.formAttribute,"label-width":e.formConfig.labelWidth+"px","label-position":e.formConfig.labelPosition}},[a("el-row",{attrs:{gutter:20}},e._l(e.formConfig.formList,(function(t,i){return a("el-col",{key:t,staticClass:"itemBox",attrs:{span:"hidden"===t.type?0:t.span}},[t.showForm&&"show"!==t.showForm?e._e():a("div",[1===t.editable||1===t.readable?a("div",["task"===e.mode&&1===t.editable&&"table"===t.type&&!0===t.addLine?a("el-row",{staticClass:"button_style"},[a("el-button",{on:{click:function(a){return e.exportTable(t)}}},[e._v("导出")]),a("el-button",{on:{click:function(a){return e.uploadTable(t)}}},[e._v("导入")]),a("el-button",{on:{click:function(a){return e.addChange(t)}}},[e._v("新增")])],1):e._e(),"task"===e.mode&&t.history?a("div",{staticClass:"history-badge"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showHistoryCompare(t)}}},[a("svg-icon",{staticClass:"icon",attrs:{"icon-class":"red_dot"}})],1)],1):e._e(),a("el-form-item",{key:t.key,staticStyle:{"margin-bottom":"20px"},attrs:{prop:"formList["+i+"].value",label:t.label,rules:t.rules}},["table"===t.type?a("base-table",{staticClass:"formTable",attrs:{"data-source":t.datas,"border-style":!0,cellClassName:e.computeCellClass,border:"",columns:e.loadingColumns(t.cols,t),"can-edit":""},on:{doHandleInput:function(a,i,r){return e.debunceInput(a["editMarkIndex"],i,r,t.key)},doEdit:function(a,i,r){return e.handleDoInput(a["editMarkIndex"],r.prop,a[r.prop],t.key,!0)}}}):"ueditor"===t.type?a("ueditor",{staticClass:"ueditor",attrs:{onEditBlur:t.onEditBlur,itemValue:t}}):"childFrom"===t.type?a("previewFormChild",{attrs:{formAttribute:t.value,taskId:e.taskId,processInstanceId:e.processInstanceId,taskDealStationId:e.taskDealStationId}}):"button"===t.type?a("el-button",{attrs:{type:t.buttonType,disabled:"task"!==e.mode},on:{click:function(a){return e.buttonChange(t)}}},[e._v(e._s(t.value))]):"alert"===t.type?a("el-alert",{attrs:{title:t.value,type:t.alertType,center:t.centerFont,description:t.description,closable:!1,"show-icon":t.showIcon}}):"upload"===t.type?a("el-upload",{ref:"upload",refInFor:!0,staticClass:"uploadList",attrs:{action:"/api/file-service/file/upload","list-type":"picture-card","auto-upload":"task"===e.mode,headers:e.uploadHeader,"file-list":t.value,disabled:1===t.readable,"on-success":function(t,a,r){return e.successList(t,a,r,i)}},scopedSlots:e._u([{key:"file",fn:function(t){var r=t.file;return a("div",{staticClass:"filestyle-li"},[a("svg-icon",{staticClass:"file-img",attrs:{"icon-class":e.fileType(r.name)}}),a("p",[a("span",{staticClass:"file-name"},[e._v(e._s(r.name))]),a("span",{staticClass:"file-delete",on:{click:function(t){return e.handleFileRemove(r,i)}}},[e._v("删除")]),a("span",{staticClass:"file-delete",on:{click:function(t){return e.download(r.url)}}},[e._v("下载")])]),a("p",["success"===r.status?a("span",{staticClass:"flie-suc"},[e._v("上传完成")]):e._e(),"error"===r.status?a("span",{staticClass:"flie-error"},[e._v("上传失败")]):e._e()])],1)}}],null,!0)},[1===t.editable?a("i",{staticClass:"el-icon-plus"}):e._e()]):a("customItemRender",{attrs:{type:t.type,config:{placeholder:t.placeholder||"",key:t.key,value:t.value,goods:t,multiple:t.itemMultiple,options:"viewsData"===t.optionsType?t.optionsList:t.options||[],listeners:t.listeners}}})],1)],1):e._e()])])})),1)],1),a("simple-dialog",{attrs:{"dialog-title":"变更历史","dialog-visible":e.modifysVisible,"dialog-width":"66%","save-text":"确 定","cancel-text":"取 消","botton-show":"true"},on:{"update:dialogVisible":function(t){e.modifysVisible=t},"update:dialog-visible":function(t){e.modifysVisible=t},saveEmit:e.certain,cancelEmit:function(t){e.modifysVisible=!1}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.historyLoading,expression:"historyLoading"}]},[a("base-table",{attrs:{"data-source":e.tableCompareContainer,columns:e.tableCompareColumns,cellClassName:e.computeCellClass,"border-style":!0,border:""}})],1)]),a("addContent",{ref:"advance",attrs:{"dialog-title":e.dialogTitle,"dialog-test-switch":e.dialogSwitch,"params-list":e.addTableList},on:{saveEmitSwitch:function(){return e.treeDataTest()},cancelEmitSwitch:function(){return e.cancelSwitch()}}}),a("simple-dialog",{attrs:{dialogTitle:"文件导入","dialog-visible":e.importDialogVisible,"botton-show":"true",dialogWidth:"500px"},on:{saveEmit:function(){return e.doUpload()},cancelEmit:function(){return e.closeDialog()}}},[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{gutter:10,"element-loading-text":"上传中...","element-loading-spinner":"el-icon-loading"}},[a("el-col",{attrs:{md:24}},[a("el-upload",{ref:"netUpload",staticClass:"netVal-import",attrs:{name:"files",action:"importApi",multiple:"","file-list":e.importFiles,"on-change":function(t,a){return e.handleUploadFileChange(t,a)},"on-remove":function(t,a){return e.onRemove(t,a)},"auto-upload":!1}},[a("el-button",{staticClass:"defaultBtn",attrs:{size:"small",type:"primary"}},[e._v("选择文件")])],1)],1)],1)],1)],1)},f=[],p=a("de3c"),h=a("e7c5"),m=a("255f"),b=a("3ef9"),v=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(n["a"])(a,[{key:"cancelSwitch",value:function(){this.addTableList=[],this.dialogSwitch=!1}},{key:"created",value:function(){this.formAttribute&&this.getVisible(this.formAttribute),this.userCode=this.$store.state.user.userInfo.usercode}}]),a}(b["a"]);v=Object(u["a"])([Object(c["a"])({components:{customItemRender:h["a"],ueditor:m["a"],addContent:p["a"],previewFormChild:C}})],v);var y=v,g=y,O=(a("6988"),a("559a"),a("2877")),E=Object(O["a"])(g,_,f,!1,null,"47503550",null),C=E.exports,k=a("2ef0"),D=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(n["a"])(a,[{key:"deleteEdit",value:function(e){this.formAttribute.formList.forEach((function(t){if("table"===t.type)for(var a=0;a<t.datas.length;a++)t.datas[a].editMarkIndex===e.editMarkIndex&&t.datas.splice(a,1)}))}},{key:"tableFormSave",value:function(e){var t=this,a={},i=Object(d["a"])(this.formAttribute.formList,"key",this.labelTable);e.formList.forEach((function(e){i.cols.forEach((function(i){(e.fieldName||e.label)===i.fieldName&&(e.value instanceof Array&&""!==e.value?t.$set(a,i.fieldCode,e.value.join(",")):t.$set(a,i.fieldCode,e.realValue?e.realValue:e.value))}))}));var r=i.splitTable;if(r){Array.isArray(r)||(r=[r]);var o=r.reduce((function(e,t){var i=[];return e.forEach((function(e){a[t].split(",").forEach((function(a){var r=Object(k["cloneDeep"])(e);r[t]=a,i.push(r)}))})),i}),[a]);this.doTableRowAdd(i,o)}else this.doTableRowAdd(i,[a]);this.dialogSwitch=!1}},{key:"cancelSwitch",value:function(){this.addTableList=[],this.dialogSwitch=!1}},{key:"created",value:function(){this.formAttribute&&this.getVisible(this.formAttribute),this.userCode=this.$store.state.user.userInfo.usercode}}]),a}(b["a"]);D=Object(u["a"])([Object(c["a"])({components:{customItemRender:h["a"],ueditor:m["a"],addContent:p["a"],previewFormChild:C}})],D);var j=D,w=j,T=(a("a8b7"),a("fbe3"),Object(O["a"])(w,i,r,!1,null,"75a9379a",null));t["a"]=T.exports},5793:function(e,t,a){"use strict";var i=a("55fb"),r=a.n(i);r.a},"579d":function(e,t,a){"use strict";a("99af");var i=a("5530"),r=a("53ca"),o=a("b85c"),n=a("2f62"),l=a("0644"),s=a.n(l);function u(e,t){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Object(o["a"])(e);try{for(n.s();!(a=n.n()).done;){var l=a.value,u=t[l];u&&("object"===Object(r["a"])(u)?i[l]=s()(u):i[l]=u)}}catch(c){n.e(c)}finally{n.f()}return i}t["a"]=function(e,t,a){return{computed:{moduleName:function(){return"".concat(this.$route.path).concat(t?"_"+t:"")},cacheParams:function(){return this.$store.state.dataCache.params[this.moduleName]}},methods:Object(i["a"])(Object(i["a"])({},Object(n["d"])(["SET_CACHE_PARAMS"])),{},{cacheParamData:function(){this.SET_CACHE_PARAMS({moduleName:this.moduleName,params:u(e,this)})},recoveryDataParams:function(){this.cacheParams&&(u(e,this.cacheParams,this),a||this.SET_CACHE_PARAMS({moduleName:this.moduleName}))}}),created:function(){this.recoveryDataParams()}}}},6062:function(e,t,a){"use strict";var i=a("6d61"),r=a("6566");e.exports=i("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},6096:function(e,t,a){},6566:function(e,t,a){"use strict";var i=a("9bf2").f,r=a("7c73"),o=a("e2cc"),n=a("0366"),l=a("19aa"),s=a("2266"),u=a("7dd0"),c=a("2626"),d=a("83ab"),_=a("f183").fastKey,f=a("69f3"),p=f.set,h=f.getterFor;e.exports={getConstructor:function(e,t,a,u){var c=e((function(e,i){l(e,c,t),p(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),d||(e.size=0),void 0!=i&&s(i,e[u],e,a)})),f=h(t),m=function(e,t,a){var i,r,o=f(e),n=b(e,t);return n?n.value=a:(o.last=n={index:r=_(t,!0),key:t,value:a,previous:i=o.last,next:void 0,removed:!1},o.first||(o.first=n),i&&(i.next=n),d?o.size++:e.size++,"F"!==r&&(o.index[r]=n)),e},b=function(e,t){var a,i=f(e),r=_(t);if("F"!==r)return i.index[r];for(a=i.first;a;a=a.next)if(a.key==t)return a};return o(c.prototype,{clear:function(){var e=this,t=f(e),a=t.index,i=t.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete a[i.index],i=i.next;t.first=t.last=void 0,d?t.size=0:e.size=0},delete:function(e){var t=this,a=f(t),i=b(t,e);if(i){var r=i.next,o=i.previous;delete a.index[i.index],i.removed=!0,o&&(o.next=r),r&&(r.previous=o),a.first==i&&(a.first=r),a.last==i&&(a.last=o),d?a.size--:t.size--}return!!i},forEach:function(e){var t,a=f(this),i=n(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:a.first){i(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!b(this,e)}}),o(c.prototype,a?{get:function(e){var t=b(this,e);return t&&t.value},set:function(e,t){return m(this,0===e?0:e,t)}}:{add:function(e){return m(this,e=0===e?0:e,e)}}),d&&i(c.prototype,"size",{get:function(){return f(this).size}}),c},setStrong:function(e,t,a){var i=t+" Iterator",r=h(t),o=h(i);u(e,t,(function(e,t){p(this,{type:i,target:e,state:r(e),kind:t,last:void 0})}),(function(){var e=o(this),t=e.kind,a=e.last;while(a&&a.removed)a=a.previous;return e.target&&(e.last=a=a?a.next:e.state.first)?"keys"==t?{value:a.key,done:!1}:"values"==t?{value:a.value,done:!1}:{value:[a.key,a.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),a?"entries":"values",!a,!0),c(t)}}},6988:function(e,t,a){"use strict";var i=a("2827"),r=a.n(i);r.a},"6d61":function(e,t,a){"use strict";var i=a("23e7"),r=a("da84"),o=a("94ca"),n=a("6eeb"),l=a("f183"),s=a("2266"),u=a("19aa"),c=a("861d"),d=a("d039"),_=a("1c7e"),f=a("d44e"),p=a("7156");e.exports=function(e,t,a){var h=-1!==e.indexOf("Map"),m=-1!==e.indexOf("Weak"),b=h?"set":"add",v=r[e],y=v&&v.prototype,g=v,O={},E=function(e){var t=y[e];n(y,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(m&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return m&&!c(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(m&&!c(e))&&t.call(this,0===e?0:e)}:function(e,a){return t.call(this,0===e?0:e,a),this})};if(o(e,"function"!=typeof v||!(m||y.forEach&&!d((function(){(new v).entries().next()})))))g=a.getConstructor(t,e,h,b),l.REQUIRED=!0;else if(o(e,!0)){var C=new g,k=C[b](m?{}:-0,1)!=C,D=d((function(){C.has(1)})),j=_((function(e){new v(e)})),w=!m&&d((function(){var e=new v,t=5;while(t--)e[b](t,t);return!e.has(-0)}));j||(g=t((function(t,a){u(t,g,e);var i=p(new v,t,g);return void 0!=a&&s(a,i[b],i,h),i})),g.prototype=y,y.constructor=g),(D||w)&&(E("delete"),E("has"),h&&E("get")),(w||k)&&E(b),m&&y.clear&&delete y.clear}return O[e]=g,i({global:!0,forced:g!=v},O),f(g,e),m||a.setStrong(g,e,h),g}},"7c35":function(e,t,a){},"82d3":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"template-box polymerization-table"},[e.block.goods?[e.preview?a("simple-card",{attrs:{title:e.block.goods.showBlockName&&e.block.goods.blockName,noTitle:!e.block.goods.showBlockName}},[e.blockQueryParams&&e.blockQueryParams.length?a("el-form",{staticClass:"block-param-form",class:{minWidth:e.block&&1===e.block.width},attrs:{inline:!0,"label-suffix":":","label-position":"left"}},[e._l(e.blockQueryParams,(function(t){return a("el-form-item",{key:t.name,staticClass:"block-param-form-item",attrs:{label:t.name,required:0===t.required}},[0===t.type||1===t.type?a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),2===t.type?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),3===t.type?a("el-select",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},[a("el-option",{attrs:{value:"0",label:"否"}}),a("el-option",{attrs:{value:"1",label:"是"}})],1):e._e()],1)})),e.blockQueryParams&&e.blockQueryParams.length?a("el-button",{on:{click:function(){return e.getRealContentById(e.block)}}},[e._v("查询")]):e._e()],2):e._e(),a(e.componentkey,e._g(e._b({ref:"componentBlock",tag:"component",class:{tableBox:"TableBlock"===e.componentkey},attrs:{preview:e.preview,block:e.block}},"component",e.$attrs,!1),e.$listeners))],1):[e.blockQueryParams&&e.blockQueryParams.length?a("el-form",{staticClass:"block-param-form",class:{echartsBoxForm:-1!==["PieBlock","LineBlock","BarBlock"].indexOf(e.componentkey),minWidth:e.block&&1===e.block.width},attrs:{inline:!0,"label-suffix":":","label-position":"left"}},[e._l(e.blockQueryParams,(function(t){return a("el-form-item",{key:t.name,staticClass:"block-param-form-item",attrs:{label:t.name,required:0===t.required}},[0===t.type||1===t.type?a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),2===t.type?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),3===t.type?a("el-select",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},[a("el-option",{attrs:{value:"0",label:"否"}}),a("el-option",{attrs:{value:"1",label:"是"}})],1):e._e()],1)})),e.blockQueryParams&&e.blockQueryParams.length?a("el-button",{on:{click:function(){return e.getRealContentById(e.block)}}},[e._v("查询")]):e._e()],2):e._e(),a(e.componentkey,e._g(e._b({ref:"componentBlock",tag:"component",class:{echartsBox:-1!==["PieBlock","LineBlock","BarBlock"].indexOf(e.componentkey)},attrs:{preview:e.preview,block:e.block}},"component",e.$attrs,!1),e.$listeners))]]:e._e()],2)},r=[],o=(a("4de4"),a("d4ec")),n=a("bee2"),l=a("262e"),s=a("2caf"),u=a("9ab4"),c=a("60a3"),d=a("4bb5"),_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-table",{staticClass:"pageTemplateTable",attrs:{"data-source":e.dataSource,columns:e.columns,height:e.height<"320"?e.height:"320"},on:{cellClick:e.cellClick}})],1)},f=[],p=(a("4160"),a("159b"),a("2ef0")),h=a("4242"),m=Object(d["a"])("pageTemplate"),b=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(n["a"])(a,[{key:"changeGrid",value:function(){}},{key:"displayTemplateDetail",value:function(e){}},{key:"queryRelationDataset",value:function(e){}},{key:"cellClick",value:function(e,t,a,i){this.queryRelationDataset({type:"chart",cell:e[t.property],relationBlock:this.block.id})}},{key:"handleUpdateData",value:function(e){var t=this;Object(h["i"])(e).then((function(e){var a=e.error;a?t.$message.error(a.message):t.displayTemplateDetail(t.$route.query.id)}))}},{key:"columns",get:function(){var e=this,t=this.block.goods&&this.block.goods.columns||[];t.forEach((function(t){t.canSet?t.render=function(a,i){var r=i.record;return!0===r.isEdit?a("el-input",{props:{value:r[t.prop],clearable:!0,placeholder:"请输入参数code"},on:{input:function(a){r[t.prop]=a,e.handleUpdateData(r)}}}):a("span",r[t.prop])}:t.render=null}));var a=Object(p["cloneDeep"])(this.block);return a.goods.columns=t,this.changeGrid(),t}},{key:"height",get:function(){return this.dataSource.length?32*this.dataSource.length+50:"100%"}}]),a}(c["e"]);Object(u["a"])([Object(c["c"])({default:[]})],b.prototype,"dataSource",void 0),Object(u["a"])([Object(c["c"])()],b.prototype,"block",void 0),Object(u["a"])([m.Mutation("UPDATE_ACTIVE_BLOCK")],b.prototype,"updateActiveBlock",void 0),Object(u["a"])([Object(c["b"])("changeGrid")],b.prototype,"changeGrid",null),Object(u["a"])([Object(c["b"])("displayTemplateDetail")],b.prototype,"displayTemplateDetail",null),Object(u["a"])([Object(c["b"])("queryRelationDataset")],b.prototype,"queryRelationDataset",null),b=Object(u["a"])([c["a"]],b);var v=b,y=v,g=(a("05de"),a("2877")),O=Object(g["a"])(y,_,f,!1,null,null,null),E=O.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"min-height":"300px"},on:{"resize-chart":e.resizeChart}})},k=[],D=(a("d81d"),a("b0c0"),a("313e")),j=a.n(D),w=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.chart=null,e.options={tooltip:{trigger:"item"},color:["rgba(42, 118, 205, 0.85)","rgba(43, 188, 184, 0.85)","rgba(68, 179, 101, 0.85)","rgba(234, 169, 38, 0.85)","rgba(204, 61, 61, 0.85)","rgba(133, 84, 201, 0.85)","rgba(60, 58, 154, 0.85)","rgba(58, 71, 119, 0.85)"],legend:{orient:"vertical",left:"left",data:[]},series:[]},e}return Object(n["a"])(a,[{key:"queryRelationDataset",value:function(e){}},{key:"onDataSourceChange",value:function(){this.initChart()}},{key:"onLabelChange",value:function(){this.initChart()}},{key:"onValueChange",value:function(){this.initChart()}},{key:"onPieTypeChange",value:function(){this.initChart()}},{key:"resizeChart",value:function(){var e=this;setTimeout((function(){e.chart&&e.chart.resize()}),100)}},{key:"initChart",value:function(){this.chart=j.a.init(this.$el),this.chart.setOption(this.options),this.refreshChart(),this.clickChart()}},{key:"refreshChart",value:function(){var e=this;if(this.dataSource){this.label&&this.chart.setOption({legend:{data:this.dataSource.map((function(t){return t[e.label]}))}});var t="55%";if("1"===this.pieType?t=["50%","70%"]:"2"===this.pieType&&(t=["20%","70%"]),this.value){var a=this.label||this.value;this.chart.setOption({series:[{name:"",type:"pie",radius:t,center:["50%","60%"],roseType:"2"===this.pieType&&"radius",data:this.dataSource.map((function(t){return{value:t[e.value],name:t[a]}})),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{borderColor:"#ffffff",borderWidth:1}}}]})}}}},{key:"clickChart",value:function(){var e=this;this.chart.off("click"),this.chart.on("click",(function(t){e.queryRelationDataset({type:"chart",label:t.name,value:t.value,relationBlock:e.block.id})}))}},{key:"label",get:function(){return this.block.goods&&this.block.goods.label||""}},{key:"value",get:function(){return this.block.goods&&this.block.goods.value||""}},{key:"pieType",get:function(){return this.block.goods&&this.block.goods.pieType||""}}]),a}(c["e"]);Object(u["a"])([Object(c["c"])()],w.prototype,"block",void 0),Object(u["a"])([Object(c["c"])({default:[]})],w.prototype,"dataSource",void 0),Object(u["a"])([Object(c["b"])("queryRelationDataset")],w.prototype,"queryRelationDataset",null),Object(u["a"])([Object(c["f"])("dataSource")],w.prototype,"onDataSourceChange",null),Object(u["a"])([Object(c["f"])("label")],w.prototype,"onLabelChange",null),Object(u["a"])([Object(c["f"])("value")],w.prototype,"onValueChange",null),Object(u["a"])([Object(c["f"])("pieType")],w.prototype,"onPieTypeChange",null),w=Object(u["a"])([c["a"]],w);var T=w,L=T,P=Object(g["a"])(L,C,k,!1,null,null,null),M=P.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"300px"},on:{"resize-chart":e.resizeChart}})},I=[],A=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.chart=null,e}return Object(n["a"])(a,[{key:"queryRelationDataset",value:function(e){}},{key:"onDataSourceChange",value:function(){this.initChart()}},{key:"onXAxisChange",value:function(){this.initChart()}},{key:"onYAxisChange",value:function(e,t){JSON.stringify(e)!==JSON.stringify(t)&&this.initChart()}},{key:"resizeChart",value:function(){var e=this;setTimeout((function(){e.chart&&e.chart.resize()}),100)}},{key:"initChart",value:function(){this.chart=j.a.init(this.$el),this.refreshData(),this.clickChart()}},{key:"refreshData",value:function(){var e=this;if(this.dataSource){var t=[],a=[];this.yaxis.forEach((function(i){t=[];var r={},o=[];e.dataSource.forEach((function(a){t.push(a[e.xaxis]),o.push(a[i.code])})),r={name:i.label,data:o,type:"line",showSymbol:!1,symbolSize:8},a.push(r)})),this.chart.setOption({textStyle:{color:"rgba(60, 68, 85, 0.7)"},animation:!1,color:["rgba(42, 118, 205, 0.85)","rgba(43, 188, 184, 0.85)","rgba(68, 179, 101, 0.85)","rgba(234, 169, 38, 0.85)","rgba(204, 61, 61, 0.85)","rgba(133, 84, 201, 0.85)","rgba(60, 58, 154, 0.85)","rgba(58, 71, 119, 0.85)"],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},grid:{left:"7%",right:"4%",bottom:"8%",containLabel:!0},yAxis:[{type:"value",name:"",nameTextStyle:{padding:[0,24,10,0]},axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#dde3ea",type:"dashed"}}}],xAxis:{name:"",type:"category",nameLocation:"start",nameTextStyle:{padding:[50,0,0,50]},axisTick:{show:!1},axisLine:{show:!1},axisLabel:{rotate:-20},data:t},series:a},!0)}}},{key:"clickChart",value:function(){var e=this;this.chart.off("click"),this.chart.on("click",(function(t){e.queryRelationDataset({type:"chart",x:t.name,y:t.value,relationBlock:e.block.id})}))}},{key:"xaxis",get:function(){return this.block.goods&&this.block.goods.xaxis||""}},{key:"yaxis",get:function(){return this.block.goods&&this.block.goods.yaxis||[]}}]),a}(c["e"]);Object(u["a"])([Object(c["c"])()],A.prototype,"block",void 0),Object(u["a"])([Object(c["c"])({default:[]})],A.prototype,"dataSource",void 0),Object(u["a"])([Object(c["b"])("queryRelationDataset")],A.prototype,"queryRelationDataset",null),Object(u["a"])([Object(c["f"])("dataSource")],A.prototype,"onDataSourceChange",null),Object(u["a"])([Object(c["f"])("xaxis")],A.prototype,"onXAxisChange",null),Object(u["a"])([Object(c["f"])("yaxis")],A.prototype,"onYAxisChange",null),A=Object(u["a"])([c["a"]],A);var B=A,V=B,S=Object(g["a"])(V,x,I,!1,null,null,null),F=S.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"300px"},on:{"resize-chart":e.resizeChart}})},U=[],K=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.chart=null,e}return Object(n["a"])(a,[{key:"queryRelationDataset",value:function(e){}},{key:"onDataSourceChange",value:function(){this.initChart()}},{key:"onXAxisChange",value:function(){this.initChart()}},{key:"onYAxisChange",value:function(e,t){JSON.stringify(e)!==JSON.stringify(t)&&this.initChart()}},{key:"resizeChart",value:function(){var e=this;setTimeout((function(){e.chart&&e.chart.resize()}),100)}},{key:"initChart",value:function(){this.chart=j.a.init(this.$el),this.refreshData(),this.clickChart()}},{key:"refreshData",value:function(){var e=this;if(this.dataSource){var t=[],a=[];this.yaxis.forEach((function(i){t=[];var r={},o=[];e.dataSource.forEach((function(a){t.push(a[e.xaxis]),o.push(a[i.code])})),r={name:i.label,data:o,type:"bar"},a.push(r)})),this.chart.setOption({color:["rgba(42, 118, 205, 0.85)","rgba(43, 188, 184, 0.85)","rgba(68, 179, 101, 0.85)","rgba(234, 169, 38, 0.85)","rgba(204, 61, 61, 0.85)","rgba(133, 84, 201, 0.85)","rgba(60, 58, 154, 0.85)","rgba(58, 71, 119, 0.85)"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},yAxis:{type:"value"},xAxis:{name:"",type:"category",axisTick:{alignWithLabel:!0},axisLabel:{rotate:-20},data:t},series:a},!0)}}},{key:"clickChart",value:function(){var e=this;this.chart.off("click"),this.chart.on("click",(function(t){e.queryRelationDataset({type:"chart",x:t.name,y:t.value,relationBlock:e.block.id})}))}},{key:"xaxis",get:function(){return this.block.goods&&this.block.goods.xaxis||""}},{key:"yaxis",get:function(){return this.block.goods&&this.block.goods.yaxis||[]}}]),a}(c["e"]);Object(u["a"])([Object(c["c"])({default:[]})],K.prototype,"dataSource",void 0),Object(u["a"])([Object(c["c"])()],K.prototype,"block",void 0),Object(u["a"])([Object(c["b"])("queryRelationDataset")],K.prototype,"queryRelationDataset",null),Object(u["a"])([Object(c["f"])("dataSource")],K.prototype,"onDataSourceChange",null),Object(u["a"])([Object(c["f"])("xaxis")],K.prototype,"onXAxisChange",null),Object(u["a"])([Object(c["f"])("yaxis")],K.prototype,"onYAxisChange",null),K=Object(u["a"])([c["a"]],K);var W=K,q=W,$=Object(g["a"])(q,R,U,!1,null,null,null),N=$.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"previewForm"},[void 0!==this.formAttribute.saveAddress?a("el-row",[a("el-button",{staticStyle:{float:"right","margin-right":"20px"},attrs:{type:"primary"},on:{click:e.saveFormData}},[e._v("保 存")])],1):e._e(),a("el-row",[a("perviewForm",{ref:"previewFormRef",attrs:{formAttribute:e.formAttribute}})],1)],1)},H=[],z=(a("c740"),a("45fc"),a("a434"),a("b64b"),a("b84e")),G=a("5764"),X=Object(d["a"])("pageTemplate"),Y=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.query="",e.loop=function(t,a){for(var i=function(i){"childFrom"!==t[i].type?(t[i].editable=1,t[i].readable=0,t[i].value=a[t[i].key]):Object.keys(a).forEach((function(r){void 0!==t[i].value.formList&&t[i].key===r&&e.loop(t[i].value.formList,a[r])}))},r=0;r<t.length;r++)i(r)},e.saveFormData=function(){if(e.vaildForm()&&void 0!==e.formAttribute.saveAddress){var t=e.paramsObtain().param,a=e.formAttribute.saveAddress,i={paramsObtain:t,saveAddress:a};Object(z["d"])(i).then((function(t){t.data;var a=t.error;a?e.$message.error(a.message):e.$message.success("保存成功")}))}},e}return Object(n["a"])(a,[{key:"updateActiveFormItem",value:function(e){}},{key:"queryRelationDataset",value:function(e){}},{key:"created",value:function(){this.$route.query&&"{}"!==JSON.stringify(this.$route.query)&&(this.query=this.$route.query,this.getTemplateDetail())}},{key:"stopBubble",value:function(e){e&&e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0}},{key:"formItemClick",value:function(e){this.stopBubble(),this.currentBlock.id!==this.block.id&&this.updateActiveBlock(Object(p["cloneDeep"])(this.block)),this.updateActiveFormItem(e)}},{key:"itemDeleteClick",value:function(e,t){if(this.currentBlock.id!==this.block.id&&this.updateActiveBlock(Object(p["cloneDeep"])(this.block)),this.formAttribute.formList.splice(t,1),this.updateActiveFormItem(this.formAttribute.formList.length?this.formAttribute.formList[0]:{}),this.currentBlock&&this.currentBlock.goods&&this.currentBlock.goods.formAttribute){var a=this.currentBlock.goods.formAttribute.formList,i=a.findIndex((function(t){return t.key===e.key}));a.splice(i,1),this.updateActiveBlock(Object(p["cloneDeep"])(this.currentBlock))}}},{key:"handleFormItemChange",value:function(e,t){var a=t.key!==this.activeFormItem.key?Object(p["cloneDeep"])(t):Object(p["cloneDeep"])(this.activeFormItem);a.value=e,this.updateActiveFormItem(a)}},{key:"washFormEditable",value:function(e){var t=this;e&&e.forEach((function(e){"childFrom"!==e.type?(e.editable=1,e.readable=0):t.washFormEditable(e.value.formList)}))}},{key:"getTemplateDetail",value:function(){var e=this,t=this.query,a=this.formAttribute.detailAddress,i={url:a,paramId:t};this.formAttribute.detailAddress?Object(z["b"])(i).then((function(t){var a=t.data,i=t.error;i?e.$message.error(i.message||"获取数据失败"):e.loop(e.formAttribute.formList,a)})):this.washFormEditable(this.formAttribute.formList)}},{key:"paramsObtain",value:function(){var e=this,t={};return Object.prototype.hasOwnProperty.call(this.formAttribute,"formList")&&this.formAttribute.formList.forEach((function(a){if((!a.showForm||"show"===a.showForm)&&(1===a.editable||1===a.readable))if("table"===a.type)a.datas&&(a.datas.forEach((function(e){delete e["edits"],delete e["beModified"]})),e.$set(t,a.key,a.datas));else if("childFrom"===a.type){var i={};a.value.formList.forEach((function(t){"table"===t.type?t.datas&&(t.datas.forEach((function(e){return delete e["edits"]})),e.$set(i,t.key,t.datas)):e.$set(i,t.key,t.value)})),e.$set(t,a.key,i)}else Object.prototype.hasOwnProperty.call(a,"realValue")?e.$set(t,a.key,a.realValue):e.$set(t,a.key,a.value)})),Object.keys(this.query).forEach((function(a){e.$set(t,a,e.query[a])})),{param:t}}},{key:"vaildForm",value:function(){var e=!0;if(this.formAttribute.formList){var t=this.formAttribute.formList.filter((function(e){return(!e.showForm||"show"===e.showForm)&&e.editable}));t.some((function(e){return"table"!==e.type&&e.required&&!e.value}))&&(this.$message.warning("请先完成必填表单项输入"),e=!1)}return e}},{key:"currentBlock",get:function(){return Object(p["cloneDeep"])(this.activeBlock)}},{key:"formAttribute",get:function(){return this.block.goods&&this.block.goods.formAttribute||{}}},{key:"formItemQueryParams",get:function(){var e=this,t=[];return this.formAttribute.formList&&this.formAttribute.formList.map((function(a){e.beRelatedFromItemList.some((function(e){return a.key===e}))&&t.push({formItemKey:a.key,formItemValue:a.value})})),t}}]),a}(c["e"]);Object(u["a"])([X.Mutation("UPDATE_ACTIVE_BLOCK")],Y.prototype,"updateActiveBlock",void 0),Object(u["a"])([X.State((function(e){return e.activeBlock}))],Y.prototype,"activeBlock",void 0),Object(u["a"])([Object(c["c"])({default:{}})],Y.prototype,"block",void 0),Object(u["a"])([Object(c["c"])({default:{}})],Y.prototype,"activeFormItem",void 0),Object(u["a"])([Object(c["c"])()],Y.prototype,"preview",void 0),Object(u["a"])([Object(c["c"])({default:[]})],Y.prototype,"beRelatedFromItemList",void 0),Object(u["a"])([Object(c["b"])("activeFormItemChange")],Y.prototype,"updateActiveFormItem",null),Object(u["a"])([Object(c["b"])("queryRelationDataset")],Y.prototype,"queryRelationDataset",null),Y=Object(u["a"])([Object(c["a"])({components:{perviewForm:G["a"]}})],Y);var J=Y,Z=J,ee=(a("5793"),a("aa97"),Object(g["a"])(Z,Q,H,!1,null,"76359e5e",null)),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"monitorChart",style:{borderColor:e.block.goods.monitorColor},on:{click:e.handleQueryData}},[a("div",{staticClass:"info"},[a("div",{staticClass:"left-info"},[a("p",{staticClass:"title"},[e._v(e._s(this.block.goods.monitorName?this.block.goods.monitorName:"监控名称"))]),a("p",{staticClass:"ratio",style:{color:e.customColor}},[a("span",[e._v(" "+e._s(this.block.goods.completeCount?this.completed:"监控分子"))]),a("span",{staticClass:"line"},[e._v(" / ")]),a("span",[e._v(" "+e._s(this.block.goods.allCount?this.all:" 监控分母"))])])]),e._m(0)]),a("div",{staticClass:"progress"},[a("el-progress",{attrs:{percentage:e.percentage,color:e.customColor,"show-text":!1}}),a("p",[e._v("当前进度："+e._s(e.percentage)+" %")])],1)])},ie=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"imgStyle"},[i("img",{attrs:{src:a("cfb4")}})])}],re=a("ca00"),oe=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.customColor="#409eff",e.all=0,e.completed=0,e}return Object(n["a"])(a,[{key:"getDataByCard",value:function(e){}},{key:"onDataSourceChange",value:function(){var e=this.block.goods;this.all=this.dataSource.length>0?this.dataSource[0][e.allCount]:0,this.completed=this.dataSource.length>0?this.dataSource[0][e.completeCount]:0}},{key:"handleQueryData",value:function(){this.block&&this.block.goods.monitorName&&this.getDataByCard({type:"monitorSteps",monitorName:this.block.goods.monitorName})}},{key:"percentage",get:function(){return this.completed&&this.all?Object(re["d"])(this.completed/this.all*100):0}}]),a}(c["e"]);Object(u["a"])([Object(c["c"])()],oe.prototype,"block",void 0),Object(u["a"])([Object(c["c"])({default:[]})],oe.prototype,"dataSource",void 0),Object(u["a"])([Object(c["b"])("getDataByCard")],oe.prototype,"getDataByCard",null),Object(u["a"])([Object(c["f"])("dataSource")],oe.prototype,"onDataSourceChange",null),oe=Object(u["a"])([c["a"]],oe);var ne=oe,le=ne,se=(a("3e81"),Object(g["a"])(le,ae,ie,!1,null,null,null)),ue=se.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"monitorSteps",on:{click:e.handleQueryData}},e._l(e.stepsList,(function(t,i){return a("div",{key:i,staticClass:"stepItem"},[a("div",{staticClass:"itemInfo"},[a("p",{staticClass:"stepName"},[e._v(e._s(t.monitorName?t.monitorName:"节点"+(i+1)+"监控名称"))]),a("p",{staticClass:"allCount"},[e._v(e._s(t.all))]),a("div",{staticClass:"progress"},[a("el-progress",{attrs:{type:"circle",percentage:t.percentage,"show-text":!1,color:"#2464B3","stroke-width":15}}),i!==e.stepsList.length-1?a("div",{staticClass:"itemLine"}):e._e()],1),a("p",{staticClass:"complatedStep"},[a("span",[e._v("待处理：")]),a("span",[e._v(e._s(t.uncomplete))])]),a("p",{staticClass:"uncomplated"},[a("span",[e._v("已处理：")]),a("span",[e._v(e._s(t.completed))])])])])})),0)},de=[],_e=(Object(d["a"])("pageTemplate"),function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(n["a"])(a,[{key:"getDataByCard",value:function(e){}},{key:"handleQueryData",value:function(){var e=this.stepsList.map((function(e){return e.monitorName}));e.length&&this.getDataByCard({type:"monitorSteps",monitorName:e})}},{key:"stepsList",get:function(){var e=this,t=this.block&&this.block.goods.stepsList?Object(p["cloneDeep"])(this.block.goods.stepsList):[];return t.length&&this.dataSource&&this.dataSource.length&&t.forEach((function(t,a){t.all=t.allCount&&e.dataSource[a]&&e.dataSource[a][0]?e.dataSource[a][0][t.allCount]:0,t.completed=t.completeCount&&e.dataSource[a]&&e.dataSource[a][0]?e.dataSource[a][0][t.completeCount]:0,t.uncomplete=t.all-t.completed,t.percentage=t.completed/t.all*100})),t}}]),a}(c["e"]));Object(u["a"])([Object(c["c"])({default:{}})],_e.prototype,"block",void 0),Object(u["a"])([Object(c["c"])()],_e.prototype,"dataSource",void 0),Object(u["a"])([Object(c["b"])("getDataByCard")],_e.prototype,"getDataByCard",null),_e=Object(u["a"])([c["a"]],_e);var fe=_e,pe=fe,he=(a("1108"),Object(g["a"])(pe,ce,de,!1,null,null,null)),me=he.exports,be=(Object(d["a"])("pageTemplate"),function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(n["a"])(a,[{key:"getRealContentById",value:function(e){}},{key:"resizeChart",value:function(){var e=this.$refs;e.componentBlock.resizeChart&&e.componentBlock.resizeChart()}},{key:"blockQueryParams",get:function(){return this.block.goods&&this.block.goods.queryParams&&this.block.goods.queryParams.filter((function(e){return"1"===e.valueBy}))||[]}},{key:"componentkey",get:function(){var e="";if(this.block.goods){var t=this.block.goods.type;"table"===t?e="TableBlock":"pie"===t?e="PieBlock":"line"===t?e="LineBlock":"bar"===t?e="BarBlock":"singleForm"===t||"doubleForm"===t?e="CustomForm":"monitorChart"===t?e="MonitorChart":"monitorSteps"===t&&(e="MonitorSteps")}return e}}]),a}(c["e"]));Object(u["a"])([Object(c["c"])({default:!1})],be.prototype,"preview",void 0),Object(u["a"])([Object(c["c"])()],be.prototype,"block",void 0),Object(u["a"])([Object(c["b"])("getRealContentById")],be.prototype,"getRealContentById",null),be=Object(u["a"])([Object(c["a"])({components:{TableBlock:E,PieBlock:M,LineBlock:F,BarBlock:N,CustomForm:te,MonitorChart:ue,MonitorSteps:me}})],be);var ve=be,ye=ve,ge=(a("db30"),Object(g["a"])(ye,i,r,!1,null,null,null));t["a"]=ge.exports},"8be5":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return _}));a("99af"),a("4160"),a("13d5"),a("b0c0"),a("159b");var i=a("ca00");a("2ef0");function r(e,t){var a=null;switch(t.goods.type){case"table":a=o;break;case"pie":a=n;break;case"line":a=l;break;case"bar":a=s;break;case"monitorChart":a=u;break;default:}return e.data?a(e.data,t.goods):a(e,t.goods)}function o(e,t){if(t.columns||(t.columns=[]),e.fields)e.fields.forEach((function(e){if(!Object(i["a"])(t.columns,"fieldCode",e.fieldCode)){var a={};a.label=e.fieldName,a.prop=e.fieldCode,a.fieldCode=e.fieldCode,a.align=e.align||"center",a.headerAlign="center",a.fieldType=e.fieldType,a.showOverflowTooltip=!0,a.canSet=e.canSet||0,1===e.fieldType?a.format=e.format||"":2===e.fieldType?a.format=e.format||"yyyy-MM-dd":a.format="",a.formatter=_(e.format),t.columns.push(a)}}));else if(!Object(i["a"])(t.columns,"fieldCode",e.fieldCode)){var a={};a.label=e.fieldName,a.prop=e.fieldCode,a.fieldCode=e.fieldCode,a.align=e.align||"center",a.headerAlign="center",a.fieldType=e.fieldType,a.showOverflowTooltip=!0,a.canSet=e.canSet||0,1===e.fieldType?a.format=e.format||"":2===e.fieldType?a.format=e.format||"yyyy-MM-dd":a.format="",a.formatter=_(e.format),t.columns.push(a)}}function n(e,t){if(e.fields)return"只能拖入节点，不能拖入整个数据集";if("pieLabel"===e.attrFlag){if(t.label)return"repeat";t.label=e.fieldCode,t.pieType=e.pieType}if("pieValue"===e.attrFlag){if(t.value)return"repeat";t.value=e.fieldCode,t.pieType=e.pieType}}function l(e,t){if(e.fields)return"只能拖入节点，不能拖入整个数据集";if("xaxis"===e.attrFlag){if(t.label)return"repeat";t.xaxis=e.fieldCode}if("yaxis"===e.attrFlag){t.yaxis||(t.yaxis=[]);var a=t.yaxis;if(Object(i["a"])(a,"fieldCode",e.fieldCode))return"repeat";a.push({code:e.fieldCode,label:e.name})}}function s(e,t){if(e.fields)return"只能拖入节点，不能拖入整个数据集";if("xaxis"===e.attrFlag){if(t.label)return"repeat";t.xaxis=e.fieldCode}if("yaxis"===e.attrFlag){t.yaxis||(t.yaxis=[]);var a=t.yaxis;if(Object(i["a"])(a,"fieldCode",e.fieldCode))return"repeat";a.push({code:e.fieldCode,label:e.name})}}function u(e,t){if(e.fields)return"只能拖入节点，不能拖入整个数据集";"completeCount"===e.attrFlag?t.completeCount=e.fieldCode:"allCount"===e.attrFlag&&(t.allCount=e.fieldCode)}function c(e){return e.reduce((function(e,t){return e.gridRowEnd>t.gridRowEnd?e:t})).gridRowEnd-1}function d(e){return e.reduce((function(e,t){return e.gridColumnEnd>t.gridColumnEnd?e:t})).gridColumnEnd-1}function _(e){var t=null;switch(e){case"thousand":t=function(e,t){return Object(i["g"])(e[t.property])};break;case"amount":t=function(e,t){return Object(i["d"])(e[t.property])};break;case"yyyy-MM-dd":t=function(e,t){return f(e[t.property],"-")};break;case"yyyy/MM/dd":t=function(e,t){return f(e[t.property],"/")};break;default:t=function(e,t){return e[t.property]}}return t}function f(e,t){var a=new Date(e),i=a.getFullYear(),r=a.getMonth()+1,o=a.getDate();return r<10&&(r="0".concat(r)),o<10&&(o="0".concat(o)),"".concat(i).concat(t).concat(r).concat(t).concat(o)}},a623:function(e,t,a){"use strict";var i=a("23e7"),r=a("b727").every,o=a("a640"),n=a("ae40"),l=o("every"),s=n("every");i({target:"Array",proto:!0,forced:!l||!s},{every:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},a8b7:function(e,t,a){"use strict";var i=a("187f"),r=a.n(i);r.a},aa97:function(e,t,a){"use strict";var i=a("f114"),r=a.n(i);r.a},b6fc:function(e,t,a){},bb2f:function(e,t,a){var i=a("d039");e.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bf0f:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"index-page-template"},[a("base-table-panel",{staticClass:"sortTable noTableBorder",attrs:{title:"页面模板列表",rightBtns:e.titleBtns(),"data-source":e.templateList,loading:e.loading,columns:e.columns(),"has-pagination":"","show-summary":!1,total:e.total,"current-page":e.currentPage,"page-size":e.pageSize,"border-style":!0},on:{handleCurrent:e.handleCurrent,handleSize:e.handleSize}},[a("template",{slot:"operate-left"},[a("el-form",{ref:"form",staticClass:"operate-left-form",attrs:{inline:!0,"label-suffix":":",size:"mini"}},[a("el-form-item",{attrs:{label:"模板名称"}},[a("el-input",{attrs:{placeholder:"请输入模板名称"},model:{value:e.templateName,callback:function(t){e.templateName=t},expression:"templateName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.selectList}},[e._v("查询")])],1)],1)],1)],2),a("simple-dialog",{staticClass:"previewDialog",attrs:{dialogTitle:"预览","dialog-visible":e.previewDialogVisible,dialogWidth:"70%"},on:{cancelEmit:function(t){e.previewDialogVisible=!1}}},[a("PreviewTemplate",{ref:"previewTemplate",attrs:{templateId:e.templateId}})],1),a("simple-dialog",{staticClass:"menuDialog",attrs:{dialogTitle:"菜单注册面板","dialog-visible":e.dialogVisible,"botton-show":"true",cancelText:"取消",saveText:"确定",dialogWidth:"20%"},on:{saveEmit:e.saveDialog,cancelEmit:e.cancelDialog}},[a("el-form",{ref:"menuForm",attrs:{rules:e.menuRules,model:e.selectedMenu}},[a("el-form-item",{attrs:{label:"菜单名称：","label-width":"94px","label-position":"left",prop:"menuTitle"}},[a("el-input",{model:{value:e.selectedMenu.menuTitle,callback:function(t){e.$set(e.selectedMenu,"menuTitle",t)},expression:"selectedMenu.menuTitle"}})],1)],1),a("div",{staticClass:"container"},[e.dialogVisible?a("el-tree",{ref:"menuTree",attrs:{data:e.menuData,props:e.defaultProps},on:{"node-click":e.handleNodeClick}}):e._e()],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.showError,expression:"showError"}],staticClass:"showError"},[e._v("节点未选取")])],1)],1)},r=[],o=(a("99af"),a("4160"),a("b0c0"),a("159b"),a("d4ec")),n=a("bee2"),l=a("262e"),s=a("2caf"),u=a("9ab4"),c=a("60a3"),d=a("4242"),_=a("fd85"),f=a("0a50"),p=a("2ef0"),h=a("579d");c["a"].registerHooks(["beforeRouteLeave"]);var m=Object(h["a"])(["currentPage","pageSize","total","templateList","templateName"]),b=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.templateList=[],e.templateName="",e.loading=!1,e.currentPage=1,e.pageSize=10,e.total=100,e.templateId="",e.dialogVisible=!1,e.previewDialogVisible=!1,e.defaultProps={children:"children",label:"title"},e.selectedMenu={menuTitle:"",id:"",code:""},e.currentTemplate=null,e.showError=!1,e.menuRules={menuTitle:[{message:"请输入菜单名称",trigger:"blur",required:!0}]},e}return Object(n["a"])(a,[{key:"formatMenuData",value:function(e){var t=this,a=[];return e.forEach((function(e){e.children&&e.children.length&&(e.children=t.formatMenuData(e.children),a.push(e))})),a}},{key:"columns",value:function(){var e=this;return[{prop:"",type:"index",align:"center",label:"序号",width:"60"},{prop:"name",label:"模板名称","header-align":"left",showOverflowTooltip:!0},{prop:"status",label:"状态",align:"center",width:"90",render:function(e,t){var a=t.record,i="";return i=0===a.status?"未发布":1===a.status?"已发布":"已撤回",e("span",{},i)}},{prop:"modifier",label:"修改人",align:"center",width:"90"},{prop:"editTime",label:"修改时间",align:"center",width:"170"},{prop:"",align:"center",label:"操作",width:"300",actions:[{code:"preview",text:"预览",onClick:e.preview},{code:"release",text:function(e){return 1===e.status?"撤销发布":"发布"},onClick:e.release},{code:"edit",text:"修改",onClick:e.modify},{code:"copy",text:"复制",onClick:e.copy},{code:"delete",text:"删除",onClick:e.delete}]}]}},{key:"titleBtns",value:function(){var e=this;return[{title:"新增",icon:"add-line",onClick:e.addPageTemplate}]}},{key:"handleSize",value:function(e){this.pageSize=e,this.currentPage=1,this.getTemplateList()}},{key:"handleCurrent",value:function(e){this.currentPage=e,this.getTemplateList()}},{key:"selectList",value:function(){this.currentPage=1,this.getTemplateList()}},{key:"getTemplateList",value:function(){var e=this,t={page:this.currentPage,pageSize:this.pageSize};this.templateName&&(t.name=this.templateName),this.loading=!0,Object(d["e"])(t).then((function(t){var a=t.data,i=t.error;e.loading=!1,i?e.$message.error(i.message||"获取数据失败"):(e.templateList=a.rows,e.total=a.total)}))}},{key:"preview",value:function(e){var t=this;this.templateId=e.id,this.previewDialogVisible=!0,this.$nextTick((function(){t.$refs.previewTemplate.initPreviewTemplate()}))}},{key:"release",value:function(e){var t=this;this.currentTemplate=e,1===e.status||2===e.status?this.$confirm(1===e.status?"是否撤销发布?":"是否确认发布?","提示",{confirmButtonText:1===e.status?"撤销发布":"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=1===e.status?0:1;t.registerMenu(a)})).catch((function(){})):0===e.status&&(this.dialogVisible=!0,this.selectedMenu.menuTitle=this.currentTemplate.menuTitle||this.currentTemplate.name)}},{key:"registerMenu",value:function(e){var t=this;if(1===e){var a=this.currentTemplate.parentMenuId||this.selectedMenu.id,i=this.currentTemplate.parentMenuCode||this.selectedMenu.code,r=this.currentTemplate.menuTitle||this.selectedMenu.menuTitle,o="dynamicPage"+this.currentTemplate.id,n={actions:[{code:"".concat(i,"_").concat(o,":query"),name:"查看"}],code:o,path:o,type:0,href:this.currentTemplate.id,parent:a,title:r,icon:"new-page",order:0};Object(_["b"])(n).then((function(e){var a=e.error;a?t.$message.error(a.message):t.doRelease()}))}else this.doRelease()}},{key:"doRelease",value:function(){var e=this,t=this.currentTemplate.id,a=this.currentTemplate.status,i="",r="",o="";0===a?(i=this.selectedMenu.id,r=this.selectedMenu.code,o=this.selectedMenu.menuTitle):2===a&&(i=this.currentTemplate.parentMenuId,r=this.currentTemplate.parentMenuCode,o=this.currentTemplate.menuTitle);var n={id:t,status:1===a?0:1};0!==a&&2!==a||(n.parentMenuId=i,n.parentMenuCode=r,n.menuTitle=o),Object(d["g"])(n).then((function(t){var i=t.error;i?e.$message.error(i.message):(e.$message.success(1===a?"撤销成功":"发布成功"),0===a&&e.cancelDialog(),e.getTemplateList())}))}},{key:"modify",value:function(e){this.$router.push({path:"/sysSupport/editPageTemplate",query:{id:e.id,type:"modify"}})}},{key:"copy",value:function(e){this.$router.push({path:"/sysSupport/editPageTemplate",query:{id:e.id,type:"copy"}})}},{key:"delete",value:function(e){var t=this;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={id:e.id};Object(d["c"])(a).then((function(e){var a=e.error;a?t.$message.error(a.message):(t.$message.success("删除成功"),t.getTemplateList())}))})).catch((function(){}))}},{key:"addPageTemplate",value:function(){this.$router.push({path:"/sysSupport/editPageTemplate",query:{type:"new"}})}},{key:"saveDialog",value:function(){var e=this,t=this.$refs["menuForm"];t.validate((function(t){if(t){if(!e.selectedMenu.id)return void(e.showError=!0);e.registerMenu(1)}}))}},{key:"cancelDialog",value:function(){this.dialogVisible=!1,this.selectedMenu={menuTitle:"",id:"",code:""},this.currentTemplate=null,this.showError=!1}},{key:"handleNodeClick",value:function(e,t,a){this.selectedMenu.id=e.id,this.selectedMenu.code=e.code,this.showError=!1;var i=this.$refs.menuTree;i.treeItems.forEach((function(e){e.removeAttribute("selected"),e.getElementsByClassName("el-tree-node").forEach((function(e){return e.removeAttribute("selected")}))})),a.$el.setAttribute("selected",!0)}},{key:"created",value:function(){!this.templateList.length&&this.getTemplateList()}},{key:"beforeRouteLeave",value:function(e,t,a){this.cacheParamData(),a()}},{key:"menuData",get:function(){var e=Object(p["cloneDeep"])(this.$store.getters.authorizes),t=this.formatMenuData(e);return t}}]),a}(c["e"]);b=Object(u["a"])([Object(c["a"])({components:{PreviewTemplate:f["a"]},mixins:[m]})],b);var v=b,y=v,g=(a("d443"),a("2877")),O=Object(g["a"])(y,i,r,!1,null,null,null);t["default"]=O.exports},c0aa:function(e,t,a){},cfb4:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFEAAAA6CAYAAAG/u4U5AAAAAXNSR0IArs4c6QAACYVJREFUeAHVG2usXEX5m3P3PtoChVof1BtSagChUdu7V02URzD+4IeRRDCpBIG4Zy9KWsBHUhN/2MTER4II1PLo3asGrUGCfwRjjCaoqZLi2b02oSr4inI1gFIVtL2td8/4fXN25sycM+fsmXPP7t1OsjvffPO95pv34wAkw62dy5IomfYkoOKV8JiCE0CamHk3J2gykn5wb0aOQJuSOdwusI32bmgEPMlYA7/9I+D8vSKj5kUx8P0wBhMGA2NXJpmjtEUqZZhm2FlzsHs6r7XlpqWeCF/qT5hhIzGmJdrEWXFSqox7RMzw28IsQx9/F338AWDwHHC42CpMIRPSFL4agKQ7asj3UKN9TxnL8oUCvwPIcY4hWygV2fNuSskr4Aq7Fc32fgj5bmUlCWLsr1jNr0ElU0JRsgRSGeJrKUsIMV/fg//064XaO4GvHBGJpDBJUiomS/z2paV4U0yN9n9SuBxEdiURE+fob74hhz+VlS/Qb4cpjj6IfIGS+bZjb5BgvzhboChuj/308t5+gmR+tkBRXHYa22KIQ80dkqFfnC2QOBfqk/j/ZawYe2ewSLcL1Is7uf5Liq/Z+Qj4wQmVtgB2gVRcxk4J+gOXvqz4wnABi79OpS2AvQsSYase9d8UE/qVeo7eFf3gGVS0HYD9ulZ4YG20r0FfRn4lgXJgIIVqiuaX1QxNKWt0BP8BWvA9gdGtI4Rmoc6RDSctyqZczeRpl5pdKQY9ewTn0q0GKiNRuMFm8IOqHAbHoTVLo3vlwd62i6rRZ2AOm4qyudKVNzIa0wuPRa6G6fTljVTzBHZyGfzO9RKsMi5npL7sjwbkyCbOC08bLoVwN5KqWW435GaGsV/0rJx1UV6U1t1IvZpbMw8LRYzFM1FRzQ50bkOQH9yHXozWgMmhXM4T47UZeHDHorBB4ijBxq6G1s6fCLzjX3FP7uOeMpCxD2fqWelG7ZLmdj3w7pO49vysjrLCH13cCs3OXvCPXijzaScV71YlNi+mtYFtOveDF7AQrxes5GXpRY89BBu8T8Or3X/mic3Mm5jY5FbdmZIwo9H+OK4H7hYkDF40DJZ8jeAPCG6TyUJxpUZSr1edqqd+asNm0FdjRayi6l7p7oLxiUfhgbf+kViq8yRJk1VMMLAAF7VvF+Aq/4p3HFdFFRnoqtZO7wdHsJqjFaadYlXYguu+DB3NxXdB2H2HtnjOICyPXl018+53lOqcE0RFUwJYpYEwrXSG/N0KrhAobyBVrx44v1xPVgWXN1CvXrKGw6gZqFVv5K5tVXlNl1POg43FuL0x+LkusGq4nIEsjHsvwBNVG6XLK2cg528UQhhD49iIeXAuiDuDx2+E6ZmnVIn3/SnjpEVROAPuHuyyuHoPzv4b9rEVpXXpuDn0qIzygLuBwLcIdaJ6E4oHMBa6GZis3oR9uIiLqz+ZVzLttlgQ1ds7VaPqTYd4+KE8uU70apfA/I7n0uT9MW4ejKv3cUM0g9+KNIf1Cj8XXKDgcOVZBTsCxQ3021co2R5P7vYOqzwJhOxhCYq42b7FSBdMFDcQuNl7dQXMMhZyfpVOgpc4XzfSWYlGcAP4nYbMLm4gh/MFE2Nm9RIyBNODtx07Syowrqv89tcUPgk0jm3qtdlDwMOWgD91dEO8p00yZKXXb9wI+y96JZUtO8SUtxVOhV/A1c2HBE20b/4HwiUORRmeIjgFxq3G6TJO47pQGscg6uljPe/rdIVgjnd0yfOXQow5RByuVLnMi9rSwdn/QbM9h+3woMorBLDilzF95ckq1gldCk9tEE7G1y8k57zxs9wGal15CqZTWT6hobsa3B9c2H4ciahP3IDxeqzZFjFVaCCnZdfVJFQEz8OzmxJhYfbbOpdjJ9FZU7C5Lpyf2Z+iKIGozkCPmWNhCWNsLNUZOD4Ve5DBF23K1h5HPZl++k3rKq2q9hjO1Rhxvth5Bnu/9vAK7/8W6tEs5Cpvjeira4ZlCtDs4Cmy7kASwneBvt4oI3fIPGvnRDqC4vxOa3lPLVe+w7HqqQi5Nk4Ul4PaKWiqMIM5dEypqQhR4cLBwSK/8xWkns7kGMBeO1NXBRnDb4niqBHfFuYFzqirr+2kl2dfIm+4TiTHmMehCXNkEtfq/tFKLtikxEHGw3ViE5/MyiPbuFTfx+3JA3GyB3nhGTO5DM+J1I3lSxPlMdwhnj12I+LT2wh+5kwuw3FiVjdmrAn37PwXTHnxVkc5uPqD3Fh0tdBwnGjrxnREL58VHZj5M3bpJaNonL8Obl28yMCNaGLwTqSrA1s3plsiI1iOccPQPLU36EcnMVgnUjfWb69kuT3mQ/Kqwz4unhGTy2AX2832vei3LdJ3Iqaz+vmZbxo4SnjeYXxokkTnt8RG8Dk6eESmF4F5d6LcnyYFDCM9uAUtXRFx/jOzEDgbj+FYl2yFkkh8M5L4zCPr1ZjfDlB+XbJGMT52X6hfa+IGnxpMd45eVD6SMt/WjQ0iceZsYMB2GOEHt6cdSGz8/XhW2AHSP8QwGGVL9B1a76JcFiarG8t8ipllvQiJyWUu2IwTFR6hZYadsNT5C8wF8U1tJmk1GdWPiVE3jh4eSxvp+ey6cxKzsczUY5qhe3fsEp18BBUyvGjlYzJbxCSfc/q4KAq0K+qyl2B352L46szfJNopngs2QsgOoNxdyKfpwxtEBvfDubW9cNfb/ksyGdbYBUhM3wrhzZxxv+SkM5eYHkm36t/KpaHMPb+bhBOvnEQ74rGaPuOanpkUb1IawQeR6tGEnBdQ9hZ8mnkX4j9h5BEv8+owv/NXBr5fwg++gf64uR8Zfnd1AHXvpue/r6K345vrvpyuBI6DfaP9S3Si+cEBfb48PXUEnj/5d9R+jmGBx67BTy9/KHDNzh4Iw/uM/EEnxqDugce3o0d/jI0SbzorDS/jsuWTzrOlbVykx0ZLy3RvaDqQsUPKgWQ63S2OwfuwLIkxodJypYTF3SaVtUaIZuc6bE2PGdoZjm+0DTTDMt6Xb5bjkpm1ypRjdx7M7LyaMoxPpg8j0g7ExTn72EAcSLa3Zm/BFn0u9tBDmErsAGhiwbEQHzzQeEjko9cSySo/+D0O7G8iMCM8iQ8j3pORN3T06LXEyAWHcz0xOdl/5swVUG3maDrR9jBPlpuxz8D9b3leJkchHk0n2k50Im89i+PQ50fBcboNo+nEVv03OFof1w2N4NpNadzaY0bTieSXdd6bcRZ8HKFl/B0BNr4NFnY8TVmjFv4PhLPGkGCnyNkAAAAASUVORK5CYII="},d443:function(e,t,a){"use strict";var i=a("b6fc"),r=a.n(i);r.a},d58f:function(e,t,a){var i=a("1c0b"),r=a("7b0b"),o=a("44ad"),n=a("50c4"),l=function(e){return function(t,a,l,s){i(a);var u=r(t),c=o(u),d=n(u.length),_=e?d-1:0,f=e?-1:1;if(l<2)while(1){if(_ in c){s=c[_],_+=f;break}if(_+=f,e?_<0:d<=_)throw TypeError("Reduce of empty array with no initial value")}for(;e?_>=0:d>_;_+=f)_ in c&&(s=a(s,c[_],_,u));return s}};e.exports={left:l(!1),right:l(!0)}},db30:function(e,t,a){"use strict";var i=a("246a"),r=a.n(i);r.a},de3c:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("simple-dialog",{ref:"advance",attrs:{"dialog-title":e.dialogTitle,"dialog-visible":e.dialogTestSwitch,"dialog-width":"600px","botton-show":"true","save-text":"保存","cancel-text":"取消"},on:{saveEmit:e.treeDataTest,cancelEmit:e.cancelSwitch}},[a("AdvancedScreening",{attrs:{spread:e.spread.visible,model:e.spread.model,items:e.spread.items,"label-width":"30%","screen-loading":e.spread.loading},on:{doQuery:e.handleQuery,doReset:e.handleReset}})],1)],1)},r=[],o=(a("4160"),a("159b"),a("d4ec")),n=a("bee2"),l=a("262e"),s=a("2caf"),u=a("9ab4"),c=a("60a3"),d=a("d2a6"),_=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.spread={visible:!0,model:{},items:[],loading:!1},e}return Object(n["a"])(a,[{key:"treeDataTest",value:function(){}},{key:"cancelSwitch",value:function(){}},{key:"getVisible",value:function(e){var t=[],a={};e.forEach((function(e){e.value?a[e.fieldCode]=e.value:e.dafalutValue?a[e.fieldCode]=e.dafalutValue:a[e.fieldCode]="",3===e.fieldType?t.push({key:e.fieldCode,label:e.fieldName,type:"switch"}):2===e.fieldType?t.push({key:e.fieldCode,label:e.fieldName,type:"date",TimePickerOptions:"",clearable:!0,disabled:!1}):t.push({type:"input",key:e.fieldCode,label:e.fieldName,placeholder:1===e.fieldType?"请输入数字":"请输入文本",config:{props:{type:1===e.fieldType?"number":"input"}}})})),this.spread.items=t,this.spread.model=a}}]),a}(c["e"]);Object(u["a"])([Object(c["c"])(Array)],_.prototype,"paramsList",void 0),Object(u["a"])([Object(c["c"])(String)],_.prototype,"dialogTitle",void 0),Object(u["a"])([Object(c["c"])({default:!1})],_.prototype,"dialogTestSwitch",void 0),Object(u["a"])([Object(c["b"])("saveEmitSwitch")],_.prototype,"treeDataTest",null),Object(u["a"])([Object(c["b"])("cancelEmitSwitch")],_.prototype,"cancelSwitch",null),Object(u["a"])([Object(c["f"])("paramsList",{immediate:!0,deep:!0})],_.prototype,"getVisible",null),_=Object(u["a"])([Object(c["a"])({components:{AdvancedScreening:d["a"]}})],_);var f=_,p=f,h=a("2877"),m=Object(h["a"])(p,i,r,!1,null,null,null);t["a"]=m.exports},e959:function(e,t,a){},f114:function(e,t,a){},f183:function(e,t,a){var i=a("d012"),r=a("861d"),o=a("5135"),n=a("9bf2").f,l=a("90e3"),s=a("bb2f"),u=l("meta"),c=0,d=Object.isExtensible||function(){return!0},_=function(e){n(e,u,{value:{objectID:"O"+ ++c,weakData:{}}})},f=function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,u)){if(!d(e))return"F";if(!t)return"E";_(e)}return e[u].objectID},p=function(e,t){if(!o(e,u)){if(!d(e))return!0;if(!t)return!1;_(e)}return e[u].weakData},h=function(e){return s&&m.REQUIRED&&d(e)&&!o(e,u)&&_(e),e},m=e.exports={REQUIRED:!1,fastKey:f,getWeakData:p,onFreeze:h};i[u]=!0},fbe3:function(e,t,a){"use strict";var i=a("e959"),r=a.n(i);r.a}}]);
//# sourceMappingURL=chunk-2ace2358.89e5574d.js.map