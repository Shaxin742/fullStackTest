(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02a6d434"],{"05b0":function(e,t,a){},"229b":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ruleEditor"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.ifEvent,expression:"!ifEvent"}],staticClass:"labelTitle"},[a("span",[e._v("数据视图：")]),a("el-select",{attrs:{filterable:"",disabled:e.detailEdit,placeholder:"请选择"},on:{change:e.queryChange},model:{value:e.dataViewId,callback:function(t){e.dataViewId=t},expression:"dataViewId"}},e._l(e.dataViewList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.ifEvent,expression:"ifEvent"}],staticClass:"labelTitle"},[a("span",[e._v(e._s(e.eventName))])]),a("div",{staticStyle:{"margin-top":"10px"}},[e._t("dataView-queryParams")],2),"conf"!==e.modeType&&e.modeType?e._e():a("div",{staticClass:"basicContent"},[a("div",{staticClass:"basicQueryLeft content"},[a("note-card",{attrs:{title:e.isMonitor?"监控数据":e.ifEvent?"流程变量":"数据视图",shadow:""}},[a("el-tree",{ref:"viewTree",staticClass:"filter-tree",attrs:{data:e.isMonitor?e.monitorOptions:e.ifEvent?e.formatFlowVariables:e.dataViewTree,draggable:"true",props:e.defaultProps,"allow-drag":e.canDrag,"allow-drop":e.allowDrop},on:{"node-drag-start":e.dataDragStart}})],1)],1),a("div",{staticClass:"basicQueryRight content"},[a("note-card",{attrs:{title:"决策编辑器",shadow:""}},[a("el-tree",{ref:"ruleTree",attrs:{data:e.editorRuleTree,"default-expand-all":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,n=t.data;return a("div",{staticClass:"custom-tree-node"},[""!==n.logicalOperator&&void 0!==n.logicalOperator?a("div",{staticClass:"leftBox"},[a("el-select",{attrs:{size:"mini"},model:{value:n.logicalOperator,callback:function(t){e.$set(n,"logicalOperator",t)},expression:"data.logicalOperator"}},e._l(e.actionType,(function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.value}})})),1)],1):a("div",{staticClass:"leftBox"},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:!n.condition.fieldName&&!n.condition.fieldCode,expression:"\n                  !data.condition.fieldName && !data.condition.fieldCode\n                "}],staticClass:"input-special",staticStyle:{"margin-right":"0px"},attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.leftIpt(n)}},model:{value:n.condition.leftIpt,callback:function(t){e.$set(n.condition,"leftIpt",t)},expression:"data.condition.leftIpt"}}),a("div",{staticClass:"name",attrs:{draggable:!1},on:{dragover:function(e){return e.preventDefault()},dragenter:function(e){return e.preventDefault()},drop:function(t){return e.handleSomethingDrop(i,n,e.ev)}}},[e._v(" "+e._s(n.condition.fieldName)+" "),a("i",{directives:[{name:"show",rawName:"v-show",value:!n.condition.fieldName&&!n.condition.fieldCode,expression:"\n                    !data.condition.fieldName && !data.condition.fieldCode\n                  "}],staticClass:"el-icon-edit"})]),a("div",{staticClass:"operate"},[a("el-select",{staticClass:"select-special",attrs:{size:"mini"},model:{value:n.condition.operator,callback:function(t){e.$set(n.condition,"operator",t)},expression:"data.condition.operator"}},e._l(e.connectortype,(function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.value}})})),1)],1),a("div",{staticClass:"right"},[0!==n.condition.fieldType&&2!==n.condition.fieldType&&"text"!==n.condition.fieldType||n.condition.fieldNameEvent?e._e():a("el-input",{staticClass:"input-special",attrs:{placeholder:"请输入",size:"mini"},on:{input:function(t){return e.rightIpt(n)}},model:{value:n.condition.rightIpt,callback:function(t){e.$set(n.condition,"rightIpt",t)},expression:"data.condition.rightIpt"}}),1!==n.condition.fieldType||n.condition.fieldNameEvent?e._e():a("el-input",{staticClass:"input-special",attrs:{placeholder:"请输入",size:"mini",type:"number"},on:{input:function(t){return e.rightIpt(n)}},model:{value:n.condition.rightIpt,callback:function(t){e.$set(n.condition,"rightIpt",t)},expression:"data.condition.rightIpt"}}),0===n.condition.fieldType||1===n.condition.fieldType||2===n.condition.fieldType||"text"===n.condition.fieldType?a("div",{staticClass:"event_div",attrs:{draggable:!1},on:{dragover:function(e){return e.preventDefault()},dragenter:function(e){return e.preventDefault()},drop:function(t){return e.handleSomethingDropEvent(i,n,e.ev)}}},[e._v(" "+e._s(n.condition.fieldNameEvent)+" ")]):e._e(),0!==n.condition.fieldType&&1!==n.condition.fieldType&&2!==n.condition.fieldType&&"text"!==n.condition.fieldType||!n.condition.fieldNameEvent?e._e():a("div",{staticClass:"event_div",attrs:{draggable:!1}},e._l(n.condition.paramTypeList,(function(t,o){return a("div",{key:o,staticStyle:{display:"inline-block"}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:!t.argumentsCode&&!t.fieldTypeEvent,expression:"!item.argumentsCode && !item.fieldTypeEvent"}],staticClass:"input-special",staticStyle:{"margin-right":"0px"},attrs:{placeholder:t.paramName,size:"mini"},model:{value:t.paramValue,callback:function(a){e.$set(t,"paramValue",a)},expression:"item.paramValue"}}),a("div",{staticClass:"arguments_div",attrs:{draggable:!1},on:{dragover:function(e){return e.preventDefault()},dragenter:function(e){return e.preventDefault()},drop:function(a){return e.handleSomethingDropArguments(i,n,t,e.ev)}}},[e._v(e._s(t.argumentsValue)+" "),a("i",{directives:[{name:"show",rawName:"v-show",value:!t.argumentsCode,expression:"!item.argumentsCode"}],staticClass:"el-icon-edit"})]),a("functionModule",{attrs:{item:t,handleSomethingDropArguments:e.handleSomethingDropArguments}})],1)})),0),3===n.condition.fieldType?a("el-select",{staticClass:"input-special",attrs:{size:"mini"},model:{value:n.condition.right,callback:function(t){e.$set(n.condition,"right",t)},expression:"data.condition.right"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e()],1)],1),a("div",{staticClass:"rightBox"},[a("el-tooltip",{attrs:{content:"添加决策",placement:"bottom"}},[""!==n.logicalOperator&&void 0!==n.logicalOperator?a("span",{staticClass:"marginRt",on:{click:function(t){return e.addLeaf(n)}}},[a("svg-icon",{staticClass:"command",attrs:{"icon-class":"icon_leaf"}})],1):e._e()]),a("el-tooltip",{attrs:{content:"添加判断逻辑",placement:"bottom"}},[""!==n.logicalOperator&&void 0!==n.logicalOperator?a("span",{staticClass:"marginRt",on:{click:function(t){return e.addRelation(n)}}},[a("svg-icon",{staticClass:"command",attrs:{"icon-class":"icon_add_s"}})],1):e._e()]),a("el-tooltip",{attrs:{content:"删除",placement:"bottom"}},[a("span",{on:{click:function(t){return e.remove(i,n)}}},[a("svg-icon",{staticClass:"command",attrs:{"icon-class":"icon_delete_s"}})],1)])],1)])}}],null,!1,3901757137)})],1)],1)]),e.manual?a("div",{staticClass:"labelTitle"},[a("span",[e._v("内容模板：")]),a("rghMenu",{ref:"rghMenu",staticStyle:{"margin-top":"20px"},attrs:{manual:e.manual,manualRghTree:e.manualRghTree,width:"100%",substanceText:e.substanceText},on:{getContent:e.getContent}})],1):e._e()])},n=[],o=(a("99af"),a("4de4"),a("c740"),a("4160"),a("c975"),a("a15b"),a("d81d"),a("a434"),a("b0c0"),a("b64b"),a("ac1f"),a("5319"),a("1276"),a("159b"),a("2909")),r=(a("96cf"),a("1da1")),l=a("5530"),s=a("d4ec"),c=a("bee2"),d=a("262e"),u=a("2caf"),f=a("9ab4"),p=a("60a3"),h=a("cb9b"),m=a("fa38"),v=a("ca00"),g=a("4bb5"),y=a("0644"),b=a.n(y),T=a("32c8"),w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"functionModule"},[4==e.item.fieldTypeEvent?a("div",{staticClass:"event_div child_event",attrs:{draggable:!1}},e._l(e.item.paramTypeList,(function(t,i){return a("div",{key:i,staticStyle:{display:"inline-block"}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:!t.argumentsCode&&!t.fieldTypeEvent,expression:"!item2.argumentsCode && !item2.fieldTypeEvent"}],staticClass:"input-special",staticStyle:{"margin-right":"0px"},attrs:{placeholder:t.paramName,size:"mini"},model:{value:t.paramValue,callback:function(a){e.$set(t,"paramValue",a)},expression:"item2.paramValue"}}),a("div",{staticClass:"arguments_div",attrs:{draggable:!1},on:{dragover:function(e){return e.preventDefault()},dragenter:function(e){return e.preventDefault()},drop:function(a){return e.handleSomethingDropArguments(e.node,e.data,t,e.ev)}}},[e._v(e._s(t.argumentsValue)+" "),a("i",{directives:[{name:"show",rawName:"v-show",value:!t.argumentsCode&&!t.fieldTypeEvent,expression:"!item2.argumentsCode && !item2.fieldTypeEvent"}],staticClass:"el-icon-edit"})]),a("FunctionModule",{attrs:{item:t,handleSomethingDropArguments:e.handleSomethingDropArguments}})],1)})),0):e._e()])},C=[],O=function(e){Object(d["a"])(a,e);var t=Object(u["a"])(a);function a(){return Object(s["a"])(this,a),t.apply(this,arguments)}return Object(c["a"])(a,[{key:"mounted",value:function(){}}]),a}(p["e"]);Object(f["a"])([Object(p["c"])({})],O.prototype,"item",void 0),Object(f["a"])([Object(p["c"])({default:[]})],O.prototype,"data",void 0),Object(f["a"])([Object(p["c"])({})],O.prototype,"handleSomethingDropArguments",void 0),O=Object(f["a"])([Object(p["a"])({components:{}})],O);var k=O,V=k,j=(a("5101"),a("2877")),D=Object(j["a"])(V,w,C,!1,null,null,null),N=D.exports,x=Object(g["a"])("processTemplate"),E=function(e){Object(d["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(s["a"])(this,a),e=t.apply(this,arguments),e.dataViewTree=[],e.dataViewList=[],e.formatFlowVariables=[],e.editorRuleTree=[],e.options=[{value:!0,label:"是"},{value:!1,label:"否"}],e.dataViewId="",e.oldDataViewId="",e.substanceText="",e.defaultProps={label:"fieldName"},e.actionType=[{name:"并且(逻辑与)",value:"&&"},{name:"或者(逻辑或)",value:"||"}],e.connectortype=[{name:"=",value:"=="},{name:">",value:">"},{name:"<",value:"<"},{name:"!=",value:"!="},{name:">=",value:">="},{name:"<=",value:"<="}],e.dateUnitList=[{value:1,label:"年"},{value:2,label:"月"},{value:3,label:"日"}],e.dateUnitListQuarter=[{value:4,label:"工作日"},{value:5,label:"自然日"}],e.dateUnitListMonth=[{value:6,label:"工作日"},{value:7,label:"自然日"}],e.formatDate={dateSel:"",baseDate:"",offsetList:[],showDatePicker:!0},e.overuseDecisions=[{fieldName:"常用字段",root:!0,children:[{fieldCode:"当前日期()",fieldName:"当前日期",fieldType:2,format:0},{fieldCode:"当前时间()",fieldName:"当前时间",fieldType:0,format:0},{fieldCode:"当前日期时间()",fieldName:"当前日期时间",fieldType:0,format:0},{fieldCode:"当前月份()",fieldName:"当前月份",fieldType:1,format:0},{fieldCode:"当前年份()",fieldName:"当前年份",fieldType:1,format:0},{fieldCode:"当前天数()",fieldName:"当前天数",fieldType:1,format:0},{fieldCode:"true",fieldName:"是",fieldType:0,format:0},{fieldCode:"false",fieldName:"否",fieldType:0,format:0}]}],e.commonEvent={fieldName:"常用函数",root:!0,children:[]},e.monitorOptions=[{fieldName:"监控结果",root:!0,children:[{fieldCode:"totalCount",fieldName:"总条数",fieldType:0},{fieldCode:"isAllMatched",fieldName:"是否全部匹配",fieldType:0},{fieldCode:"matchedCount",fieldName:"匹配条数",fieldType:0},{fieldCode:"notMatchedCount",fieldName:"不匹配条数",fieldType:0}]},{fieldName:"常用决策",root:!0,children:[{fieldCode:"true",fieldName:"是",fieldType:0},{fieldCode:"false",fieldName:"否",fieldType:0}]}],e.manualRghTree=[],e}return Object(c["a"])(a,[{key:"resetItem",value:function(){}},{key:"getParams",value:function(e){this.reset(),""!==JSON.stringify(e)&&(this.queryCommonRules(),0===this.dataViewTree.length&&e&&(this.dataViewId=e,this.dataViewQuery(this.dataViewId,!0)))}},{key:"watchContentIf",value:function(e){var t=this;e&&this.$nextTick((function(){t.rghMenu.init(),t.rghMenu.refreshContent()}))}},{key:"watchDataViewId",value:function(e,t){this.oldDataViewId=t}},{key:"watchRuleSwitch",value:function(e){if(this.substanceText="",e&&e.length)this.substanceText=e[0].script?e[0].script:"",this.ifEvent&&0===this.dataViewTree.length?this.formatFlowVariablesFun():this.ifEvent||0!==this.dataViewTree.length?this.refreshEditorTree(!0):this.dataViewQuery(this.dataViewId,!0);else{var t=this.createRegulation();t.logicalOperator="&&",this.editorRuleTree=[t]}}},{key:"syncRuleChange",value:function(){this.dataViewId&&this.$emit("change",this.dataViewId,this.editorRuleTree)}},{key:"allChange",value:function(){this.getViewDataOptions()}},{key:"detailEditChange",value:function(){this.detailEdit&&(this.detailEdit=!0)}},{key:"getCurrentRule",value:function(){return this.ifEvent?this.handleSaveConcatParams(this.editorRuleTree[0]):{dataViewId:this.dataViewId,ruleArray:this.handleSaveConcatParams(this.editorRuleTree[0])}}},{key:"createRegulation",value:function(){return{script:"",logicalOperator:"&&",condition:{left:"",operator:"",right:""},children:[]}}},{key:"getContent",value:function(e){this.editorRuleTree[0].script=e}},{key:"dateSelChange",value:function(e){if("systemNow"===e.dateSel)e.showDatePicker=!1,e.baseDate="getDate()";else{if("currentQuarter"===e.dateSel)return e.showDatePicker=!1,e.baseDate="",void(e.offsetList=[{type:4,sign:"+",offset:1}]);if("currentMonth"===e.dateSel)return e.showDatePicker=!1,e.baseDate="",void(e.offsetList=[{type:6,sign:"+",offset:1}]);"selDate"===e.dateSel&&(e.showDatePicker=!0,e.baseDate="")}e.offsetList=[{type:3,sign:"+",offset:1}]}},{key:"leftIpt",value:function(e){this.$set(e.condition,"fieldType","text"),e.condition.left='"'.concat(e.condition.leftIpt,'"')}},{key:"rightIpt",value:function(e){e.condition.right='"'.concat(e.condition.rightIpt,'"')}},{key:"dateUnitChange",value:function(e,t,a){var i=this,n=!0;if(0!==t){var o=0;if(a.forEach((function(r){if(r.type>e)return i.$message.info('请保证"年"偏移量在"月"前面设置'),a.splice(t,1),n=!1,!1;r.type===e&&o++})),o>1){var r=this.$message,l=1===e?"年":2===e?"月":3===e?"日":"";return r.closeAll(),this.$message.info('已经选择过"'.concat(l,'"的偏移量')),a.splice(t,1),n=!1,!1}}n&&3!==e&&a.push({type:3,sign:"+",offset:1})}},{key:"formatTreeData",value:function(e,t){var a=this,i=[];return e&&e.length>0?e.forEach((function(e){var t=a.createRegulation();if(t.logicalOperator=e.logicalOperator,e.children&&e.children.length>0)t.children=a.formatTreeData(e.children,!1);else if(e.condition){var n=e.condition,o=a.isMonitor?a.monitorOptions:a.ifEvent?a.formatFlowVariables:a.dataViewTree,r=Object(v["b"])(o,"fieldCode",n.left);r&&(a.$set(n,"fieldName",r.fieldName),a.$set(n,"fieldType",r.fieldType)),t.condition=n}i.push(t)})):t&&i.push(this.createRegulation()),i}},{key:"getViewDataOptions",value:function(){var e=this,t={type:"0"};this.all||(t.dictFlag="0"),Object(h["e"])(t).then((function(t){var a=t.data,i=t.error;i?e.$message.error(i.message):e.dataViewList=a}))}},{key:"queryCommonRules",value:function(){var e=this;Object(m["e"])().then((function(t){var a=t.data,i=t.error;if(!i){var n=[];a.forEach((function(e){n.push({fieldCode:e.methodName,fieldTypeEvent:4,fieldName:e.methodAlias,paramTypeList:e.paramTypeList instanceof Array&&e.paramTypeList.length>0?e.paramTypeList.map((function(e){return Object(l["a"])(Object(l["a"])({},e),{},{paramValue:"",argumentsValue:""})})):[]})})),e.commonEvent.children=n,Object(v["a"])(e.formatFlowVariables,"fieldName","常用函数")||e.formatFlowVariables.push(e.commonEvent),Object(v["a"])(e.dataViewTree,"fieldName","常用函数")||e.dataViewTree.push(e.commonEvent),Object(v["a"])(e.monitorOptions,"fieldName","常用函数")||e.monitorOptions.push(e.commonEvent)}}))}},{key:"dataViewQuery",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,a){var i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["e"])({type:"0"}).then((function(e){var n=e.data,o=e.error;o||i.doViewDataFieldsGet(n,t,a)}));case 2:case"end":return e.stop()}}),e)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"doViewDataFieldsGet",value:function(e,t,a){if(this.dataViewTree=Object(o["a"])(this.overuseDecisions),this.manualRghTree=[],e.length){var i=Object(v["a"])(e,"id",t);if(i){var n=this.concatId(t,i);this.dataViewTree.unshift({fieldName:n.name,fieldCode:t,root:!0,children:this.splicingViewForeignFields(n.fields,t)}),this.manual&&(this.manualRghTree.unshift({fieldName:n.name,fieldCode:t,root:!0,children:this.splicingViewForeignFields(n.fields,t)}),this.rghTreeFormat())}this.refreshEditorTree(a)}this.queryCommonRules()}},{key:"splicingViewForeignFields",value:function(e,t){var a=this,i=Object(o["a"])(e),n=[];return e.forEach((function(e){if(e.foreignId&&-1===n.indexOf(e.foreignId)){n.push(e.foreignId);var r=Object(v["a"])(a.dataViewList,"id",e.foreignId);r&&i.push.apply(i,Object(o["a"])(r.fields.map((function(e){return Object(l["a"])(Object(l["a"])({},e),{},{fieldCode:"".concat(t,".").concat(e.fieldCode),fieldName:"".concat(r.name,"_").concat(e.fieldName)})}))))}})),i}},{key:"rghTreeFormat",value:function(){var e=this;function t(e){for(var a=0;a<e.length;a++)e[a].text=e[a].fieldName,e[a].value=e[a].fieldCode,e[a].children&&e[a].children.length>0&&(e[a].children=t(e[a].children));return e}t(this.manualRghTree),this.$nextTick((function(){e.rghMenu.queryDataViewsFields()}))}},{key:"concatId",value:function(e,t){if(t&&t.fields&&t.fields.length){var a=b()(t);return a.fields.forEach((function(t){t.fieldCode="".concat(e,".").concat(t.fieldCode)})),a}return[]}},{key:"addRelation",value:function(e){var t=this.createRegulation();t.logicalOperator="&&",e.children||this.$set(e,"children",[]),e.children.push(t)}},{key:"addLeaf",value:function(e){var t=this.createRegulation();t.logicalOperator="",t.condition["fieldName"]="",t.condition["operator"]="==",e.children||this.$set(e,"children",[]),e.children.push(t)}},{key:"remove",value:function(e,t){var a=this,i=e.parent,n=[];t.children&&t.children.length?this.$confirm("此操作将永久删除本节点以及所有子节点, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n=i.data,a.sureDel(n,t)})).catch((function(){})):(n=i.data.children,this.sureDel(n,t))}},{key:"refreshEditorTree",value:function(e){if(e){var t=b()(this.rule);this.editorRuleTree=this.formatTreeData(t,!0),this.editorRuleTree[0].script=this.substanceText}else{var a=this.createRegulation();a.logicalOperator="&&",this.editorRuleTree=[a],this.substanceText=this.editorRuleTree[0].script}}},{key:"sureDel",value:function(e,t){var a=e.findIndex((function(e){return e.$treeNodeId===t.$treeNodeId}));e.splice(a,1)}},{key:"created",value:function(){this.viewList.length?this.dataViewList=this.viewList:this.getViewDataOptions(),this.formatFlowVariables.length||this.formatFlowVariablesFun()}},{key:"formatFlowVariablesFun",value:function(){function e(t){for(var a=0;a<t.length;a++)t[a].fieldName=t[a].label,t[a].fieldCode=t[a].value,t[a].fieldType=t[a].fieldType||0,t[a].children&&t[a].children.length>0&&(t[a].children=e(t[a].children));return t}var t;(this.formatFlowVariables=b()(this.flowVariables),e(this.formatFlowVariables),Object(v["a"])(this.formatFlowVariables,"fieldName","常用时间"))||(t=this.formatFlowVariables).push.apply(t,Object(o["a"])(this.overuseDecisions));this.refreshEditorTree(!0),this.queryCommonRules()}},{key:"reset",value:function(){this.dataViewId="",this.dataViewTree=[];var e=this.createRegulation();e.logicalOperator="&&",this.editorRuleTree=[e],this.resetItem()}},{key:"ruleTreeFun",value:function(e){"add"===e&&this.reset()}},{key:"queryChange",value:function(e){var t=this;this.editorRuleTree[0].children.length?this.$confirm("此操作将清空已编辑的决策编辑器数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.refreshEditorTree(!1),t.regionCge(e)})).catch((function(){t.dataViewId=t.oldDataViewId})):(this.regionCge(e),this.queryChangeView(e))}},{key:"queryChangeView",value:function(e){var t=Object(v["a"])(this.dataViewList,"id",e);return t.fields}},{key:"regionCge",value:function(e){var t=[],a=Object(v["a"])(this.dataViewList,"id",e);if(a&&a.queryParams&&(t.push({fields:a.fields}),t=a.queryParams.map((function(e){return{paramCode:e.code,paramName:e.name,paramType:e.type,paramValueName:e.defaultValue,paramValue:""}}))),a){var i=Object(o["a"])(this.overuseDecisions);this.manualRghTree=[];var n=this.concatId(e,a);i.unshift({fieldName:n.name,fieldCode:e,root:!0,children:this.splicingViewForeignFields(n.fields,e)}),this.manual&&(this.manualRghTree.unshift({fieldName:n.name,fieldCode:e,root:!0,children:this.splicingViewForeignFields(n.fields,e)}),this.rghTreeFormat()),i.push(this.commonEvent),this.dataViewTree=i}return t}},{key:"allowDrop",value:function(){return!1}},{key:"canDrag",value:function(e){return e.isLeaf}},{key:"dataDragStart",value:function(e,t){this.dragNodeData=void 0!==t?e:{}}},{key:"handleSomethingDrop",value:function(e,t){return 0!==Object.keys(this.dragNodeData).length&&(4!=this.dragNodeData.data.fieldTypeEvent&&(t.condition.fieldName=this.dragNodeData.data.fieldName,t.condition.left=this.dragNodeData.data.fieldCode,t.condition.fieldType=this.dragNodeData.data.fieldType,void(this.dragNodeData={})))}},{key:"handleSomethingDropEvent",value:function(e,t){if(0===Object.keys(this.dragNodeData).length)return!1;this.$set(t.condition,"fieldNameEvent",this.dragNodeData.data.fieldName),t.condition.leftEvent=this.dragNodeData.data.fieldCode,4==this.dragNodeData.data.fieldTypeEvent?t.condition.fieldTypeEvent=this.dragNodeData.data.fieldTypeEvent:t.condition.fieldTypeEvent="notFun";var a=b()(this.dragNodeData.data.paramTypeList);a&&a.forEach((function(e){e.paramValue="",e.argumentsValue="",e.argumentsCode=""})),this.$set(t.condition,"paramTypeList",a),this.dragNodeData={}}},{key:"handleSomethingDropArguments",value:function(e,t,a){if(0===Object.keys(this.dragNodeData).length)return!1;this.$set(a,"argumentsValue",this.dragNodeData.data.fieldName),this.$set(a,"argumentsCode",this.dragNodeData.data.fieldCode),a.fieldTypeEvent=this.dragNodeData.data.fieldTypeEvent,a.format=this.dragNodeData.data.format;var i=b()(this.dragNodeData.data.paramTypeList);i&&i.forEach((function(e){e.paramValue="",e.argumentsValue="",e.argumentsCode=""})),this.$set(a,"paramTypeList",i),this.dragNodeData={}}},{key:"handleSaveConcatParams",value:function(e){var t=this;return e&&e.children.length>0?e.children.forEach((function(e){e&&e.children.length>0&&t.handleSaveConcatParams(e);var a=e.condition;if(4!==a["fieldTypeEvent"])"notFun"===a["fieldTypeEvent"]&&(a["right"]=a.leftEvent);else{var i=function e(t){var a=[];return t.forEach((function(t){4==t.fieldTypeEvent?a.push(t.argumentsCode+"("+e(t.paramTypeList).join(",")+")"):0===t.format?a.push(t.argumentsCode):t.argumentsCode?a.push('"${'+t.argumentsCode+'}"'):a.push('"'.concat(t.paramValue,'"'))})),a},n=i(a.paramTypeList);a["right"]="".concat(a.leftEvent,"(").concat(n.join(","),")")}})):this.editorRuleTree[0].script||(this.editorRuleTree=[]),b()(this.editorRuleTree)}},{key:"splitParams",value:function(e){var t=this,a=e.replace(/\s*/g,"");if(-1===a.indexOf(","))"getDate()"===a?(this.formatDate.dateSel="systemNow",this.formatDate.baseDate="getDate()",this.formatDate.showDatePicker=!1):(this.formatDate.dateSel="selDate",this.formatDate.baseDate=a,this.formatDate.showDatePicker=!0);else{var i=a.replace(/\)|\(/g,",").split(","),n=i.filter((function(e){return""!==e}));this.formatDate.offsetList=[];var o=n.length-1;if("getCurrentQuarterTime"==n[0]||"getCurrentMoonTime"==n[0]){var r={};"getCurrentQuarterTime"==n[0]?(r["type"]=1==n[2]?4:2==n[2]?5:0,this.formatDate.dateSel="currentQuarter"):"getCurrentMoonTime"==n[0]&&(r["type"]=1==n[2]?6:2==n[2]?7:0,this.formatDate.dateSel="currentMonth");var l=n[1].substr(0,1);"-"===l?(r["sign"]="-",r["offset"]=parseInt(n[1].substr(1))):(r["sign"]="+",r["offset"]=parseInt(n[1])),this.formatDate.showDatePicker=!1,this.formatDate.offsetList.unshift(r)}else n.forEach((function(e,a){var i={};if(a<o/2){var r=n[o-a],l=r.substr(0,1);i["type"]="addDateForYear"===e?1:"addDateForMonth"===e?2:"addDateForDay"===e?3:0,"-"===l?(i["sign"]="-",i["offset"]=parseInt(r.substr(1))):(i["sign"]="+",i["offset"]=parseInt(r)),t.formatDate.offsetList.unshift(i)}else{if(a!==o/2)return;"getDate"===e&&(t.formatDate.dateSel="systemNow",t.formatDate.baseDate="getDate()",t.formatDate.showDatePicker=!1)}}))}return this.formatDate}}]),a}(p["e"]);Object(f["a"])([Object(p["c"])({default:[]})],E.prototype,"viewList",void 0),Object(f["a"])([Object(p["c"])({default:""})],E.prototype,"dataView",void 0),Object(f["a"])([Object(p["c"])({default:[]})],E.prototype,"rule",void 0),Object(f["a"])([Object(p["c"])({default:!1})],E.prototype,"all",void 0),Object(f["a"])([Object(p["c"])({default:!1})],E.prototype,"ifEvent",void 0),Object(f["a"])([Object(p["c"])({default:""})],E.prototype,"modeType",void 0),Object(f["a"])([Object(p["c"])({default:!1})],E.prototype,"isMonitor",void 0),Object(f["a"])([Object(p["c"])({default:!1})],E.prototype,"manual",void 0),Object(f["a"])([Object(p["c"])({default:"触发条件设置"})],E.prototype,"eventName",void 0),Object(f["a"])([Object(p["c"])({default:!1})],E.prototype,"detailEdit",void 0),Object(f["a"])([x.Getter("flowVariables")],E.prototype,"flowVariables",void 0),Object(f["a"])([Object(p["d"])()],E.prototype,"rghMenu",void 0),Object(f["a"])([Object(p["b"])("resetItem")],E.prototype,"resetItem",null),Object(f["a"])([Object(p["f"])("dataView",{deep:!0,immediate:!0})],E.prototype,"getParams",null),Object(f["a"])([Object(p["f"])("manual",{deep:!0,immediate:!0})],E.prototype,"watchContentIf",null),Object(f["a"])([Object(p["f"])("dataViewId")],E.prototype,"watchDataViewId",null),Object(f["a"])([Object(p["f"])("rule",{deep:!0,immediate:!0})],E.prototype,"watchRuleSwitch",null),Object(f["a"])([Object(p["f"])("editorRuleTree",{deep:!0,immediate:!0})],E.prototype,"syncRuleChange",null),Object(f["a"])([Object(p["f"])("all",{immediate:!0})],E.prototype,"allChange",null),Object(f["a"])([Object(p["f"])("detailEdit")],E.prototype,"detailEditChange",null),Object(f["a"])([Object(p["b"])("queryViewEmit")],E.prototype,"queryChangeView",null),Object(f["a"])([Object(p["b"])("queryParamsEmit")],E.prototype,"regionCge",null),E=Object(f["a"])([Object(p["a"])({components:{rghMenu:T["a"],functionModule:N}})],E);var _=E,S=_,R=(a("2771"),a("b2183"),Object(j["a"])(S,i,n,!1,null,"5a588ea3",null));t["a"]=R.exports},2771:function(e,t,a){"use strict";var i=a("05b0"),n=a.n(i);n.a},"2c89":function(e,t,a){},"32c8":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"rghMenu"},[a("div",{class:[e.theme,"default"],style:{width:e.width,height:e.height},attrs:{id:"test",contentEditable:""}}),a("ul",{staticClass:"rgh_ul"},[a("li",{directives:[{name:"popover",rawName:"v-popover:popover",arg:"popover"}]},[e._v("插入流程变量")])]),a("ul",{staticClass:"rgh_ul_span"},[a("li",{directives:[{name:"popover",rawName:"v-popover:popoverspan",arg:"popoverspan"}]},[e._v("替换流程变量")]),a("li",{on:{click:e.delFun}},[e._v("删除流程变量")])]),a("el-popover",{ref:"popover",attrs:{placement:"right",title:"标题",width:"200",trigger:"click","popper-class":"mail_poper"},model:{value:e.visiblePop,callback:function(t){e.visiblePop=t},expression:"visiblePop"}},[a("el-tree",{attrs:{data:e.dataViewsTree,props:e.treeProps,accordion:""},on:{"node-expand":function(t){return e.expandFun("visiblePop")},"node-click":e.handleNodeClick}}),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.closevisiblePop}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addConfirm}},[e._v("确定")])],1)],1),a("el-popover",{ref:"popoverspan",attrs:{placement:"right","popper-class":"mail_poper",title:"标题",width:"200",trigger:"click"},model:{value:e.visiblePopcge,callback:function(t){e.visiblePopcge=t},expression:"visiblePopcge"}},[a("el-tree",{attrs:{data:e.dataViewsTreeCge,props:e.treeProps,accordion:""},on:{"node-expand":function(t){return e.expandFun("visiblePopcge")},"node-click":e.handleNodeClickcge}}),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.closevisible}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.cgeConfirm}},[e._v("确定")])],1)],1)],1)},n=[],o=(a("99af"),a("4160"),a("159b"),a("d4ec")),r=a("bee2"),l=a("262e"),s=a("2caf"),c=a("9ab4"),d=a("60a3"),u=a("4bb5"),f=(Object(u["a"])("eventRegiste"),Object(u["a"])("processTemplate")),p=function(e){Object(l["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.ids=null,e.visiblePop=!1,e.visiblePopcge=!1,e.i=1,e.sel="",e.range="",e.el="",e.frag="",e.node="",e.lastNode="",e.dataViewsTree=[],e.dataViewsTreeCge=[],e.addValue="1",e.cgeValue="1",e.tag="",e.addId=100,e.addNode=[],e.cgeNode=[],e.accessoryNode=[],e.treeProps={children:"children",label:"text"},e.ruleArray=[],e}return Object(r["a"])(a,[{key:"ChangeSubstanceText",value:function(e,t){this.setSubstanceText(e)}},{key:"refreshContent",value:function(){this.substanceText&&this.setSubstanceText(this.substanceText)}},{key:"onChangeValue",value:function(e,t){""!=e&&(this.listClick(),this.testrCgeFun())}},{key:"onChangeValue2",value:function(e,t){this.changeTag(),this.testrCgeFun()}},{key:"mounted",value:function(){}},{key:"setSubstanceText",value:function(e){this.$nextTick((function(){var t=document.querySelectorAll("#test")[0];t.innerText=e}))}},{key:"cgeConfirm",value:function(){this.cgeNode.value&&(this.cgeValue="${"+this.cgeNode.value+"}")}},{key:"addConfirm",value:function(){this.addNode.value&&(this.addValue="${"+this.addNode.value+"}")}},{key:"closevisiblePop",value:function(){var e=document.querySelectorAll(".rgh_ul")[0];e.style.display="none",this.visiblePop=!1}},{key:"closevisible",value:function(){var e=document.querySelectorAll(".rgh_ul_span")[0];e.style.display="none",this.visiblePopcge=!1}},{key:"queryDataViewsFields",value:function(){this.manual?(this.dataViewsTree=this.manualRghTree,this.dataViewsTreeCge=this.manualRghTree):(this.dataViewsTree=this.flowVariables,this.dataViewsTreeCge=this.flowVariables)}},{key:"cleanContent",value:function(){var e=document.querySelectorAll("#test")[0];e.innerText=""}},{key:"testrCgeFun",value:function(){var e=document.querySelectorAll("#test")[0];this.$emit("getContent",e.innerText)}},{key:"init",value:function(){this.queryDataViewsFields(),this.cleanContent();var e=this,t=document.querySelectorAll("#test")[0];t.oninput=function(){e.testrCgeFun()},t.oncontextmenu=function(t){var a=document.querySelectorAll(".rgh_ul_span")[0];a.style.display="none";var i=t.clientX,n=t.clientY,o=document.documentElement.scrollTop||document.body.scrollTop,r=document.documentElement.scrollLeft||document.body.scrollLeft;window.getSelection&&(e.sel=window.getSelection(),e.sel.getRangeAt&&e.sel.rangeCount&&(e.range=e.sel.getRangeAt(0),e.range.deleteContents(),e.el=document.createElement("div")));var l=document.querySelectorAll(".rgh_ul")[0];return"slot_html"==e.sel.anchorNode.parentElement.className?(l.style.display="none",!1):(l.style.left=i+r+"px",l.style.top=n+o+"px",l.style.display="block",!1)};var a=document.body;a.onclick=function(e){if("插入流程变量"!=e.target.innerText&&"替换流程变量"!=e.target.innerText){var t=document.querySelectorAll(".rgh_ul")[0];if(void 0!=t){t.style.display="none";var a=document.querySelectorAll(".rgh_ul_span")[0];a.style.display="none"}}}}},{key:"expandFun",value:function(e){var t=this;setTimeout((function(){t[e]=!1,t.$nextTick((function(){t[e]=!0}))}),400)}},{key:"handleNodeClick",value:function(e){this.addNode=e}},{key:"handleNodeClickcge",value:function(e){this.cgeNode=e}},{key:"listClick",value:function(){var e=this;e.i++,e.el.innerHTML='<span id="slot'.concat(e.i,'" contentEditable="false" class="slot_html">').concat(e.addValue,"</span>"),e.frag=document.createDocumentFragment();while(e.node=e.el.firstChild)e.lastNode=e.frag.appendChild(e.node);e.range.insertNode(e.frag),e.lastNode&&(e.range=e.range.cloneRange(),e.range.setStartAfter(e.lastNode),e.range.collapse(!0),e.sel.removeAllRanges(),e.sel.addRange(e.range));var t=document.querySelectorAll(".rgh_ul")[0];t.style.display="none",this.visiblePop=!1,this.addValue="",this.addNode=[];var a=document.querySelectorAll(".slot_html");a.forEach((function(t){t.oncontextmenu=function(a){return e.tag=t,e.slottagFun(t,a),a.stopPropagation(),!1}}))}},{key:"changeTag",value:function(){this.tag.innerText=this.cgeValue;var e=document.querySelectorAll(".rgh_ul_span")[0];e.style.display="none",this.visiblePopcge=!1}},{key:"delFun",value:function(){var e=document.getElementById(this.tag.id);e.parentNode.removeChild(e),this.addValue=""}},{key:"slottagFun",value:function(e,t){var a=document.querySelectorAll(".rgh_ul")[0];a.style.display="none";var i=t.clientX,n=t.clientY,o=document.documentElement.scrollTop||document.body.scrollTop,r=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.querySelectorAll(".rgh_ul_span")[0];l.style.left=i+r+"px",l.style.top=n+o+"px",l.style.display="block"}}]),a}(d["e"]);Object(c["a"])([Object(d["c"])({default:""})],p.prototype,"substanceText",void 0),Object(c["a"])([Object(d["c"])({default:""})],p.prototype,"theme",void 0),Object(c["a"])([Object(d["c"])({default:"90%"})],p.prototype,"width",void 0),Object(c["a"])([Object(d["c"])({default:"240px"})],p.prototype,"height",void 0),Object(c["a"])([Object(d["c"])({default:!1})],p.prototype,"manual",void 0),Object(c["a"])([Object(d["c"])({default:[]})],p.prototype,"manualRghTree",void 0),Object(c["a"])([Object(d["f"])("substanceText",{deep:!0,immediate:!0})],p.prototype,"ChangeSubstanceText",null),Object(c["a"])([Object(d["f"])("addValue")],p.prototype,"onChangeValue",null),Object(c["a"])([Object(d["f"])("cgeValue")],p.prototype,"onChangeValue2",null),Object(c["a"])([f.Getter("flowVariables")],p.prototype,"flowVariables",void 0),p=Object(c["a"])([Object(d["a"])({components:{}})],p);var h=p,m=h,v=(a("bf5e"),a("2877")),g=Object(v["a"])(m,i,n,!1,null,null,null);t["a"]=g.exports},"455a":function(e,t,a){},"4bb5":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a("2fe1"),n=a("2f62"),o=d("computed",n["e"]),r=d("computed",n["c"]),l=d("methods",n["b"]),s=d("methods",n["d"]);function c(e,t){function a(t){function a(a,i){if("string"===typeof i){var n=i,o=a;return t(n,{namespace:e})(o,n)}var r=a,l=f(i||{},{namespace:e});return t(r,l)}return a}return t?(console.warn("[vuex-class] passing the 2nd argument to `namespace` function is deprecated. pass only namespace string instead."),a(t)):{State:a(o),Getter:a(r),Mutation:a(s),Action:a(l)}}function d(e,t){function a(a,n){return Object(i["a"])((function(i,o){i[e]||(i[e]={});var r,l=(r={},r[o]=a,r);i[e][o]=void 0!==n?t(n,l)[o]:t(l)[o]}))}function n(e,t){if("string"===typeof t){var i=t,n=e;return a(i,void 0)(n,i)}var o=u(t),r=e;return a(r,o)}return n}function u(e){var t=e&&e.namespace;if("string"===typeof t)return"/"!==t[t.length-1]?t+"/":t}function f(e,t){var a={};return[e,t].forEach((function(e){Object.keys(e).forEach((function(t){a[t]=e[t]}))})),a}},5101:function(e,t,a){"use strict";var i=a("78e0f"),n=a.n(i);n.a},"78e0f":function(e,t,a){},b2183:function(e,t,a){"use strict";var i=a("2c89"),n=a.n(i);n.a},bf5e:function(e,t,a){"use strict";var i=a("455a"),n=a.n(i);n.a}}]);
//# sourceMappingURL=chunk-02a6d434.763bcf04.js.map