(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c8107728"],{"0c45":function(e,t,a){},"13d5":function(e,t,a){"use strict";var o=a("23e7"),i=a("d58f").left,n=a("a640"),r=a("ae40"),l=n("reduce"),c=r("reduce",{1:0});o({target:"Array",proto:!0,forced:!l||!c},{reduce:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"13f5":function(e,t,a){"use strict";var o=a("d09a"),i=a.n(o);i.a},"1cc4":function(e,t,a){},"2efc":function(e,t,a){},3206:function(e,t,a){"use strict";var o=a("e90e"),i=a.n(o);i.a},"34b6":function(e,t,a){},"3ed9":function(e,t,a){"use strict";var o=a("2efc"),i=a.n(o);i.a},"42c7":function(e,t,a){},"49ab":function(e,t,a){},5571:function(e,t,a){},5781:function(e,t,a){"use strict";var o=a("99f7"),i=a.n(o);i.a},"5a65":function(e,t,a){"use strict";var o=a("1cc4"),i=a.n(o);i.a},"669f":function(e,t,a){"use strict";var o=a("42c7"),i=a.n(o);i.a},6933:function(e,t,a){"use strict";var o=a("49ab"),i=a.n(o);i.a},"72ac":function(e,t,a){},"72b0":function(e,t,a){e.exports=a.p+"assets/img/left-open.e8948188.png"},7522:function(e,t,a){},7728:function(e,t,a){},"7db0":function(e,t,a){"use strict";var o=a("23e7"),i=a("b727").find,n=a("44d2"),r=a("ae40"),l="find",c=!0,s=r(l);l in[]&&Array(1)[l]((function(){c=!1})),o({target:"Array",proto:!0,forced:c||!s},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(l)},"8ae2":function(e,t,a){"use strict";var o=a("5571"),i=a.n(o);i.a},"8b25":function(e,t,a){"use strict";var o=a("f362"),i=a.n(o);i.a},"99f7":function(e,t,a){},a623:function(e,t,a){"use strict";var o=a("23e7"),i=a("b727").every,n=a("a640"),r=a("ae40"),l=n("every"),c=r("every");o({target:"Array",proto:!0,forced:!l||!c},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},ab3e4:function(e,t,a){e.exports=a.p+"assets/img/right-close.7d2d7ebc.png"},ac55:function(e,t,a){"use strict";var o=a("72ac"),i=a.n(o);i.a},acb1:function(e,t,a){"use strict";var o=a("e3b7"),i=a.n(o);i.a},b189:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=this,o=t.$createElement,i=t._self._c||o;return i("div",{staticClass:"edit-page-template"},[i("LeftToolbar",{attrs:{narrow:t.leftBarOpen,templateName:t.templateName,leftBarOpen:t.leftBarOpen},on:{tempateNameChange:function(t){e.templateName=t},onDragStart:t.handleDragStart,handleSideBarOpen:t.handleSideBarOpen}}),i("div",{staticClass:"main-body",class:{leftNarrow:!t.leftBarOpen,rightHidden:!t.rightBarOpen}},[i("div",{staticClass:"top-toolbar"},[i("div",{staticClass:"title"},[t._v("页面模板编辑器")]),i("div",{staticClass:"btn-group"},t._l(t.getOperateButtons(),(function(e,a){return i("el-button",{key:a,class:e.className,on:{click:e.click}},[e.icon?i("i",{class:e.icon}):t._e(),t._v(" "+t._s(e.label)+" ")])})),1)]),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"center-canvas"},[i("div",{staticClass:"grid-layout"},t._l(t.grid,(function(e){return i("div",{key:e.id,staticClass:"grid-item",class:{rightBorder:e.gridColumnEnd-1!==t.COLUMNS,bottomBorder:e.gridRowEnd-1!==t.ROWS,"forbidden-childe-pointer-events":0!==e.canDrop},style:{gridColumn:e.gridColumnStart+" / "+e.gridColumnEnd,gridRow:e.gridRowStart+" / "+e.gridRowEnd,height:320*e.height+"px"},attrs:{draggable:!e.empty&&e.draggable},on:{click:function(a){return t.switchActiveBlock(e,"click")},dragenter:function(a){return t.handleOriginEnter(a,e)},dragover:function(e){return e.preventDefault()},dragleave:function(a){return t.handleOriginLeave(e)},dragstart:function(a){return t.handleOriginStart(e)},drop:function(a){return t.handleSomethingDrop(e)}}},[!e.goods||"singleForm"!==e.goods.type&&"doubleForm"!==e.goods.type?t._e():i("div",[0===e.goods.formAttribute.formList.length?i("img",{staticStyle:{display:"block",margin:"0px auto","padding-top":"60px"},attrs:{draggable:"false",src:a("c112"),alt:""}}):t._e(),e.goods.formAttribute.formList.length>0?i("el-form",{staticStyle:{padding:"30px 0"},attrs:{"label-width":e.goods.formAttribute.labelWidth+"px",model:e.goods.formAttribute,"label-position":e.goods.formAttribute.labelPosition}},[i("formDisplay",{attrs:{formAttribute:e.goods.formAttribute,itemAttribute:t.itemAttribute,draggingArea:t.draggingArea,generateFormItem:t.generateFormItem,draggingAreaType:t.draggingAreaType},on:{"update:draggingArea":function(e){t.draggingArea=e},"update:dragging-area":function(e){t.draggingArea=e},"update:draggingAreaType":function(e){t.draggingAreaType=e},"update:dragging-area-type":function(e){t.draggingAreaType=e},draggingChange:t.draggingAreaChange,activeItemChange:t.clickActiveItem,draggingTypeChange:t.draggingAreaTypeChange}})],1):t._e()],1),e.empty||"singleForm"===e.goods.type&&"doubleForm"===e.goods.type?t._e():[i("TemplateBlock",{ref:"templateBlock_"+e.id,refInFor:!0,attrs:{block:e,"data-source":t.multipleData[e.id],activeFormItem:t.activeFormItem,beRelatedFromItemList:t.beRelatedFromItemList},on:{activeFormItemChange:t.activeFormItemChange,getRealContentById:t.getRealContentById,queryRelationDataset:t.queryRelationDataset,getDataByCard:t.getDataByCard,displayTemplateDetail:t.displayTemplateDetail}})],e.goods&&"pie"===e.goods.type?i("div",[i("div",{staticClass:"vertical",on:{drop:function(a){return t.handleChartFieldsDrop(e,"pieValue")}}},[t._v("请将统计字段拖入此区域")]),i("div",{staticClass:"horizontal",on:{drop:function(a){return t.handleChartFieldsDrop(e,"pieLabel")}}},[t._v("请将标题字段拖入此区域")])]):t._e(),!e.goods||"line"!==e.goods.type&&"bar"!==e.goods.type?t._e():i("div",[i("div",{staticClass:"vertical",on:{drop:function(a){return t.handleChartFieldsDrop(e,"yaxis")}}},[t._v("请将垂直轴字段拖入此区域")]),i("div",{staticClass:"horizontal",on:{drop:function(a){return t.handleChartFieldsDrop(e,"xaxis")}}},[t._v("请将水平轴字段拖入此区域")])]),e.goods&&"monitorChart"===e.goods.type?i("div",{staticClass:"monitorPlace"},[i("div",{staticClass:"info"},[i("p",{staticClass:"title"}),i("p",{staticClass:"ratio"},[i("span",{staticClass:"molecule",on:{drop:function(a){return t.handleMonitorDrop(e,"completeCount")}}}),i("span",{staticClass:"line"}),i("span",{staticClass:"denominator",on:{drop:function(a){return t.handleMonitorDrop(e,"allCount")}}})])])]):t._e(),i("span",{staticClass:"canDropFlag"},[1===e.canDrop?i("i",{staticClass:"accept-icon el-icon-circle-check"}):t._e(),2===e.canDrop?i("i",{staticClass:"warn-icon el-icon-warning-outline"}):t._e()]),e.empty?t._e():i("span",{staticClass:"block-move",on:{mouseenter:function(t){e.draggable=!0},mouseleave:function(t){e.draggable=!1}}},[i("svg-icon",{attrs:{"icon-class":"block-move"}})],1),e.empty?t._e():i("span",{staticClass:"block-empty",on:{click:function(a){return t.emptyContent(e)}}},[i("svg-icon",{attrs:{"icon-class":"block-delete"}})],1),[i("div",{staticClass:"top-btn",class:{firstRow:1===e.gridRowStart}},[e.canBackDown?i("svg-icon",{staticClass:"back back-down",attrs:{"icon-class":"block-extend"},on:{svgClick:function(a){return t.handleShortenHeight(e,1)}}}):t._e(),e.canUp?i("svg-icon",{staticClass:"extend extend-up",attrs:{"icon-class":"block-extend"},on:{svgClick:function(a){return t.handleExtendHeight(e,-1)}}}):t._e()],1),i("div",{staticClass:"right-btn",class:{lastColumn:e.gridColumnEnd-1===t.COLUMNS}},[e.canBackLeft?i("svg-icon",{staticClass:"back back-left",attrs:{"icon-class":"block-extend"},on:{svgClick:function(a){return t.handleShortenWidth(e,-1)}}}):t._e(),e.canRight?i("svg-icon",{staticClass:"extend extend-right",attrs:{"icon-class":"block-extend"},on:{svgClick:function(a){return t.handleExtendWidth(e,1)}}}):t._e()],1),i("div",{staticClass:"bottom-btn",class:{lastRow:e.gridRowEnd-1===t.ROWS}},[e.canBackUp?i("svg-icon",{staticClass:"back back-up",attrs:{"icon-class":"block-extend"},on:{svgClick:function(a){return t.handleShortenHeight(e,-1)}}}):t._e(),e.canDown?i("svg-icon",{staticClass:"extend extend-down",attrs:{"icon-class":"block-extend"},on:{svgClick:function(a){return t.handleExtendHeight(e,1)}}}):t._e()],1),i("div",{staticClass:"left-btn",class:{firstColumn:1===e.gridColumnStart}},[e.canBackRight?i("svg-icon",{staticClass:"back back-right",attrs:{"icon-class":"block-extend"},on:{svgClick:function(a){return t.handleShortenWidth(e,1)}}}):t._e(),e.canLeft?i("svg-icon",{staticClass:"extend extend-left",attrs:{"icon-class":"block-extend"},on:{svgClick:function(a){return t.handleExtendWidth(e,-1)}}}):t._e()],1)]],2)})),0)])]),i("RightToolbar",{attrs:{hidden:t.rightBarOpen,clickRandom:t.clickRandom,itemAttribute:t.itemAttribute,formAttribute:t.formAttribute,dataSet:t.dataSet,templateSet:"templateSet",grid:t.grid,viewDataSet:t.viewDataSet,optionLabelInit:t.optionLabel,activeFormItem:t.activeFormItem,formItemList:t.formItemList,chartList:t.chartList,rightBarOpen:t.rightBarOpen},on:{changeGrid:t.changeGrid,getRealContentById:t.getRealContentById,fieldDragStart:t.fieldDragStart,activeFormItemChange:t.activeFormItemChange,handleSideBarOpen:t.handleSideBarOpen}}),i("simple-dialog",{staticClass:"previewDialog",attrs:{dialogTitle:"预览","dialog-visible":t.previewDialogVisible,dialogWidth:"70%"},on:{cancelEmit:function(e){t.previewDialogVisible=!1}}},[i("PreviewTemplate",{ref:"previewTemplate",attrs:{currentGrid:t.grid}})],1),i("LayoutTemplate",{ref:"layoutDialog",on:{applyTemplate:t.applyTemplate}})],1)},i=[],n=(a("a4d3"),a("e01a"),a("99af"),a("4de4"),a("4160"),a("c975"),a("a15b"),a("d81d"),a("b0c0"),a("d3b7"),a("25f0"),a("159b"),a("5530")),r=a("d4ec"),l=a("bee2"),c=a("262e"),s=a("2caf"),u=a("9ab4"),d=a("60a3"),p=(a("a623"),a("c740"),a("13d5"),a("a434"),a("0644")),f=a.n(p),h=a("ca00"),g=3,m=3,b={grid:function(){for(var e=[],t=1;t<=m;t++)for(var a=1;a<=g;a++)e.push({id:e.length+1,width:1,height:1,gridColumnStart:a,gridColumnEnd:a+1,gridRowStart:t,gridRowEnd:t+1,canDrop:0,empty:!0});return e}()};function v(e){var t=this.grid;this.block=Object(h["a"])(t,"id",e.id),this.leftNeighbors=k.call(this,-1),this.rightNeighbors=k.call(this,1),this.topNeighbors=C.call(this,-1),this.bottomNeighbors=C.call(this,1)}function y(){var e=this.block,t=this.leftNeighbors,a=this.rightNeighbors,o=this.topNeighbors,i=this.bottomNeighbors,n=!0,r=!0,l=!0,c=!0,s=!0,u=!0,d=!0,p=!0;e.empty?(n=!1,r=!1,l=!1,c=!1,s=!1,u=!1,d=!1,p=!1):(1===e.width&&(s=!1,u=!1),1===e.height&&(d=!1,p=!1),"Unavailable"!==t&&O(t)||(n=!1),"Unavailable"!==a&&O(a)||(r=!1),"Unavailable"!==o&&O(o)||(l=!1),"Unavailable"!==i&&O(i)||(c=!1)),e.canLeft=n,e.canRight=r,e.canUp=l,e.canDown=c,e.canBackRight=s,e.canBackLeft=u,e.canBackUp=d,e.canBackDown=p}function k(e){var t=this.grid,a=this.block,o=[],i=1===e?a.gridColumnEnd:a.gridColumnStart-1;return t.forEach((function(e){1===e.width&&1===e.height&&e.gridColumnStart===i&&e.gridRowStart>=a.gridRowStart&&e.gridRowEnd<=a.gridRowEnd&&o.push(e)})),o.length!==a.height?"Unavailable":o}function C(e){var t=this.grid,a=this.block,o=[],i=1===e?a.gridRowEnd:a.gridRowStart-1;return t.forEach((function(e){1===e.width&&1===e.height&&e.gridRowStart===i&&e.gridColumnStart>=a.gridColumnStart&&e.gridColumnEnd<=a.gridColumnEnd&&o.push(e)})),o.length!==a.width?"Unavailable":o}function O(e){return e.every((function(e){return e.empty}))}function j(e){var t=this.grid,a=this.block,o=this.leftNeighbors,i=this.rightNeighbors;a.width++,1===e?(a.gridColumnEnd++,i.forEach((function(e){return t.splice(t.findIndex((function(t){return t.id===e.id})),1)}))):(a.gridColumnStart--,o.forEach((function(e){return t.splice(t.findIndex((function(t){return t.id===e.id})),1)})))}function B(e){var t=this.grid,a=this.block,o=null;a.width--,1===e?(o=a.gridColumnStart,a.gridColumnStart++):(a.gridColumnEnd--,o=a.gridColumnEnd);for(var i=a.gridRowStart;i<a.gridRowEnd;i++)t.push({id:"".concat((new Date).getTime()).concat(Math.floor(900*Math.random())+100),width:1,height:1,gridColumnStart:o,gridColumnEnd:o+1,gridRowStart:i,gridRowEnd:i+1,canDrop:0,empty:!0})}function S(e){var t=this.grid,a=this.block,o=this.topNeighbors,i=this.bottomNeighbors;a.height++,1===e?(a.gridRowEnd++,i.forEach((function(e){return t.splice(t.findIndex((function(t){return t.id===e.id})),1)}))):(a.gridRowStart--,o.forEach((function(e){return t.splice(t.findIndex((function(t){return t.id===e.id})),1)})))}function x(e){var t=this.grid,a=this.block,o=null;a.height--,1===e?(o=a.gridRowStart,a.gridRowStart++):(a.gridRowEnd--,o=a.gridRowEnd);for(var i=a.gridColumnStart;i<a.gridColumnEnd;i++)t.push({id:"".concat((new Date).getTime()).concat(Math.floor(900*Math.random())+100),width:1,height:1,gridColumnStart:i,gridColumnEnd:i+1,gridRowStart:o,gridRowEnd:o+1,canDrop:0,empty:!0})}function w(e){var t=this.draggingBlock,a=!1;if(e.empty){var o=t.width,i=t.height,n=new F(this.getGrid());v.call(n,e),n.block.empty=!1,y.call(n),D.call(this,o,n,"horizontal")&&D.call(this,i,n,"vertical")&&(a=!0)}return a?1:2}function D(e,t,a){var o=t.block,i=!0,n="horizontal"===a?o.width:o.height;return e>n?("horizontal"===a?o.canRight:o.canDown)?("horizontal"===a?t.blockWidthExtend(o,1):t.blockHeightExtend(o,1),v.call(t,o),y.call(t),i=D.call(this,e,t,a)):i=!1:i=!0,i}function T(e){for(var t=this.draggingBlock,a=this.grid,o=t.width,i=t.height,n=t.goods,r=t.id,l=[],c=t.gridRowStart;c<t.gridRowEnd;c++)for(var s=t.gridColumnStart;s<t.gridColumnEnd;s++)l.push({id:"".concat((new Date).getTime()).concat(Math.floor(900*Math.random())+100),width:1,height:1,gridColumnStart:s,gridColumnEnd:s+1,gridRowStart:c,gridRowEnd:c+1,canDrop:0,empty:!0});a.splice.apply(a,[a.findIndex((function(e){return e.id===t.id})),1].concat(l)),v.call(this,e),this.block.empty=!1,this.block.goods=n;for(var u=1;u<o;u++)this.blockWidthExtend(e,1),v.call(this,e),y.call(this);for(var d=1;d<i;d++)this.blockHeightExtend(e,1),v.call(this,e),y.call(this);this.block.id=r}var F=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f()(b.grid);Object(r["a"])(this,e),this.grid=t}return Object(l["a"])(e,[{key:"blockWidthExtend",value:function(e,t){v.call(this,e),j.call(this,t)}},{key:"blockHeightExtend",value:function(e,t){v.call(this,e),S.call(this,t)}},{key:"blockWidthShorten",value:function(e,t){v.call(this,e),B.call(this,t)}},{key:"blockHeightShorten",value:function(e,t){v.call(this,e),x.call(this,t)}},{key:"getGrid",value:function(){return this.getAllExtendStatus(),f()(this.grid)}},{key:"getAllExtendStatus",value:function(){var e=this;this.grid.forEach((function(t){v.call(e,t),y.call(e)}))}},{key:"emptyBlock",value:function(e){v.call(this,e);for(var t=this.block,a=t.gridRowStart,o=t.gridColumnStart,i=t.gridColumnEnd,n=t.gridRowEnd,r=a;r<n;r++)for(var l=o;l<i;l++)r===a&&l===o||this.grid.push({id:"".concat((new Date).getTime()).concat(Math.floor(900*Math.random())+100),width:1,height:1,gridColumnStart:l,gridColumnEnd:l+1,gridRowStart:r,gridRowEnd:r+1,canDrop:0,empty:!0});this.block.empty=!0,this.block.goods=null,this.block.width=1,this.block.height=1,this.block.gridColumnEnd=this.block.gridColumnStart+1,this.block.gridRowEnd=this.block.gridRowStart+1}},{key:"addRow",value:function(){for(var e=this.grid,t=e.reduce((function(e,t){return e.gridRowEnd>t.gridRowEnd?e:t})).gridRowEnd,a=1;a<=g;a++)e.push({id:"".concat((new Date).getTime()).concat(Math.floor(900*Math.random())+101),width:1,height:1,gridColumnStart:a,gridColumnEnd:a+1,gridRowStart:t,gridRowEnd:t+1,canDrop:0,empty:!0})}},{key:"setDraggingBlock",value:function(e){this.draggingBlock=e}},{key:"setDraggingBlockContent",value:function(e){v.call(this,e),this.block.empty=!1,this.block.goods=e.goods}},{key:"checkDragAllow",value:function(e){if(e!==this.draggingBlock)return w.call(this,e)}},{key:"checkIconDrag",value:function(e){return e.empty?1:2}},{key:"moving",value:function(e){T.call(this,e)}}]),e}(),I=a("cb9b"),L=a("ad7d"),A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"template-box polymerization-table"},[e.block.goods?[e.preview?a("simple-card",{attrs:{title:e.block.goods.showBlockName&&e.block.goods.blockName,noTitle:!e.block.goods.showBlockName}},[e.blockQueryParams&&e.blockQueryParams.length?a("el-form",{staticClass:"block-param-form",class:{minWidth:e.block&&1===e.block.width},attrs:{inline:!0,"label-suffix":":","label-position":"left"}},[e._l(e.blockQueryParams,(function(t){return a("el-form-item",{key:t.name,staticClass:"block-param-form-item",attrs:{label:t.name,required:0===t.required}},[0===t.type||1===t.type?a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),2===t.type?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),3===t.type?a("el-select",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},[a("el-option",{attrs:{value:"0",label:"否"}}),a("el-option",{attrs:{value:"1",label:"是"}})],1):e._e()],1)})),e.blockQueryParams&&e.blockQueryParams.length?a("el-button",{on:{click:function(){return e.getRealContentById(e.block)}}},[e._v("查询")]):e._e()],2):e._e(),a(e.componentkey,e._g(e._b({ref:"componentBlock",tag:"component",class:{tableBox:"TableBlock"===e.componentkey},attrs:{preview:e.preview,block:e.block}},"component",e.$attrs,!1),e.$listeners))],1):[e.blockQueryParams&&e.blockQueryParams.length?a("el-form",{staticClass:"block-param-form",class:{echartsBoxForm:-1!==["PieBlock","LineBlock","BarBlock"].indexOf(e.componentkey),minWidth:e.block&&1===e.block.width},attrs:{inline:!0,"label-suffix":":","label-position":"left"}},[e._l(e.blockQueryParams,(function(t){return a("el-form-item",{key:t.name,staticClass:"block-param-form-item",attrs:{label:t.name,required:0===t.required}},[0===t.type||1===t.type?a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),2===t.type?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),3===t.type?a("el-select",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},[a("el-option",{attrs:{value:"0",label:"否"}}),a("el-option",{attrs:{value:"1",label:"是"}})],1):e._e()],1)})),e.blockQueryParams&&e.blockQueryParams.length?a("el-button",{on:{click:function(){return e.getRealContentById(e.block)}}},[e._v("查询")]):e._e()],2):e._e(),a(e.componentkey,e._g(e._b({ref:"componentBlock",tag:"component",class:{echartsBox:-1!==["PieBlock","LineBlock","BarBlock"].indexOf(e.componentkey)},attrs:{preview:e.preview,block:e.block}},"component",e.$attrs,!1),e.$listeners))]]:e._e()],2)},_=[],E=a("4bb5"),N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-table",{staticClass:"pageTemplateTable",attrs:{"data-source":e.dataSource,columns:e.columns,height:e.height<"320"?e.height:"320"},on:{cellClick:e.cellClick}})],1)},R=[],$=a("2ef0"),P=a("4242"),G=Object(E["a"])("pageTemplate"),q=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(r["a"])(this,a),t.apply(this,arguments)}return Object(l["a"])(a,[{key:"changeGrid",value:function(){}},{key:"displayTemplateDetail",value:function(e){}},{key:"queryRelationDataset",value:function(e){}},{key:"cellClick",value:function(e,t,a,o){this.queryRelationDataset({type:"chart",cell:e[t.property],relationBlock:this.block.id})}},{key:"handleUpdateData",value:function(e){var t=this;Object(P["i"])(e).then((function(e){var a=e.error;a?t.$message.error(a.message):t.displayTemplateDetail(t.$route.query.id)}))}},{key:"columns",get:function(){var e=this,t=this.block.goods&&this.block.goods.columns||[];t.forEach((function(t){t.canSet?t.render=function(a,o){var i=o.record;return!0===i.isEdit?a("el-input",{props:{value:i[t.prop],clearable:!0,placeholder:"请输入参数code"},on:{input:function(a){i[t.prop]=a,e.handleUpdateData(i)}}}):a("span",i[t.prop])}:t.render=null}));var a=Object($["cloneDeep"])(this.block);return a.goods.columns=t,this.changeGrid(),t}},{key:"height",get:function(){return this.dataSource.length?32*this.dataSource.length+50:"100%"}}]),a}(d["e"]);Object(u["a"])([Object(d["c"])({default:[]})],q.prototype,"dataSource",void 0),Object(u["a"])([Object(d["c"])()],q.prototype,"block",void 0),Object(u["a"])([G.Mutation("UPDATE_ACTIVE_BLOCK")],q.prototype,"updateActiveBlock",void 0),Object(u["a"])([Object(d["b"])("changeGrid")],q.prototype,"changeGrid",null),Object(u["a"])([Object(d["b"])("displayTemplateDetail")],q.prototype,"displayTemplateDetail",null),Object(u["a"])([Object(d["b"])("queryRelationDataset")],q.prototype,"queryRelationDataset",null),q=Object(u["a"])([d["a"]],q);var M=q,V=M,U=(a("5a65"),a("2877")),z=Object(U["a"])(V,N,R,!1,null,null,null),W=z.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"min-height":"300px"},on:{"resize-chart":e.resizeChart}})},K=[],H=a("313e"),J=a.n(H),X=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.chart=null,e.options={tooltip:{trigger:"item"},color:["rgba(42, 118, 205, 0.85)","rgba(43, 188, 184, 0.85)","rgba(68, 179, 101, 0.85)","rgba(234, 169, 38, 0.85)","rgba(204, 61, 61, 0.85)","rgba(133, 84, 201, 0.85)","rgba(60, 58, 154, 0.85)","rgba(58, 71, 119, 0.85)"],legend:{orient:"vertical",left:"left",data:[]},series:[]},e}return Object(l["a"])(a,[{key:"queryRelationDataset",value:function(e){}},{key:"onDataSourceChange",value:function(){this.initChart()}},{key:"onLabelChange",value:function(){this.initChart()}},{key:"onValueChange",value:function(){this.initChart()}},{key:"onPieTypeChange",value:function(){this.initChart()}},{key:"resizeChart",value:function(){var e=this;setTimeout((function(){e.chart&&e.chart.resize()}),100)}},{key:"initChart",value:function(){this.chart=J.a.init(this.$el),this.chart.setOption(this.options),this.refreshChart(),this.clickChart()}},{key:"refreshChart",value:function(){var e=this;if(this.dataSource){this.label&&this.chart.setOption({legend:{data:this.dataSource.map((function(t){return t[e.label]}))}});var t="55%";if("1"===this.pieType?t=["50%","70%"]:"2"===this.pieType&&(t=["20%","70%"]),this.value){var a=this.label||this.value;this.chart.setOption({series:[{name:"",type:"pie",radius:t,center:["50%","60%"],roseType:"2"===this.pieType&&"radius",data:this.dataSource.map((function(t){return{value:t[e.value],name:t[a]}})),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{borderColor:"#ffffff",borderWidth:1}}}]})}}}},{key:"clickChart",value:function(){var e=this;this.chart.off("click"),this.chart.on("click",(function(t){e.queryRelationDataset({type:"chart",label:t.name,value:t.value,relationBlock:e.block.id})}))}},{key:"label",get:function(){return this.block.goods&&this.block.goods.label||""}},{key:"value",get:function(){return this.block.goods&&this.block.goods.value||""}},{key:"pieType",get:function(){return this.block.goods&&this.block.goods.pieType||""}}]),a}(d["e"]);Object(u["a"])([Object(d["c"])()],X.prototype,"block",void 0),Object(u["a"])([Object(d["c"])({default:[]})],X.prototype,"dataSource",void 0),Object(u["a"])([Object(d["b"])("queryRelationDataset")],X.prototype,"queryRelationDataset",null),Object(u["a"])([Object(d["f"])("dataSource")],X.prototype,"onDataSourceChange",null),Object(u["a"])([Object(d["f"])("label")],X.prototype,"onLabelChange",null),Object(u["a"])([Object(d["f"])("value")],X.prototype,"onValueChange",null),Object(u["a"])([Object(d["f"])("pieType")],X.prototype,"onPieTypeChange",null),X=Object(u["a"])([d["a"]],X);var Y=X,Z=Y,ee=Object(U["a"])(Z,Q,K,!1,null,null,null),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"300px"},on:{"resize-chart":e.resizeChart}})},oe=[],ie=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.chart=null,e}return Object(l["a"])(a,[{key:"queryRelationDataset",value:function(e){}},{key:"onDataSourceChange",value:function(){this.initChart()}},{key:"onXAxisChange",value:function(){this.initChart()}},{key:"onYAxisChange",value:function(e,t){JSON.stringify(e)!==JSON.stringify(t)&&this.initChart()}},{key:"resizeChart",value:function(){var e=this;setTimeout((function(){e.chart&&e.chart.resize()}),100)}},{key:"initChart",value:function(){this.chart=J.a.init(this.$el),this.refreshData(),this.clickChart()}},{key:"refreshData",value:function(){var e=this;if(this.dataSource){var t=[],a=[];this.yaxis.forEach((function(o){t=[];var i={},n=[];e.dataSource.forEach((function(a){t.push(a[e.xaxis]),n.push(a[o.code])})),i={name:o.label,data:n,type:"line",showSymbol:!1,symbolSize:8},a.push(i)})),this.chart.setOption({textStyle:{color:"rgba(60, 68, 85, 0.7)"},animation:!1,color:["rgba(42, 118, 205, 0.85)","rgba(43, 188, 184, 0.85)","rgba(68, 179, 101, 0.85)","rgba(234, 169, 38, 0.85)","rgba(204, 61, 61, 0.85)","rgba(133, 84, 201, 0.85)","rgba(60, 58, 154, 0.85)","rgba(58, 71, 119, 0.85)"],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},grid:{left:"7%",right:"4%",bottom:"8%",containLabel:!0},yAxis:[{type:"value",name:"",nameTextStyle:{padding:[0,24,10,0]},axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#dde3ea",type:"dashed"}}}],xAxis:{name:"",type:"category",nameLocation:"start",nameTextStyle:{padding:[50,0,0,50]},axisTick:{show:!1},axisLine:{show:!1},axisLabel:{rotate:-20},data:t},series:a},!0)}}},{key:"clickChart",value:function(){var e=this;this.chart.off("click"),this.chart.on("click",(function(t){e.queryRelationDataset({type:"chart",x:t.name,y:t.value,relationBlock:e.block.id})}))}},{key:"xaxis",get:function(){return this.block.goods&&this.block.goods.xaxis||""}},{key:"yaxis",get:function(){return this.block.goods&&this.block.goods.yaxis||[]}}]),a}(d["e"]);Object(u["a"])([Object(d["c"])()],ie.prototype,"block",void 0),Object(u["a"])([Object(d["c"])({default:[]})],ie.prototype,"dataSource",void 0),Object(u["a"])([Object(d["b"])("queryRelationDataset")],ie.prototype,"queryRelationDataset",null),Object(u["a"])([Object(d["f"])("dataSource")],ie.prototype,"onDataSourceChange",null),Object(u["a"])([Object(d["f"])("xaxis")],ie.prototype,"onXAxisChange",null),Object(u["a"])([Object(d["f"])("yaxis")],ie.prototype,"onYAxisChange",null),ie=Object(u["a"])([d["a"]],ie);var ne=ie,re=ne,le=Object(U["a"])(re,ae,oe,!1,null,null,null),ce=le.exports,se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"300px"},on:{"resize-chart":e.resizeChart}})},ue=[],de=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.chart=null,e}return Object(l["a"])(a,[{key:"queryRelationDataset",value:function(e){}},{key:"onDataSourceChange",value:function(){this.initChart()}},{key:"onXAxisChange",value:function(){this.initChart()}},{key:"onYAxisChange",value:function(e,t){JSON.stringify(e)!==JSON.stringify(t)&&this.initChart()}},{key:"resizeChart",value:function(){var e=this;setTimeout((function(){e.chart&&e.chart.resize()}),100)}},{key:"initChart",value:function(){this.chart=J.a.init(this.$el),this.refreshData(),this.clickChart()}},{key:"refreshData",value:function(){var e=this;if(this.dataSource){var t=[],a=[];this.yaxis.forEach((function(o){t=[];var i={},n=[];e.dataSource.forEach((function(a){t.push(a[e.xaxis]),n.push(a[o.code])})),i={name:o.label,data:n,type:"bar"},a.push(i)})),this.chart.setOption({color:["rgba(42, 118, 205, 0.85)","rgba(43, 188, 184, 0.85)","rgba(68, 179, 101, 0.85)","rgba(234, 169, 38, 0.85)","rgba(204, 61, 61, 0.85)","rgba(133, 84, 201, 0.85)","rgba(60, 58, 154, 0.85)","rgba(58, 71, 119, 0.85)"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},yAxis:{type:"value"},xAxis:{name:"",type:"category",axisTick:{alignWithLabel:!0},axisLabel:{rotate:-20},data:t},series:a},!0)}}},{key:"clickChart",value:function(){var e=this;this.chart.off("click"),this.chart.on("click",(function(t){e.queryRelationDataset({type:"chart",x:t.name,y:t.value,relationBlock:e.block.id})}))}},{key:"xaxis",get:function(){return this.block.goods&&this.block.goods.xaxis||""}},{key:"yaxis",get:function(){return this.block.goods&&this.block.goods.yaxis||[]}}]),a}(d["e"]);Object(u["a"])([Object(d["c"])({default:[]})],de.prototype,"dataSource",void 0),Object(u["a"])([Object(d["c"])()],de.prototype,"block",void 0),Object(u["a"])([Object(d["b"])("queryRelationDataset")],de.prototype,"queryRelationDataset",null),Object(u["a"])([Object(d["f"])("dataSource")],de.prototype,"onDataSourceChange",null),Object(u["a"])([Object(d["f"])("xaxis")],de.prototype,"onXAxisChange",null),Object(u["a"])([Object(d["f"])("yaxis")],de.prototype,"onYAxisChange",null),de=Object(u["a"])([d["a"]],de);var pe=de,fe=pe,he=Object(U["a"])(fe,se,ue,!1,null,null,null),ge=he.exports,me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"previewForm"},[a("el-form",{attrs:{"label-position":e.formAttribute.labelPosition,"label-suffix":e.formAttribute.labelSuffix}},e._l(e.formAttribute.formList,(function(t,o){return a("el-col",{key:o,staticClass:"itemBox",class:[e.currentBlock.id!==e.block.id||t.key!==e.activeFormItem.key||e.preview?"":"activeItem"],attrs:{span:t.span}},[a("div",{on:{click:function(a){return e.formItemClick(t)}}},[a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:t.label,"label-width":"button"!==t.formItemType&&"upload"!==t.formItemType&&e.formAttribute.labelWidth+"px",prop:"formList."+o+"."+t.value,rules:"item.rules",required:t.required}},[a("customItemRender",{attrs:{type:t.formItemType||t.type,config:{placeholder:t.placeholder||"",key:t.key,value:t.value,goods:t,iconProps:t.iconProps,btnProp:t.btnProp,options:t.options||[],multiple:t.multiple,listeners:{change:function(a){return e.handleFormItemChange(a,t)}}}}})],1)],1),e.currentBlock.id!==e.block.id||t.key!==e.activeFormItem.key||e.preview?e._e():a("div",{staticClass:"itemButton"},[a("el-button",{staticClass:"itemOperatButton deleteButton",attrs:{icon:"el-icon-delete"},on:{click:function(a){return e.itemDeleteClick(t,o)}}})],1)])})),1),e.formItemQueryParams&&e.formItemQueryParams.length?a("el-button",{staticClass:"queryButton",on:{click:function(){return e.queryRelationDataset({type:"formItem",formItems:e.formItemQueryParams})}}},[e._v("查询")]):e._e()],1)},be=[],ve=(a("45fc"),a("e7c5")),ye=Object(E["a"])("pageTemplate"),ke=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(r["a"])(this,a),t.apply(this,arguments)}return Object(l["a"])(a,[{key:"updateActiveFormItem",value:function(e){}},{key:"queryRelationDataset",value:function(e){}},{key:"stopBubble",value:function(e){e&&e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0}},{key:"formItemClick",value:function(e){this.stopBubble(),this.currentBlock.id!==this.block.id&&this.updateActiveBlock(Object($["cloneDeep"])(this.block)),this.updateActiveFormItem(e)}},{key:"itemDeleteClick",value:function(e,t){if(this.currentBlock.id!==this.block.id&&this.updateActiveBlock(Object($["cloneDeep"])(this.block)),this.formAttribute.formList.splice(t,1),this.updateActiveFormItem(this.formAttribute.formList.length?this.formAttribute.formList[0]:{}),this.currentBlock&&this.currentBlock.goods&&this.currentBlock.goods.formAttribute){var a=this.currentBlock.goods.formAttribute.formList,o=a.findIndex((function(t){return t.key===e.key}));a.splice(o,1),this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock))}}},{key:"handleFormItemChange",value:function(e,t){var a=t.key!==this.activeFormItem.key?Object($["cloneDeep"])(t):Object($["cloneDeep"])(this.activeFormItem);a.value=e,this.updateActiveFormItem(a)}},{key:"currentBlock",get:function(){return Object($["cloneDeep"])(this.activeBlock)}},{key:"formAttribute",get:function(){return this.block.goods&&this.block.goods.formAttribute||{}}},{key:"formItemQueryParams",get:function(){var e=this,t=[];return this.formAttribute.formList&&this.formAttribute.formList.map((function(a){e.beRelatedFromItemList.some((function(e){return a.key===e}))&&t.push({formItemKey:a.key,formItemValue:a.value})})),t}}]),a}(d["e"]);Object(u["a"])([ye.Mutation("UPDATE_ACTIVE_BLOCK")],ke.prototype,"updateActiveBlock",void 0),Object(u["a"])([ye.State((function(e){return e.activeBlock}))],ke.prototype,"activeBlock",void 0),Object(u["a"])([Object(d["c"])({default:{}})],ke.prototype,"block",void 0),Object(u["a"])([Object(d["c"])({default:{}})],ke.prototype,"activeFormItem",void 0),Object(u["a"])([Object(d["c"])()],ke.prototype,"preview",void 0),Object(u["a"])([Object(d["c"])({default:[]})],ke.prototype,"beRelatedFromItemList",void 0),Object(u["a"])([Object(d["b"])("activeFormItemChange")],ke.prototype,"updateActiveFormItem",null),Object(u["a"])([Object(d["b"])("queryRelationDataset")],ke.prototype,"queryRelationDataset",null),ke=Object(u["a"])([Object(d["a"])({components:{customItemRender:ve["a"]}})],ke);var Ce=ke,Oe=Ce,je=(a("8b25"),a("bbad7"),Object(U["a"])(Oe,me,be,!1,null,"df840904",null)),Be=je.exports,Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"monitorChart",style:{borderColor:e.block.goods.monitorColor},on:{click:e.handleQueryData}},[a("div",{staticClass:"info"},[a("div",{staticClass:"left-info"},[a("p",{staticClass:"title"},[e._v(e._s(this.block.goods.monitorName?this.block.goods.monitorName:"监控名称"))]),a("p",{staticClass:"ratio",style:{color:e.customColor}},[a("span",[e._v(" "+e._s(this.block.goods.completeCount?this.completed:"监控分子"))]),a("span",{staticClass:"line"},[e._v(" / ")]),a("span",[e._v(" "+e._s(this.block.goods.allCount?this.all:" 监控分母"))])])]),e._m(0)]),a("div",{staticClass:"progress"},[a("el-progress",{attrs:{percentage:e.percentage,color:e.customColor,"show-text":!1}}),a("p",[e._v("当前进度："+e._s(e.percentage)+" %")])],1)])},xe=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"imgStyle"},[a("img",{attrs:{src:"https://www.baidu.com/link?url=aRNa5U1na9G6qBEPsZEMxVAMgvf1N5Zrsld93EPbXE3JpCEAxjYrr-kI5ZcDnideG1FKezjrDlIJ4Kxk563E5Ke8K8Ct21RdhwK2bl4xAjqB3EYytR0fskY_eQQdtUPQKi40uE0tCeNJlJKy4twO0cFarl22HCmoM0zpE6OcrfSJv-e8uBtr5zauNwKoEEmKV27sHnvSvyFFqdD6Xa-68oE30-v3QUuCZXrfOHkm03bq-87_AsQCiTXlQ2xxIecDFJvbZUWhfQlybDITbKhS9DL_yKhVnCeRvZp0PAxtSSGRGfqC7TkzjgtXMzCcM7DZojIPksCNQf0glvUIp1EGL6W_-wj3mzjpNjl5x2vqfzQizqPpFU7HUFTrd7L28IQFcfH4kv4x-ADlsxmEkWJmzDURrwKWQHz-3yVS77WtxJrbBICoqVnaFSnUzdodYH3IKxoiep45QHm8SnjZKbAxCICGpIrGvScoB3r9iHA0hZLTV9Zecg-fA6KtwgVLwarEKV6MkPJiH7hrUvPCbPkeouET143lTK2CVjzEVGChSU58VAXHSv_UEgdieN-rsS9_d_JJY5tPsCKt6322Znzf9CpJbl7kilJVNuhwrE0cwDO&timg=https%3A%2F%2Fss0.bdstatic.com%2F94oJfD_bAAcT8t7mm9GUKT-xh_%2Ftimg%3Fimage%26quality%3D100%26size%3Db4000_4000%26sec%3D1594974398%26di%3Ded406ff683148a6d0e7d1ca0fccc69e5%26src%3Dhttp%3A%2F%2Fa2.att.hudong.com%2F36%2F48%2F19300001357258133412489354717.jpg&click_t=1594974399776&s_info=1903_937&wd=&eqid=de00d6a30003bc59000000035f1160bd"}})])}],we=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.customColor="#409eff",e.all=0,e.completed=0,e}return Object(l["a"])(a,[{key:"getDataByCard",value:function(e){}},{key:"onDataSourceChange",value:function(){var e=this.block.goods;this.all=this.dataSource.length>0?this.dataSource[0][e.allCount]:0,this.completed=this.dataSource.length>0?this.dataSource[0][e.completeCount]:0}},{key:"handleQueryData",value:function(){this.block&&this.block.goods.monitorName&&this.getDataByCard({type:"monitorSteps",monitorName:this.block.goods.monitorName})}},{key:"percentage",get:function(){return this.completed&&this.all?Object(h["d"])(this.completed/this.all*100):0}}]),a}(d["e"]);Object(u["a"])([Object(d["c"])()],we.prototype,"block",void 0),Object(u["a"])([Object(d["c"])({default:[]})],we.prototype,"dataSource",void 0),Object(u["a"])([Object(d["b"])("getDataByCard")],we.prototype,"getDataByCard",null),Object(u["a"])([Object(d["f"])("dataSource")],we.prototype,"onDataSourceChange",null),we=Object(u["a"])([d["a"]],we);var De=we,Te=De,Fe=(a("cce6"),Object(U["a"])(Te,Se,xe,!1,null,null,null)),Ie=Fe.exports,Le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"monitorSteps",on:{click:e.handleQueryData}},e._l(e.stepsList,(function(t,o){return a("div",{key:o,staticClass:"stepItem"},[a("div",{staticClass:"itemInfo"},[a("p",{staticClass:"stepName"},[e._v(e._s(t.monitorName?t.monitorName:"节点"+(o+1)+"监控名称"))]),a("p",{staticClass:"allCount"},[e._v(e._s(t.all))]),a("div",{staticClass:"progress"},[a("el-progress",{attrs:{type:"circle",percentage:t.percentage,"show-text":!1,color:"#2464B3","stroke-width":15}}),o!==e.stepsList.length-1?a("div",{staticClass:"itemLine"}):e._e()],1),a("p",{staticClass:"complatedStep"},[a("span",[e._v("待处理：")]),a("span",[e._v(e._s(t.uncomplete))])]),a("p",{staticClass:"uncomplated"},[a("span",[e._v("已处理：")]),a("span",[e._v(e._s(t.completed))])])])])})),0)},Ae=[],_e=(Object(E["a"])("pageTemplate"),function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(r["a"])(this,a),t.apply(this,arguments)}return Object(l["a"])(a,[{key:"getDataByCard",value:function(e){}},{key:"handleQueryData",value:function(){var e=this.stepsList.map((function(e){return e.monitorName}));e.length&&this.getDataByCard({type:"monitorSteps",monitorName:e})}},{key:"stepsList",get:function(){var e=this,t=this.block&&this.block.goods.stepsList?Object($["cloneDeep"])(this.block.goods.stepsList):[];return t.length&&this.dataSource&&this.dataSource.length&&t.forEach((function(t,a){t.all=t.allCount&&e.dataSource[a]&&e.dataSource[a][0]?e.dataSource[a][0][t.allCount]:0,t.completed=t.completeCount&&e.dataSource[a]&&e.dataSource[a][0]?e.dataSource[a][0][t.completeCount]:0,t.uncomplete=t.all-t.completed,t.percentage=t.completed/t.all*100})),t}}]),a}(d["e"]));Object(u["a"])([Object(d["c"])({default:{}})],_e.prototype,"block",void 0),Object(u["a"])([Object(d["c"])()],_e.prototype,"dataSource",void 0),Object(u["a"])([Object(d["b"])("getDataByCard")],_e.prototype,"getDataByCard",null),_e=Object(u["a"])([d["a"]],_e);var Ee=_e,Ne=Ee,Re=(a("5781"),Object(U["a"])(Ne,Le,Ae,!1,null,null,null)),$e=Re.exports,Pe=(Object(E["a"])("pageTemplate"),function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(r["a"])(this,a),t.apply(this,arguments)}return Object(l["a"])(a,[{key:"getRealContentById",value:function(e){}},{key:"resizeChart",value:function(){var e=this.$refs;e.componentBlock.resizeChart&&e.componentBlock.resizeChart()}},{key:"blockQueryParams",get:function(){return this.block.goods&&this.block.goods.queryParams&&this.block.goods.queryParams.filter((function(e){return"1"===e.valueBy}))||[]}},{key:"componentkey",get:function(){var e="";if(this.block.goods){var t=this.block.goods.type;"table"===t?e="TableBlock":"pie"===t?e="PieBlock":"line"===t?e="LineBlock":"bar"===t?e="BarBlock":"singleForm"===t||"doubleForm"===t?e="CustomForm":"monitorChart"===t?e="MonitorChart":"monitorSteps"===t&&(e="MonitorSteps")}return e}}]),a}(d["e"]));Object(u["a"])([Object(d["c"])({default:!1})],Pe.prototype,"preview",void 0),Object(u["a"])([Object(d["c"])()],Pe.prototype,"block",void 0),Object(u["a"])([Object(d["b"])("getRealContentById")],Pe.prototype,"getRealContentById",null),Pe=Object(u["a"])([Object(d["a"])({components:{TableBlock:W,PieBlock:te,LineBlock:ce,BarBlock:ge,CustomForm:Be,MonitorChart:Ie,MonitorSteps:$e}})],Pe);var Ge=Pe,qe=Ge,Me=(a("669f"),Object(U["a"])(qe,A,_,!1,null,null,null)),Ve=Me.exports;function Ue(e,t){var a=null;switch(t.goods.type){case"table":a=ze;break;case"pie":a=We;break;case"line":a=Qe;break;case"bar":a=Ke;break;case"monitorChart":a=He;break;default:}return e.data?a(e.data,t.goods):a(e,t.goods)}function ze(e,t){if(t.columns||(t.columns=[]),e.fields)e.fields.forEach((function(e){if(!Object(h["a"])(t.columns,"fieldCode",e.fieldCode)){var a={};a.label=e.fieldName,a.prop=e.fieldCode,a.fieldCode=e.fieldCode,a.align=e.align||"center",a.headerAlign="center",a.fieldType=e.fieldType,a.showOverflowTooltip=!0,a.canSet=e.canSet||0,1===e.fieldType?a.format=e.format||"":2===e.fieldType?a.format=e.format||"yyyy-MM-dd":a.format="",a.formatter=Ye(e.format),t.columns.push(a)}}));else if(!Object(h["a"])(t.columns,"fieldCode",e.fieldCode)){var a={};a.label=e.fieldName,a.prop=e.fieldCode,a.fieldCode=e.fieldCode,a.align=e.align||"center",a.headerAlign="center",a.fieldType=e.fieldType,a.showOverflowTooltip=!0,a.canSet=e.canSet||0,1===e.fieldType?a.format=e.format||"":2===e.fieldType?a.format=e.format||"yyyy-MM-dd":a.format="",a.formatter=Ye(e.format),t.columns.push(a)}}function We(e,t){if(e.fields)return"只能拖入节点，不能拖入整个数据集";if("pieLabel"===e.attrFlag){if(t.label)return"repeat";t.label=e.fieldCode,t.pieType=e.pieType}if("pieValue"===e.attrFlag){if(t.value)return"repeat";t.value=e.fieldCode,t.pieType=e.pieType}}function Qe(e,t){if(e.fields)return"只能拖入节点，不能拖入整个数据集";if("xaxis"===e.attrFlag){if(t.label)return"repeat";t.xaxis=e.fieldCode}if("yaxis"===e.attrFlag){t.yaxis||(t.yaxis=[]);var a=t.yaxis;if(Object(h["a"])(a,"fieldCode",e.fieldCode))return"repeat";a.push({code:e.fieldCode,label:e.name})}}function Ke(e,t){if(e.fields)return"只能拖入节点，不能拖入整个数据集";if("xaxis"===e.attrFlag){if(t.label)return"repeat";t.xaxis=e.fieldCode}if("yaxis"===e.attrFlag){t.yaxis||(t.yaxis=[]);var a=t.yaxis;if(Object(h["a"])(a,"fieldCode",e.fieldCode))return"repeat";a.push({code:e.fieldCode,label:e.name})}}function He(e,t){if(e.fields)return"只能拖入节点，不能拖入整个数据集";"completeCount"===e.attrFlag?t.completeCount=e.fieldCode:"allCount"===e.attrFlag&&(t.allCount=e.fieldCode)}function Je(e){return e.reduce((function(e,t){return e.gridRowEnd>t.gridRowEnd?e:t})).gridRowEnd-1}function Xe(e){return e.reduce((function(e,t){return e.gridColumnEnd>t.gridColumnEnd?e:t})).gridColumnEnd-1}function Ye(e){var t=null;switch(e){case"thousand":t=function(e,t){return Object(h["g"])(e[t.property])};break;case"amount":t=function(e,t){return Object(h["d"])(e[t.property])};break;case"yyyy-MM-dd":t=function(e,t){return Ze(e[t.property],"-")};break;case"yyyy/MM/dd":t=function(e,t){return Ze(e[t.property],"/")};break;default:t=function(e,t){return e[t.property]}}return t}function Ze(e,t){var a=new Date(e),o=a.getFullYear(),i=a.getMonth()+1,n=a.getDate();return i<10&&(i="0".concat(i)),n<10&&(n="0".concat(n)),"".concat(o).concat(t).concat(i).concat(t).concat(n)}var et=a("ed5d"),tt=a("aa62"),at=a.n(tt),ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"preivew-grid-layout"},e._l(e.previewGrid,(function(t){return a("div",{directives:[{name:"show",rawName:"v-show",value:!t.empty,expression:"!block.empty"}],key:t.id,staticClass:"grid-item",style:{gridColumn:t.gridColumnStart+" / "+t.gridColumnEnd,gridRow:t.gridRowStart+" / "+t.gridRowEnd,margin:t.gridColumnEnd-1!==e.COLUMNS?"0 20px 20px 0":"0 0 20px 0"}},[a("TemplateBlock",{attrs:{preview:!0,"data-source":e.multipleData[t.id],block:t,beRelatedFromItemList:e.beRelatedFromItemList},on:{getRealContentById:e.getRealContentById,queryRelationDataset:e.queryRelationDataset,getDataByCard:e.getDataByCard}})],1)})),0)},it=[],nt=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.previewGrid=null,e.multipleData={},e.loading=!1,e}return Object(l["a"])(a,[{key:"initBlockParamsAndContent",value:function(e){var t=this;this.previewGrid.forEach((function(a){if(e){var o=Object(h["a"])(e,"blockId",a.goods);"table"===o.type&&o.columns.forEach((function(e){e.format&&(e.formatter=Ye(e.format))})),a.goods=o}t.getRealContentById(a)}))}},{key:"initPreviewTemplate",value:function(){this.templateId?this.getTemplateDetail():(this.previewGrid=Object($["cloneDeep"])(this.currentGrid),this.initBlockParamsAndContent())}},{key:"getTemplateDetail",value:function(){var e=this;this.loading=!0,Object(P["f"])({id:this.templateId}).then((function(t){var a=t.data,o=t.error;if(e.loading=!1,o)e.$message.error(o.message||"获取数据失败");else{var i=JSON.parse(et["a"].decode(a.style)),n=a.blocks;e.previewGrid=i,e.initBlockParamsAndContent(n)}}))}},{key:"getRealContentById",value:function(e){var t=this;if(e.goods&&"monitorSteps"!==e.goods.type){if(!e.goods||!e.goods.dataSetId)return;for(var a={viewId:e.goods.dataSetId},o=[],i=0,n=e.goods.queryParams.length;i<n;i++){var r=e.goods.queryParams[i];if(0===r.required&&!r.value)return;o.push({code:r.code,type:r.type,value:r.value})}a.queryParams=o,Object(I["f"])(a).then((function(a){var o=a.data,i=a.error;i?t.$message.error(i.message||"获取数据失败"):("table"===e.goods.type&&o.rows.forEach((function(e){e.isEdit=!0})),t.$set(t.multipleData,e.id,o.rows))}))}else{var l=e.goods?e.goods.stepsList:[];l.forEach((function(a,o){if(a.dataSetId){var i={viewId:a.dataSetId},n=[];e.goods.queryParams&&e.goods.queryParams.forEach((function(t){"monitorName"===t.code&&(t.value=e.goods.queryName),n.push({code:t.code,type:t.type,value:t.value})})),i.previewParams=n,Object(I["f"])(i).then((function(a){var i=a.data,n=a.error;if(n)t.$message.error(n.message||"获取数据失败");else{var r=Object($["cloneDeep"])(t.multipleData);t.multipleData[e.id]?(r[e.id][o]=i.rows,t.multipleData=r):(r[e.id]=[],r[e.id][o]=i.rows,t.multipleData=r)}}))}}))}}},{key:"queryRelationDataset",value:function(e){var t=this;this.previewGrid&&this.previewGrid.forEach((function(a){if(a.goods&&a.goods.queryParams){var o=!1;a.goods.queryParams.forEach((function(a){if("chart"===e.type&&"3"===a.valueBy&&a.relationChart===e.relationBlock&&(o=!0,t.$set(a,"value",e[a.relationChartField])),"formItem"===e.type&&"2"===a.valueBy)for(var i=0,n=e.formItems.length;i<n;i++){var r=e.formItems[i];if(a.relationFormItem===r.formItemKey){o=!0,t.$set(a,"value",r.formItemValue);break}}})),o&&t.getRealContentById(a)}}))}},{key:"getDataByCard",value:function(e){var t=this;this.previewGrid&&this.previewGrid.forEach((function(a){if(a.goods&&"table"===a.goods.type&&a.goods.dataSetId){var o={viewId:a.goods.dataSetId,monitorName:e.monitorName};Object(I["f"])(o).then((function(e){var o=e.data,i=e.error;i?t.$message.error(i.message||"获取数据失败"):(o.rows.forEach((function(e){e.isEdit=!0})),t.$set(t.multipleData,a.id,o.rows))}))}}))}},{key:"COLUMNS",get:function(){return Xe(this.previewGrid)}},{key:"beRelatedFromItemList",get:function(){var e=[];return this.previewGrid&&this.previewGrid.map((function(t){if(t&&t.goods&&t.goods.queryParams){var a=t.goods.queryParams.filter((function(e){return"2"===e.valueBy}));a.map((function(t){-1===e.indexOf(t.relationFormItem)&&e.push(t.relationFormItem)}))}})),e}}]),a}(d["e"]);Object(u["a"])([Object(d["c"])()],nt.prototype,"templateId",void 0),Object(u["a"])([Object(d["c"])()],nt.prototype,"currentGrid",void 0),nt=Object(u["a"])([Object(d["a"])({components:{TemplateBlock:Ve}})],nt);var rt=nt,lt=rt,ct=(a("3ed9"),Object(U["a"])(lt,ot,it,!1,null,"41d596d4",null)),st=ct.exports,ut=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("simple-dialog",{staticClass:"layoutDialog",attrs:{dialogTitle:"选择布局模板","dialog-visible":e.dialogVisible,"save-text":"应 用","cancel-text":"取 消","botton-show":"true",dialogWidth:"70%"},on:{saveEmit:e.applyLayout,cancelEmit:e.cancelDialog}},[a("div",{staticClass:"container"},e._l(e.layoutGrid,(function(t){return a("div",{key:t.id,staticClass:"grid-layout",class:{active:t.id===e.activeLayout},on:{click:function(){return e.selectLayout(t.id)}}},[e._l(t.grid,(function(e,o){return a("div",{key:o,staticClass:"grid-item",class:{rightBorder:e.gridColumnEnd-1!==t.COLUMNS,bottomBorder:e.gridRowEnd-1!==t.ROWS},style:{gridColumn:e.gridColumnStart+" / "+e.gridColumnEnd,gridRow:e.gridRowStart+" / "+e.gridRowEnd,height:600/t.ROWS*e.height+"px"}})})),a("span",{staticClass:"delete-layout",on:{click:function(a){return e.deleteLayout(t.id)}}},[a("svg-icon",{attrs:{"icon-class":"block-delete"}})],1)],2)})),0)])},dt=[],pt=(a("7db0"),Object(E["a"])("pageTemplate")),ft=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.dialogVisible=!1,e.activeLayout=null,e}return Object(l["a"])(a,[{key:"apply",value:function(e){}},{key:"cancelDialog",value:function(){this.dialogVisible=!1,this.activeLayout=null}},{key:"openPreviewDialog",value:function(){this.layoutList.length?this.dialogVisible=!0:this.$message.warning("您还没有创建布局模板")}},{key:"deleteLayout",value:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={id:e};Object(P["b"])(a).then((function(e){var a=e.error;a?t.$message.warning(a.message):(t.$message.success("删除成功"),t.getLayoutTemplateList())}))})).catch((function(){}))}},{key:"applyLayout",value:function(){var e=this;if(this.activeLayout){var t=this.layoutGrid.find((function(t){return t.id===e.activeLayout}));t=t&&t.grid,this.apply(t),this.cancelDialog()}else this.cancelDialog()}},{key:"selectLayout",value:function(e){this.activeLayout=e}},{key:"layoutGrid",get:function(){return this.layoutList.map((function(e){var t=JSON.parse(et["a"].decode(e.style));return{id:e.id,grid:t,COLUMNS:Xe(t),ROWS:Je(t)}}))}}]),a}(d["e"]);Object(u["a"])([pt.State((function(e){return e.layoutList}))],ft.prototype,"layoutList",void 0),Object(u["a"])([pt.Action("getLayoutTemplateList")],ft.prototype,"getLayoutTemplateList",void 0),Object(u["a"])([Object(d["b"])("applyTemplate")],ft.prototype,"apply",null),ft=Object(u["a"])([d["a"]],ft);var ht=ft,gt=ht,mt=(a("6933"),Object(U["a"])(gt,ut,dt,!1,null,null,null)),bt=mt.exports,vt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"left-toolbar",class:{narrow:!e.narrow}},[o("div",{staticClass:"toolbar-container"},e._l(e.pageElement,(function(t,a){return o("div",{key:a,staticClass:"toolbar-box"},[o("div",{staticClass:"toolbar-title"},[e._v(e._s(t.title))]),e._l(t.element,(function(t,a){return o("div",{key:a,staticClass:"dragItem",attrs:{draggable:"true"},on:{dragstart:function(a){return e.handleDragStart({iconType:t.value,allowType:t.allowType})}}},[o("svg-icon",{staticClass:"item-icon",attrs:{"icon-class":t.icon}}),o("span",[e._v(e._s(t.label))])],1)}))],2)})),0),e.leftBarOpen?o("div",{staticClass:"left-open-btn",on:{click:function(t){return e.handleSideBarOpen("left")}}},[o("img",{attrs:{src:a("f9a2")}})]):o("div",{staticClass:"left-open-btn",on:{click:function(t){return e.handleSideBarOpen("left")}}},[o("img",{attrs:{src:a("72b0")}})])])},yt=[],kt=Object(E["a"])("pageTemplate"),Ct=(Object(E["a"])("collapse"),function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.pageElement=[{title:"表格",element:[{label:"表格",value:"table",icon:"table-icon",allowType:0}]},{title:"统计图",element:[{label:"饼图",value:"pie",icon:"pie-icon",allowType:0},{label:"柱状图",value:"bar",icon:"bar-icon",allowType:0},{label:"折线图",value:"line",icon:"line-icon",allowType:0},{label:"监控图表",value:"monitorChart",icon:"line-icon",allowType:0},{label:"监控节点",value:"monitorSteps",icon:"line-icon",allowType:0}]},{title:"表单",element:[{label:"表单",value:"singleForm",icon:"single-form",allowType:0}]},{title:"表单元素组",element:[{label:"文本框",value:"text",icon:"input-icon",allowType:1},{label:"文本域",value:"textarea",icon:"text-icon",allowType:1},{label:"下拉框",value:"select",icon:"select-icon",allowType:1},{label:"日期选择器",value:"date",icon:"datepicker-icon",allowType:1},{label:"时间选择器",value:"time",icon:"timepicker-icon",allowType:1},{label:"单选按钮组",value:"radioGroup",icon:"radio-icon",allowType:1},{label:"复选框组",value:"checkboxGroup",icon:"checkbox-icon",allowType:1},{label:"文件上传",value:"upload",icon:"upload-icon",allowType:1},{label:"按钮",value:"button",icon:"button-icon",allowType:1},{label:"开关",value:"switch",icon:"form-tool-switch",allowType:1},{label:"提示卡",value:"alert",icon:"folder-alert-line",allowType:1},{label:"数字",value:"number",icon:"form-tool-inputNumber",allowType:1}]}],e}return Object(l["a"])(a,[{key:"handleDragStart",value:function(e){}},{key:"tempateNameChange",value:function(e){}},{key:"handleSideBarOpen",value:function(e){}},{key:"handleNameChange",value:function(){this.tempateNameChange(this.templateName),this.handleEditFlagChange(!0)}}]),a}(d["e"]));Object(u["a"])([Object(d["b"])("onDragStart")],Ct.prototype,"handleDragStart",null),Object(u["a"])([Object(d["b"])("tempateNameChange")],Ct.prototype,"tempateNameChange",null),Object(u["a"])([Object(d["b"])("handleSideBarOpen")],Ct.prototype,"handleSideBarOpen",null),Object(u["a"])([Object(d["c"])()],Ct.prototype,"templateName",void 0),Object(u["a"])([Object(d["c"])()],Ct.prototype,"narrow",void 0),Object(u["a"])([Object(d["c"])()],Ct.prototype,"leftBarOpen",void 0),Object(u["a"])([kt.State((function(e){return e.editFlag}))],Ct.prototype,"editFlag",void 0),Object(u["a"])([kt.Mutation("UPDATE_EDIT_FLAG")],Ct.prototype,"handleEditFlagChange",void 0),Ct=Object(u["a"])([d["a"]],Ct);var Ot=Ct,jt=Ot,Bt=(a("ac55"),Object(U["a"])(jt,vt,yt,!1,null,null,null)),St=Bt.exports,xt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return!this.formAttribute||"singleForm"!==this.currentBlock.goods.type&&"doubleForm"!==this.currentBlock.goods.type?o("div",{staticClass:"right-toolbar",class:{hidden:!e.hidden}},[o("div",{staticClass:"toolbar-container"},[o("el-collapse",[o("div",[o("el-collapse-item",{attrs:{title:"数据视图筛选面板",name:"1"}},[o("el-form",{attrs:{"label-position":"left"}},[o("el-form-item",{attrs:{label:"选择视图：","label-width":"70px"}},[o("el-select",{attrs:{placeholder:"请选择",filterable:""},on:{change:e.handleViweChange},model:{value:e.selectedDataSet,callback:function(t){e.selectedDataSet=t},expression:"selectedDataSet"}},e._l(e.dataSetList,(function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}},[o("span",[e._v(e._s(t.name))])])})),1)],1)],1),o("div",{staticClass:"fields-tree"},[o("el-tree",{attrs:{data:e.fieldsTree,props:{children:"fields",label:"name"},draggable:"","allow-drop":function(){return!1}},on:{"node-drag-start":function(t){return e.fieldDragStart({node:t})}}})],1)],1),o("el-collapse-item",{attrs:{title:"图表属性",name:"2"}},[o("el-form",{ref:"configForm",staticClass:"configForm",attrs:{"label-position":"left",model:e.configForm,"label-width":"pie"===e.configForm.type?"100px":"84px"}},[o("el-form-item",{staticClass:"requiredItem",attrs:{label:"块标题：",required:"",prop:"blockName","show-message":!1,rules:[{required:!0,trigger:"blur"}]}},[o("el-input",{attrs:{placeholder:"请输入块标题",disabled:"{}"===JSON.stringify(e.currentBlock)||e.currentBlock.empty},on:{input:function(t){return e.handleBaseInfoChange("blockName",t)}},model:{value:e.configForm.blockName,callback:function(t){e.$set(e.configForm,"blockName",t)},expression:"configForm.blockName"}})],1),o("el-form-item",{attrs:{label:"显示块标题："}},[o("el-switch",{attrs:{"active-color":"#409eff",disabled:"{}"===JSON.stringify(e.currentBlock)||e.currentBlock.empty},on:{change:function(t){return e.handleBaseInfoChange("showBlockName",t)}},model:{value:e.configForm.showBlockName,callback:function(t){e.$set(e.configForm,"showBlockName",t)},expression:"configForm.showBlockName"}})],1),o(e.componentkey,e._g(e._b({tag:"component",attrs:{configForm:e.configForm}},"component",e.$attrs,!1),e.$listeners))],1)],1),o("el-collapse-item",{attrs:{title:"视图参数设置",name:"3"}},[e.queryParams.length?e._e():o("span",{staticClass:"noParams"},[e._v("暂无数据")]),e._l(e.queryParams,(function(t,a){return o("el-form",{key:t.code,ref:"paramForm_"+a,refInFor:!0,staticClass:"param-form",attrs:{"label-width":"84px","label-position":"left",model:t}},[o("el-form-item",{attrs:{label:"参数名称：",prop:"name"}},[o("el-input",{attrs:{disabled:"",value:t.name}})],1),o("el-form-item",{attrs:{label:"值获取方式：",prop:"valueBy"}},[o("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){return e.handleParamsChange("valueBy",a,t)}},model:{value:t.valueBy,callback:function(a){e.$set(t,"valueBy",a)},expression:"item.valueBy"}},[o("el-option",{attrs:{label:"使用默认值",value:"0"}}),o("el-option",{attrs:{label:"在内容块显示参数表单",value:"1"}}),o("el-option",{attrs:{label:"使用画布中指定表单项的值",value:"2"}}),o("el-option",{attrs:{label:"其它图表",value:"3"}})],1)],1),"0"===t.valueBy?o("el-form-item",{class:{requiredItem:0===t.required},attrs:{label:"默认值：",required:0===t.required}},[0===t.type||1===t.type?o("el-input",{attrs:{placeholder:"请输入默认值"},on:{input:function(t){return e.handleParamsChange("value",t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),2===t.type?o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{input:function(t){return e.handleParamsChange("value",t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),3===t.type?o("el-select",{on:{change:function(t){return e.handleParamsChange("value",t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},[o("el-option",{attrs:{value:"0",label:"否"}}),o("el-option",{attrs:{value:"1",label:"是"}})],1):e._e()],1):e._e(),"2"===t.valueBy?o("el-form-item",{attrs:{label:"表单项：",prop:"formItem"}},[o("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleParamsChange("relationFormItem",t)}},model:{value:t.relationFormItem,callback:function(a){e.$set(t,"relationFormItem",a)},expression:"item.relationFormItem"}},e._l(e.formItemList,(function(e){return o("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)],1):e._e(),"3"===t.valueBy?o("el-form-item",{attrs:{label:"关联图表：",prop:"relationChart"}},[o("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleParamsChange("relationChart",t)}},model:{value:t.relationChart,callback:function(a){e.$set(t,"relationChart",a)},expression:"item.relationChart"}},e._l(e.chartList,(function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:e.currentBlock.id===t.value}})})),1)],1):e._e(),"3"===t.valueBy?o("el-form-item",{attrs:{label:"关联字段：",prop:"relationChartField"}},[o("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleParamsChange("relationChartField",t)}},model:{value:t.relationChartField,callback:function(a){e.$set(t,"relationChartField",a)},expression:"item.relationChartField"}},e._l(e.getRelationChartOptions(t.relationChart),(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e()],1)}))],2)],1)])],1),e.rightBarOpen?o("div",{staticClass:"right-open-btn",on:{click:function(t){return e.handleSideBarOpen("right")}}},[o("img",{attrs:{src:a("ab3e4")}})]):o("div",{staticClass:"right-open-btn",on:{click:function(t){return e.handleSideBarOpen("right")}}},[o("img",{attrs:{src:a("f9a2")}})])]):o("RightSet",{attrs:{itemAttribute:e.itemAttribute,formAttribute:e.formAttribute,dataSet:e.dataSet,grid:e.grid,templateSet:"templateSet",viewDataSet:e.viewDataSet,optionLabelInit:e.optionLabel}})},wt=[],Dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("p",{staticClass:"columns-wrap-title"},[e._v("表头列配置：")]),a("div",{staticClass:"columns-wrap-content"},[a("vuedraggable",{on:{change:e.handleOrderChange},model:{value:e.config.tableFields,callback:function(t){e.$set(e.config,"tableFields",t)},expression:"config.tableFields"}},[a("transition-group",e._l(e.config.tableFields,(function(t){return a("div",{key:t.fieldCode,staticClass:"columns-item"},[e._v(" "+e._s(t.label)+" "),a("span",{staticClass:"columns-operation"},[a("i",{staticClass:"el-icon-delete",on:{click:function(){return e.deleteTableColumn(t)}}}),a("el-popover",{attrs:{width:"260",placement:"right",trigger:"click","popper-class":"columns-pop"}},[a("el-form",{attrs:{"label-width":"84px","label-position":"left"}},[a("el-form-item",{attrs:{label:"对齐方式："}},[a("el-select",{on:{change:function(a){return e.handleAlignChange(a,t)}},model:{value:t.align,callback:function(a){e.$set(t,"align",a)},expression:"item.align"}},[a("el-option",{attrs:{label:"左对齐",value:"left"}}),a("el-option",{attrs:{label:"居中对齐",value:"center"}}),a("el-option",{attrs:{label:"右对齐",value:"right"}})],1)],1),a("el-form-item",{attrs:{label:"格式化方式："}},[a("el-select",{attrs:{disabled:1!==t.fieldType&&2!==t.fieldType},on:{change:function(a){return e.handleFormatChange(a,t)}},model:{value:t.format,callback:function(a){e.$set(t,"format",a)},expression:"item.format"}},[1==t.fieldType?[a("el-option",{attrs:{label:"无",value:""}}),a("el-option",{attrs:{label:"金额",value:"amount"}}),a("el-option",{attrs:{label:"千分位",value:"thousand"}})]:e._e(),2==t.fieldType?[a("el-option",{attrs:{label:"yyyy-MM-dd",value:"yyyy-MM-dd"}}),a("el-option",{attrs:{label:"yyyy/MM/dd",value:"yyyy/MM/dd"}})]:e._e()],2)],1),a("el-form-item",{attrs:{label:"可编辑:"}},[a("el-checkbox",{on:{change:function(a){return e.handleEditChange(a,t)}},model:{value:!!t.canSet,callback:function(a){e.$set(t,"canSet ? true : false",a)},expression:"item.canSet ? true : false"}})],1)],1),a("i",{staticClass:"el-icon-edit",attrs:{slot:"reference"},slot:"reference"})],1)],1)])})),0)],1)],1)])},Tt=[],Ft=a("310e"),It=a.n(Ft),Lt=Object(E["a"])("pageTemplate"),At=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(r["a"])(this,a),t.apply(this,arguments)}return Object(l["a"])(a,[{key:"changeGrid",value:function(){}},{key:"handleOrderChange",value:function(){this.currentBlock.goods.columns=this.config.tableFields,this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock)),this.changeGrid()}},{key:"deleteTableColumn",value:function(e){if(this.currentBlock.goods&&this.currentBlock.goods.columns){var t=this.currentBlock.goods.columns.findIndex((function(t){return t.fieldCode===e.fieldCode}));this.currentBlock.goods.columns.splice(t,1),this.configForm.tableFields.splice(t,1),this.currentBlock.goods.columns.length||(this.currentBlock.goods.dataSetId=""),this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock)),this.changeGrid()}}},{key:"handleAlignChange",value:function(e,t){this.currentBlock.goods&&this.currentBlock.goods.columns&&(this.currentBlock.goods.columns.map((function(a){a.fieldCode===t.fieldCode&&(a.align=e)})),this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock)),this.changeGrid())}},{key:"handleFormatChange",value:function(e,t){var a=this;this.currentBlock.goods&&this.currentBlock.goods.columns&&(this.currentBlock.goods.columns.map((function(o){o.fieldCode===t.fieldCode&&(a.$set(o,"format",e),a.$set(o,"formatter",Ye(e)))})),this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock)),this.changeGrid())}},{key:"handleEditChange",value:function(e,t){var a=this;if(this.currentBlock.goods&&this.currentBlock.goods.columns){var o=Object($["cloneDeep"])(this.currentBlock);o.goods.columns.map((function(i){i.fieldCode===t.fieldCode&&(i.canSet=e?1:0,a.updateActiveBlock(o),a.changeGrid())}))}}},{key:"currentBlock",get:function(){return Object($["cloneDeep"])(this.activeBlock)}},{key:"config",get:function(){return Object($["cloneDeep"])(this.configForm)}}]),a}(d["e"]);Object(u["a"])([Lt.State((function(e){return e.dataSetList}))],At.prototype,"dataSetList",void 0),Object(u["a"])([Lt.State((function(e){return e.activeBlock}))],At.prototype,"activeBlock",void 0),Object(u["a"])([Lt.Mutation("UPDATE_ACTIVE_BLOCK")],At.prototype,"updateActiveBlock",void 0),Object(u["a"])([Object(d["b"])("changeGrid")],At.prototype,"changeGrid",null),Object(u["a"])([Object(d["c"])()],At.prototype,"configForm",void 0),At=Object(u["a"])([Object(d["a"])({components:{vuedraggable:It.a}})],At);var _t=At,Et=_t,Nt=(a("bb23"),a("f2a5"),Object(U["a"])(Et,Dt,Tt,!1,null,"7d513394",null)),Rt=Nt.exports,$t=a("6474"),Pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:"饼图类型："}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleConfigFormChange(t,"pieType")}},model:{value:e.config.pieType,callback:function(t){e.$set(e.config,"pieType",t)},expression:"config.pieType"}},[a("el-option",{attrs:{label:"普通饼图",value:"0"}}),a("el-option",{attrs:{label:"环形图",value:"1"}}),a("el-option",{attrs:{label:"南丁格尔图",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"分区名称字段："}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleConfigFormChange(t,"label")}},model:{value:e.config.pieLabel,callback:function(t){e.$set(e.config,"pieLabel",t)},expression:"config.pieLabel"}},e._l(e.config.pieLabelOptions,(function(e){return a("el-option",{key:e.fieldCode,attrs:{value:e.fieldCode,label:e.fieldName}})})),1)],1),a("el-form-item",{attrs:{label:"分区数值字段："}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleConfigFormChange(t,"value")}},model:{value:e.config.pieValue,callback:function(t){e.$set(e.config,"pieValue",t)},expression:"config.pieValue"}},e._l(e.config.pieValueOptions,(function(e){return a("el-option",{key:e.fieldCode,attrs:{value:e.fieldCode,label:e.fieldName}})})),1)],1)],1)},Gt=[],qt=Object(E["a"])("pageTemplate"),Mt=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(r["a"])(this,a),t.apply(this,arguments)}return Object(l["a"])(a,[{key:"changeGrid",value:function(){}},{key:"handleConfigFormChange",value:function(e,t){this.currentBlock.goods[t]=e,this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock)),this.changeGrid()}},{key:"currentBlock",get:function(){return Object($["cloneDeep"])(this.activeBlock)}},{key:"config",get:function(){return Object($["cloneDeep"])(this.configForm)}}]),a}(d["e"]);Object(u["a"])([qt.State((function(e){return e.dataSetList}))],Mt.prototype,"dataSetList",void 0),Object(u["a"])([qt.State((function(e){return e.activeBlock}))],Mt.prototype,"activeBlock",void 0),Object(u["a"])([qt.Mutation("UPDATE_ACTIVE_BLOCK")],Mt.prototype,"updateActiveBlock",void 0),Object(u["a"])([Object(d["b"])("changeGrid")],Mt.prototype,"changeGrid",null),Object(u["a"])([Object(d["c"])()],Mt.prototype,"configForm",void 0),Mt=Object(u["a"])([d["a"]],Mt);var Vt=Mt,Ut=Vt,zt=Object(U["a"])(Ut,Pt,Gt,!1,null,"912682ba",null),Wt=zt.exports,Qt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return-1===["table","pie","line","bar"].indexOf(e.config.type)&&e.config.key?a("div",[a("div",[a("el-form-item",{attrs:{label:"属性值："}},[a("el-input",{model:{value:e.config.key,callback:function(t){e.$set(e.config,"key",t)},expression:"config.key"}})],1),-1===["upload","button"].indexOf(e.config.formItemType)?a("el-form-item",{attrs:{label:"标题："}},[a("el-input",{attrs:{placeholder:"请输入表单项标题"},on:{input:function(t){return e.handleFormConfigChange("label",t)}},model:{value:e.config.label,callback:function(t){e.$set(e.config,"label",t)},expression:"config.label"}})],1):a("el-form-item",{attrs:{label:"文字："}},[a("el-input",{attrs:{placeholder:"请输入按钮文字"},on:{input:function(t){return e.handleFormConfigChange("btnProp.buttonText",t)}},model:{value:e.config.btnProp.buttonText,callback:function(t){e.$set(e.config.btnProp,"buttonText",t)},expression:"config.btnProp.buttonText"}})],1),["text","textarea","date","time","select"].indexOf(e.config.formItemType)>-1?a("el-form-item",{attrs:{label:"占位内容："}},[a("el-input",{attrs:{placeholder:"请输入占位内容"},on:{input:function(t){return e.handleFormConfigChange("placeholder",t)}},model:{value:e.config.placeholder,callback:function(t){e.$set(e.config,"placeholder",t)},expression:"config.placeholder"}})],1):e._e(),-1===["upload","button"].indexOf(e.config.formItemType)?a("el-form-item",{attrs:{label:"默认值："}},["date"===e.config.formItemType?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},on:{input:function(t){return e.handleFormConfigChange("value",t)}},model:{value:e.config.value,callback:function(t){e.$set(e.config,"value",t)},expression:"config.value"}}):"time"===e.config.formItemType?a("el-time-picker",{attrs:{placeholder:"选择时间","value-format":"HH:mm:ss"},on:{input:function(t){return e.handleFormConfigChange("value",t)}},model:{value:e.config.value,callback:function(t){e.$set(e.config,"value",t)},expression:"config.value"}}):["radioGroup","checkboxGroup","select"].indexOf(e.config.formItemType)>-1?a("el-select",{key:e.config.formItemType,attrs:{placeholder:"请选择",multiple:"checkboxGroup"===e.config.formItemType||e.config.multiple},on:{change:function(t){return e.handleFormConfigChange("value",t)}},model:{value:e.config.value,callback:function(t){e.$set(e.config,"value",t)},expression:"config.value"}},e._l(e.config.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:"checkboxGroup"===e.config.formItemType?t.label:t.value}})})),1):a("el-input",{attrs:{placeholder:"请输入默认值"},on:{input:function(t){return e.handleFormConfigChange("value",t)}},model:{value:e.config.value,callback:function(t){e.$set(e.config,"value",t)},expression:"config.value"}})],1):e._e(),["radioGroup","checkboxGroup","select"].indexOf(e.config.formItemType)>-1?a("el-form-item",{staticClass:"staticData",attrs:{label:"字典配置："}},[a("el-table",{staticClass:"tabItemTable",staticStyle:{width:"100%"},attrs:{data:e.config.options,"show-header":!1}},[a("el-table-column",{attrs:{label:"属性名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入内容"},on:{input:function(a){return e.handelOptionsChange(a,t.$index)}},model:{value:t.row.label,callback:function(a){e.$set(t.row,"label",a)},expression:"scope.row.label"}})]}}],null,!1,917020043)}),a("el-table-column",{attrs:{label:"属性值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入内容",disabled:""},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}],null,!1,3893186576)}),a("el-table-column",{attrs:{width:"60px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.deleteTabRow(t.$index,e.config.options)}}},[e._v("删除")])]}}],null,!1,1296612117)})],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.addTabRow(e.config.options)}}},[e._v("添加列")])],1):e._e()],1)]):e._e()},Kt=[],Ht=(a("ac1f"),a("1276"),Object(E["a"])("pageTemplate")),Jt=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(r["a"])(this,a),t.apply(this,arguments)}return Object(l["a"])(a,[{key:"changeGrid",value:function(){}},{key:"updateActiveFormItem",value:function(e){}},{key:"handleFormConfigChange",value:function(e,t){var a=this,o=Object($["cloneDeep"])(this.activeBlock),i=o.goods.formAttribute.formList;i.forEach((function(o){if(o.key===a.config.key)if(e.indexOf(".")>-1){var i=e.split(".");o[i[0]][i[1]]=t}else o[e]=t})),this.updateActiveFormItem(this.config),this.updateActiveBlock(o),this.changeGrid()}},{key:"deleteTabRow",value:function(e,t){var a=this,o="checkboxGroup"===this.config.formItemType?t[e].label:t[e].value;Array.isArray(this.config.value)?this.config.value.forEach((function(e,t,a){e===o&&a.splice(t,1)})):o===this.config.value&&(this.config.value=""),t.splice(e,1);var i=Object($["cloneDeep"])(this.activeBlock),n=i.goods.formAttribute.formList;n.forEach((function(t){t.key===a.config.key&&(t.options.splice(e,1),Array.isArray(t.value)?t.value.forEach((function(e,t,a){e===o&&a.splice(t,1)})):o===t.value&&(t.value=""))})),this.updateActiveFormItem(this.config),this.updateActiveBlock(i),this.changeGrid()}},{key:"handelOptionsChange",value:function(e,t){var a=this,o=Object($["cloneDeep"])(this.activeBlock),i=o.goods.formAttribute.formList;i.forEach((function(o){o.key===a.config.key&&(o.options[t].label=e)})),this.updateActiveFormItem(this.config),this.updateActiveBlock(o),this.changeGrid()}},{key:"addTabRow",value:function(e){var t=this,a=Object($["cloneDeep"])(this.activeBlock),o=a.goods.formAttribute.formList,i={label:"选项"+(this.config.options.length+1),value:Math.random().toString(36).substring(2)};o.forEach((function(e){e.key===t.config.key&&e.options.push(i)})),e.push(i),this.updateActiveFormItem(this.config),this.updateActiveBlock(a),this.changeGrid()}},{key:"config",get:function(){return Object($["cloneDeep"])(this.configForm)}}]),a}(d["e"]);Object(u["a"])([Ht.Mutation("UPDATE_ACTIVE_BLOCK")],Jt.prototype,"updateActiveBlock",void 0),Object(u["a"])([Ht.State((function(e){return e.activeBlock}))],Jt.prototype,"activeBlock",void 0),Object(u["a"])([Object(d["c"])()],Jt.prototype,"configForm",void 0),Object(u["a"])([Object(d["b"])("changeGrid")],Jt.prototype,"changeGrid",null),Object(u["a"])([Object(d["b"])("activeFormItemChange")],Jt.prototype,"updateActiveFormItem",null),Jt=Object(u["a"])([d["a"]],Jt);var Xt=Jt,Yt=Xt,Zt=(a("acb1"),Object(U["a"])(Yt,Qt,Kt,!1,null,null,null)),ea=Zt.exports,ta=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:"x轴："}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleConfigFormChange(t,"xaxis")}},model:{value:e.config.xaxis,callback:function(t){e.$set(e.config,"xaxis",t)},expression:"config.xaxis"}},e._l(e.config.xaxisOptions,(function(e){return a("el-option",{key:e.fieldCode,attrs:{label:e.fieldName,value:e.fieldCode}})})),1)],1),a("el-form-item",{attrs:{label:"y轴："}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},on:{change:function(t){return e.handleConfigFormChange(t,"yaxis")}},model:{value:e.config.yaxis,callback:function(t){e.$set(e.config,"yaxis",t)},expression:"config.yaxis"}},e._l(e.config.yaxisOptions,(function(e){return a("el-option",{key:e.fieldCode,attrs:{label:e.fieldName,value:e.fieldCode}})})),1)],1)],1)},aa=[],oa=Object(E["a"])("pageTemplate"),ia=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(r["a"])(this,a),t.apply(this,arguments)}return Object(l["a"])(a,[{key:"changeGrid",value:function(){}},{key:"handleConfigFormChange",value:function(e,t){if("yaxis"===t){var a=Object($["cloneDeep"])(Object(h["a"])(this.dataSetList,"id",this.currentBlock.goods.dataSetId)),o=[];e.map((function(e){var t=a.fields.find((function(t){return t.fieldCode===e}));t&&o.push({code:t.fieldCode,label:t.fieldName})})),this.currentBlock.goods.yaxis=o}else this.currentBlock.goods.xaxis=e;this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock)),this.changeGrid()}},{key:"currentBlock",get:function(){return Object($["cloneDeep"])(this.activeBlock)}},{key:"config",get:function(){var e=this.configForm,t=e.type,a=e.blockName,o="bar"===t?this.configForm.barXaxis:this.configForm.lineXaxis,i="bar"===t?this.configForm.barYaxis:this.configForm.lineYaxis,n="bar"===t?this.configForm.barXaxisOptions:this.configForm.lineXaxisOptions,r="bar"===t?this.configForm.barYaxisOptions:this.configForm.lineYaxisOptions;return{type:t,blockName:a,xaxis:o,yaxis:i,xaxisOptions:n,yaxisOptions:r}}}]),a}(d["e"]);Object(u["a"])([oa.State((function(e){return e.dataSetList}))],ia.prototype,"dataSetList",void 0),Object(u["a"])([oa.State((function(e){return e.activeBlock}))],ia.prototype,"activeBlock",void 0),Object(u["a"])([oa.Mutation("UPDATE_ACTIVE_BLOCK")],ia.prototype,"updateActiveBlock",void 0),Object(u["a"])([Object(d["b"])("changeGrid")],ia.prototype,"changeGrid",null),Object(u["a"])([Object(d["c"])()],ia.prototype,"configForm",void 0),ia=Object(u["a"])([d["a"]],ia);var na=ia,ra=na,la=Object(U["a"])(ra,ta,aa,!1,null,"4bf84de5",null),ca=la.exports,sa=function(){var e=this,t=this,a=t.$createElement,o=t._self._c||a;return o("div",[o("el-form-item",{attrs:{label:"监控名称："}},[o("el-input",{attrs:{placeholder:"请输入"},on:{input:function(t){return e.handleInputFrom(t,"monitorName")}},model:{value:t.config.monitorName,callback:function(e){t.$set(t.config,"monitorName",e)},expression:"config.monitorName"}})],1),t.config.allCount?o("el-form-item",{attrs:{label:"监控分母："}},[o("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleInputFrom(t,"allCount")}},model:{value:t.config.allCount,callback:function(e){t.$set(t.config,"allCount",e)},expression:"config.allCount"}},t._l(t.config.options,(function(e){return o("el-option",{key:e.fieldCode,attrs:{label:e.fieldName,value:e.fieldCode}})})),1)],1):t._e(),t.config.completeCount?o("el-form-item",{attrs:{label:"监控分子："}},[o("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleInputFrom(t,"completeCount")}},model:{value:t.config.completeCount,callback:function(e){t.$set(t.config,"completeCount",e)},expression:"config.completeCount"}},t._l(t.config.options,(function(e){return o("el-option",{key:e.fieldCode,attrs:{label:e.fieldName,value:e.fieldCode}})})),1)],1):t._e(),o("el-form-item",{attrs:{label:"视图边框颜色："}},[o("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleInputFrom(t,"monitorColor")}},model:{value:t.config.monitorColor,callback:function(e){t.$set(t.config,"monitorColor",e)},expression:"config.monitorColor"}},t._l(t.borderColorList,(function(e){return o("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)},ua=[],da=Object(E["a"])("pageTemplate"),pa=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.borderColorList=[{code:"#409eff",name:"蓝色"},{code:"#db4242",name:"红色"},{code:"#606266",name:"灰色"}],e}return Object(l["a"])(a,[{key:"updateActiveFormItem",value:function(e){}},{key:"getRealContentById",value:function(e){}},{key:"changeGrid",value:function(){}},{key:"handleInputFrom",value:function(e,t){if("monitorName"===t||this.config.monitorName){this.config[t]=e;var a=Object($["cloneDeep"])(this.activeBlock);a.goods[t]=e,this.updateActiveFormItem(this.config),this.updateActiveBlock(a),this.changeGrid(),"monitorName"!==t&&this.getRealContentById(a)}else this.config[t]="",this.$message.error("请先输入当前节点监控名称")}},{key:"config",get:function(){return Object($["cloneDeep"])(this.configForm)}}]),a}(d["e"]);Object(u["a"])([Object(d["c"])()],pa.prototype,"configForm",void 0),Object(u["a"])([Object(d["b"])("activeFormItemChange")],pa.prototype,"updateActiveFormItem",null),Object(u["a"])([Object(d["b"])("getRealContentById")],pa.prototype,"getRealContentById",null),Object(u["a"])([Object(d["b"])("changeGrid")],pa.prototype,"changeGrid",null),Object(u["a"])([da.State((function(e){return e.activeBlock}))],pa.prototype,"activeBlock",void 0),Object(u["a"])([da.Mutation("UPDATE_ACTIVE_BLOCK")],pa.prototype,"updateActiveBlock",void 0),pa=Object(u["a"])([d["a"]],pa);var fa=pa,ha=fa,ga=Object(U["a"])(ha,sa,ua,!1,null,null,null),ma=ga.exports,ba=function(){var e=this,t=this,a=t.$createElement,o=t._self._c||a;return o("div",[o("el-form-item",{attrs:{label:"节点个数"}},[o("el-input",{attrs:{type:"number",min:0},on:{input:function(t){return e.handleStepChange(t,"stepCount")}},model:{value:t.config.stepCount,callback:function(e){t.$set(t.config,"stepCount",e)},expression:"config.stepCount"}})],1),o("el-form-item",{attrs:{label:"选择设置节点"}},[o("el-select",{key:t.index,attrs:{placeholder:"请选择"},on:{change:function(e){return t.handleStepChange(e,"currentStep")}},model:{value:t.config.currentStep,callback:function(e){t.$set(t.config,"currentStep",e)},expression:"config.currentStep"}},t._l(t.selectList,(function(e){return o("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1)],1),t.selectList.length&&t.config.currentStep?o("div",[o("el-form-item",{attrs:{label:"节点"+t.config.currentStep+"监控名称"}},[o("el-input",{key:t.index,attrs:{placeholder:"请输入"},on:{input:function(e){return t.handleStepChange(e,"monitorName",t.config.currentStep-1)}},model:{value:t.config.stepsList[t.config.currentStep-1]["monitorName"],callback:function(e){t.$set(t.config.stepsList[t.config.currentStep-1],"monitorName",e)},expression:"config.stepsList[config.currentStep - 1]['monitorName']"}})],1),o("el-form-item",{attrs:{label:"节点"+t.config.currentStep+"监控分子"}},[o("el-select",{key:t.index,attrs:{placeholder:"请选择"},on:{change:function(e){return t.handleStepChange(e,"completeCount",t.config.currentStep-1)}},model:{value:t.config.stepsList[t.config.currentStep-1].completeCount,callback:function(e){t.$set(t.config.stepsList[t.config.currentStep-1],"completeCount",e)},expression:"config.stepsList[config.currentStep - 1].completeCount"}},t._l(t.config.stepsList[t.config.currentStep-1].options,(function(e){return o("el-option",{key:e.fieldCode,attrs:{label:e.fieldName,value:e.fieldCode}})})),1)],1),o("el-form-item",{attrs:{label:"节点"+t.config.currentStep+"监控分母"}},[o("el-select",{key:t.index,attrs:{placeholder:"请选择"},on:{change:function(e){return t.handleStepChange(e,"allCount",t.config.currentStep-1)}},model:{value:t.config.stepsList[t.config.currentStep-1].allCount,callback:function(e){t.$set(t.config.stepsList[t.config.currentStep-1],"allCount",e)},expression:"config.stepsList[config.currentStep - 1].allCount"}},t._l(t.config.stepsList[t.config.currentStep-1].options,(function(e){return o("el-option",{key:e.fieldCode,attrs:{label:e.fieldName,value:e.fieldCode}})})),1)],1)],1):t._e()],1)},va=[],ya=Object(E["a"])("pageTemplate"),ka=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(r["a"])(this,a),t.apply(this,arguments)}return Object(l["a"])(a,[{key:"updateActiveFormItem",value:function(e){}},{key:"changeGrid",value:function(){}},{key:"getRealContentById",value:function(e){}},{key:"handleStepChange",value:function(e,t,a){var o=Object($["cloneDeep"])(this.activeBlock);if("stepCount"===t){this.config.stepCount=e;var i=0;if(this.config.stepsList&&(i=this.config.stepsList.length),e>i)for(i;i<parseInt(e);i++){var n={monitorName:"",completeCount:"",allCount:"",options:i>0?this.config.stepsList[i-1].options:"",dataSetId:i>0?this.config.stepsList[i-1].dataSetId:""};this.config.stepsList.push(n)}else for(e;e<i;i--)this.config.stepsList.pop(),this.config.currentStep="",o.goods.currentStep="";o.goods.stepsList=this.config.stepsList,o.goods.stepCount=e,o.goods["currentStep"]=this.config.stepsList.length}else if("currentStep"===t)this.config[t]=e,o.goods[t]=e;else{var r=this.config.stepsList[a];"monitorName"===t?(r[t]=e,o.goods["currentStep"]=a+1,this.$set(this.config.stepsList,a,r),this.$set(o.goods.stepsList,a,r)):r.monitorName?(r[t]=e,o.goods["queryName"]=r.monitorName,this.$set(this.config.stepsList,a,r),this.$set(o.goods.stepsList,a,r),this.getRealContentById(o)):(r[t]="",this.$message.error("请先输入当前节点监控名称"))}this.updateActiveBlock(o),this.updateActiveFormItem(this.config),this.changeGrid()}},{key:"config",get:function(){var e=this,t=Object($["cloneDeep"])(this.configForm);return t.stepsList&&t.stepsList.forEach((function(t){t.dataSetId&&(t.options=Object($["cloneDeep"])(Object(h["a"])(e.dataSetList,"id",t.dataSetId)).fields)})),t}},{key:"selectList",get:function(){var e=this.configForm.stepsList,t=[];return e.forEach((function(e,a){var o={id:a+1,label:"节点"+(a+1)};t.push(o)})),t}}]),a}(d["e"]);Object(u["a"])([Object(d["c"])()],ka.prototype,"configForm",void 0),Object(u["a"])([Object(d["b"])("activeFormItemChange")],ka.prototype,"updateActiveFormItem",null),Object(u["a"])([Object(d["b"])("changeGrid")],ka.prototype,"changeGrid",null),Object(u["a"])([Object(d["b"])("getRealContentById")],ka.prototype,"getRealContentById",null),Object(u["a"])([ya.State((function(e){return e.activeBlock}))],ka.prototype,"activeBlock",void 0),Object(u["a"])([ya.State((function(e){return e.dataSetList}))],ka.prototype,"dataSetList",void 0),Object(u["a"])([ya.Mutation("UPDATE_ACTIVE_BLOCK")],ka.prototype,"updateActiveBlock",void 0),ka=Object(u["a"])([d["a"]],ka);var Ca=ka,Oa=Ca,ja=Object(U["a"])(Oa,ba,va,!1,null,null,null),Ba=ja.exports,Sa=Object(E["a"])("pageTemplate"),xa=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.configForm={},e.selectedDataSet=null,e.selectedMonitorDataSet=null,e.timer={},e}return Object(l["a"])(a,[{key:"fieldDragStart",value:function(e){}},{key:"changeGrid",value:function(){}},{key:"getRealContentById",value:function(e){}},{key:"handleSideBarOpen",value:function(e){}},{key:"clickBlock",value:function(){this.currentBlock.goods.dataSetId?this.selectedDataSet=this.currentBlock.goods.dataSetId:this.selectedDataSet=null}},{key:"handleCurrentBlockChange",value:function(){if(!this.currentBlock.empty&&this.currentBlock.goods){if(this.configForm={blockName:this.currentBlock.goods.blockName||"",showBlockName:!!this.currentBlock.goods.showBlockName},this.currentBlock.goods.dataSetId){this.selectedDataSet=this.currentBlock.goods.dataSetId;var e=Object($["cloneDeep"])(Object(h["a"])(this.dataSetList,"id",this.currentBlock.goods.dataSetId));if(e&&e.fields)switch(this.currentBlock.goods.type){case"table":this.changeTableConfig();break;case"pie":this.changePieConfig(e);break;case"line":this.changeLineConfig(e);break;case"bar":this.changeBarConfig(e);break;default:break}}"singleForm"!==this.currentBlock.goods.type&&"doubleForm"!==this.currentBlock.goods.type||this.changeFormConfig(),"monitorChart"===this.currentBlock.goods.type&&this.changeMonitorConfig(),"monitorSteps"===this.currentBlock.goods.type&&this.changeMonitorStepsConfig()}else this.configForm={}}},{key:"handleActiveFormItem",value:function(){this.currentBlock&&this.currentBlock.goods&&this.changeFormConfig()}},{key:"getRelationChartOptions",value:function(e){var t=this.chartList.find((function(t){return t.value===e}));return t?t.options:[]}},{key:"handleBaseInfoChange",value:function(e,t){this.currentBlock.goods&&(this.$set(this.currentBlock.goods,e,t),console.log("123W",this.currentBlock),this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock)),this.changeGrid(),this.handleEditFlagChange(!0))}},{key:"changeTableConfig",value:function(){var e=this.currentBlock.goods.columns,t=Object($["cloneDeep"])(e);this.configForm={type:"table",blockName:this.currentBlock.goods.blockName||"",tableFields:t||[],showBlockName:!!this.currentBlock.goods.showBlockName}}},{key:"changePieConfig",value:function(e){var t=this.currentBlock.goods,a=t.blockName,o=t.pieType,i=t.label,n=t.value,r=t.showBlockName;this.configForm={type:"pie",blockName:a||"",pieType:o||"0",pieLabel:i,pieLabelOptions:e.fields,pieValue:n,pieValueOptions:e.fields,showBlockName:!!r}}},{key:"changeLineConfig",value:function(e){var t=this.currentBlock.goods,a=t.blockName,o=t.xaxis,i=t.yaxis,n=t.showBlockName,r=[];i&&(r=i.map((function(e){return e.code}))),this.configForm={type:"line",blockName:a||"",lineXaxis:o,lineXaxisOptions:e.fields,lineYaxis:r,lineYaxisOptions:e.fields,showBlockName:n}}},{key:"changeBarConfig",value:function(e){var t=this.currentBlock.goods,a=t.blockName,o=t.xaxis,i=t.yaxis,n=t.showBlockName,r=[];i&&(r=i.map((function(e){return e.code}))),this.configForm={type:"bar",blockName:a||"",barXaxis:o,barXaxisOptions:e.fields,barYaxis:r,barYaxisOptions:e.fields,showBlockName:n}}},{key:"changeFormConfig",value:function(){this.configForm=Object(n["a"])(Object(n["a"])({blockName:this.currentBlock.goods.blockName||""},this.activeFormItem),{},{showBlockName:!!this.currentBlock.goods.showBlockName})}},{key:"changeMonitorConfig",value:function(){var e=this.currentBlock.goods,t=e.monitorName,a=e.blockName,o=e.showBlockName,i=e.allCount,n=e.completeCount,r=e.monitorColor;this.configForm={type:"monitorChart",allCount:i||"",completeCount:n||"",monitorName:t||"",options:this.fieldsTree.length?this.fieldsTree[0].fields:[],showBlockName:o,blockName:a||"",monitorColor:r||"#409eff"},this.selectedMonitorDataSet=t||""}},{key:"changeMonitorStepsConfig",value:function(){var e=this.currentBlock.goods,t=e.stepsList,a=e.stepCount,o=e.blockName,i=e.showBlockName,n=e.dataSetId,r=e.currentStep;this.configForm={type:"monitorSteps",currentStep:r||"",stepsList:t||[],stepCount:a||0,blockName:o||"",showBlockName:i,dataSetId:n||""}}},{key:"handleParamsChange",value:function(e,t,a){var o=this;"valueBy"===e&&(a.value=a.defaultValue||""),"value"===e&&(clearTimeout(this.timer),this.timer=setTimeout((function(){o.getRealContentById(o.currentBlock)}),1e3)),this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock)),this.changeGrid()}},{key:"handleViweChange",value:function(e){this.currentBlock.goods&&"monitorChart"===this.currentBlock.goods.type&&(this.currentBlock.goods.dataSetId=e,this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock)),this.changeGrid()),this.currentBlock.goods&&"monitorSteps"===this.currentBlock.goods.type&&(this.currentBlock.goods.dataSetId=e,this.currentBlock.goods.stepCount?(this.currentBlock.goods.stepsList[this.currentBlock.goods.currentStep-1]["dataSetId"]=e,this.currentBlock.goods.stepsList[this.currentBlock.goods.currentStep-1]["completeCount"]="",this.currentBlock.goods.stepsList[this.currentBlock.goods.currentStep-1]["allCount"]="",this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock)),this.changeGrid()):(this.selectedDataSet=null,this.$message.error("请先在图表属性中设置节点个数")))}},{key:"currentBlock",get:function(){return Object($["cloneDeep"])(this.activeBlock)}},{key:"fieldsTree",get:function(){var e=Object($["cloneDeep"])(Object(h["a"])(this.dataSetList,"id",this.selectedDataSet));return e?[{id:this.selectedDataSet,name:e.name,fields:e.fields.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{},{name:e.fieldName})}))}]:[]}},{key:"queryParams",get:function(){return this.currentBlock.goods&&this.currentBlock.goods.queryParams||[]}},{key:"componentkey",get:function(){var e="";switch(this.configForm.type){case"table":e="TableConfig";break;case"pie":e="PieConfig";break;case"line":case"bar":e="BarAndLineConfig";break;case"singleForm":case"doubleForm":e="FormConfig";break;case"monitorChart":e="MonitorConfig";break;case"monitorSteps":e="MonitorStepsConfig";break;default:}return e}}]),a}(d["e"]);Object(u["a"])([Sa.State((function(e){return e.dataSetList}))],xa.prototype,"dataSetList",void 0),Object(u["a"])([Sa.State((function(e){return e.activeBlock}))],xa.prototype,"activeBlock",void 0),Object(u["a"])([Sa.Mutation("UPDATE_EDIT_FLAG")],xa.prototype,"handleEditFlagChange",void 0),Object(u["a"])([Sa.Mutation("UPDATE_ACTIVE_BLOCK")],xa.prototype,"updateActiveBlock",void 0),Object(u["a"])([Object(d["c"])({default:{}})],xa.prototype,"itemAttribute",void 0),Object(u["a"])([Object(d["c"])()],xa.prototype,"formAttribute",void 0),Object(u["a"])([Object(d["c"])()],xa.prototype,"dataSet",void 0),Object(u["a"])([Object(d["c"])()],xa.prototype,"viewDataSet",void 0),Object(u["a"])([Object(d["c"])()],xa.prototype,"optionLabel",void 0),Object(u["a"])([Object(d["c"])()],xa.prototype,"grid",void 0),Object(u["a"])([Object(d["b"])("fieldDragStart")],xa.prototype,"fieldDragStart",null),Object(u["a"])([Object(d["b"])("changeGrid")],xa.prototype,"changeGrid",null),Object(u["a"])([Object(d["b"])("getRealContentById")],xa.prototype,"getRealContentById",null),Object(u["a"])([Object(d["b"])("handleSideBarOpen")],xa.prototype,"handleSideBarOpen",null),Object(u["a"])([Object(d["f"])("clickRandom")],xa.prototype,"clickBlock",null),Object(u["a"])([Object(d["f"])("currentBlock")],xa.prototype,"handleCurrentBlockChange",null),Object(u["a"])([Object(d["f"])("activeFormItem")],xa.prototype,"handleActiveFormItem",null),Object(u["a"])([Object(d["c"])()],xa.prototype,"hidden",void 0),Object(u["a"])([Object(d["c"])()],xa.prototype,"clickRandom",void 0),Object(u["a"])([Object(d["c"])({default:{}})],xa.prototype,"activeFormItem",void 0),Object(u["a"])([Object(d["c"])()],xa.prototype,"formItemList",void 0),Object(u["a"])([Object(d["c"])()],xa.prototype,"chartList",void 0),Object(u["a"])([Object(d["c"])()],xa.prototype,"rightBarOpen",void 0),xa=Object(u["a"])([Object(d["a"])({components:{TableConfig:Rt,RightSet:$t["a"],PieConfig:Wt,BarAndLineConfig:ca,FormConfig:ea,MonitorConfig:ma,MonitorStepsConfig:Ba}})],xa);var wa=xa,Da=wa,Ta=(a("13f5"),a("3206"),Object(U["a"])(Da,xt,wt,!1,null,"f13f2ac4",null)),Fa=Ta.exports,Ia=Object(E["a"])("pageTemplate"),La=Object(E["a"])("taskLibraryManage"),Aa=null,_a=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.draggingType="",e.iconType="",e.allowType=null,e.grid=[],e.ROWS=3,e.COLUMNS=3,e.templateName="",e.leftBarOpen=!0,e.rightBarOpen=!0,e.loading=!1,e.draggingArea="",e.clickRandom=0,e.multipleData={},e.dragNodeData=null,e.activeFormItem={},e.draggingAreaType="",e.optionLabel=[],e.dataSet=[],e.viewDataSet=[],e.formAttribute={labelPosition:"right",labelSuffix:"：",labelWidth:"120",blockName:"内容块"+Math.random().toString(36).substring(2),showBlockName:!1,formList:[]},e.itemAttribute={sourceDataType:"",type:"",label:"",key:"",placeHolder:"",value:"",span:24,itemMultiple:!1,itemMultipleLimit:1,clearAble:!1,disabled:!1,required:!1,options:[],parameterList:[],performResult:"",cols:[],dataLabel:"",dataValue:"",dataSetVal:"",dataQueryList:[],colsList:[],associatedNodeList:[],alertType:"",centerFont:!1,description:"",showIcon:!1,editable:!1,readable:!1,recordable:!1,rules:[{required:!1,message:""}],bindValue:{dateValue:"",dateSpecify:"",systemDate:"",variableDate:"",selectDate:"",countDate:"",numDate:0,predestination:""},addLine:!1,addSetList:[],flowVisibleCode:"",dictFlagValue:1,defaultValue:null,remoteDataUrl:"",remoteDataLabel:"",remoteDataValue:"",showConfig:null,remoteDataType:"get",mutexSetList:[],origId:"",filterText:[]},e.previewDialogVisible=!1,e}return Object(l["a"])(a,[{key:"handleDragStart",value:function(e){this.draggingType="icon",this.draggingArea="draggingTooles",this.iconType=e.iconType,this.allowType=e.allowType}},{key:"getOperateButtons",value:function(){return[{label:"保存",icon:"el-icon-plus",className:"",click:this.saveTemplate},{label:"新增行",icon:"el-icon-plus",className:"",click:this.addRow},{label:"预览",icon:"el-icon-plus",className:"",click:this.previewTemplate},{label:"关闭",icon:"",className:"close",click:this.close}]}},{key:"addRow",value:function(){Aa.addRow(),this.refreshGrid(),this.ROWS++}},{key:"validateSaveTemplate",value:function(){var e=[];this.grid.map((function(t){t.empty||e.push(Object(n["a"])({},t.goods))}));for(var t=[],a=0,o=e.length;a<o;a++){if(!e[a].blockName)return"块标题不能为空";var i=e[a].queryParams&&e[a].queryParams.filter((function(e){return"0"===e.valueBy}))||[];i.map((function(e){0!==e.required||e.value||t.push(e.name)}))}return!!t.length&&"请检查视图参数设置：".concat(t.join("、"),"为必填参数")}},{key:"saveTemplate",value:function(){for(var e=Object($["cloneDeep"])(this.grid),t=[],a=0;a<e.length;a++){e[a].goods&&"doubleForm"===e[a].goods.type&&(e[a].goods.blockName=e[a].goods.formAttribute.blockName);var o=Object(n["a"])({blockId:"".concat((new Date).getTime()).concat(Math.floor(900*Math.random())+100)},e[a].goods);o.queryParams&&o.queryParams.length&&o.queryParams.forEach((function(e){"0"!==e.valueBy&&(e.value=null)})),t.push(o),e[a].goods=o.blockId}var i=this.validateSaveTemplate();if(i)this.$message.warning(i);else{var r={blocks:t,style:et["a"].encode(JSON.stringify(e))};this.updateTaskForm(r),this.$router.push({path:"/taskConfigCenter/addTasks",query:Object(n["a"])(Object(n["a"])({},this.$route.query),{},{isBack:"true"})})}}},{key:"previewTemplate",value:function(){var e=this;this.previewDialogVisible=!0,this.$nextTick((function(){e.$refs.previewTemplate.initPreviewTemplate()}))}},{key:"close",value:function(){var e=this;this.editFlag?this.$confirm("操作没有保存，确定要离开吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$router.push({path:"/taskConfigCenter/addTasks",query:Object(n["a"])(Object(n["a"])({},e.$route.query),{},{isBack:"true"})})})).catch((function(){})):this.$router.push({path:"/taskConfigCenter/addTasks",query:Object(n["a"])(Object(n["a"])({},this.$route.query),{},{isBack:"true"})})}},{key:"switchActiveBlock",value:function(e,t){console.log("block",e),e&&e.goods&&e.goods.formAttribute&&(this.formAttribute=e.goods.formAttribute),this.updateActiveBlock(Object($["cloneDeep"])(e)),"click"===t&&e.goods&&e.goods.dataSetId&&(this.clickRandom=Math.random())}},{key:"handleOriginEnter",value:function(e,t){if(e.preventDefault(),"block"===this.draggingType){var a=Aa.checkDragAllow(t);a&&(t.canDrop=a)}else if("icon"===this.draggingType)if(1===this.allowType)t.goods&&t.goods.type&&("singleForm"===t.goods.type||"doubleForm"===t.goods.type)?t.canDrop=1:t.canDrop=2;else{var o=Aa.checkIconDrag(t);t.canDrop=o}}},{key:"handleOriginLeave",value:function(e){e.canDrop=0}},{key:"handleOriginStart",value:function(e){this.draggingType="block",Aa.setDraggingBlock(e)}},{key:"handleSomethingDrop",value:function(e){var t=this;if("block"===this.draggingType)1===Aa.checkDragAllow(e)&&(Aa.moving(e),this.refreshGrid());else if("icon"===this.draggingType)if(0===this.allowType){if(e.empty){if(e.empty=!1,e.goods={type:this.iconType,blockName:"内容块"+Math.random().toString(36).substring(2),showBlockName:!1},"singleForm"===this.iconType||"doubleForm"===this.iconType){var a={labelPosition:"right",labelSuffix:":",labelWidth:"120",blockName:"内容块"+Math.random().toString(36).substring(2),showBlockName:!1,formList:[]};e.empty=!0,this.formAttribute=a,this.$set(e.goods,"formAttribute",a)}"monitorChart"===this.iconType&&(e.goods.monitorColor="#409eff"),Aa.setDraggingBlockContent(e),this.refreshGrid()}}else"draggingTooles"===this.draggingArea&&this.generateFormItem("single",24,"",e);else if("dataSet"===this.draggingType){if(!e.goods||!e.goods.type)return void this.$message.warning("请先从左侧工具栏拖入页面元素");var o=this.dragNodeData,i=o.isLeaf?o.parent.data.id:o.data.id;if("table"===e.goods.type)this.drawCanvas(e,i,o);else if("singleForm"===e.goods.type||"doubleForm"===e.goods.type){var n=[];o.data.fields.forEach((function(e){var t={label:e.name,value:e.fieldCode};n.push(t)})),e.goods.formAttribute.formList.forEach((function(e){e.key===t.activeFormItem.key&&(t.$set(e,"dataSetId",i),t.$set(e,"options",n))}))}}e.canDrop=0,this.switchActiveBlock(e)}},{key:"clickActiveItem",value:function(e){if(console.log("item",e),this.itemAttribute=e,this.itemAttribute.filterText instanceof Array||this.$set(this.itemAttribute,"filterText",[]),this.optionLabel=Object(h["a"])(this.dataSet,"id",e.dataSetVal)?Object(h["a"])(this.dataSet,"id",e.dataSetVal)["fields"]:[],this.optionLabel.length>0){var t=Object($["cloneDeep"])(this.optionLabel);"select"===this.itemAttribute.type&&(this.itemAttribute.cols=t.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{},{prop:e.fieldCode,label:e.fieldName})})))}this.stopBubble("sourceDataType")}},{key:"stopBubble",value:function(e){if(e&&e.stopPropagation)e.stopPropagation();else{var t=window.event;null!==t&&(t.cancelBubble=!0)}}},{key:"draggingAreaChange",value:function(e){this.draggingArea=e}},{key:"draggingAreaTypeChange",value:function(e){this.draggingAreaType=e}},{key:"generateFormItem",value:function(e,t,a,o){if(o.goods&&o.goods.type&&("singleForm"===o.goods.type||"doubleForm"===o.goods.type)){var i={},n="yejijizhunchae";i={sourceDataType:"static",type:this.iconType,key:n,placeHolder:"请输入",value:"",span:t,editable:!1,readable:!1,recordable:!1,clearAble:!0,disabled:!1,required:!1,rules:[{required:!1,message:""}],dataQueryList:[],colsList:[],performResult:"",parameterList:[],substanceText:"",addSetList:[],mutexSetList:[],origId:"",bindValue:{},addLine:!1,remoteDataUrl:"",remoteDataLabel:"",remoteDataValue:"",remoteDataType:"get",filterText:[]},"text"===this.iconType?(i.label="单行文本",i.sourceDataType="dataView"):"number"===this.iconType?(i.label="数字",i.placeHolder="请输入数字",i.sourceDataType="dataView"):"textarea"===this.iconType?(i.label="多行文本",i.sourceDataType="dataView"):"table"===this.iconType?(i.label="表格",i.cols=[],i.value=[],i.datas=[],i.associatedNodeList=[],i.sourceDataType="dataView",i.dictFlagValue=1):"date"===this.iconType?(i.label="日期",i.bindValue={dateValue:"",dateSpecify:"",systemDate:"",variableDate:"",selectDate:"",countDate:"",numDate:0,predestination:""},i.sourceDataType="dataView"):"select"===this.iconType?(i.label="下拉选择器",i.value=[],i.options=[],i.itemMultiple=!1,i.itemMultipleLimit=1,i.associatedNodeList=[]):"cascader"===this.iconType?(i.label="级联选择器",i.options=[],i.value=[],i.associatedNodeList=[]):"radioGroup"===this.iconType?(i.label="单选框组",i.associatedNodeList=[],i.options=[]):"checkboxGroup"===this.iconType?(i.label="多选框组",i.options=[],i.value=[],i.associatedNodeList=[]):"inputNumber"===this.iconType?(i.label="计数器",i.bindValue={countDate:"",numDate:""}):"switch"===this.iconType?(i.label="开关",i.value=!1):"ueditor"===this.iconType?i.label="富文本编辑器":"upload"===this.iconType?(i.label="上传",i.btnProp={buttonText:"文件上传"},i.value=[]):"alert"===this.iconType?(i.label="提示卡",i.value="",i.alertType="success",i.description="",i.centerFont=!1,i.showIcon=!0):"hidden"===this.iconType?(i.label="隐藏项",i.value=""):"button"===this.iconType?(i.label="按钮",i.value="确定",i.btnProp={buttonText:"确定"}):"time"===this.iconType&&(i.label="时间",i.value=""),"single"===e&&this.formAttribute.formList.push(i),this.draggingType="",i.key&&""!==i.key&&(this.itemAttribute=i);var r=[];this.formAttribute.formList.forEach((function(e){if(e.key===i.key&&r.push(e),r.length>1){var t=Math.floor(90*Math.random())+10;i.key=at.a.convertToPinyinString(i.label,"",at.a.WITHOUT_TONE).concat(t.toString())}else i.key=at.a.convertToPinyinString(i.label,"",at.a.WITHOUT_TONE)})),o.goods.formAttribute=this.formAttribute,Aa.setDraggingBlockContent(o),this.refreshGrid()}else this.$message.warning("请将表单元素拖入到表单内")}},{key:"getDataSet",value:function(){var e=this;Object(I["e"])({}).then((function(t){var a=t.data,o=t.error;a?(e.dataSet=a,e.viewDataSet=a):e.$message.error(o.message)}))}},{key:"handleChartFieldsDrop",value:function(e,t){if("dataSet"===this.draggingType){var a=this.dragNodeData,o="";a.isLeaf?(o=a.parent.data.id,a.data.attrFlag=t):(o=a.data.id,this.$message.error("请拖入单一字段")),this.drawCanvas(e,o,a)}this.switchActiveBlock(e)}},{key:"drawCanvas",value:function(e,t,a){if(e.goods.dataSetId){if(t!==e.goods.dataSetId)return void this.$message.warning("字段必须来自同一个数据集！")}else e.goods.dataSetId=t;var o=Object($["cloneDeep"])(Object(h["a"])(this.dataSetList,"id",t)),i=o.queryParams?o.queryParams.filter((function(e){return 3!==e.required})):[];e.goods.queryParams=i.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{},{valueBy:"0",value:e.defaultValue||null,relationFormItem:"",relationChart:"",relationChartField:""})})),Ue(a,e),this.getRealContentById(e),Aa.setDraggingBlockContent(e),this.refreshGrid()}},{key:"getRealContentById",value:function(e){var t=this;if(e.goods&&"monitorSteps"!==e.goods.type){if(!e.goods||!e.goods.dataSetId)return;var a={viewId:e.goods.dataSetId},o=[];if("monitorChart"!==e.goods.type)for(var i=0,n=e.goods.queryParams.length;i<n;i++){var r=e.goods.queryParams[i];if(0===r.required&&!r.value)return void this.$message.warning("".concat(e.goods.blockName,"中数据源必选参数为空！"));o.push({code:r.code,type:r.type,value:r.value})}else e.goods.queryParams&&e.goods.queryParams.forEach((function(t){"monitorName"===t.code&&(t.value=e.goods.monitorName),o.push({code:t.code,type:t.type,value:t.value})}));a.queryParams=o,Object(I["f"])(a).then((function(a){var o=a.data,i=a.error;if(i)t.$message.error(i.message||"获取数据失败");else if("table"===e.goods.type&&o.rows.forEach((function(e){e.isEdit=!0})),"monitorSteps"===e.goods.type){var n=Object($["cloneDeep"])(t.multipleData);t.multipleData[e.id]?(n[e.id][e.goods.currentStep]=o.rows,t.multipleData=n):(n[e.id]=[],n[e.id][e.goods.currentStep]=o.rows,t.multipleData=n)}else t.$set(t.multipleData,e.id,o.rows)}))}else{var l=e.goods.stepsList;l.forEach((function(a,o){if(a.dataSetId){var i={viewId:a.dataSetId},n=[];e.goods.queryParams&&e.goods.queryParams.forEach((function(t){"monitorName"===t.code&&(t.value=e.goods.queryName),n.push({code:t.code,type:t.type,value:t.value})})),i.queryParams=n,Object(I["f"])(i).then((function(a){var i=a.data,n=a.error;if(n)t.$message.error(n.message||"获取数据失败");else{var r=Object($["cloneDeep"])(t.multipleData);t.multipleData[e.id]?(r[e.id][o]=i.rows,t.multipleData=r):(r[e.id]=[],r[e.id][o]=i.rows,t.multipleData=r)}}))}}))}}},{key:"emptyContent",value:function(e){var t=this;console.log(e),this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){(e.goods&&"singleForm"===e.goods.type||e.goods&&"doubleForm"===e.goods.type)&&e.goods.formAttribute&&e.goods.formAttribute.formList&&(e.goods.formAttribute.formList=[]),t.$set(t.multipleData,e.id,[]),t.updateActiveBlock({}),Aa.emptyBlock(e),t.refreshGrid()})).catch((function(){}))}},{key:"handleExtendWidth",value:function(e,t){Aa.blockWidthExtend(e,t);var a=this.$refs;for(var o in a)a[o].length>0&&a[o][0].resizeChart();this.refreshGrid()}},{key:"handleExtendHeight",value:function(e,t){Aa.blockHeightExtend(e,t);var a=this.$refs;for(var o in a)a[o].length>0&&a[o][0].resizeChart();this.refreshGrid()}},{key:"handleShortenWidth",value:function(e,t){Aa.blockWidthShorten(e,t);var a=this.$refs;for(var o in a)a[o].length>0&&a[o][0].resizeChart();this.refreshGrid()}},{key:"handleShortenHeight",value:function(e,t){Aa.blockHeightShorten(e,t);var a=this.$refs;for(var o in a)a[o].length>0&&a[o][0].resizeChart();this.refreshGrid()}},{key:"handleSideBarOpen",value:function(e){"left"===e?this.leftBarOpen=!this.leftBarOpen:this.rightBarOpen=!this.rightBarOpen;var t=this.$refs;for(var a in t)t[a].length>0&&t[a][0].resizeChart()}},{key:"fieldDragStart",value:function(e){this.draggingType="dataSet",this.dragNodeData=e.node}},{key:"applyTemplate",value:function(e){var t=Object($["cloneDeep"])(e);this.ROWS=Je(t),Aa=new F(t),this.refreshGrid()}},{key:"initGrid",value:function(){Aa=new F,this.refreshGrid(!0)}},{key:"refreshGrid",value:function(e){this.grid=Aa.getGrid(),e||this.handleEditFlagChange(!0)}},{key:"changeGrid",value:function(){for(var e=0,t=this.grid.length;e<t;e++){var a=this.grid[e];a.id===this.currentBlock.id&&(a.empty||(a.goods=this.currentBlock.goods))}Aa=new F(this.grid),this.refreshGrid()}},{key:"setFormItem",value:function(e,t){if(t.goods&&t.goods.type&&("singleForm"===t.goods.type||"doubleForm"===t.goods.type)){var a={type:t.goods.type,formItemType:e,key:Math.random().toString(36).substring(2),span:"singleForm"===t.goods.type?24:12},o=["text","textarea"].indexOf(e)>-1?"请输入":"请选择",i=[{value:Math.random().toString(36).substring(2),label:"选项1"},{value:Math.random().toString(36).substring(2),label:"选项2"},{value:Math.random().toString(36).substring(2),label:"选项3"}];switch(e){case"text":a.label="单行文本",a.placeholder=o,a.value="";break;case"textarea":a.label="多行文本",a.placeholder=o,a.value="";break;case"select":a.label="下拉框",a.placeholder=o,a.value="",a.multiple=!1,a.options=i;break;case"date":a.label="日期",a.placeholder=o,a.value="";break;case"time":a.label="时间",a.placeholder=o,a.value="";break;case"radioGroup":a.label="单选框组",a.value="",a.options=i;break;case"checkboxGroup":a.label="复选框组",a.value=[],a.options=i;break;case"upload":a.btnProp={buttonText:"文件上传"},a.iconProps={iconClass:"upload-icon"};break;case"button":a.btnProp={buttonText:"确定"};break;default:}a.formItemType&&(this.activeFormItem=a,t.goods.formAttribute.formList.push(a)),Aa.setDraggingBlockContent(t),this.refreshGrid()}else this.$message.warning("请将表单元素拖入到表单内")}},{key:"activeFormItemChange",value:function(e){var t=this;if(this.activeFormItem=e,this.currentBlock.goods&&this.currentBlock.goods.formAttribute){var a=this.currentBlock.goods.formAttribute.formList;a.forEach((function(a,o,i){a.key===e.key&&t.$set(i,o,e)}))}this.updateActiveBlock(Object($["cloneDeep"])(this.currentBlock))}},{key:"displayTemplateDetail",value:function(){var e=this.taskForm;if("{}"!==JSON.stringify(e)){this.loading=!0;for(var t=JSON.parse(et["a"].decode(e.style)),a=e.blocks,o=0;o<t.length;o++){var i=t[o],n=Object(h["a"])(a,"blockId",i.goods);i.empty?i.goods={}:(this.switchBlock(n,i),this.getRealContentById(i))}this.grid=Object($["cloneDeep"])(t),this.ROWS=Je(t),Aa=new F(t),this.refreshGrid(!0),this.loading=!1}}},{key:"switchBlock",value:function(e,t){if(t.goods={blockName:e.blockName,showBlockName:e.showBlockName||!1,queryParams:e.queryParams||[],relationQuery:e.relationQuery||[]},e.dataSetId){t.goods.dataSetId=e.dataSetId;var a=Object($["cloneDeep"])(Object(h["a"])(this.dataSetList,"id",e.dataSetId));if(a&&a.fields){var o=a.fields;if("table"===e.type)t.goods.type="table",e.columns.forEach((function(e){var a=Object(h["a"])(o,"fieldCode",e.fieldCode);a&&(a.align=e.align,a.format=e.format,a.canSet=e.canSet,Ue(a,t))}));else if("pie"===e.type){t.goods.type="pie";var i=Object(h["a"])(o,"fieldCode",e.label);i&&(i.attrFlag="pieLabel",i.pieType=e.pieType,Ue(i,t));var n=Object(h["a"])(o,"fieldCode",e.value);n&&(n.attrFlag="pieValue",n.pieType=e.pieType,Ue(n,t))}else if("line"===e.type){t.goods.type="line";var r=Object(h["a"])(o,"fieldCode",e.xaxis);r&&(r.attrFlag="xaxis",Ue(r,t)),e.yaxis.forEach((function(e){var a=Object(h["a"])(o,"fieldCode",e.code);a&&(a.attrFlag="yaxis",Ue(a,t))}))}else if("bar"===e.type){t.goods.type="bar";var l=Object(h["a"])(o,"fieldCode",e.xaxis);l&&(l.attrFlag="xaxis",Ue(l,t)),e.yaxis.forEach((function(e){var a=Object(h["a"])(o,"fieldCode",e.code);a&&(a.attrFlag="yaxis",Ue(a,t))}))}else"monitorSteps"===e.type?(t.goods.type="monitorSteps",t.goods.stepCount=e.stepCount,t.goods.stepsList=e.stepsList):"monitorChart"===e.type&&(t.goods.type="monitorChart",t.goods.allCount=e.allCount,t.goods.completeCount=e.completeCount,t.goods.monitorColor=e.monitorColor,t.goods.monitorName=e.monitorName)}}e.formAttribute&&(t.goods.formAttribute=e.formAttribute,this.formAttribute=e.formAttribute,t.goods.type=e.type)}},{key:"handleMonitorDrop",value:function(e,t){if(e.goods.monitorName){if("dataSet"===this.draggingType){var a=this.dragNodeData,o="";a.isLeaf?(o=a.parent.data.id,a.data.attrFlag=t):(o=a.data.id,this.$message.error("请拖入单一字段")),this.drawCanvas(e,o,a)}}else this.$message.error("请先在图表属性中配置监控名称");this.switchActiveBlock(e)}},{key:"queryRelationDataset",value:function(e){var t=this;this.grid.forEach((function(a){if(a.goods&&a.goods.queryParams){var o=!1;a.goods.queryParams.forEach((function(a){if("chart"===e.type&&"3"===a.valueBy&&a.relationChart===e.relationBlock&&(o=!0,t.$set(a,"value",e[a.relationChartField])),"formItem"===e.type&&"2"===a.valueBy)for(var i=0,n=e.formItems.length;i<n;i++){var r=e.formItems[i];if(a.relationFormItem===r.formItemKey){o=!0,t.$set(a,"value",r.formItemValue);break}}})),o&&t.getRealContentById(a)}}))}},{key:"getDataByCard",value:function(e){var t=this;this.grid.forEach((function(a){if(a.goods&&"table"===a.goods.type&&a.goods.dataSetId){var o=a.goods.queryParams.filter((function(e){return"监控名称"===e.name}))[0],i={viewId:a.goods.dataSetId,queryParams:o?[{code:o.code,type:o.type,value:e.monitorName}]:[]};Object(I["f"])(i).then((function(e){var o=e.data,i=e.error;i?t.$message.error(i.message||"获取数据失败"):(o.rows.forEach((function(e){e.isEdit=!0})),t.$set(t.multipleData,a.id,o.rows))}))}}))}},{key:"created",value:function(){var e=this;this.initGrid(),this.getDataSet(),this.loading=!!this.$route.query.id,this.getDataSets().then((function(){e.displayTemplateDetail()})),this.getLayoutTemplateList()}},{key:"currentBlock",get:function(){return Object($["cloneDeep"])(this.activeBlock)}},{key:"formItemList",get:function(){var e=[];return this.grid.map((function(t){if(t&&t.goods&&t.goods.formAttribute){var a=t.goods.formAttribute.formList;a.map((function(t){"button"!==t.formItemType&&"upload"!==t.formItemType&&e.push(JSON.parse(JSON.stringify(t)))}))}})),e}},{key:"beRelatedFromItemList",get:function(){var e=[];return this.grid.map((function(t){if(t&&t.goods&&t.goods.queryParams){var a=t.goods.queryParams.filter((function(e){return"2"===e.valueBy}));a.map((function(t){-1===e.indexOf(t.relationFormItem)&&e.push(t.relationFormItem)}))}})),e}},{key:"chartList",get:function(){var e=[];return this.grid.map((function(t){if(t&&t.goods&&t.goods.blockName){var a={value:t.id,label:t.goods.blockName};switch(t.goods.type){case"pie":a.options=[{value:"label",label:"label"},{value:"value",label:"value"}];break;case"bar":case"line":a.options=[{value:"x",label:"x轴"},{value:"y",label:"y轴"}];break;case"table":a.options=[{value:"cell",label:"单元格"}];break;default:}e.push(a)}})),e}}]),a}(d["e"]);Object(u["a"])([Ia.State((function(e){return e.layoutList}))],_a.prototype,"layoutList",void 0),Object(u["a"])([Ia.State((function(e){return e.dataSetList}))],_a.prototype,"dataSetList",void 0),Object(u["a"])([Ia.State((function(e){return e.activeBlock}))],_a.prototype,"activeBlock",void 0),Object(u["a"])([Ia.State((function(e){return e.editFlag}))],_a.prototype,"editFlag",void 0),Object(u["a"])([Ia.Action("getLayoutTemplateList")],_a.prototype,"getLayoutTemplateList",void 0),Object(u["a"])([Ia.Action("getDataSet")],_a.prototype,"getDataSets",void 0),Object(u["a"])([Ia.Mutation("UPDATE_ACTIVE_BLOCK")],_a.prototype,"updateActiveBlock",void 0),Object(u["a"])([Ia.Mutation("UPDATE_EDIT_FLAG")],_a.prototype,"handleEditFlagChange",void 0),Object(u["a"])([La.State((function(e){return e.taskForm}))],_a.prototype,"taskForm",void 0),Object(u["a"])([La.Mutation("UPDATETASKFORM")],_a.prototype,"updateTaskForm",void 0),Object(u["a"])([La.State("taskLib")],_a.prototype,"taskLib",void 0),_a=Object(u["a"])([Object(d["a"])({components:{TemplateBlock:Ve,formDisplay:L["a"],PreviewTemplate:st,dataViewFields:I["e"],LayoutTemplate:bt,LeftToolbar:St,RightToolbar:Fa}})],_a);var Ea=_a,Na=Ea,Ra=(a("b2be"),a("8ae2"),Object(U["a"])(Na,o,i,!1,null,"26d413f8",null));t["default"]=Ra.exports},b2be:function(e,t,a){"use strict";var o=a("fc4f"),i=a.n(o);i.a},bb23:function(e,t,a){"use strict";var o=a("7728"),i=a.n(o);i.a},bbad7:function(e,t,a){"use strict";var o=a("7522"),i=a.n(o);i.a},cce6:function(e,t,a){"use strict";var o=a("0c45"),i=a.n(o);i.a},d09a:function(e,t,a){},d58f:function(e,t,a){var o=a("1c0b"),i=a("7b0b"),n=a("44ad"),r=a("50c4"),l=function(e){return function(t,a,l,c){o(a);var s=i(t),u=n(s),d=r(s.length),p=e?d-1:0,f=e?-1:1;if(l<2)while(1){if(p in u){c=u[p],p+=f;break}if(p+=f,e?p<0:d<=p)throw TypeError("Reduce of empty array with no initial value")}for(;e?p>=0:d>p;p+=f)p in u&&(c=a(c,u[p],p,s));return c}};e.exports={left:l(!1),right:l(!0)}},e3b7:function(e,t,a){},e90e:function(e,t,a){},f2a5:function(e,t,a){"use strict";var o=a("34b6"),i=a.n(o);i.a},f362:function(e,t,a){},f9a2:function(e,t,a){e.exports=a.p+"assets/img/left-close.4d6c78e9.png"},fc4f:function(e,t,a){}}]);
//# sourceMappingURL=chunk-c8107728.3320fae2.js.map