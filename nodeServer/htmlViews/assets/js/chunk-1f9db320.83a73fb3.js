(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f9db320"],{"0993":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"formControl"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("div",{staticClass:"left-main"},[r("simple-card",{staticClass:"hgieht-control",attrs:{title:"节点选择"}},[r("Tabs",{attrs:{"tab-list":e.userTaskList,"tab-active":e.activeName,"tab-position":"left"},on:{tabClick:e.handleClick}})],1)],1)]),r("el-col",{attrs:{span:6}},[r("div",{staticClass:"left-main"},[r("simple-card",{attrs:{title:"表单项控制"}},[r("base-table",{attrs:{tableKey:e.activeName,"row-key":"formItem",height:"360","tree-props":{children:"extendProp"},"data-source":e.tableFormList,columns:e.tableColumns(),"show-summary":!1,"border-style":!0}})],1)],1)]),r("el-col",{attrs:{span:14}},[r("simple-card",{attrs:{title:"表单预览",actions:e.formEditAction()}},[r("div",{staticClass:"formControl-right"},[r("previewForm",{attrs:{formAttribute:e.customList,mode:"preview"}})],1)])],1)],1)],1)},o=[],n=(r("7db0"),r("4160"),r("d81d"),r("b64b"),r("159b"),r("2909")),i=r("d4ec"),s=r("bee2"),c=r("262e"),d=r("2caf"),l=r("9ab4"),u=r("60a3"),f=r("5764"),m=r("4bb5"),p=r("d547"),b=r("ed5d"),h=r("2ef0"),v=r("fa38"),y=Object(m["a"])("processTemplate"),I=function(e){Object(c["a"])(r,e);var t=Object(d["a"])(r);function r(){var e;return Object(i["a"])(this,r),e=t.apply(this,arguments),e.tableFormList=[],e.listFrom={},e.activeName="",e.customList={},e}return Object(s["a"])(r,[{key:"initFormsByNodes",value:function(){this.init()}},{key:"formEditAction",value:function(){return[{title:"编辑表单",onClick:this.setFormItem}]}},{key:"tableColumns",value:function(){var e=this;return[{prop:"nodeName",label:"表单项",align:"center",showOverflowTooltip:!0,"min-width":"100"},{prop:"editable",label:"可修改",align:"center",showOverflowTooltip:!0,"min-width":"100",render:function(t,r){var a=r.record;return t("el-checkbox",{props:{value:a.editable,"true-label":1,"false-label":0},on:{change:function(t){a.editable=t,e.selectionChange(a,"editable")}}})}},{prop:"readable",label:"只读",align:"center",showOverflowTooltip:!0,"min-width":"100",render:function(t,r){var a=r.record;return t("el-checkbox",{props:{value:a.readable,"true-label":1,"false-label":0},on:{change:function(t){a.readable=t,e.selectionChange(a,"readable")}}})}}]}},{key:"init",value:function(){var e=this;if(this.userTaskList.length>0){var t={},r="";if(this.userTaskList.forEach((function(e){r||(r=e.id),t[e.id]=[]})),this.activeName=r,"edit"===this.currentStatus)this.editFromList(r);else{var a=[];this.form.length>0?(this.form.forEach((function(r){e.formAttribute.formList.forEach((function(a){if(t[r.nodeId]&&r.formItem===a.key)if("table"===a.type&&r.extendProp){var o=[];a.cols.forEach((function(e){r.extendProp.forEach((function(t){t.formItem===e.prop&&o.push(t)}));var t=o.find((function(t){return t.formItem===e.prop}));void 0===t&&o.push({editable:0,formItem:e["prop"],nodeName:e["label"],readable:0,nodeId:r.nodeId})})),e.$set(r,"extendProp",o),t[r.nodeId].push(r)}else{var n=t[r.nodeId].find((function(e){return e.formItem===a.key}));void 0===n&&t[r.nodeId].push(r)}}))})),Object.keys(t).forEach((function(e){var a=t[e];a&&(0===a.length&&t[r].length>0&&(a=t[r].map((function(t){if(Object.prototype.hasOwnProperty.call(t,"extendProp")){var r=[];return t.extendProp.forEach((function(t){r.push({formItem:t["formItem"],nodeName:t["nodeName"],readable:0,editable:0,nodeId:e})})),{formItem:t["formItem"],nodeName:t["nodeName"],readable:0,editable:0,nodeId:e,extendProp:r}}return{formItem:t["formItem"],nodeName:t["nodeName"],readable:0,editable:0,nodeId:e}}))),t[e]=a)})),a=Object(h["differenceWith"])(this.formAttribute.formList,t[r],(function(e,t){return e["key"]===t["formItem"]}))):a=this.formAttribute.formList,Object.keys(t).forEach((function(e){var r,o=t[e];a.length>0&&(o=t[e],(r=o).push.apply(r,Object(n["a"])(a.map((function(t){if("table"===t.type){var r=[];return t.extendProp&&t.extendProp.forEach((function(t){r.push({editable:0,formItem:t["prop"],nodeName:t["label"],readable:0,nodeId:e})})),{editable:0,formItem:t["key"],nodeName:t["label"],readable:0,nodeId:e,extendProp:r}}return{editable:0,formItem:t["key"],nodeName:t["label"],readable:0,nodeId:e}})))))})),this.listFrom=t,this.tableFormList=this.listFrom[r],this.updateForm(),this.refreshPreview()}}}},{key:"updateForm",value:function(){var e=this,t=[];Object.keys(this.listFrom).forEach((function(r){t.push.apply(t,Object(n["a"])(e.listFrom[r]))})),this.customList=Object(h["cloneDeep"])(this.formAttribute),this.$store.dispatch("processTemplate/updateForm",t)}},{key:"refreshPreview",value:function(){var e=this;this.tableFormList&&this.tableFormList.forEach((function(t){e.selectionChange(t,"")}))}},{key:"editFromList",value:function(e){var t=this;this.tableFormList=[];var r={nodeId:e,tempId:this.$store.state.processTemplate.currentTempId};Object(v["g"])(r).then((function(r){var a=r.data,o=r.error;if(o)return t.$message.error(o.message),!1;var n=[];t.formAttribute.formList.forEach((function(r){a.length>0&&a.forEach((function(a){if(a.formItem===r.key){if(r.editable=a.editable,r.readable=a.readable,a.extendProp&&"table"===r.type){a.extendProp=JSON.parse(b["a"].decode(a.extendProp));var o=[];r.cols.forEach((function(t){a.extendProp.forEach((function(e){e.formItem===t.prop&&o.push(e)}));var r=o.find((function(e){return e.formItem===t.prop}));void 0===r&&t["prop"]&&o.push({editable:0,formItem:t["prop"],nodeName:t["label"],readable:0,nodeId:e})})),t.$set(a,"extendProp",o)}n.push(a)}}));var o=n.find((function(e){return e.formItem===r.key}));if(void 0===o)if("table"===r.type){var i=[];r.cols.forEach((function(t){t["prop"]&&i.push({editable:0,formItem:t["prop"],nodeName:t["label"],readable:0,nodeId:e})})),n.push({formItem:r["key"],nodeName:r["label"],readable:0,editable:0,nodeId:e,extendProp:i})}else n.push({formItem:r["key"],nodeName:r["label"],readable:0,editable:0,nodeId:e})})),t.tableFormList=n,t.customList=Object(h["cloneDeep"])(t.formAttribute),t.$store.dispatch("processTemplate/updateTableFormList",t.tableFormList),t.$store.dispatch("processTemplate/updateSelectChange",!1)}))}},{key:"handleClick",value:function(e){this.activeName=e,"edit"===this.currentStatus?(!0===this.$store.state.processTemplate.selectChange&&this.saveFormChange(),this.editFromList(e)):(this.tableFormList=this.listFrom[e],this.refreshPreview())}},{key:"selectionChange",value:function(e,t){this.$store.dispatch("processTemplate/updateSelectChange",!0);var r=Object(p["b"])(this.formAttribute.formList,"key",e.formItem);"editable"===t?1===e.editable&&(e.readable=0):"readable"===t&&1===e.readable&&(e.editable=0),r&&(r.editable=e.editable,r.readable=e.readable,Object.prototype.hasOwnProperty.call(e,"extendProp")&&e.extendProp&&e.extendProp instanceof Array&&e.extendProp.forEach((function(t){t.editable=e.editable,t.readable=e.readable}))),this.updateForm()}},{key:"setFormItem",value:function(){"edit"===this.currentStatus&&!0===this.$store.state.processTemplate.selectChange&&this.saveFormChange(),this.$router.push({name:"customForm",query:{id:this.$route.query.id,flag:this.$route.query.flag}})}},{key:"created",value:function(){this.init()}}]),r}(u["e"]);Object(l["a"])([y.State((function(e){return e.userTaskList}))],I.prototype,"userTaskList",void 0),Object(l["a"])([y.State((function(e){return e.form}))],I.prototype,"form",void 0),Object(l["a"])([y.State((function(e){return e.customForm}))],I.prototype,"formAttribute",void 0),Object(l["a"])([y.State((function(e){return e.currentStatus}))],I.prototype,"currentStatus",void 0),Object(l["a"])([y.Action("saveFormChange")],I.prototype,"saveFormChange",void 0),Object(l["a"])([Object(u["f"])("userTaskList")],I.prototype,"initFormsByNodes",null),I=Object(l["a"])([Object(u["a"])({components:{previewForm:f["a"]}})],I);var g=I,k=g,F=(r("96d8"),r("153e"),r("2877")),O=Object(F["a"])(k,a,o,!1,null,"5f3a37c7",null);t["default"]=O.exports},"153e":function(e,t,r){"use strict";var a=r("1541"),o=r.n(a);o.a},1541:function(e,t,r){},"4bb5":function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var a=r("2fe1"),o=r("2f62"),n=l("computed",o["e"]),i=l("computed",o["c"]),s=l("methods",o["b"]),c=l("methods",o["d"]);function d(e,t){function r(t){function r(r,a){if("string"===typeof a){var o=a,n=r;return t(o,{namespace:e})(n,o)}var i=r,s=f(a||{},{namespace:e});return t(i,s)}return r}return t?(console.warn("[vuex-class] passing the 2nd argument to `namespace` function is deprecated. pass only namespace string instead."),r(t)):{State:r(n),Getter:r(i),Mutation:r(c),Action:r(s)}}function l(e,t){function r(r,o){return Object(a["a"])((function(a,n){a[e]||(a[e]={});var i,s=(i={},i[n]=r,i);a[e][n]=void 0!==o?t(o,s)[n]:t(s)[n]}))}function o(e,t){if("string"===typeof t){var a=t,o=e;return r(a,void 0)(o,a)}var n=u(t),i=e;return r(i,n)}return o}function u(e){var t=e&&e.namespace;if("string"===typeof t)return"/"!==t[t.length-1]?t+"/":t}function f(e,t){var r={};return[e,t].forEach((function(e){Object.keys(e).forEach((function(t){r[t]=e[t]}))})),r}},"7db0":function(e,t,r){"use strict";var a=r("23e7"),o=r("b727").find,n=r("44d2"),i=r("ae40"),s="find",c=!0,d=i(s);s in[]&&Array(1)[s]((function(){c=!1})),a({target:"Array",proto:!0,forced:c||!d},{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(s)},"96d8":function(e,t,r){"use strict";var a=r("b019"),o=r.n(a);o.a},b019:function(e,t,r){},d547:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return n}));r("99af"),r("4de4"),r("4160"),r("a630"),r("d81d"),r("d3b7"),r("ac1f"),r("25f0"),r("6062"),r("3ca3"),r("5319"),r("159b"),r("ddb0"),r("c1df"),r("ca00"),r("c24f");function a(e,t,r){for(var a=0;a<e.length;a+=1)if(e[a][t]===r)return e[a]}function o(e,t,r){for(var a=0;a<e.length;a+=1){var n=e[a];if(n.children){var i=o(n.children,t,r);if(i)return i}else if(e[a][t]===r)return e[a]}}function n(e,t){var r=new Set(t),a=Array.from(new Set(e.filter((function(e){return r.has(e)}))));return a}}}]);
//# sourceMappingURL=chunk-1f9db320.83a73fb3.js.map