(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19ddb668"],{1148:function(e,t,i){"use strict";var n=i("a691"),r=i("1d80");e.exports="".repeat||function(e){var t=String(r(this)),i="",a=n(e);if(a<0||a==1/0)throw RangeError("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(t+=t))1&a&&(i+=t);return i}},"13d5":function(e,t,i){"use strict";var n=i("23e7"),r=i("d58f").left,a=i("a640"),l=i("ae40"),s=a("reduce"),o=l("reduce",{1:0});n({target:"Array",proto:!0,forced:!s||!o},{reduce:function(e){return r(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"1ccf2":function(e,t,i){},"1d34":function(e,t,i){"use strict";var n=i("6dd1"),r=i.n(n);r.a},2315:function(e,t,i){"use strict";var n=i("23e7"),r=i("857a"),a=i("af03");n({target:"String",proto:!0,forced:a("strike")},{strike:function(){return r(this,"strike","","")}})},"408a":function(e,t,i){var n=i("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=n(e))throw TypeError("Incorrect invocation");return+e}},"4ec9":function(e,t,i){"use strict";var n=i("6d61"),r=i("6566");e.exports=n("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},6566:function(e,t,i){"use strict";var n=i("9bf2").f,r=i("7c73"),a=i("e2cc"),l=i("0366"),s=i("19aa"),o=i("2266"),c=i("7dd0"),h=i("2626"),u=i("83ab"),f=i("f183").fastKey,d=i("69f3"),v=d.set,g=d.getterFor;e.exports={getConstructor:function(e,t,i,c){var h=e((function(e,n){s(e,h,t),v(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),u||(e.size=0),void 0!=n&&o(n,e[c],e,i)})),d=g(t),p=function(e,t,i){var n,r,a=d(e),l=y(e,t);return l?l.value=i:(a.last=l={index:r=f(t,!0),key:t,value:i,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=l),n&&(n.next=l),u?a.size++:e.size++,"F"!==r&&(a.index[r]=l)),e},y=function(e,t){var i,n=d(e),r=f(t);if("F"!==r)return n.index[r];for(i=n.first;i;i=i.next)if(i.key==t)return i};return a(h.prototype,{clear:function(){var e=this,t=d(e),i=t.index,n=t.first;while(n)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete i[n.index],n=n.next;t.first=t.last=void 0,u?t.size=0:e.size=0},delete:function(e){var t=this,i=d(t),n=y(t,e);if(n){var r=n.next,a=n.previous;delete i.index[n.index],n.removed=!0,a&&(a.next=r),r&&(r.previous=a),i.first==n&&(i.first=r),i.last==n&&(i.last=a),u?i.size--:t.size--}return!!n},forEach:function(e){var t,i=d(this),n=l(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:i.first){n(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!y(this,e)}}),a(h.prototype,i?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return p(this,0===e?0:e,t)}}:{add:function(e){return p(this,e=0===e?0:e,e)}}),u&&n(h.prototype,"size",{get:function(){return d(this).size}}),h},setStrong:function(e,t,i){var n=t+" Iterator",r=g(t),a=g(n);c(e,t,(function(e,t){v(this,{type:n,target:e,state:r(e),kind:t,last:void 0})}),(function(){var e=a(this),t=e.kind,i=e.last;while(i&&i.removed)i=i.previous;return e.target&&(e.last=i=i?i.next:e.state.first)?"keys"==t?{value:i.key,done:!1}:"values"==t?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),i?"entries":"values",!i,!0),h(t)}}},"6d61":function(e,t,i){"use strict";var n=i("23e7"),r=i("da84"),a=i("94ca"),l=i("6eeb"),s=i("f183"),o=i("2266"),c=i("19aa"),h=i("861d"),u=i("d039"),f=i("1c7e"),d=i("d44e"),v=i("7156");e.exports=function(e,t,i){var g=-1!==e.indexOf("Map"),p=-1!==e.indexOf("Weak"),y=g?"set":"add",m=r[e],b=m&&m.prototype,w=m,k={},x=function(e){var t=b[e];l(b,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(p&&!h(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return p&&!h(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(p&&!h(e))&&t.call(this,0===e?0:e)}:function(e,i){return t.call(this,0===e?0:e,i),this})};if(a(e,"function"!=typeof m||!(p||b.forEach&&!u((function(){(new m).entries().next()})))))w=i.getConstructor(t,e,g,y),s.REQUIRED=!0;else if(a(e,!0)){var O=new w,C=O[y](p?{}:-0,1)!=O,j=u((function(){O.has(1)})),T=f((function(e){new m(e)})),E=!p&&u((function(){var e=new m,t=5;while(t--)e[y](t,t);return!e.has(-0)}));T||(w=t((function(t,i){c(t,w,e);var n=v(new m,t,w);return void 0!=i&&o(i,n[y],n,g),n})),w.prototype=b,b.constructor=w),(j||E)&&(x("delete"),x("has"),g&&x("get")),(E||C)&&x(y),p&&b.clear&&delete b.clear}return k[e]=w,n({global:!0,forced:w!=m},k),d(w,e),p||i.setStrong(w,e,g),w}},"6dd1":function(e,t,i){},"81d5":function(e,t,i){"use strict";var n=i("7b0b"),r=i("23cb"),a=i("50c4");e.exports=function(e){var t=n(this),i=a(t.length),l=arguments.length,s=r(l>1?arguments[1]:void 0,i),o=l>2?arguments[2]:void 0,c=void 0===o?i:r(o,i);while(c>s)t[s++]=e;return t}},a184:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fileType"},[i("base-panel",{directives:[{name:"loading",rawName:"v-loading",value:e.testloading,expression:"testloading"}],attrs:{title:"新增-文件型数据视图",actions:e.actionsList}},[i("el-form",{ref:"fileTypeForm",staticClass:"formCss labelSuffix",attrs:{model:e.fileTypeForm,rules:e.rules,"label-position":"left","label-width":"110px",inline:!0}},[i("el-form-item",{attrs:{label:"视图名称：",prop:"viewName"}},[i("el-input",{attrs:{placeholder:"请输入视图名称"},model:{value:e.fileTypeForm.viewName,callback:function(t){e.$set(e.fileTypeForm,"viewName",t)},expression:"fileTypeForm.viewName"}})],1),i("el-form-item",{staticClass:"labelStyle",attrs:{label:"列表题行：",prop:"titleLine"}},[i("el-input",{attrs:{placeholder:"请输入列表题行"},model:{value:e.fileTypeForm.titleLine,callback:function(t){e.$set(e.fileTypeForm,"titleLine",t)},expression:"fileTypeForm.titleLine"}})],1),i("el-form-item",{attrs:{label:"文档库连接器：",prop:"linkId"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.fileTypeForm.linkId,callback:function(t){e.$set(e.fileTypeForm,"linkId",t)},expression:"fileTypeForm.linkId"}},e._l(e.linkList,(function(e){return i("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})})),1),i("el-button",{staticClass:"create_button",attrs:{icon:"el-icon-plus"},on:{click:e.createLink}},[e._v("新增")])],1),i("el-form-item",{staticClass:"labelStyle",attrs:{label:"数据起始行：",prop:"startLine"}},[i("el-input",{attrs:{placeholder:"请输入数据起始行"},model:{value:e.fileTypeForm.startLine,callback:function(t){e.$set(e.fileTypeForm,"startLine",t)},expression:"fileTypeForm.startLine"}})],1),i("el-form-item",{attrs:{label:"文件路径：",prop:"path"}},[i("el-input",{attrs:{placeholder:"请输入文件路径"},model:{value:e.fileTypeForm.path,callback:function(t){e.$set(e.fileTypeForm,"path",t)},expression:"fileTypeForm.path"}})],1),i("el-form-item",{staticClass:"labelStyle",attrs:{label:"数据结束行：",prop:"endLine"}},[i("el-input",{attrs:{placeholder:"请输入数据结束行"},model:{value:e.fileTypeForm.endLine,callback:function(t){e.$set(e.fileTypeForm,"endLine",t)},expression:"fileTypeForm.endLine"}})],1),i("el-form-item",{attrs:{label:"sheet名称：",prop:"sheetName"}},[i("el-input",{attrs:{placeholder:"请输入sheet名称"},model:{value:e.fileTypeForm.sheetName,callback:function(t){e.$set(e.fileTypeForm,"sheetName",t)},expression:"fileTypeForm.sheetName"}})],1),i("el-form-item",{staticClass:"labelStyle",attrs:{label:"数据字典:"}},[i("el-switch",{attrs:{"active-value":0,"inactive-value":1},model:{value:e.fileTypeForm.dictFlag,callback:function(t){e.$set(e.fileTypeForm,"dictFlag",t)},expression:"fileTypeForm.dictFlag"}})],1)],1),i("simple-card",{attrs:{actions:e.paramsActions,title:"参数列表"}},[i("parameView",{ref:"parameViewTable",attrs:{isCompatible:e.isCompatible,dictFlag:e.fileTypeForm.dictFlag,"parameter-data":e.parameterTable}})],1),i("simple-card",{attrs:{title:"Excel预览"}},[i("div",{attrs:{id:"spreadsheet-execl",height:"300px"}})]),i("simple-card",{attrs:{title:"字段列表"}},[i("treeTableList",{ref:"treeLists",attrs:{isCompatible:e.isCompatible,"data-list":e.fieldTable}})],1),i("createDialog",{attrs:{"dialog-title":"新建文档库连接器","dialog-visible":e.dialogVisible,"dialog-width":"500px","botton-show":"true",type:"2","save-text":"保存","cancel-text":"取消"},on:{saveEmit:e.handelSure,cancelEmit:e.handelCancel}}),i("testEditor",{ref:"advance",attrs:{"dialog-test-switch":e.testParameterDialog,"params-list":e.parameterTable},on:{saveEmitSwitch:e.handleTestQuery,cancelEmitSwitch:e.testParameterCancel}})],1)],1)},r=[],a=(i("4160"),i("b0c0"),i("159b"),i("5530")),l=i("d4ec"),s=i("bee2"),o=i("262e"),c=i("2caf"),h=i("9ab4"),u=i("60a3"),f=(i("fb6a"),i("b64b"),i("ac1f"),i("1276"),i("0d21")),d=i("db90"),v=i("06c5"),g=i("3d8c");function p(e){return Object(f["a"])(e)||Object(d["a"])(e)||Object(v["a"])(e)||Object(g["a"])()}var y=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(l["a"])(this,e),"string"===typeof t?(this.el=document.createElement(t),this.el.className=i):this.el=t,this.data={}}return Object(s["a"])(e,[{key:"data",value:function(e,t){return void 0!==t?(this.data[e]=t,this):this.data[e]}},{key:"on",value:function(e,t){var i=e.split("."),n=p(i),r=n[0],a=n.slice(1),l=r;return"mousewheel"===l&&/Firefox/i.test(window.navigator.userAgent)&&(l="DOMMouseScroll"),this.el.addEventListener(l,(function(e){t(e);for(var i=0;i<a.length;i+=1){var n=a[i];if("left"===n&&0!==e.button)return;if("right"===n&&2!==e.button)return;"stop"===n&&e.stopPropagation()}})),this}},{key:"offset",value:function(e){var t=this;if(void 0!==e)return Object.keys(e).forEach((function(i){t.css(i,"".concat(e[i],"px"))})),this;var i=this.el,n=i.offsetTop,r=i.offsetLeft,a=i.offsetHeight,l=i.offsetWidth;return{top:n,left:r,height:a,width:l}}},{key:"scroll",value:function(e){var t=this.el;return void 0!==e&&(void 0!==e.left&&(t.scrollLeft=e.left),void 0!==e.top&&(t.scrollTop=e.top)),{left:t.scrollLeft,top:t.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new e(this.el.parentNode)}},{key:"children",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(i.forEach((function(t){return e.child(t)})),this)}},{key:"child",value:function(t){var i=t;return"string"===typeof t?i=document.createTextNode(t):t instanceof e&&(i=t.el),this.el.appendChild(i),this}},{key:"contains",value:function(e){return this.el.contains(e)}},{key:"className",value:function(e){return void 0!==e?(this.el.className=e,this):this.el.className}},{key:"addClass",value:function(e){return this.el.classList.add(e),this}},{key:"hasClass",value:function(e){return this.el.classList.contains(e)}},{key:"removeClass",value:function(e){return this.el.classList.remove(e),this}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(e)}},{key:"toggleClass",value:function(e){return this.el.classList.toggle(e)}},{key:"active",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.addClass("active"):this.removeClass("active"),this}},{key:"disabled",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(e,t){var i=this;if(void 0!==t)this.el.setAttribute(e,t);else{if("string"===typeof e)return this.el.getAttribute(e);Object.keys(e).forEach((function(t){i.el.setAttribute(t,e[t])}))}return this}},{key:"removeAttr",value:function(e){return this.el.removeAttribute(e),this}},{key:"html",value:function(e){return void 0!==e?(this.el.innerHTML=e,this):this.el.innerHTML}},{key:"val",value:function(e){return void 0!==e?(this.el.value=e,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.forEach((function(t){return e.el.style.removeProperty(t)})),this}},{key:"css",value:function(e,t){var i=this;return void 0===t&&"string"!==typeof e?(Object.keys(e).forEach((function(t){i.el.style[t]=e[t]})),this):void 0!==t?(this.el.style[e]=t,this):this.el.style[e]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}]),e}(),m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new y(e,t)},b=(i("a434"),i("d3b7"),i("25f0"),i("3835")),w=(i("99af"),["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]);function k(e){var t="",i=e;while(i>=w.length)i/=w.length,i-=1,t+=w[parseInt(i,10)%w.length];var n=e%w.length;return t+=w[n],t}function x(e){for(var t=0,i=0;i<e.length-1;i+=1){var n=e.charCodeAt(i)-65,r=e.length-1-i;t+=Math.pow(w.length,r)+w.length*n}return t+=e.charCodeAt(e.length-1)-65,t}function O(e){for(var t="",i="",n=0;n<e.length;n+=1)e.charAt(n)>="0"&&e.charAt(n)<="9"?i+=e.charAt(n):t+=e.charAt(n);return[x(t),parseInt(i,10)-1]}function C(e,t,i){var n=O(e),r=Object(b["a"])(n,2),a=r[0],l=r[1];return k(a+t)+(l+i)}function j(e,t){return"".concat(k(e)).concat(t+1)}var T=function(){function e(t,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;Object(l["a"])(this,e),this.sri=t,this.sci=i,this.eri=n,this.eci=r,this.w=a,this.h=s}return Object(s["a"])(e,[{key:"set",value:function(e,t,i,n){this.sri=e,this.sci=t,this.eri=i,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var e=0,t=0,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];if(1===n.length){var a=O(n[0]),l=Object(b["a"])(a,2);t=l[0],e=l[1]}else 2===n.length&&(e=n[0],t=n[1]);var s=this.sri,o=this.sci,c=this.eri,h=this.eci;return s<=e&&e<=c&&o<=t&&t<=h}},{key:"each",value:function(e){for(var t=this.sri,i=this.sci,n=this.eri,r=this.eci,a=t;a<=n;a+=1)for(var l=i;l<=r;l+=1)e(a,l)}},{key:"contains",value:function(e){return this.sri<=e.sri&&this.sci<=e.sci&&this.eri>=e.eri&&this.eci>=e.eci}},{key:"within",value:function(e){return this.sri>=e.sri&&this.sci>=e.sci&&this.eri<=e.eri&&this.eci<=e.eci}},{key:"disjoint",value:function(e){return this.sri>e.eri||this.sci>e.eci||e.sri>this.eri||e.sci>this.eci}},{key:"intersects",value:function(e){return this.sri<=e.eri&&this.sci<=e.eci&&e.sri<=this.eri&&e.sci<=this.eci}},{key:"union",value:function(t){var i=this.sri,n=this.sci,r=this.eri,a=this.eci;return new e(t.sri<i?t.sri:i,t.sci<n?t.sci:n,t.eri>r?t.eri:r,t.eci>a?t.eci:a)}},{key:"difference",value:function(t){var i=[],n=function(t,n,r,a){i.push(new e(t,n,r,a))},r=this.sri,a=this.sci,l=this.eri,s=this.eci,o=t.sri-r,c=t.sci-a,h=l-t.eri,u=s-t.eci;return o>0?(n(r,a,t.sri-1,s),h>0?(n(t.eri+1,a,l,s),c>0&&n(t.sri,a,t.eri,t.sci-1),u>0&&n(t.sri,t.eci+1,t.eri,s)):(c>0&&n(t.sri,a,l,t.sci-1),u>0&&n(t.sri,t.eci+1,l,s))):h>0&&(n(t.eri+1,a,l,s),c>0&&n(r,a,t.eri,t.sci-1),u>0&&n(r,t.eci+1,t.eri,s)),c>0?(n(r,a,l,t.sci-1),u>0?(n(r,t.eri+1,l,s),o>0&&n(r,t.sci,t.sri-1,t.eci),h>0&&n(t.sri+1,t.sci,l,t.eci)):(o>0&&n(r,t.sci,t.sri-1,s),h>0&&n(t.sri+1,t.sci,l,s))):u>0&&(n(l,t.eci+1,l,s),o>0&&n(r,a,t.sri-1,t.eci),h>0&&n(t.eri+1,a,l,t.eci)),i}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var e=this.sri,t=this.sci,i=this.eri,n=this.eci,r=j(t,e);return this.multiple()&&(r="".concat(r,":").concat(j(n,i))),r}},{key:"clone",value:function(){var t=this.sri,i=this.sci,n=this.eri,r=this.eci,a=this.w,l=this.h;return new e(t,i,n,r,a,l)}},{key:"equals",value:function(e){return this.eri===e.eri&&this.eci===e.eci&&this.sri===e.sri&&this.sci===e.sci}}],[{key:"valueOf",value:function(t){var i=t.split(":"),n=O(i[0]),r=Object(b["a"])(n,2),a=r[0],l=r[1],s=l,o=a;if(i.length>1){var c=O(i[1]),h=Object(b["a"])(c,2);o=h[0],s=h[1]}return new e(l,a,s,o)}}]),e}(),E=function(){function e(){Object(l["a"])(this,e),this.range=new T(0,0,0,0),this.ri=0,this.ci=0}return Object(s["a"])(e,[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(e,t){this.ri=e,this.ci=t}},{key:"size",value:function(){return this.range.size()}}]),e}(),S=function e(){Object(l["a"])(this,e),this.x=0,this.y=0,this.ri=0,this.ci=0},F=function(){function e(){Object(l["a"])(this,e),this.undoItems=[],this.redoItems=[]}return Object(s["a"])(e,[{key:"add",value:function(e){this.undoItems.push(JSON.stringify(e)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(e,t){var i=this.undoItems,n=this.redoItems;this.canUndo()&&(n.push(JSON.stringify(e)),t(JSON.parse(i.pop())))}},{key:"redo",value:function(e,t){var i=this.undoItems,n=this.redoItems;this.canRedo()&&(i.push(JSON.stringify(e)),t(JSON.parse(n.pop())))}}]),e}(),D=function(){function e(){Object(l["a"])(this,e),this.range=null,this.state="clear"}return Object(s["a"])(e,[{key:"copy",value:function(e){return this.range=e,this.state="copy",this}},{key:"cut",value:function(e){return this.range=e,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}]),e}(),z=(i("4de4"),i("caad"),i("d81d"),i("2532"),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(l["a"])(this,e),this._=t}return Object(s["a"])(e,[{key:"forEach",value:function(e){this._.forEach(e)}},{key:"deleteWithin",value:function(e){this._=this._.filter((function(t){return!t.within(e)}))}},{key:"getFirstIncludes",value:function(e,t){for(var i=0;i<this._.length;i+=1){var n=this._[i];if(n.includes(e,t))return n}return null}},{key:"filterIntersects",value:function(t){return new e(this._.filter((function(e){return e.intersects(t)})))}},{key:"intersects",value:function(e){for(var t=0;t<this._.length;t+=1){var i=this._[t];if(i.intersects(e))return!0}return!1}},{key:"union",value:function(e){var t=e;return this._.forEach((function(e){e.intersects(t)&&(t=e.union(t))})),t}},{key:"add",value:function(e){this.deleteWithin(e),this._.push(e)}},{key:"shift",value:function(e,t,i,n){this._.forEach((function(r){var a=r.sri,l=r.sci,s=r.eri,o=r.eci,c=r;"row"===e?a>=t?(c.sri+=i,c.eri+=i):a<t&&t<=s&&(c.eri+=i,n(a,l,i,0)):"column"===e&&(l>=t?(c.sci+=i,c.eci+=i):l<t&&t<=o&&(c.eci+=i,n(a,l,0,i)))}))}},{key:"move",value:function(e,t,i){this._.forEach((function(n){var r=n;r.within(e)&&(r.eri+=t,r.sri+=t,r.sci+=i,r.eci+=i)}))}},{key:"setData",value:function(e){return this._=e.map((function(e){return T.valueOf(e)})),this}},{key:"getData",value:function(){return this._.map((function(e){return e.toString()}))}}]),e}());function I(e){return JSON.parse(JSON.stringify(e))}var R=function e(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return n.forEach((function(i){Object.keys(i).forEach((function(n){var r=i[n];"string"===typeof r||"number"===typeof r||"boolean"===typeof r?t[n]=r:"function"!==typeof r&&!Array.isArray(r)&&r instanceof Object?(t[n]=t[n]||{},e(t[n],r)):t[n]=r}))})),t};function A(e,t){var i=Object.keys(e);if(i.length!==Object.keys(t).length)return!1;for(var n=0;n<i.length;n+=1){var r=i[n],a=e[r],l=t[r];if(void 0===l)return!1;if("string"===typeof a||"number"===typeof a||"boolean"===typeof a){if(a!==l)return!1}else if(Array.isArray(a)){if(a.length!==l.length)return!1;for(var s=0;s<a.length;s+=1)if(!A(a[s],l[s]))return!1}else if("function"!==typeof a&&!Array.isArray(a)&&a instanceof Object&&!A(a,l))return!1}return!0}var N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},i=0,n=0;return Object.keys(e).forEach((function(r){i+=t(e[r],r),n+=1})),[i,n]};function W(e,t){var i=e["".concat(t)];return delete e["".concat(t)],i}function L(e,t,i,n,r,a){for(var l=i,s=n,o=e;o<t;o+=1){if(l>r)break;s=a(o),l+=s}return[o,l-s,s]}function q(e,t,i){for(var n=0,r=e;r<t;r+=1)n+=i(r);return n}function V(e,t,i){for(var n=e;n<t;n+=1)i(n)}function M(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i+=1)if(e[i]!==t[i])return!1;return!0}var H={cloneDeep:I,merge:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return R.apply(void 0,[{}].concat(t))},equals:A,arrayEquals:M,sum:N,rangeEach:V,rangeSum:q,rangeReduceIf:L,deleteProperty:W},P=(i("a9e3"),i("4fad"),i("5319"),function(){function e(t){var i=t.len,n=t.height;Object(l["a"])(this,e),this._={},this.len=i,this.height=n}return Object(s["a"])(e,[{key:"getHeight",value:function(e){var t=this.get(e);return t&&t.height?t.height:this.height}},{key:"setHeight",value:function(e,t){var i=this.getOrNew(e);i.height=t}},{key:"setStyle",value:function(e,t){var i=this.getOrNew(e);i.style=t}},{key:"sumHeight",value:function(e,t){var i=this;return H.rangeSum(e,t,(function(e){return i.getHeight(e)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(e){return this._[e]}},{key:"getOrNew",value:function(e){return this._[e]=this._[e]||{cells:{}},this._[e]}},{key:"getCell",value:function(e,t){var i=this.get(e);return void 0!==i&&void 0!==i.cells&&void 0!==i.cells[t]?i.cells[t]:null}},{key:"getCellMerge",value:function(e,t){var i=this.getCell(e,t);return i&&i.merge?i.merge:[0,0]}},{key:"getCellOrNew",value:function(e,t){var i=this.getOrNew(e);return i.cells[t]=i.cells[t]||{},i.cells[t]}},{key:"setCell",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",r=this.getOrNew(e);"all"===n?r.cells[t]=i:"text"===n?(r.cells[t]=r.cells[t]||{},r.cells[t].text=i.text):"format"===n&&(r.cells[t]=r.cells[t]||{},r.cells[t].style=i.style,i.merge&&(r.cells[t].merge=i.merge))}},{key:"setCellText",value:function(e,t,i){var n=this.getCellOrNew(e,t);n.text=i}},{key:"copyPaste",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a=e.sri,l=e.sci,s=e.eri,o=e.eci,c=t.sri,h=t.sci,u=t.eri,f=t.eci,d=e.size(),v=Object(b["a"])(d,2),g=v[0],p=v[1],y=t.size(),m=Object(b["a"])(y,2),w=m[0],k=m[1],x=!0,O=0;(u<a||f<l)&&(x=!1,O=u<a?w:k);for(var j=a;j<=s;j+=1)if(this._[j])for(var T=l;T<=o;T+=1)if(this._[j].cells&&this._[j].cells[T])for(var E=c;E<=u;E+=g)for(var S=h;S<=f;S+=p){var F=E+(j-a),D=S+(T-l),z=H.cloneDeep(this._[j].cells[T]);n&&z&&z.text&&z.text.length>0&&function(){var e=z.text,t=S-h+(E-c)+1;if(x||(t-=O+1),"="===e[0])z.text=e.replace(/\w{1,3}\d/g,(function(e){var i=0,n=0;return a===c?i=t:n=t,C(e,i,n)}));else{var i=/[\\.\d]+$/.exec(e);if(null!==i){var n=Number(i[0])+t;z.text=e.substring(0,i.index)+n}}}(),this.setCell(F,D,z,i),r(F,D,z)}}},{key:"cutPaste",value:function(e,t){var i=this,n={};this.each((function(r){i.eachCells(r,(function(a){var l=parseInt(r,10),s=parseInt(a,10);e.includes(r,a)&&(l=t.sri+(l-e.sri),s=t.sci+(s-e.sci)),n[l]=n[l]||{cells:{}},n[l].cells[s]=i._[r].cells[a]}))})),this._=n}},{key:"insert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i={};this.each((function(n,r){var a=parseInt(n,10);a>=e&&(a+=t),i[a]=r})),this._=i,this.len+=t}},{key:"delete",value:function(e,t){var i=t-e+1,n={};this.each((function(r,a){var l=parseInt(r,10);l<e?n[l]=a:r>t&&(n[l-i]=a)})),this._=n,this.len-=i}},{key:"insertColumn",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(n,r){var a={};t.eachCells(n,(function(t,n){var r=parseInt(t,10);r>=e&&(r+=i),a[r]=n})),r.cells=a}))}},{key:"deleteColumn",value:function(e,t){var i=this,n=t-e+1;this.each((function(r,a){var l={};i.eachCells(r,(function(i,r){var a=parseInt(i,10);a<e?l[a]=r:a>t&&(l[a-n]=r)})),a.cells=l}))}},{key:"deleteCells",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";e.each((function(e,n){t.deleteCell(e,n,i)}))}},{key:"deleteCell",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=this.get(e);if(null!==n){var r=this.getCell(e,t);null!==r&&("all"===i?delete n.cells[t]:"text"===i?(r.text&&delete r.text,r.value&&delete r.value):"format"===i?(void 0!==r.style&&delete r.style,r.merge&&delete r.merge):"merge"===i&&r.merge&&delete r.merge)}}},{key:"each",value:function(e){Object.entries(this._).forEach((function(t){var i=Object(b["a"])(t,2),n=i[0],r=i[1];e(n,r)}))}},{key:"eachCells",value:function(e,t){this._[e]&&this._[e].cells&&Object.entries(this._[e].cells).forEach((function(e){var i=Object(b["a"])(e,2),n=i[0],r=i[1];t(n,r)}))}},{key:"setData",value:function(e){e.len&&(this.len=e.len,delete e.len),this._=e}},{key:"getData",value:function(){var e=this.len;return Object.assign({len:e},this._)}}]),e}()),_=function(){function e(t){var i=t.len,n=t.width,r=t.indexWidth,a=t.minWidth;Object(l["a"])(this,e),this._={},this.len=i,this.width=n,this.indexWidth=r,this.minWidth=a}return Object(s["a"])(e,[{key:"setData",value:function(e){e.len&&(this.len=e.len,delete e.len),this._=e}},{key:"getData",value:function(){var e=this.len;return Object.assign({len:e},this._)}},{key:"getWidth",value:function(e){var t=this._[e];return t&&t.width?t.width:this.width}},{key:"getOrNew",value:function(e){return this._[e]=this._[e]||{},this._[e]}},{key:"setWidth",value:function(e,t){var i=this.getOrNew(e);i.width=t}},{key:"setStyle",value:function(e,t){var i=this.getOrNew(e);i.style=t}},{key:"sumWidth",value:function(e,t){var i=this;return H.rangeSum(e,t,(function(e){return i.getWidth(e)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}]),e}(),$=(i("4ec9"),i("3ca3"),i("ddb0"),{toolbar:{undo:"Undo",redo:"Redo",paintformat:"Paint format",clearformat:"Clear format",format:"Format",font:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",textColor:"Text color",fillColor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",insertRow:"Insert row",insertColumn:"Insert column",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations"},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{cancel:"Cancel",remove:"Remove",save:"Save"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}),B="en",U={en:$};function Y(e,t){if(t&&t[B])for(var i=t[B],n=e.split("."),r=0;r<n.length;r+=1){var a=n[r],l=i[a];if(r===n.length-1)return l;if(!l)return;i=l}}function X(e){var t=Y(e,U);return!t&&window&&window.x&&window.x.spreadsheet&&window.x.spreadsheet.$messages&&(t=Y(e,window.x.spreadsheet.$messages)),t||""}function J(e){return function(){return X(e)}}function K(e,t){B=e,t&&(U[e]=t)}var Q={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function Z(e,t){var i="";if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];i=X.apply(void 0,["validation.".concat(t)].concat(r))}return[e,i]}var G=function(){function e(t,i,n,r){Object(l["a"])(this,e),this.required=i,this.value=n,this.type=t,this.operator=r,this.message=""}return Object(s["a"])(e,[{key:"parseValue",value:function(e){var t=this.type;return"date"===t?new Date(e):"number"===t?Number(e):e}},{key:"equals",value:function(e){var t=this.type===e.type&&this.required===e.required&&this.operator===e.operator;return t&&(t=Array.isArray(this.value)?H.arrayEquals(this.value,e.value):this.value===e.value),t}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(e){var t=this.required,i=this.operator,n=this.value,r=this.type;if(t&&/^\s*$/.test(e))return Z(!1,"required");if(/^\s*$/.test(e))return[!0];if(Q[r]&&!Q[r].test(e))return Z(!1,"notMatch");if("list"===r)return Z(this.values().includes(e),"notIn");if(i){var a=this.parseValue(e);if("be"===i){var l=Object(b["a"])(n,2),s=l[0],o=l[1];return Z(a>=this.parseValue(s)&&a<=this.parseValue(o),"between",s,o)}if("nbe"===i){var c=Object(b["a"])(n,2),h=c[0],u=c[1];return Z(a<this.parseValue(h)||a>this.parseValue(u),"notBetween",h,u)}if("eq"===i)return Z(a===this.parseValue(n),"equal",n);if("neq"===i)return Z(a!==this.parseValue(n),"notEqual",n);if("lt"===i)return Z(a<this.parseValue(n),"lessThan",n);if("lte"===i)return Z(a<=this.parseValue(n),"lessThanEqual",n);if("gt"===i)return Z(a>this.parseValue(n),"greaterThan",n);if("gte"===i)return Z(a>=this.parseValue(n),"greaterThanEqual",n)}return[!0]}}]),e}(),ee=function(){function e(t,i,n){Object(l["a"])(this,e),this.refs=i,this.mode=t,this.validator=n}return Object(s["a"])(e,[{key:"includes",value:function(e,t){for(var i=this.refs,n=0;n<i.length;n+=1){var r=T.valueOf(i[n]);if(r.includes(e,t))return!0}return!1}},{key:"addRef",value:function(e){this.remove(T.valueOf(e)),this.refs.push(e)}},{key:"remove",value:function(e){var t=[];this.refs.forEach((function(i){var n=T.valueOf(i);if(n.intersects(e)){var r=n.difference(e);r.forEach((function(e){return t.push(e.toString())}))}else t.push(i)})),this.refs=t}},{key:"getData",value:function(){var e=this.refs,t=this.mode,i=this.validator,n=i.type,r=i.required,a=i.operator,l=i.value;return{refs:e,mode:t,type:n,required:r,operator:a,value:l}}}],[{key:"valueOf",value:function(t){var i=t.refs,n=t.mode,r=t.type,a=t.required,l=t.operator,s=t.value;return new e(n,i,new G(r,a,s,l))}}]),e}(),te=function(){function e(){Object(l["a"])(this,e),this._=[],this.errors=new Map}return Object(s["a"])(e,[{key:"getError",value:function(e,t){return this.errors.get("".concat(e,"_").concat(t))}},{key:"validate",value:function(e,t,i){var n=this.get(e,t),r="".concat(e,"_").concat(t),a=this.errors;if(null!==n){var l=n.validator.validate(i),s=Object(b["a"])(l,2),o=s[0],c=s[1];o?a.delete(r):a.set(r,c)}else a.delete(r);return!0}},{key:"add",value:function(e,t,i){var n=i.type,r=i.required,a=i.value,l=i.operator,s=new G(n,r,a,l),o=this.getByValidator(s);null!==o?o.addRef(t):this._.push(new ee(e,[t],s))}},{key:"getByValidator",value:function(e){for(var t=0;t<this._.length;t+=1){var i=this._[t];if(i.validator.equals(e))return i}return null}},{key:"get",value:function(e,t){for(var i=0;i<this._.length;i+=1){var n=this._[i];if(n.includes(e,t))return n}return null}},{key:"remove",value:function(e){this.each((function(t){t.remove(e)}))}},{key:"each",value:function(e){this._.forEach((function(t){return e(t)}))}},{key:"getData",value:function(){return this._.filter((function(e){return e.refs.length>0})).map((function(e){return e.getData()}))}},{key:"setData",value:function(e){this._=e.map((function(e){return ee.valueOf(e)}))}}]),e}(),ie={view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1}}},ne=41;function re(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=this.merges,r=t.clone(),a=e.size(),l=Object(b["a"])(a,2),s=l[0],o=l[1],c=t.size(),h=Object(b["a"])(c,2),u=h[0],f=h[1];return s>u&&(r.eri=t.sri+s-1),o>f&&(r.eci=t.sci+o-1),!n.intersects(r)||(i(X("error.pasteForMergedCell")),!1)}function ae(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.rows,a=this.merges;"all"!==i&&"format"!==i||(r.deleteCells(t,i),a.deleteWithin(t)),r.copyPaste(e,t,i,n,(function(e,t,i){if(i&&i.merge){var n=Object(b["a"])(i.merge,2),r=n[0],l=n[1];if(r<=0&&l<=0)return;a.add(new T(e,t,e+r,t+l))}}))}function le(e,t){var i=this.clipboard,n=this.rows,r=this.merges;n.cutPaste(e,t),r.move(e,t.sri-e.sri,t.sci-e.sci),i.clear()}function se(e,t,i){var n=this.styles,r=this.rows,a=r.getCellOrNew(e,t),l={};void 0!==a.style&&(l=H.cloneDeep(n[a.style])),Object.assign(l,{border:i}),a.style=this.addStyle(l)}function oe(e){var t=this,i=e.mode,n=e.style,r=e.color,a=this.styles,l=this.selector,s=this.rows,o=l.range,c=o.sri,h=o.sci,u=o.eri,f=o.eci,d=!this.isSignleSelected();if(d||"inside"!==i&&"horizontal"!==i&&"vertical"!==i)if("outside"!==i||d){if("none"===i)l.range.each((function(e,i){var n=s.getCell(e,i);if(n&&void 0!==n.style){var r=H.cloneDeep(a[n.style]);delete r.border,n.style=t.addStyle(r)}}));else if("all"===i||"inside"===i||"outside"===i||"horizontal"===i||"vertical"===i)(function(){for(var e=[],a=c;a<=u;a+=1)for(var l=h;l<=f;l+=1){for(var o=[],v=0;v<e.length;v+=1){var g=Object(b["a"])(e[v],4),p=g[0],y=g[1],m=g[2],w=g[3];if(a===p+m+1&&o.push(v),p<=a&&a<=p+m&&l===y){l+=w+1;break}}if(o.forEach((function(t){return e.splice(t,1)})),l>f)break;var k=s.getCell(a,l),x=0,O=0;if(k&&k.merge){var C=Object(b["a"])(k.merge,2);x=C[0],O=C[1],e.push([a,l,x,O])}var j=x>0&&a+x===u,T=O>0&&l+O===f,E={};"all"===i?E={bottom:[n,r],top:[n,r],left:[n,r],right:[n,r]}:"inside"===i?(!T&&l<f&&(E.right=[n,r]),!j&&a<u&&(E.bottom=[n,r])):"horizontal"===i?!j&&a<u&&(E.bottom=[n,r]):"vertical"===i?!T&&l<f&&(E.right=[n,r]):"outside"===i&&d&&(c===a&&(E.top=[n,r]),(j||u===a)&&(E.bottom=[n,r]),h===l&&(E.left=[n,r]),(T||f===l)&&(E.right=[n,r])),Object.keys(E).length>0&&se.call(t,a,l,E),l+=O}})();else if("top"===i||"bottom"===i)for(var v=h;v<=f;v+=1)"top"===i&&(se.call(this,c,v,{top:[n,r]}),v+=s.getCellMerge(c,v)[1]),"bottom"===i&&(se.call(this,u,v,{bottom:[n,r]}),v+=s.getCellMerge(u,v)[1]);else if("left"===i||"right"===i)for(var g=c;g<=u;g+=1)"left"===i&&(se.call(this,g,h,{left:[n,r]}),g+=s.getCellMerge(g,h)[0]),"right"===i&&(se.call(this,g,f,{right:[n,r]}),g+=s.getCellMerge(g,f)[0])}else se.call(this,c,h,{top:[n,r],bottom:[n,r],left:[n,r],right:[n,r]})}function ce(e,t){var i=this.rows,n=this.freezeTotalHeight(),r=i.height;n+i.height<e&&(r-=t);var a=H.rangeReduceIf(0,i.len,r,i.height,e,(function(e){return i.getHeight(e)})),l=Object(b["a"])(a,3),s=l[0],o=l[1],c=l[2];return o<=0?{ri:-1,top:0,height:c}:{ri:s-1,top:o,height:c}}function he(e,t){var i=this.cols,n=this.freezeTotalWidth(),r=i.indexWidth;n+i.indexWidth<e&&(r-=t);var a=H.rangeReduceIf(0,i.len,r,i.indexWidth,e,(function(e){return i.getWidth(e)})),l=Object(b["a"])(a,3),s=l[0],o=l[1],c=l[2];return o<=0?{ci:-1,left:0,width:i.indexWidth}:{ci:s-1,left:o,width:c}}var ue=function(){function e(t,i){Object(l["a"])(this,e),this.settings=H.merge(ie,i||{}),this.name=t||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new z,this.rows=new P(this.settings.row),this.cols=new _(this.settings.col),this.validations=new te,this.hyperlinks={},this.comments={},this.selector=new E,this.scroll=new S,this.history=new F,this.clipboard=new D,this.change=function(){}}return Object(s["a"])(e,[{key:"addValidation",value:function(e,t,i){var n=this;this.changeData((function(){n.validations.add(e,t,i)}))}},{key:"removeValidation",value:function(){var e=this,t=this.selector.range;this.changeData((function(){e.validations.remove(t)}))}},{key:"getSelectedValidator",value:function(){var e=this.selector,t=e.ri,i=e.ci,n=this.validations.get(t,i);return n?n.validator:null}},{key:"getSelectedValidation",value:function(){var e=this.selector,t=e.ri,i=e.ci,n=e.range,r=this.validations.get(t,i),a={ref:n.toString()};return null!==r&&(a.mode=r.mode,a.validator=r.validator),a}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var e=this;this.history.undo(this.getData(),(function(t){e.setData(t)}))}},{key:"redo",value:function(){var e=this;this.history.redo(this.getData(),(function(t){e.setData(t)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.clipboard,r=this.selector;return!n.isClear()&&(!!re.call(this,n.range,r.range,i)&&(this.changeData((function(){n.isCopy()?ae.call(e,n.range,r.range,t):n.isCut()&&le.call(e,n.range,r.range)})),!0))}},{key:"autofill",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.selector.range;return!!re.call(this,r,e,n)&&(this.changeData((function(){ae.call(i,r,e,t,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(e,t){var i=this.selector,n=this.rows,r=this.cols,a=this.merges,l=i.range,s=l.sri,o=l.sci,c=l.eri,h=l.eci,u=i.ri,f=i.ci,d=e,v=t;return e<0&&(d=n.len-1),t<0&&(v=r.len-1),d<=u?(s=d,c=u):c=d,v<=f?(o=v,h=f):h=v,i.range=a.union(new T(s,o,c,h)),i.range}},{key:"calSelectedRangeByStart",value:function(e,t){var i=this.selector,n=this.rows,r=this.cols,a=this.merges,l=a.getFirstIncludes(e,t);return null===l&&(l=new T(e,t,e,t),-1===e&&(l.sri=0,l.eri=n.len-1),-1===t&&(l.sci=0,l.eci=r.len-1)),i.range=l,l}},{key:"setSelectedCellAttr",value:function(e,t){var i=this;this.changeData((function(){var n=i.selector,r=i.styles,a=i.rows;if("merge"===e)t?i.merge():i.unmerge();else if("border"===e)oe.call(i,t);else if("formula"===e){var l=a.getCellOrNew(n.ri,n.ci);l.text="=".concat(t,"()")}else n.range.each((function(n,l){var s=a.getCellOrNew(n,l),o={};if(void 0!==s.style&&(o=H.cloneDeep(r[s.style])),"format"===e)o.format=t,s.style=i.addStyle(o);else if("font-bold"===e||"font-italic"===e||"font-name"===e||"font-size"===e){var c={};c[e.split("-")[1]]=t,o.font=Object.assign(o.font||{},c),s.style=i.addStyle(o)}else"strike"!==e&&"textwrap"!==e&&"underline"!==e&&"align"!==e&&"valign"!==e&&"color"!==e&&"bgcolor"!==e||(o[e]=t,s.style=i.addStyle(o))}))}))}},{key:"setSelectedCellText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",i=this.selector,n=i.ri,r=i.ci;this.setCellText(n,r,e,t)}},{key:"getSelectedCell",value:function(){var e=this.selector,t=e.ri,i=e.ci;return this.rows.getCell(t,i)}},{key:"xyInSelectedRect",value:function(e,t){var i=this.getSelectedRect(),n=i.left,r=i.top,a=i.width,l=i.height,s=e-this.cols.indexWidth,o=t-this.rows.height;return s>n&&s<n+a&&o>r&&o<r+l}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var e=this.clipboard;return e.isClear()?{left:-100,top:-100}:this.getRect(e.range)}},{key:"getRect",value:function(e){var t=this.scroll,i=this.rows,n=this.cols,r=e.sri,a=e.sci,l=e.eri,s=e.eci;if(r<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:t};var o=this.cellPosition(r,a),c=o.left,h=o.top,u=i.sumHeight(r,l+1),f=n.sumWidth(a,s+1),d=c-t.x,v=h-t.y,g=this.freezeTotalHeight(),p=this.freezeTotalWidth();return p>0&&p>c&&(d=c),g>0&&g>h&&(v=h),{l:c,t:h,left:d,top:v,height:u,width:f,scroll:t}}},{key:"getCellRectByXY",value:function(e,t){var i=this.scroll,n=this.merges,r=this.rows,a=this.cols,l=ce.call(this,t,i.y),s=l.ri,o=l.top,c=l.height,h=he.call(this,e,i.x),u=h.ci,f=h.left,d=h.width;if(-1===u&&(d=a.totalWidth()),-1===s&&(c=r.totalHeight()),s>=0||u>=0){var v=n.getFirstIncludes(s,u);if(v){s=v.sri,u=v.sci;var g=this.cellRect(s,u);f=g.left,o=g.top,d=g.width,c=g.height}}return{ri:s,ci:u,left:f,top:o,width:d,height:c}}},{key:"isSignleSelected",value:function(){var e=this.selector.range,t=e.sri,i=e.sci,n=e.eri,r=e.eci,a=this.getCell(t,i);if(a&&a.merge){var l=Object(b["a"])(a.merge,2),s=l[0],o=l[1];if(t+s===n&&i+o===r)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var e=this.selector.range,t=e.sri,i=e.sci,n=e.eri,r=e.eci,a=this.getCell(t,i);if(a&&a.merge){var l=Object(b["a"])(a.merge,2),s=l[0],o=l[1];if(t+s===n&&i+o===r)return!0}return!1}},{key:"merge",value:function(){var e=this,t=this.selector,i=this.rows;if(!this.isSignleSelected()){var n=t.size(),r=Object(b["a"])(n,2),a=r[0],l=r[1];if(a>1||l>1){var s=t.range,o=s.sri,c=s.sci;this.changeData((function(){var n=i.getCellOrNew(o,c);n.merge=[a-1,l-1],e.merges.add(t.range),e.rows.deleteCells(t.range),e.rows.setCell(o,c,n)}))}}}},{key:"unmerge",value:function(){var e=this,t=this.selector;if(this.isSignleSelected()){var i=t.range,n=i.sri,r=i.sci;this.changeData((function(){e.rows.deleteCell(n,r,"merge"),e.merges.deleteWithin(t.range)}))}}},{key:"deleteCell",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",i=this.selector;this.changeData((function(){e.rows.deleteCells(i.range,t),"all"!==t&&"format"!==t||e.merges.deleteWithin(i.range)}))}},{key:"insert",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var n=t.selector.range,r=n.sri,a=n.sci,l=t.rows,s=t.merges,o=t.cols,c=r;"row"===e?l.insert(r,i):"column"===e&&(l.insertColumn(a,i),c=a,o.len+=1),s.shift(e,c,i,(function(e,t,i,n){var r=l.getCell(e,t);r.merge[0]+=i,r.merge[1]+=n}))}))}},{key:"delete",value:function(e){var t=this;this.changeData((function(){var i=t.rows,n=t.merges,r=t.selector,a=t.cols,l=r.range,s=r.range,o=s.sri,c=s.sci,h=s.eri,u=s.eci,f=r.range.size(),d=Object(b["a"])(f,2),v=d[0],g=d[1],p=o,y=v;"row"===e?i.delete(o,h):"column"===e&&(i.deleteColumn(c,u),p=l.sci,y=g,a.len-=1),n.shift(e,p,-y,(function(e,t,n,r){var a=i.getCell(e,t);a.merge[0]+=n,a.merge[1]+=r,0===a.merge[0]&&0===a.merge[1]&&delete a.merge}))}))}},{key:"scrollx",value:function(e,t){var i=this.scroll,n=this.freeze,r=this.cols,a=Object(b["a"])(n,2),l=a[1],s=H.rangeReduceIf(l,r.len,0,0,e,(function(e){return r.getWidth(e)})),o=Object(b["a"])(s,3),c=o[0],h=o[1],u=o[2],f=h;e>0&&(f+=u),i.x!==f&&(i.ci=e>0?c:0,i.x=f,t())}},{key:"scrolly",value:function(e,t){var i=this.scroll,n=this.freeze,r=this.rows,a=Object(b["a"])(n,1),l=a[0],s=H.rangeReduceIf(l,r.len,0,0,e,(function(e){return r.getHeight(e)})),o=Object(b["a"])(s,3),c=o[0],h=o[1],u=o[2],f=h;e>0&&(f+=u),i.y!==f&&(i.ri=e>0?c:0,i.y=f,t())}},{key:"cellRect",value:function(e,t){var i=this.rows,n=this.cols,r=this.cellPosition(e,t),a=r.left,l=r.top,s=i.getCell(e,t),o=n.getWidth(t),c=i.getHeight(e);if(null!==s&&s.merge){var h=Object(b["a"])(s.merge,2),u=h[0],f=h[1];if(u>0)for(var d=1;d<=u;d+=1)c+=i.getHeight(e+d);if(f>0)for(var v=1;v<=f;v+=1)o+=n.getWidth(t+v)}return{left:a,top:l,width:o,height:c,cell:s}}},{key:"cellPosition",value:function(e,t){var i=this.cols,n=this.rows,r=i.sumWidth(0,t),a=n.sumHeight(0,e);return{left:r,top:a}}},{key:"getCell",value:function(e,t){return this.rows.getCell(e,t)}},{key:"getCellTextOrDefault",value:function(e,t){var i=this.getCell(e,t);return i&&i.text?i.text:""}},{key:"getCellStyle",value:function(e,t){var i=this.getCell(e,t);return i&&void 0!==i.style?this.styles[i.style]:null}},{key:"getCellStyleOrDefault",value:function(e,t){var i=this.styles,n=this.rows,r=n.getCell(e,t),a=r&&void 0!==r.style?i[r.style]:{};return H.merge(this.defaultStyle(),a)}},{key:"getSelectedCellStyle",value:function(){var e=this.selector,t=e.ri,i=e.ci;return this.getCellStyleOrDefault(t,i)}},{key:"setCellText",value:function(e,t,i,n){var r=this.rows,a=this.history,l=this.validations;"finished"===n?(r.setCellText(e,t,""),a.add(this.getData()),r.setCellText(e,t,i)):(r.setCellText(e,t,i),this.change(this.getData())),l.validate(e,t,i)}},{key:"freezeIsActive",value:function(){var e=Object(b["a"])(this.freeze,2),t=e[0],i=e[1];return t>0||i>0}},{key:"setFreeze",value:function(e,t){var i=this;this.changeData((function(){i.freeze=[e,t]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(e,t){var i=this;this.changeData((function(){i.rows.setHeight(e,t)}))}},{key:"setColWidth",value:function(e,t){var i=this;this.changeData((function(){i.cols.setWidth(e,t)}))}},{key:"viewHeight",value:function(){var e=this.settings,t=e.view,i=e.showToolbar,n=t.height();return i&&(n-=ne),n}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var e=Object(b["a"])(this.freeze,2),t=e[0],i=e[1];return new T(0,0,t-1,i-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"viewRange",value:function(){var e=this.scroll,t=this.rows,i=this.cols,n=this.freeze,r=e.ri,a=e.ci;if(r<=0){var l=Object(b["a"])(n,1);r=l[0]}if(a<=0){var s=Object(b["a"])(n,2);a=s[1]}for(var o=0,c=0,h=[t.len,i.len],u=h[0],f=h[1],d=r;d<t.len;d+=1)if(c+=t.getHeight(d),u=d,c>this.viewHeight())break;for(var v=a;v<i.len;v+=1)if(o+=i.getWidth(v),f=v,o>this.viewWidth())break;return new T(r,a,u,f,o,c)}},{key:"eachMergesInView",value:function(e,t){this.merges.filterIntersects(e).forEach((function(e){return t(e)}))}},{key:"rowEach",value:function(e,t,i){for(var n=0,r=this.rows,a=e;a<=t;a+=1){var l=r.getHeight(a);if(i(a,n,l),n+=l,n>this.viewHeight())break}}},{key:"colEach",value:function(e,t,i){for(var n=0,r=this.cols,a=e;a<=t;a+=1){var l=r.getWidth(a);if(i(a,n,l),n+=l,n>this.viewWidth())break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(e){for(var t=this.styles,i=0;i<t.length;i+=1){var n=t[i];if(H.equals(n,e))return i}return t.push(e),t.length-1}},{key:"changeData",value:function(e){this.history.add(this.getData()),e(),this.change(this.getData())}},{key:"setData",value:function(e){var t=this;return Object.keys(e).forEach((function(i){if("merges"===i||"rows"===i||"cols"===i||"validations"===i)t[i].setData(e[i]);else if("freeze"===i){var n=O(e[i]),r=Object(b["a"])(n,2),a=r[0],l=r[1];t.freeze=[l,a]}else void 0!==e[i]&&(t[i]=e[i])})),this}},{key:"getData",value:function(){var e=this.name,t=this.freeze,i=this.styles,n=this.merges,r=this.rows,a=this.cols,l=this.validations;return{name:e,freeze:j(t[1],t[0]),styles:i,merges:n.getData(),rows:r.getData(),cols:a.getData(),validations:l.getData()}}}]),e}();function fe(e,t,i){e.addEventListener(t,i)}function de(e,t,i){e.removeEventListener(t,i)}function ve(e){e.xclickoutside&&(de(window.document.body,"click",e.xclickoutside),delete e.xclickoutside)}function ge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){e.hide()};e.xclickoutside=function(i){2===i.detail||e.contains(i.target)||(t(e),ve(e))},fe(window.document.body,"click",e.xclickoutside)}function pe(e,t,i){fe(e,"mousemove",t);var n=e;n.xEvtUp=function(n){de(e,"mousemove",t),de(e,"mouseup",e.xEvtUp),i(n)},fe(e,"mouseup",e.xEvtUp)}function ye(e,t,i,n){var r="";Math.abs(e)>Math.abs(t)?(r=e>0?"right":"left",n(r,e,i)):(r=t>0?"down":"up",n(r,t,i))}function me(e,t){var i=t.move,n=t.end,r=0,a=0;fe(e,"touchstart",(function(e){var t=e.touches[0],i=t.pageX,n=t.pageY;r=i,a=n})),fe(e,"touchmove",(function(e){if(i){var t=e.changedTouches[0],n=t.pageX,l=t.pageY,s=n-r,o=l-a;(Math.abs(s)>10||Math.abs(o)>10)&&(ye(s,o,e,i),r=n,a=l),e.preventDefault()}})),fe(e,"touchend",(function(e){if(n){var t=e.changedTouches[0],i=t.pageX,l=t.pageY,s=i-r,o=l-a;ye(s,o,e,n)}}))}var be="x-spreadsheet",we=(window.devicePixelRatio,function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;Object(l["a"])(this,e),this.moving=!1,this.vertical=i,this.el=m("div","".concat(be,"-resizer ").concat(i?"vertical":"horizontal")).children(this.hoverEl=m("div","".concat(be,"-resizer-hover")).on("mousedown.stop",(function(e){return t.mousedownHandler(e)})),this.lineEl=m("div","".concat(be,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=n}return Object(s["a"])(e,[{key:"show",value:function(e,t){var i=this.moving,n=this.vertical,r=this.hoverEl,a=this.lineEl,l=this.el;if(!i){this.cRect=e;var s=e.left,o=e.top,c=e.width,h=e.height;l.offset({left:n?s+c-5:s,top:n?o:o+h-5}).show(),r.offset({width:n?5:c,height:n?h:5}),a.offset({width:n?0:t.width,height:n?t.height:0})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide()}},{key:"mousedownHandler",value:function(e){var t=this,i=e,n=this.el,r=this.lineEl,a=this.cRect,l=this.vertical,s=this.minDistance,o=l?a.width:a.height;r.show(),pe(window,(function(e){t.moving=!0,null!==i&&1===e.buttons&&(l?(o+=e.movementX,o>s&&n.css("left","".concat(a.left+o,"px"))):(o+=e.movementY,o>s&&n.css("top","".concat(a.top+o,"px"))),i=e)}),(function(){i=null,r.hide(),t.moving=!1,t.hide(),t.finishedFn&&(o<s&&(o=s),t.finishedFn(a,o))}))}}]),e}()),ke=function(){function e(t){var i=this;Object(l["a"])(this,e),this.vertical=t,this.moveFn=null,this.el=m("div","".concat(be,"-scrollbar ").concat(t?"vertical":"horizontal")).child(this.contentEl=m("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(e){var t=e.target,n=t.scrollTop,r=t.scrollLeft;i.moveFn&&i.moveFn(i.vertical?n:r,e)}))}return Object(s["a"])(e,[{key:"move",value:function(e){return this.el.scroll(e),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(e,t){var i=e-1;if(t>i){var n=this.vertical?"height":"width";this.el.css(n,"".concat(i,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(n,"".concat(t,"px"))}else this.el.hide();return this}}]),e}(),xe=3,Oe=10,Ce=function(){function e(){Object(l["a"])(this,e),this.cornerEl=m("div","".concat(be,"-selector-corner")),this.areaEl=m("div","".concat(be,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=m("div","".concat(be,"-selector-clipboard")).hide(),this.autofillEl=m("div","".concat(be,"-selector-autofill")).hide(),this.el=m("div","".concat(be,"-selector")).css("z-index","".concat(Oe)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),Oe+=1}return Object(s["a"])(e,[{key:"setOffset",value:function(e){return this.el.offset(e).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(e){var t=e.left,i=e.top,n=e.width,r=e.height;this.areaEl.offset({width:n-xe+.8,height:r-xe+.8,left:t-.8,top:i-.8}).show()}},{key:"setClipboardOffset",value:function(e){var t=e.left,i=e.top,n=e.width,r=e.height;this.clipboardEl.offset({left:t,top:i,width:n-5,height:r-5})}},{key:"showAutofill",value:function(e){var t=e.left,i=e.top,n=e.width,r=e.height;this.autofillEl.offset({width:n-xe,height:r-xe,left:t,top:i}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),e}();function je(e){var t=this.data,i=e.left,n=e.top,r=e.width,a=e.height,l=e.scroll,s=e.l,o=e.t,c=t.freezeTotalWidth(),h=t.freezeTotalHeight(),u=i-c;c>s&&(u-=l.x);var f=n-h;return h>o&&(f-=l.y),{left:u,top:f,width:r,height:a}}function Te(e){var t=this.data,i=e.left,n=e.width,r=e.height,a=e.l,l=e.t,s=e.scroll,o=t.freezeTotalWidth(),c=i-o;return o>a&&(c-=s.x),{left:c,top:l,width:n,height:r}}function Ee(e){var t=this.data,i=e.top,n=e.width,r=e.height,a=e.l,l=e.t,s=e.scroll,o=t.freezeTotalHeight(),c=i-o;return o>l&&(c-=s.y),{left:a,top:c,width:n,height:r}}function Se(e){var t=this.br;t.setAreaOffset(je.call(this,e))}function Fe(e){var t=this.tl;t.setAreaOffset(e)}function De(e){var t=this.t;t.setAreaOffset(Te.call(this,e))}function ze(e){var t=this.l;t.setAreaOffset(Ee.call(this,e))}function Ie(e){var t=this.l;t.setClipboardOffset(Ee.call(this,e))}function Re(e){var t=this.br;t.setClipboardOffset(je.call(this,e))}function Ae(e){var t=this.tl;t.setClipboardOffset(e)}function Ne(e){var t=this.t;t.setClipboardOffset(Te.call(this,e))}function We(e){Se.call(this,e),Fe.call(this,e),De.call(this,e),ze.call(this,e)}function Le(e){Re.call(this,e),Ae.call(this,e),Ne.call(this,e),Ie.call(this,e)}var qe=function(){function e(t){Object(l["a"])(this,e),this.data=t,this.br=new Ce,this.t=new Ce,this.l=new Ce,this.tl=new Ce,this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=m("div","".concat(be,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Oe+=1}return Object(s["a"])(e,[{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var e=this.data,t=this.tl,i=this.t,n=this.l,r=this.br,a=e.freezeTotalHeight(),l=e.freezeTotalWidth();a>0||l>0?(t.setOffset({width:l,height:a}),i.setOffset({left:l,height:a}),n.setOffset({top:a,width:l}),r.setOffset({left:l,top:a})):(t.hide(),i.hide(),n.hide(),r.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();We.call(this,e),Le.call(this,t),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();Se.call(this,e),De.call(this,e),Re.call(this,t),Ne.call(this,t),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();Se.call(this,e),ze.call(this,e),Re.call(this,t),Ie.call(this,t),this.resetOffset()}},{key:"set",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,r=n.calSelectedRangeByStart(e,t),a=r.sri,l=r.sci;if(i){var s=e,o=t;e<0&&(s=0),t<0&&(o=0),n.selector.setIndexes(s,o),this.indexes=[s,o]}this.moveIndexes=[a,l],this.range=r,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,r=this.lastri,a=this.lastci;if(i){if(e===r&&t===a)return;this.lastri=e,this.lastci=t}this.range=n.calSelectedRangeByEnd(e,t),We.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var e=this.data.selector.range,t=e.eri,i=e.eci;this.setEnd(t,i)}},{key:"showAutofill",value:function(e,t){if(-1!==e||-1!==t){var i=this.range,n=i.sri,r=i.sci,a=i.eri,l=i.eci,s=e,o=t,c=n-e,h=r-t,u=a-e,f=l-t;if(h>0)this.arange=new T(n,o,a,r-1);else if(c>0)this.arange=new T(s,r,n-1,l);else if(f<0)this.arange=new T(n,l+1,a,o);else{if(!(u<0))return void(this.arange=null);this.arange=new T(a+1,r,s,l)}if(null!==this.arange){var d=this.data.getRect(this.arange);d.width+=2,d.height+=2;var v=this.br,g=this.l,p=this.t,y=this.tl;v.showAutofill(je.call(this,d)),g.showAutofill(Ee.call(this,d)),p.showAutofill(Te.call(this,d)),y.showAutofill(d)}}}},{key:"hideAutofill",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideAutofill()}))}},{key:"showClipboard",value:function(){var e=this,t=this.data.getClipboardRect();Le.call(this,t),["br","l","t","tl"].forEach((function(t){e[t].showClipboard()}))}},{key:"hideClipboard",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideClipboard()}))}}]),e}(),Ve=(i("c975"),i("baa5"),i("841c"),i("2ca0"),i("2909"));function Me(e){e.preventDefault(),e.stopPropagation();var t=this.filterItems;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=t.length-1),t[this.itemIndex].toggle())}function He(e){e.stopPropagation();var t=this.filterItems;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>t.length-1&&(this.itemIndex=0),t[this.itemIndex].toggle())}function Pe(e){e.preventDefault();var t=this.filterItems;t.length<=0||(e.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),t[this.itemIndex].el.click(),this.hide())}function _e(e){var t=e.keyCode;switch(e.ctrlKey&&e.stopPropagation(),t){case 37:e.stopPropagation();break;case 38:Me.call(this,e);break;case 39:e.stopPropagation();break;case 40:He.call(this,e);break;case 13:Pe.call(this,e);break;case 9:Pe.call(this,e);break;default:e.stopPropagation();break}}var $e=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";Object(l["a"])(this,e),this.filterItems=[],this.items=t,this.el=m("div","".concat(be,"-suggest")).css("width",n).hide(),this.itemClick=i,this.itemIndex=-1}return Object(s["a"])(e,[{key:"setOffset",value:function(e){this.el.cssRemoveKeys("top","bottom").offset(e)}},{key:"hide",value:function(){var e=this.el;this.filterItems=[],this.itemIndex=-1,e.hide(),ve(this.el.parent())}},{key:"setItems",value:function(e){this.items=e,this.search("")}},{key:"search",value:function(e){var t,i=this,n=this.items;if(/^\s*$/.test(e)||(n=n.filter((function(t){return(t.key||t).startsWith(e.toUpperCase())}))),n=n.map((function(e){var t=e.title;t?"function"===typeof t&&(t=t()):t=e;var n=m("div","".concat(be,"-item")).child(t).on("click.stop",(function(){i.itemClick(e),i.hide()}));return e.label&&n.child(m("div","label").html(e.label)),n})),this.filterItems=n,!(n.length<=0)){var r=this.el;(t=r.html("")).children.apply(t,Object(Ve["a"])(n)).show(),ge(r.parent(),(function(){i.hide()}))}}},{key:"bindInputEvents",value:function(e){var t=this;e.on("keydown",(function(e){return _e.call(t,e)}))}}]),e}(),Be=(i("4d63"),function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(e){var n;return Object(l["a"])(this,i),n=t.call(this,"div","".concat(be,"-icon")),n.iconNameEl=m("div","".concat(be,"-icon-img ").concat(e)),n.child(n.iconNameEl),n}return Object(s["a"])(i,[{key:"setName",value:function(e){this.iconNameEl.className("".concat(be,"-icon-img ").concat(e))}}]),i}(y));function Ue(e,t){e.setMonth(e.getMonth()+t)}function Ye(e,t){var i=new Date(e);return i.setDate(t-e.getDay()+1),i}function Xe(e,t,i){for(var n=new Date(e,t,1,23,59,59),r=[[],[],[],[],[],[]],a=0;a<6;a+=1)for(var l=0;l<7;l+=1){var s=7*a+l,o=Ye(n,s),c=o.getMonth()!==t,h=o.getMonth()===i.getMonth()&&o.getDate()===i.getDate();r[a][l]={d:o,disabled:c,active:h}}return r}var Je=function(){function e(t){var i,n=this;Object(l["a"])(this,e),this.value=t,this.cvalue=new Date(t),this.headerLeftEl=m("div","calendar-header-left"),this.bodyEl=m("tbody",""),this.buildAll(),this.el=m("div","x-spreadsheet-calendar").children(m("div","calendar-header").children(this.headerLeftEl,m("div","calendar-header-right").children(m("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new Be("chevron-left")),m("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new Be("chevron-right")))),m("table","calendar-body").children(m("thead","").child((i=m("tr","")).children.apply(i,Object(Ve["a"])(X("calendar.weeks").map((function(e){return m("th","cell").child(e)}))))),this.bodyEl)),this.selectChange=function(){}}return Object(s["a"])(e,[{key:"setValue",value:function(e){this.value=e,this.cvalue=new Date(e),this.buildAll()}},{key:"prev",value:function(){var e=this.value;Ue(e,-1),this.buildAll()}},{key:"next",value:function(){var e=this.value;Ue(e,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var e=this.value;this.headerLeftEl.html("".concat(X("calendar.months")[e.getMonth()]," ").concat(e.getFullYear()))}},{key:"buildBody",value:function(){var e,t=this,i=this.value,n=this.cvalue,r=this.bodyEl,a=Xe(i.getFullYear(),i.getMonth(),n),l=a.map((function(e){var i,n=e.map((function(e){var i="cell";return e.disabled&&(i+=" disabled"),e.active&&(i+=" active"),m("td","").child(m("div",i).on("click.stop",(function(){t.selectChange(e.d)})).child(e.d.getDate().toString()))}));return(i=m("tr","")).children.apply(i,Object(Ve["a"])(n))}));(e=r.html("")).children.apply(e,Object(Ve["a"])(l))}}]),e}(),Ke=function(){function e(){Object(l["a"])(this,e),this.calendar=new Je(new Date),this.el=m("div","".concat(be,"-datepicker")).child(this.calendar.el).hide()}return Object(s["a"])(e,[{key:"setValue",value:function(e){var t=this.calendar;return"string"===typeof e?/^\d{4}-\d{1,2}-\d{1,2}$/.test(e)&&t.setValue(new Date(e.replace(new RegExp("-","g"),"/"))):e instanceof Date&&t.setValue(e),this}},{key:"change",value:function(e){var t=this;this.calendar.selectChange=function(i){e(i),t.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}]),e}();function Qe(){if(!/^\s*$/.test(this.inputText)){var e=this.textlineEl,t=this.textEl,i=this.areaOffset,n=e.offset().width+9,r=this.viewFn().width-i.left-9;if(n>i.width){var a=n;if(n>r){a=r;var l=parseInt(n/r,10);l+=n%r>0?1:0,l*=this.rowHeight,l>i.height&&t.css("height","".concat(l,"px"))}t.css("width","".concat(a,"px"))}}}function Ze(e){var t=e.target.value,i=this.suggest,n=this.textlineEl,r=this.validator;if(this.inputText=t,r)"list"===r.type?i.search(t):i.hide();else{var a=t.lastIndexOf("=");-1!==a?i.search(t.substring(a+1)):i.hide()}n.html(t),Qe.call(this),this.change("input",t)}function Ge(e){var t=this.textEl.el;setTimeout((function(){t.focus(),t.setSelectionRange(e,e)}),0)}function et(e,t){var i=this.textEl,n=this.textlineEl;i.el.blur(),i.val(e),n.html(e),Ge.call(this,t)}function tt(e){var t=this.inputText,i=this.validator,n=0;if(i&&"list"===i.type)this.inputText=e,n=this.inputText.length;else{var r=t.lastIndexOf("="),a=t.substring(0,r+1),l=t.substring(r+1);l=-1!==l.indexOf(")")?l.substring(l.indexOf(")")):"",this.inputText="".concat(a+e.key,"("),n=this.inputText.length,this.inputText+=")".concat(l)}et.call(this,this.inputText,n)}function it(){this.suggest.setItems(this.formulas)}function nt(e){var t=e.getMonth()+1,i=e.getDate();return t<10&&(t="0".concat(t)),i<10&&(i="0".concat(i)),"".concat(e.getFullYear(),"-").concat(t,"-").concat(i)}var rt=function(){function e(t,i,n){var r=this;Object(l["a"])(this,e),this.viewFn=i,this.rowHeight=n,this.formulas=t,this.suggest=new $e(t,(function(e){tt.call(r,e)})),this.datepicker=new Ke,this.datepicker.change((function(e){r.setText(nt(e)),r.clear()})),this.areaEl=m("div","".concat(be,"-editor-area")).children(this.textEl=m("textarea","").on("input",(function(e){return Ze.call(r,e)})),this.textlineEl=m("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=m("div","".concat(be,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}return Object(s["a"])(e,[{key:"setFreezeLengths",value:function(e,t){this.freeze.w=e,this.freeze.h=t}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),it.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",i=this.textEl,n=this.areaEl,r=this.suggest,a=this.freeze,l=this.el;if(e){this.areaOffset=e;var s=e.left,o=e.top,c=e.width,h=e.height,u=e.l,f=e.t,d={left:0,top:0};a.w>u&&a.h>f||(a.w<u&&a.h<f?(d.left=a.w,d.top=a.h):a.w>u?d.top=a.h:a.h>f&&(d.left=a.w)),l.offset(d),n.offset({left:s-d.left-.8,top:o-d.top-.8}),i.offset({width:c-9+.8,height:h-3+.8});var v={left:0};v[t]=h,r.setOffset(v),r.hide()}}},{key:"setCell",value:function(e,t){var i=this.el,n=this.datepicker,r=this.suggest;i.show(),this.cell=e;var a=e&&e.text||"";if(this.setText(a),this.validator=t,t){var l=t.type;"date"===l&&(n.show(),/^\s*$/.test(a)||n.setValue(a)),"list"===l&&r.setItems(t.values())}}},{key:"setText",value:function(e){this.inputText=e,et.call(this,e,e.length),Qe.call(this)}}]),e}(),at=[{key:"copy",title:J("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:J("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:J("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:J("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:J("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:J("contextmenu.insertRow")},{key:"insert-column",title:J("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:J("contextmenu.deleteRow")},{key:"delete-column",title:J("contextmenu.deleteColumn")},{key:"delete-cell-text",title:J("contextmenu.deleteCellText")},{key:"divider"},{key:"validation",title:J("contextmenu.validation")}];function lt(e){var t=this;return"divider"===e.key?m("div","".concat(be,"-item divider")):m("div","".concat(be,"-item")).on("click",(function(){t.itemClick(e.key),t.hide()})).children(e.title(),m("div","label").child(e.label||""))}function st(){var e=this;return at.map((function(t){return lt.call(e,t)}))}var ot=function(){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(l["a"])(this,e),this.el=(i=m("div","".concat(be,"-contextmenu"))).children.apply(i,Object(Ve["a"])(st.call(this))).hide(),this.viewFn=t,this.itemClick=function(){},this.isHide=n}return Object(s["a"])(e,[{key:"hide",value:function(){var e=this.el;e.hide(),ve(e)}},{key:"setPosition",value:function(e,t){if(!this.isHide){var i=this.el,n=i.show().offset(),r=n.height,a=n.width,l=this.viewFn(),s=t,o=e;l.height-t<=r&&(s-=r),l.width-e<=a&&(o-=a),i.offset({left:o,top:s}),ge(i)}}}]),e}(),ct=(i("2315"),[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}]),ht=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function ut(e){for(var t=0;t<ht.length;t+=1){var i=ht[t];if(i.pt===e)return i.px}return e}i("a15b");var ft=function(e){for(var t=[],i=[],n=[],r=0,a=1,l=0;l<e.length;l+=1){var s=e.charAt(l);if(" "!==s)if(s>="a"&&s<="z")n.push(s.toUpperCase());else if(s>="0"&&s<="9"||s>="A"&&s<="Z"||"."===s)n.push(s);else if('"'===s){l+=1;while('"'!==e.charAt(l))n.push(e.charAt(l)),l+=1;i.push('"'.concat(n.join(""))),n=[]}else{if("("!==s&&n.length>0&&i.push(n.join("")),")"===s){var o=t.pop();if(2===r)try{for(var c=O(i.pop()),h=Object(b["a"])(c,2),u=h[0],f=h[1],d=O(i.pop()),v=Object(b["a"])(d,2),g=v[0],p=v[1],y=0,m=g;m<=u;m+=1)for(var w=p;w<=f;w+=1)i.push(j(m,w)),y+=1;i.push([o,y])}catch(x){}else if(1===r)i.push([o,a]),a=1;else while("("!==o){if(i.push(o),t.length<=0)break;o=t.pop()}r=0}else if(":"===s)r=2;else if(","===s)r=1,a+=1;else if("("===s&&n.length>0)t.push(n.join(""));else{if(t.length>0&&("+"===s||"-"===s)){var k=t[t.length-1];if("("!==k&&i.push(t.pop()),"*"===k||"/"===k)while(t.length>0){if(k=t[t.length-1],"("===k)break;i.push(t.pop())}}t.push(s)}n=[]}}n.length>0&&i.push(n.join(""));while(t.length>0)i.push(t.pop());return i},dt=function(e,t){if(e[0]>="0"&&e[0]<="9")return Number(e);if('"'===e[0])return e.substring(1);var i=O(e),n=Object(b["a"])(i,2),r=n[0],a=n[1];return t(r,a)},vt=function(e,t,i,n){for(var r=[],a=0;a<e.length;a+=1)if("+"===e[a]){var l=r.pop();r.push(Number(r.pop())+Number(l))}else if("-"===e[a]){var s=r.pop();r.push(Number(r.pop())-Number(s))}else if("*"===e[a])r.push(Number(r.pop())*Number(r.pop()));else if("/"===e[a]){var o=r.pop();r.push(Number(r.pop())/Number(o))}else if(Array.isArray(e[a])){for(var c=Object(b["a"])(e[a],2),h=c[0],u=c[1],f=[],d=0;d<u;d+=1)f.push(r.pop());r.push(t[h].render(f.reverse()))}else{if(n.includes(e[a]))return 0;n.push(e[a]),r.push(dt(e[a],i))}return r[0]},gt=function e(t,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===t[0]){var a=ft(t.substring(1));return a.length<=0?t:vt(a,i,(function(t,a){return e(n(t,a),i,n,r)}),r)}return t},pt={render:gt},yt=(i("13d5"),[{key:"SUM",title:J("formula.sum"),render:function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}),0)}},{key:"AVERAGE",title:J("formula.average"),render:function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}),0)/e.length}},{key:"MAX",title:J("formula.max"),render:function(e){return Math.max.apply(Math,Object(Ve["a"])(e.map((function(e){return Number(e)}))))}},{key:"MIN",title:J("formula.min"),render:function(e){return Math.min.apply(Math,Object(Ve["a"])(e.map((function(e){return Number(e)}))))}},{key:"CONCAT",title:J("formula.concat"),render:function(e){return e.join("")}}]),mt=yt,bt={};yt.forEach((function(e){bt[e.key]=e}));i("b680");var wt=function(e){return e},kt=function(e){if(/^(-?\d*.?\d*)$/.test(e)){var t=Number(e).toFixed(2).toString(),i=t.split("\\."),n=p(i),r=n[0],a=n.slice(1);return[r.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(Object(Ve["a"])(a))}return e},xt=[{key:"normal",title:J("format.normal"),type:"string",render:wt},{key:"text",title:J("format.text"),type:"string",render:wt},{key:"number",title:J("format.number"),type:"number",label:"1,000.12",render:kt},{key:"percent",title:J("format.percent"),type:"number",label:"10.12%",render:function(e){return"".concat(e,"%")}},{key:"rmb",title:J("format.rmb"),type:"number",label:"￥10.00",render:function(e){return"￥".concat(kt(e))}},{key:"usd",title:J("format.usd"),type:"number",label:"$10.00",render:function(e){return"$".concat(kt(e))}},{key:"date",title:J("format.date"),type:"date",label:"26/09/2008",render:wt},{key:"time",title:J("format.time"),type:"date",label:"15:59:00",render:wt},{key:"datetime",title:J("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:wt},{key:"duration",title:J("format.duration"),type:"date",label:"24:01:00",render:wt}],Ot={};xt.forEach((function(e){Ot[e.key]=e}));i("cb29"),i("cc71");function Ct(){return window.devicePixelRatio||1}function jt(){return Ct()-.5}function Tt(e){return parseInt(e*Ct(),10)}function Et(e){var t=Tt(e);return t>0?t-.5:.5}var St=function(){function e(t,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Object(l["a"])(this,e),this.x=t,this.y=i,this.width=n,this.height=r,this.padding=a,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return Object(s["a"])(e,[{key:"setBorders",value:function(e){var t=e.top,i=e.bottom,n=e.left,r=e.right;t&&(this.borderTop=t),r&&(this.borderRight=r),i&&(this.borderBottom=i),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding}},{key:"innerHeight",value:function(){return this.height-2*this.padding}},{key:"textx",value:function(e){var t=this.width,i=this.padding,n=this.x;return"left"===e?n+=i:"center"===e?n+=t/2:"right"===e&&(n+=t-i),n}},{key:"texty",value:function(e,t,i){var n=this.height,r=this.padding,a=this.y;return"top"===e?a+=r:"middle"===e?a=a+n/2-i:"bottom"===e&&(a+=n-2*i-r),a}},{key:"topxys",value:function(){var e=this.x,t=this.y,i=this.width;return[[e,t],[e+i,t]]}},{key:"rightxys",value:function(){var e=this.x,t=this.y,i=this.width,n=this.height;return[[e+i,t],[e+i,t+n]]}},{key:"bottomxys",value:function(){var e=this.x,t=this.y,i=this.width,n=this.height;return[[e,t+n],[e+i,t+n]]}},{key:"leftxys",value:function(){var e=this.x,t=this.y,i=this.height;return[[e,t],[e,t+i]]}}]),e}();function Ft(e,t,i,n,r,a,l){var s={x:0,y:0};"underline"===e?s.y="bottom"===r?0:"top"===r?-(a+2):-a/2:"strike"===e&&("bottom"===r?s.y=a/2:"top"===r&&(s.y=-(a/2+2))),"center"===n?s.x=l/2:"right"===n&&(s.x=l),this.line([t-s.x,i-s.y],[t-s.x+l,i-s.y])}var Dt=function(){function e(t,i,n){Object(l["a"])(this,e),this.el=t,this.ctx=t.getContext("2d"),this.resize(i,n),this.ctx.scale(Ct(),Ct())}return Object(s["a"])(e,[{key:"resize",value:function(e,t){this.el.style.width="".concat(e,"px"),this.el.style.height="".concat(t,"px"),this.el.width=Tt(e),this.el.height=Tt(t)}},{key:"clear",value:function(){var e=this.el,t=e.width,i=e.height;return this.ctx.clearRect(0,0,t,i),this}},{key:"attr",value:function(e){return Object.assign(this.ctx,e),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(e,t){return this.ctx.translate(Tt(e),Tt(t)),this}},{key:"clearRect",value:function(e,t,i,n){return this.ctx.clearRect(e,t,i,n),this}},{key:"fillRect",value:function(e,t,i,n){return this.ctx.fillRect(Tt(e)-.5,Tt(t)-.5,Tt(i),Tt(n)),this}},{key:"fillText",value:function(e,t,i){return this.ctx.fillText(e,Tt(t),Tt(i)),this}},{key:"text",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=this.ctx,a=i.align,l=i.valign,s=i.font,o=i.color,c=i.strike,h=i.underline,u=t.textx(a);r.save(),r.beginPath(),this.attr({textAlign:a,textBaseline:l,font:"".concat(s.italic?"italic":""," ").concat(s.bold?"bold":""," ").concat(Tt(s.size),"px ").concat(s.name),fillStyle:o,strokeStyle:o});var f=r.measureText(e).width,d=0;if(n){var v=Math.ceil(f/t.innerWidth());d=(v-1)*s.size/2}var g=t.texty(l,s.size,d);if(n&&f>t.innerWidth()){for(var p={len:0,start:0},y=0;y<e.length;y+=1)p.len>=t.innerWidth()&&(this.fillText(e.substring(p.start,y),u,g),c&&Ft.call(this,"strike",u,g,a,l,s.size,p.len),h&&Ft.call(this,"underline",u,g,a,l,s.size,p.len),g+=s.size+2,p.len=0,p.start=y),p.len+=r.measureText(e[y]).width;n&&p.len>0&&(this.fillText(e.substring(p.start),u,g),c&&Ft.call(this,"strike",u,g,a,l,s.size,p.len),h&&Ft.call(this,"underline",u,g,a,l,s.size,p.len))}else this.fillText(e,u,g),c&&Ft.call(this,"striket",u,g,a,l,s.size,f),h&&Ft.call(this,"underline",u,g,a,l,s.size,f);return r.restore(),this}},{key:"border",value:function(e,t){var i=this.ctx;return i.lineWidth=jt,i.strokeStyle=t,"medium"===e?i.lineWidth=Tt(2)-.5:"thick"===e?i.lineWidth=Tt(3):"dashed"===e?i.setLineDash([Tt(3),Tt(2)]):"dotted"===e?i.setLineDash([Tt(1),Tt(1)]):"double"===e&&i.setLineDash([Tt(2),0]),this}},{key:"line",value:function(){var e=this.ctx;if(arguments.length>1){var t=arguments.length<=0?void 0:arguments[0],i=Object(b["a"])(t,2),n=i[0],r=i[1];e.moveTo(Et(n),Et(r));for(var a=1;a<arguments.length;a+=1){var l=a<0||arguments.length<=a?void 0:arguments[a],s=Object(b["a"])(l,2),o=s[0],c=s[1];e.lineTo(Et(o),Et(c))}e.stroke()}return this}},{key:"strokeBorders",value:function(e){var t=this.ctx;t.save(),t.beginPath();var i=e.borderTop,n=e.borderRight,r=e.borderBottom,a=e.borderLeft;i&&(this.border.apply(this,Object(Ve["a"])(i)),this.line.apply(this,Object(Ve["a"])(e.topxys()))),n&&(this.border.apply(this,Object(Ve["a"])(n)),this.line.apply(this,Object(Ve["a"])(e.rightxys()))),r&&(this.border.apply(this,Object(Ve["a"])(r)),this.line.apply(this,Object(Ve["a"])(e.bottomxys()))),a&&(this.border.apply(this,Object(Ve["a"])(a)),this.line.apply(this,Object(Ve["a"])(e.leftxys()))),t.restore()}},{key:"error",value:function(e){var t=this.ctx,i=e.x,n=e.y,r=e.width,a=i+r-1;t.save(),t.beginPath(),t.moveTo(Tt(a-8),Tt(n-1)),t.lineTo(Tt(a),Tt(n-1)),t.lineTo(Tt(a),Tt(n+8)),t.closePath(),t.fillStyle="rgba(255, 0, 0, .65)",t.fill(),t.restore()}},{key:"rect",value:function(e,t){var i=this.ctx,n=e.x,r=e.y,a=e.width,l=e.height,s=e.bgcolor;i.save(),i.beginPath(),i.fillStyle=s||"#fff",i.rect(Et(n+1),Et(r+1),Tt(a-2),Tt(l-2)),i.clip(),i.fill(),t(),i.restore()}}]),e}(),zt=5,It={fillStyle:"#f4f5f8"},Rt={fillStyle:"#fff",lineWidth:jt,strokeStyle:"#e6e6e6"};function At(){return{textAlign:"center",textBaseline:"middle",font:"500 ".concat(Tt(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:jt(),strokeStyle:"#e6e6e6"}}function Nt(e,t){var i=this.data,n=i.cellRect(e,t),r=n.left,a=n.top,l=n.width,s=n.height;return new St(r,a,l,s,zt)}function Wt(){var e=this.draw,t=this.bboxes;t&&t.forEach((function(t){return e.strokeBorders(t)}))}function Lt(e,t){var i=this.draw,n=this.data,r=n.getCell(e,t);if(null!==r){var a=n.getCellStyleOrDefault(e,t),l=Nt.call(this,e,t);l.bgcolor=a.bgcolor,void 0!==a.border&&(l.setBorders(a.border),this.bboxes.push(l)),i.rect(l,(function(){var s=pt.render(r.text||"",bt,(function(e,t){return n.getCellTextOrDefault(t,e)}));a.format&&(s=Ot[a.format].render(s));var o=Object.assign({},a.font);o.size=ut(o.size),i.text(s,l,{align:a.align,valign:a.valign,font:o,color:a.color,strike:a.strike,underline:a.underline},a.textwrap);var c=n.validations.getError(e,t);c&&i.error(l)}))}}function qt(e,t,i,n,r){var a=this,l=this.draw,s=this.data;l.save(),l.translate(t,i).translate(n,r),this.bboxes=[],e.each((function(e,t){Lt.call(a,e,t)})),Wt.call(this),this.bboxes=[],s.eachMergesInView(e,(function(e){Lt.call(a,e.sri,e.sci)})),Wt.call(this),l.restore()}function Vt(e,t,i,n){var r=this.draw;r.save(),r.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(e,t,i,n),r.restore()}function Mt(e,t,i,n,r,a){var l=this,s=this.draw,o=this.data,c=t.h,h=t.w,u=a+n,f=r+i;s.save(),s.attr(It),"all"!==e&&"left"!==e||s.fillRect(0,u,i,c),"all"!==e&&"top"!==e||s.fillRect(f,0,h,n);var d=o.selector.range,v=d.sri,g=d.sci,p=d.eri,y=d.eci;s.attr(At()),"all"!==e&&"left"!==e||(o.rowEach(t.sri,t.eri,(function(e,t,n){var r=u+t,a=e;s.line([0,r],[i,r]),v<=a&&a<p+1&&Vt.call(l,0,r,i,n),s.fillText(a+1,i/2,r+n/2)})),s.line([0,c+u],[i,c+u]),s.line([i,u],[i,c+u])),"all"!==e&&"top"!==e||(o.colEach(t.sci,t.eci,(function(e,t,i){var r=f+t,a=e;s.line([r,0],[r,n]),g<=a&&a<y+1&&Vt.call(l,r,0,i,n),s.fillText(k(a),r+i/2,n/2)})),s.line([h+f,0],[h+f,n]),s.line([0,n],[h+f,n])),s.restore()}function Ht(e,t){var i=this.draw;i.save(),i.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,e,t),i.restore()}function Pt(e,t,i,n,r){var a=e.sri,l=e.sci,s=e.eri,o=e.eci,c=e.w,h=e.h,u=this.draw,f=this.data,d=f.settings;u.save(),u.attr(Rt).translate(t+n,i+r),u.clearRect(0,0,c,h),d.showGrid?(f.rowEach(a,s,(function(e,t,i){e!==a&&u.line([0,t],[c,t]),e===s&&u.line([0,t+i],[c,t+i])})),f.colEach(l,o,(function(e,t,i){e!==l&&u.line([t,0],[t,h]),e===o&&u.line([t+i,0],[t+i,h])})),u.restore()):u.restore()}function _t(e,t,i,n){var r=this.draw,a=this.data,l=a.viewWidth()-e,s=a.viewHeight()-t;r.save().translate(e,t).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),r.line([0,n],[l,n]),r.line([i,0],[i,s]),r.restore()}var $t=function(){function e(t,i){Object(l["a"])(this,e),this.el=t,this.draw=new Dt(t,i.viewWidth(),i.viewHeight()),this.data=i}return Object(s["a"])(e,[{key:"render",value:function(){var e=this.data,t=e.rows,i=e.cols,n=i.indexWidth,r=t.height;this.draw.resize(e.viewWidth(),e.viewHeight()),this.clear();var a=e.viewRange(),l=e.freezeTotalWidth(),s=e.freezeTotalHeight(),o=e.scroll,c=o.x,h=o.y;Pt.call(this,a,n,r,l,s),Mt.call(this,"all",a,n,r,l,s),qt.call(this,a,n,r,-c,-h),Ht.call(this,n,r);var u=Object(b["a"])(e.freeze,2),f=u[0],d=u[1];if(f>0||d>0){if(f>0){var v=a.clone();v.sri=0,v.eri=f-1,v.h=s,Pt.call(this,v,n,r,l,0),Mt.call(this,"top",v,n,r,l,0),qt.call(this,v,n,r,-c,0)}if(d>0){var g=a.clone();g.sci=0,g.eci=d-1,g.w=l,Pt.call(this,g,n,r,0,s),Mt.call(this,"left",g,n,r,0,s),qt.call(this,g,n,r,0,-h)}var p=e.freezeViewRange();Pt.call(this,p,n,r,0,0),Mt.call(this,"all",p,n,r,0,0),qt.call(this,p,n,r,0,0),_t.call(this,n,r,l,s)}}},{key:"clear",value:function(){this.draw.clear()}}]),e}(),Bt=$t;function Ut(e,t){if(!t.classList.contains("active")){var i=t.getBoundingClientRect(),n=i.left,r=i.top,a=i.width,l=i.height,s=m("div","".concat(be,"-tooltip")).html(e).show();document.body.appendChild(s.el);var o=s.box();s.css("left","".concat(n+a/2-o.width/2,"px")).css("top","".concat(r+l+2,"px")),fe(t,"mouseleave",(function(){document.body.contains(s.el)&&document.body.removeChild(s.el)})),fe(t,"click",(function(){document.body.contains(s.el)&&document.body.removeChild(s.el)}))}}var Yt=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(e,n,r,a){var s,o;Object(l["a"])(this,i),o=t.call(this,"div","".concat(be,"-dropdown ").concat(a)),o.title=e,o.change=function(){},"string"===typeof e?o.title=m("div","".concat(be,"-dropdown-title")).child(e):r&&o.title.addClass("arrow-left");for(var c=arguments.length,h=new Array(c>4?c-4:0),u=4;u<c;u++)h[u-4]=arguments[u];return o.contentEl=(s=m("div","".concat(be,"-dropdown-content"))).children.apply(s,h).css("width",n).hide(),o.headerEl=m("div","".concat(be,"-dropdown-header")),o.headerEl.on("click",(function(){"block"!==o.contentEl.css("display")?o.show():o.hide()})).children(o.title,r?m("div","".concat(be,"-icon arrow-right")).child(m("div","".concat(be,"-icon-img arrow-down"))):""),o.children(o.headerEl,o.contentEl),o}return Object(s["a"])(i,[{key:"setTitle",value:function(e){this.title.html(e),this.hide()}},{key:"show",value:function(){var e=this,t=this.contentEl;t.show(),this.parent().active(),ge(this.parent(),(function(){e.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),ve(this.parent())}}]),i}(y),Xt=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(){var e;Object(l["a"])(this,i);var n=ct.map((function(t){return m("div","".concat(be,"-item")).on("click",(function(){e.setTitle(t.title),e.change(t)})).child(t.title)}));return e=t.call.apply(t,[this,ct[0].title,"160px",!0,"bottom-left"].concat(Object(Ve["a"])(n)))}return i}(Yt),Jt=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(){var e;Object(l["a"])(this,i);var n=ht.map((function(t){return m("div","".concat(be,"-item")).on("click",(function(){e.setTitle("".concat(t.pt)),e.change(t)})).child("".concat(t.pt))}));return e=t.call.apply(t,[this,"10","60px",!0,"bottom-left"].concat(Object(Ve["a"])(n)))}return i}(Yt),Kt=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(){var e;Object(l["a"])(this,i);var n=xt.slice(0);return n.splice(2,0,{key:"divider"}),n.splice(7,0,{key:"divider"}),n=n.map((function(t){var i=m("div","".concat(be,"-item"));return"divider"===t.key?i.addClass("divider"):(i.child(t.title()).on("click",(function(){e.setTitle(t.title()),e.change(t)})),t.label&&i.child(m("div","label").html(t.label))),i})),e=t.call.apply(t,[this,"Normal","220px",!0,"bottom-left"].concat(Object(Ve["a"])(n)))}return Object(s["a"])(i,[{key:"setTitle",value:function(e){for(var t=0;t<xt.length;t+=1)xt[t].key===e&&this.title.html(xt[t].title);this.hide()}}]),i}(Yt),Qt=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(){var e;Object(l["a"])(this,i);var n=yt.map((function(t){return m("div","".concat(be,"-item")).on("click",(function(){e.hide(),e.change(t)})).child(t.key)}));return e=t.call.apply(t,[this,new Be("formula"),"180px",!0,"bottom-left"].concat(Object(Ve["a"])(n)))}return i}(Yt),Zt=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Gt=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],ei=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function ti(e){var t=this;return m("td","").child(m("div","".concat(be,"-color-palette-cell")).on("click.stop",(function(){return t.change(e)})).css("background-color",e))}var ii=function e(){var t,i,n,r=this;Object(l["a"])(this,e),this.el=m("div","".concat(be,"-color-palette")),this.change=function(){};var a=m("table","").children((t=m("tbody","")).children.apply(t,[(i=m("tr","".concat(be,"-theme-color-placeholders"))).children.apply(i,Object(Ve["a"])(Zt.map((function(e){return ti.call(r,e)}))))].concat(Object(Ve["a"])(Gt.map((function(e){var t;return(t=m("tr","".concat(be,"-theme-colors"))).children.apply(t,Object(Ve["a"])(e.map((function(e){return ti.call(r,e)}))))}))),[(n=m("tr","".concat(be,"-standard-colors"))).children.apply(n,Object(Ve["a"])(ei.map((function(e){return ti.call(r,e)}))))])));this.el.child(a)},ni=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(e,n){var r;Object(l["a"])(this,i);var a=new Be(e).css("height","16px").css("border-bottom","3px solid ".concat(n)),s=new ii;return s.change=function(e){r.setTitle(e),r.change(e)},r=t.call(this,a,"auto",!1,"bottom-left",s.el)}return Object(s["a"])(i,[{key:"setTitle",value:function(e){this.title.css("border-color",e),this.hide()}}]),i}(Yt);function ri(e){return m("div","".concat(be,"-item")).child(new Be(e))}var ai=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(e,n){var r;Object(l["a"])(this,i);var a=new Be("align-".concat(n)),s=e.map((function(e){return ri("align-".concat(e)).on("click",(function(){r.setTitle(e),r.change(e)}))}));return r=t.call.apply(t,[this,a,"auto",!0,"bottom-left"].concat(Object(Ve["a"])(s)))}return Object(s["a"])(i,[{key:"setTitle",value:function(e){this.title.setName("align-".concat(e)),this.hide()}}]),i}(Yt),li=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],si=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(e){var n;Object(l["a"])(this,i);var r=new Be("line-type"),a=0,s=li.map((function(t,i){return m("div","".concat(be,"-item state ").concat(e===t[0]?"checked":"")).on("click",(function(){s[a].toggle("checked"),s[i].toggle("checked"),a=i,n.hide(),n.change(t)})).child(m("div","".concat(be,"-line-type")).html(t[1]))}));return n=t.call.apply(t,[this,r,"auto",!1,"bottom-left"].concat(Object(Ve["a"])(s)))}return i}(Yt);function oi(){var e;return m("table","").child((e=m("tbody","")).children.apply(e,arguments))}function ci(e){var t=this;return m("td","").child(m("div","".concat(be,"-border-palette-cell")).child(new Be("border-".concat(e))).on("click",(function(){t.mode=e;var i=t.mode,n=t.style,r=t.color;t.change({mode:i,style:n,color:r})})))}var hi=function e(){var t,i,n=this;Object(l["a"])(this,e),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new ni("line-color",this.color),this.ddColor.change=function(e){n.color=e},this.ddType=new si(this.style),this.ddType.change=function(e){var t=Object(b["a"])(e,1),i=t[0];n.style=i},this.el=m("div","".concat(be,"-border-palette"));var r=oi(m("tr","").children(m("td","".concat(be,"-border-palette-left")).child(oi((t=m("tr","")).children.apply(t,Object(Ve["a"])(["all","inside","horizontal","vertical","outside"].map((function(e){return ci.call(n,e)})))),(i=m("tr","")).children.apply(i,Object(Ve["a"])(["left","top","right","bottom","none"].map((function(e){return ci.call(n,e)})))))),m("td","".concat(be,"-border-palette-right")).children(m("div","".concat(be,"-toolbar-btn")).child(this.ddColor.el),m("div","".concat(be,"-toolbar-btn")).child(this.ddType.el))));this.el.child(r)},ui=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(){var e;Object(l["a"])(this,i);var n=new Be("border-all"),r=new hi;return r.change=function(t){e.change(t),e.hide()},e=t.call(this,n,"auto",!1,"bottom-left",r.el)}return i}(Yt);function fi(e){return new Be(e)}function di(e){return m("div","".concat(be,"-toolbar-btn")).on("mouseenter",(function(t){Ut(e,t.target)})).attr("data-tooltip",e)}function vi(){return m("div","".concat(be,"-toolbar-divider"))}function gi(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return di(e).child(fi(t)).on("click",(function(){return i()}))}function pi(){var e=this;this.ddFormat.change=function(t){return e.change("format",t.key)},this.ddFont.change=function(t){return e.change("font-name",t.key)},this.ddFormula.change=function(t){return e.change("formula",t.key)},this.ddFontSize.change=function(t){return e.change("font-size",t.pt)},this.ddTextColor.change=function(t){return e.change("color",t)},this.ddFillColor.change=function(t){return e.change("bgcolor",t)},this.ddAlign.change=function(t){return e.change("align",t)},this.ddVAlign.change=function(t){return e.change("valign",t)},this.ddBorder.change=function(t){return e.change("border",t)}}function yi(e){var t=e,i=e.split("-");i.length>1&&i.forEach((function(e,i){0===i?t=e:t+=e[0].toUpperCase()+e.substring(1)}));var n=this["".concat(t,"El")];n.toggle(),this.change(e,n.hasClass("active"))}var mi=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(){var e;Object(l["a"])(this,i);var n=new Be("ellipsis"),r=m("div","".concat(be,"-toolbar-more"));return e=t.call(this,n,"auto",!1,"bottom-right",r),e.moreBtns=r,e.contentEl.css("max-width","420px"),e}return i}(Yt);function bi(){this.btns2=this.btnChildren.map((function(e){var t=e.box(),i=e.computedStyle(),n=i.marginLeft,r=i.marginRight;return[e,t.width+parseInt(n,10)+parseInt(r,10)]}))}function wi(){var e,t,i=this.el,n=this.btns,r=this.moreEl,a=this.ddMore,l=this.btns2,s=a.moreBtns,o=a.contentEl;i.css("width","".concat(this.widthFn()-60,"px"));var c=i.box(),h=160,u=12,f=[],d=[];l.forEach((function(e,t){var i=Object(b["a"])(e,2),n=i[0],r=i[1];h+=r,t===l.length-1||h<c.width?f.push(n):(u+=r,d.push(n))})),(e=n.html("")).children.apply(e,f),(t=s.html("")).children.apply(t,d),o.css("width","".concat(u,"px")),d.length>0?r.show():r.hide()}var ki=function(){function e(t,i){var n,r=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(l["a"])(this,e),this.data=t,this.change=function(){},this.widthFn=i;var s=t.defaultStyle();this.ddFormat=new Kt,this.ddFont=new Xt,this.ddFormula=new Qt,this.ddFontSize=new Jt,this.ddTextColor=new ni("text-color",s.color),this.ddFillColor=new ni("fill-color",s.bgcolor),this.ddAlign=new ai(["left","center","right"],s.align),this.ddVAlign=new ai(["top","middle","bottom"],s.valign),this.ddBorder=new ui,this.ddMore=new mi,this.btnChildren=[this.undoEl=gi("".concat(X("toolbar.undo")," (Ctrl+Z)"),"undo",(function(){return r.change("undo")})),this.redoEl=gi("".concat(X("toolbar.undo")," (Ctrl+Y)"),"redo",(function(){return r.change("redo")})),this.paintformatEl=gi("".concat(X("toolbar.paintformat")),"paintformat",(function(){return yi.call(r,"paintformat")})),this.clearformatEl=gi("".concat(X("toolbar.clearformat")),"clearformat",(function(){return r.change("clearformat")})),vi(),di("".concat(X("toolbar.format"))).child(this.ddFormat.el),vi(),di("".concat(X("toolbar.font"))).child(this.ddFont.el),di("".concat(X("toolbar.fontSize"))).child(this.ddFontSize.el),vi(),this.fontBoldEl=gi("".concat(X("toolbar.fontBold")," (Ctrl+B)"),"bold",(function(){return yi.call(r,"font-bold")})),this.fontItalicEl=gi("".concat(X("toolbar.fontItalic")," (Ctrl+I)"),"italic",(function(){return yi.call(r,"font-italic")})),this.underlineEl=gi("".concat(X("toolbar.underline")," (Ctrl+U)"),"underline",(function(){return yi.call(r,"underline")})),this.strikeEl=gi("".concat(X("toolbar.strike")),"strike",(function(){return yi.call(r,"strike")})),di("".concat(X("toolbar.textColor"))).child(this.ddTextColor.el),vi(),di("".concat(X("toolbar.fillColor"))).child(this.ddFillColor.el),di("".concat(X("toolbar.border"))).child(this.ddBorder.el),this.mergeEl=gi("".concat(X("toolbar.merge")),"merge",(function(){return yi.call(r,"merge")})),vi(),di("".concat(X("toolbar.align"))).child(this.ddAlign.el),di("".concat(X("toolbar.valign"))).child(this.ddVAlign.el),this.textwrapEl=gi("".concat(X("toolbar.textwrap")),"textwrap",(function(){return yi.call(r,"textwrap")})),vi(),di("".concat(X("toolbar.formula"))).child(this.ddFormula.el),this.moreEl=di("".concat(X("toolbar.more"))).child(this.ddMore.el).hide()],this.el=m("div","".concat(be,"-toolbar")),this.btns=(n=m("div","".concat(be,"-toolbar-btns"))).children.apply(n,Object(Ve["a"])(this.btnChildren)),this.el.child(this.btns),a&&this.el.hide(),pi.call(this),this.reset(),setTimeout((function(){bi.call(r),wi.call(r)}),0),fe(window,"resize",(function(){wi.call(r)}))}return Object(s["a"])(e,[{key:"paintformatActive",value:function(){return this.paintformatEl.hasClass("active")}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(e){yi.call(this,e)}},{key:"reset",value:function(){var e=this.data,t=e.getSelectedCellStyle(),i=e.getSelectedCell();this.undoEl.disabled(!e.canUndo()),this.redoEl.disabled(!e.canRedo()),this.mergeEl.active(e.canUnmerge()).disabled(!e.selector.multiple());var n=t.font;this.ddFont.setTitle(n.name),this.ddFontSize.setTitle(n.size),this.fontBoldEl.active(n.bold),this.fontItalicEl.active(n.italic),this.underlineEl.active(t.underline),this.strikeEl.active(t.strike),this.ddTextColor.setTitle(t.color),this.ddFillColor.setTitle(t.bgcolor),this.ddAlign.setTitle(t.align),this.ddVAlign.setTitle(t.valign),this.textwrapEl.active(t.textwrap),i&&i.format&&this.ddFormat.setTitle(i.format)}}]),e}(),xi=function(){function e(t,i){var n,r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";Object(l["a"])(this,e),this.title=t,this.el=m("div","".concat(be,"-modal")).css("width",a).children(m("div","".concat(be,"-modal-header")).children(new Be("close").on("click.stop",(function(){return r.hide()})),this.title),(n=m("div","".concat(be,"-modal-content"))).children.apply(n,Object(Ve["a"])(i))).hide()}return Object(s["a"])(e,[{key:"show",value:function(){var e=this;this.dimmer=m("div","".concat(be,"-dimmer active")),document.body.appendChild(this.dimmer.el);var t=this.el.show().box(),i=t.width,n=t.height,r=document.documentElement,a=r.clientHeight,l=r.clientWidth;this.el.offset({left:(l-i)/2,top:(a-n)/3}),window.xkeydownEsc=function(t){27===t.keyCode&&e.hide()},fe(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),de(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}]),e}(),Oi=function(){function e(t,i){var n=this;Object(l["a"])(this,e),this.vchange=function(){},this.el=m("div","".concat(be,"-form-input")),this.input=m("input","").css("width",t).on("input",(function(e){return n.vchange(e)})).attr("placeholder",i),this.el.child(this.input)}return Object(s["a"])(e,[{key:"hint",value:function(e){this.input.attr("placeholder",e)}},{key:"val",value:function(e){return this.input.val(e)}}]),e}(),Ci=function(){function e(t,i,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};Object(l["a"])(this,e),this.key=t,this.getTitle=a,this.vchange=function(){},this.el=m("div","".concat(be,"-form-select")),this.suggest=new $e(i.map((function(e){return{key:e,title:r.getTitle(e)}})),(function(e){r.itemClick(e.key),s(e.key),r.vchange(e.key)}),n,this.el),this.el.children(this.itemEl=m("div","input-text").html(this.getTitle(t)),this.suggest.el).on("click",(function(){return r.show()}))}return Object(s["a"])(e,[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(e){this.key=e,this.itemEl.html(this.getTitle(e))}},{key:"val",value:function(e){return void 0!==e?(this.key=e,this.itemEl.html(this.getTitle(e)),this):this.key}}]),e}(),ji={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},Ti=function(){function e(t,i,n,r){var a=this;Object(l["a"])(this,e),this.label="",this.rule=i,n&&(this.label=m("label","label").css("width","".concat(r,"px")).html(n)),this.tip=m("div","tip").child("tip").hide(),this.input=t,this.input.vchange=function(){return a.validate()},this.el=m("div","".concat(be,"-form-field")).children(this.label,t.el,this.tip)}return Object(s["a"])(e,[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(e){return this.input.val(e)}},{key:"hint",value:function(e){this.input.hint(e)}},{key:"validate",value:function(){var e=this.input,t=this.rule,i=this.tip,n=this.el,r=e.val();if(t.required&&/^\s*$/.test(r))return i.html(X("validation.required")),n.addClass("error"),!1;if(t.type||t.pattern){var a=t.pattern||ji[t.type];if(!a.test(r))return i.html(X("validation.notMatch")),n.addClass("error"),!1}return n.removeClass("error"),!0}}]),e}(),Ei=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(l["a"])(this,i),n=t.call(this,"div","".concat(be,"-button ").concat(r)),n.child(X("button.".concat(e))),n}return i}(y),Si=100,Fi=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(){var e;Object(l["a"])(this,i);var n=new Ti(new Ci("cell",["cell"],"100%",(function(e){return X("dataValidation.modeType.".concat(e))})),{required:!0},"".concat(X("dataValidation.range"),":"),Si),r=new Ti(new Oi("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),a=new Ti(new Ci("list",["list","number","date","phone","email"],"100%",(function(e){return X("dataValidation.type.".concat(e))}),(function(t){return e.criteriaSelected(t)})),{required:!0},"".concat(X("dataValidation.criteria"),":"),Si),s=new Ti(new Ci("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(e){return X("dataValidation.operator.".concat(e))}),(function(t){return e.criteriaOperatorSelected(t)})),{required:!0}).hide(),o=new Ti(new Oi("70px","10"),{required:!0}).hide(),c=new Ti(new Oi("70px","100"),{required:!0,type:"number"}).hide(),h=new Ti(new Oi("120px","a,b,c"),{required:!0}),u=new Ti(new Oi("70px","10"),{required:!0,type:"number"}).hide();return e=t.call(this,X("contextmenu.validation"),[m("div","".concat(be,"-form-fields")).children(n.el,r.el),m("div","".concat(be,"-form-fields")).children(a.el,s.el,o.el,c.el,u.el,h.el),m("div","".concat(be,"-buttons")).children(new Ei("cancel").on("click",(function(){return e.btnClick("cancel")})),new Ei("remove").on("click",(function(){return e.btnClick("remove")})),new Ei("save","primary").on("click",(function(){return e.btnClick("save")})))]),e.mf=n,e.rf=r,e.cf=a,e.of=s,e.minvf=o,e.maxvf=c,e.vf=u,e.svf=h,e.change=function(){},e}return Object(s["a"])(i,[{key:"showVf",value:function(e){var t="date"===e?"2018-11-12":"10",i=this.vf;i.input.hint(t),i.show()}},{key:"criteriaSelected",value:function(e){var t=this.of,i=this.minvf,n=this.maxvf,r=this.vf,a=this.svf;"date"===e||"number"===e?(t.show(),i.rule.type=e,n.rule.type=e,"date"===e?(i.hint("2018-11-12"),n.hint("2019-11-12")):(i.hint("10"),n.hint("100")),i.show(),n.show(),r.hide(),a.hide()):("list"===e?a.show():a.hide(),r.hide(),t.hide(),i.hide(),n.hide())}},{key:"criteriaOperatorSelected",value:function(e){if(e){var t=this.minvf,i=this.maxvf,n=this.vf;if("be"===e||"nbe"===e)t.show(),i.show(),n.hide();else{var r=this.cf.val();n.rule.type=r,"date"===r?n.hint("2018-11-12"):n.hint("10"),n.show(),t.hide(),i.hide()}}}},{key:"btnClick",value:function(e){if("cancel"===e)this.hide();else if("remove"===e)this.change("remove"),this.hide();else if("save"===e){for(var t=["mf","rf","cf","of","svf","vf","minvf","maxvf"],i=0;i<t.length;i+=1){var n=this[t[i]];if(n.isShow()&&!n.validate())return}var r=this.mf.val(),a=this.rf.val(),l=this.cf.val(),s=this.of.val(),o=this.svf.val();"number"!==l&&"date"!==l||(o="be"===s||"nbe"===s?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",r,a,{type:l,operator:s,required:!1,value:o}),this.hide()}}},{key:"setValue",value:function(e){if(e){var t=this.mf,i=this.rf,n=this.cf,r=this.of,a=this.svf,l=this.vf,s=this.minvf,o=this.maxvf,c=e.mode,h=e.ref,u=e.validator,f=u||{type:"list"},d=f.type,v=f.operator,g=f.value;t.val(c||"cell"),i.val(h),n.val(d),r.val(v),Array.isArray(g)?(s.val(g[0]),o.val(g[1])):(a.val(g||""),l.val(g||"")),this.criteriaSelected(d),this.criteriaOperatorSelected(v)}this.show()}}]),i}(xi);function Di(e,t){var i=m("div","".concat(be,"-toast")),n=m("div","".concat(be,"-dimmer active")),r=function(){document.body.removeChild(i.el),document.body.removeChild(n.el)};i.children(m("div","".concat(be,"-toast-header")).children(new Be("close").on("click.stop",(function(){return r()})),e),m("div","".concat(be,"-toast-content")).html(t)),document.body.appendChild(i.el),document.body.appendChild(n.el);var a=i.box(),l=a.width,s=a.height,o=document.documentElement,c=o.clientHeight,h=o.clientWidth;i.offset({left:(h-l)/2,top:(c-s)/3})}function zi(){var e=this.data,t=this.verticalScrollbar,i=this.horizontalScrollbar,n=e.getSelectedRect(),r=n.l,a=n.t,l=n.left,s=n.top,o=n.width,c=n.height,h=this.getTableOffset();if(Math.abs(l)+o>h.width)i.move({left:r+o-h.width});else{var u=e.freezeTotalWidth();l<u&&i.move({left:r-1-u})}if(Math.abs(s)+c>h.height)t.move({top:a+c-h.height-1});else{var f=e.freezeTotalHeight();s<f&&t.move({top:a-1-f})}}function Ii(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==t||-1!==i){var a=this.table,l=this.selector,s=this.toolbar;e?l.setEnd(t,i,r):l.set(t,i,n),s.reset(),a.render()}}function Ri(e,t){var i=this.selector,n=this.data,r=n.rows,a=n.cols,l=Object(b["a"])(i.indexes,2),s=l[0],o=l[1],c=i.range,h=c.eri,u=c.eci;if(e){var f=Object(b["a"])(i.moveIndexes,2);s=f[0],o=f[1]}"left"===t?o>0&&(o-=1):"right"===t?(u!==o&&(o=u),o<a.len-1&&(o+=1)):"up"===t?s>0&&(s-=1):"down"===t?(h!==s&&(s=h),s<r.len-1&&(s+=1)):"row-first"===t?o=0:"row-last"===t?o=a.len-1:"col-first"===t?s=0:"col-last"===t&&(s=r.len-1),e&&(i.moveIndexes=[s,o]),Ii.call(this,e,s,o),zi.call(this)}function Ai(e){if(0===e.buttons&&e.target.className!=="".concat(be,"-resizer-hover")){var t=e.offsetX,i=e.offsetY,n=this.rowResizer,r=this.colResizer,a=this.tableEl,l=this.data,s=l.rows,o=l.cols;if(t>o.indexWidth&&i>s.height)return n.hide(),void r.hide();var c=a.box(),h=l.getCellRectByXY(e.offsetX,e.offsetY);h.ri>=0&&-1===h.ci?(h.width=o.indexWidth,n.show(h,{width:c.width})):n.hide(),-1===h.ri&&h.ci>=0?(h.height=s.height,r.show(h,{height:c.height})):r.hide()}}function Ni(e){var t=this.verticalScrollbar,i=this.data,n=t.scroll(),r=n.top,a=e.deltaY,l=i.rows;if(e.detail&&(a=40*e.detail),a>0){var s=i.scroll.ri+1;s<l.len&&t.move({top:r+l.getHeight(s)-1})}else{var o=i.scroll.ri-1;o>=0&&t.move({top:0===o?0:r-l.getHeight(o)})}}function Wi(e,t){var i=this.verticalScrollbar,n=this.horizontalScrollbar,r=i.scroll(),a=r.top,l=n.scroll(),s=l.left;"left"===e||"right"===e?n.move({left:s-t}):"up"!==e&&"down"!==e||i.move({top:a-t})}function Li(){var e=this.data,t=this.verticalScrollbar,i=this.getTableOffset(),n=i.height;t.set(n,e.rows.totalHeight())}function qi(){var e=this.data,t=this.horizontalScrollbar,i=this.getTableOffset(),n=i.width;e&&t.set(n,e.cols.totalWidth())}function Vi(){var e=this.selector,t=this.data,i=this.editor,n=Object(b["a"])(t.freeze,2),r=n[0],a=n[1];if(r>0||a>0){var l=t.freezeTotalWidth(),s=t.freezeTotalHeight();i.setFreezeLengths(l,s)}e.resetAreaOffset()}function Mi(){var e=this.tableEl,t=this.overlayerEl,i=this.overlayerCEl,n=this.table,r=this.toolbar,a=this.selector,l=this.el,s=this.getTableOffset(),o=this.getRect();e.attr(o),t.offset(o),i.offset(s),l.css("width","".concat(o.width,"px")),Li.call(this),qi.call(this),Vi.call(this),n.render(),r.reset(),a.reset()}function Hi(){var e=this.data,t=this.selector;e.clearClipboard(),t.hideClipboard()}function Pi(){var e=this.data,t=this.selector;console.log("data.copy",e.copy),e.copy(),t.showClipboard()}function _i(){var e=this.data,t=this.selector;e.cut(),t.showClipboard()}function $i(e){var t=this.data;t.paste(e,(function(e){return Di("Tip",e)}))&&Mi.call(this)}function Bi(){var e=this.toolbar;e.paintformatActive()&&($i.call(this,"format"),Hi.call(this),e.paintformatToggle())}function Ui(e){var t=this,i=this.selector,n=this.data,r=this.table,a=e.target.className==="".concat(be,"-selector-corner"),l=n.getCellRectByXY(e.offsetX,e.offsetY),s=l.ri,o=l.ci;e.shiftKey||(a?i.showAutofill(s,o):Ii.call(this,!1,s,o),pe(window,(function(e){var r=n.getCellRectByXY(e.offsetX,e.offsetY);s=r.ri,o=r.ci,a?i.showAutofill(s,o):1!==e.buttons||e.shiftKey||Ii.call(t,!0,s,o,!0,!0)}),(function(){a&&n.autofill(i.arange,"all",(function(e){return Di("Tip",e)}))&&r.render(),i.hideAutofill(),Bi.call(t)}))),a||1!==e.buttons||e.shiftKey&&Ii.call(this,!0,s,o)}function Yi(){var e=this.editor,t=this.data,i=t.getSelectedRect(),n=this.getTableOffset(),r="top";i.top>n.height/2&&(r="bottom"),e.setOffset(i,r)}function Xi(){var e=this.editor,t=this.data;Yi.call(this),e.setCell(t.getSelectedCell(),t.getSelectedValidator()),Hi.call(this)}function Ji(e){var t=this,i=this.data,n=this.table,r=this.selector;i.scrolly(e,(function(){r.resetBRLAreaOffset(),Yi.call(t),n.render()}))}function Ki(e){var t=this,i=this.data,n=this.table,r=this.selector;i.scrollx(e,(function(){r.resetBRTAreaOffset(),Yi.call(t),n.render()}))}function Qi(e,t){var i=e.ri,n=this.table,r=this.selector,a=this.data;a.rows.setHeight(i,t),n.render(),r.resetAreaOffset(),Li.call(this),Yi.call(this)}function Zi(e,t){var i=e.ci,n=this.table,r=this.selector,a=this.data;a.cols.setWidth(i,t),n.render(),r.resetAreaOffset(),qi.call(this),Yi.call(this)}function Gi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",i=this.data,n=this.table;i.setSelectedCellText(e,t),"finished"===t&&n.render()}function en(e){var t=this.data;"insert-row"===e?t.insert("row"):"delete-row"===e?t.delete("row"):"insert-column"===e?t.insert("column"):"delete-column"===e?t.delete("column"):"delete-cell"===e?t.deleteCell():"delete-cell-format"===e?t.deleteCell("format"):"delete-cell-text"===e&&t.deleteCell("text"),Hi.call(this),Mi.call(this)}function tn(e,t){var i=this.data;if("undo"===e)this.undo();else if("redo"===e)this.redo();else if("print"===e);else if("paintformat"===e)!0===t?Pi.call(this):Hi.call(this);else if("clearformat"===e)en.call(this,"delete-cell-format");else if("link"===e);else if("chart"===e);else if("filter"===e);else if("freeze"===e)if(t){var n=i.selector,r=n.ri,a=n.ci;this.freeze(r,a)}else this.freeze(0,0);else i.setSelectedCellAttr(e,t),"formula"===e&&Xi.call(this),Mi.call(this)}function nn(){var e=this,t=this.overlayerEl,i=this.rowResizer,n=this.colResizer,r=this.verticalScrollbar,a=this.horizontalScrollbar,l=this.editor,s=this.contextMenu,o=this.data,c=this.toolbar,h=this.modalValidation;t.on("mousemove",(function(t){Ai.call(e,t)})).on("mousedown",(function(t){2===t.buttons?o.xyInSelectedRect(t.offsetX,t.offsetY)?(s.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):s.hide():2===t.detail?Xi.call(e):(l.clear(),Ui.call(e,t))})).on("mousewheel.stop",(function(t){Ni.call(e,t)})),me(t.el,{move:function(t,i){Wi.call(e,t,i)}}),c.change=function(t,i){return tn.call(e,t,i)},i.finishedFn=function(t,i){Qi.call(e,t,i)},n.finishedFn=function(t,i){Zi.call(e,t,i)},r.moveFn=function(t,i){Ji.call(e,t,i)},a.moveFn=function(t,i){Ki.call(e,t,i)},l.change=function(t,i){Gi.call(e,i,t)},h.change=function(e){if("save"===e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];o.addValidation.apply(o,i)}else o.removeValidation()},s.itemClick=function(t){"validation"===t?h.setValue(o.getSelectedValidation()):"copy"===t?Pi.call(e):"cut"===t?_i.call(e):"paste"===t?$i.call(e,"all"):"paste-value"===t?$i.call(e,"text"):"paste-format"===t?$i.call(e,"format"):en.call(e,t)},fe(window,"resize",(function(){e.reload()})),fe(window,"click",(function(i){e.focusing=t.contains(i.target)})),fe(window,"keydown",(function(t){if(e.focusing){var i=t.keyCode||t.which,n=t.key,r=t.ctrlKey,a=t.shiftKey,h=t.altKey,u=t.metaKey;if(r||u){var f="all";switch(a&&(f="text"),h&&(f="format"),i){case 90:e.undo(),t.preventDefault();break;case 89:e.redo(),t.preventDefault();break;case 67:Pi.call(e),t.preventDefault();break;case 88:_i.call(e),t.preventDefault();break;case 85:c.trigger("underline"),t.preventDefault();break;case 86:$i.call(e,f),t.preventDefault();break;case 37:Ri.call(e,a,"row-first"),t.preventDefault();break;case 38:Ri.call(e,a,"col-first"),t.preventDefault();break;case 39:Ri.call(e,a,"row-last"),t.preventDefault();break;case 40:Ri.call(e,a,"col-last"),t.preventDefault();break;case 32:Ii.call(e,!1,-1,o.selector.ci,!1),t.preventDefault();break;case 66:c.trigger("font-bold");break;case 73:c.trigger("font-italic");break;default:break}}else{switch(i){case 32:a&&Ii.call(e,!1,o.selector.ri,-1,!1);break;case 27:s.hide(),Hi.call(e);break;case 37:Ri.call(e,a,"left"),t.preventDefault();break;case 38:Ri.call(e,a,"up"),t.preventDefault();break;case 39:Ri.call(e,a,"right"),t.preventDefault();break;case 40:Ri.call(e,a,"down"),t.preventDefault();break;case 9:l.clear(),Ri.call(e,!1,a?"left":"right"),t.preventDefault();break;case 13:l.clear(),Ri.call(e,!1,a?"up":"down"),t.preventDefault();break;case 8:en.call(e,"delete-cell-text"),t.preventDefault();break;default:break}"Delete"===n?(en.call(e,"delete-cell-text"),t.preventDefault()):i>=65&&i<=90||i>=48&&i<=57||i>=96&&i<=105||"="===t.key?(Gi.call(e,t.key,"input"),Xi.call(e)):113===i&&Xi.call(e)}}}))}var rn=function(){function e(t,i){var n=this;Object(l["a"])(this,e);var r=i.settings,a=r.view,s=r.showToolbar,o=r.showContextmenu;this.el=m("div","".concat(be,"-sheet")),this.toolbar=new ki(i,a.width,!s),t.children(this.toolbar.el,this.el),this.data=i,this.tableEl=m("canvas","".concat(be,"-table")),this.rowResizer=new we(!1,i.rows.height),this.colResizer=new we(!0,i.cols.minWidth),this.verticalScrollbar=new ke(!0),this.horizontalScrollbar=new ke(!1),this.editor=new rt(mt,(function(){return n.getTableOffset()}),i.rows.height),this.modalValidation=new Fi,this.contextMenu=new ot((function(){return n.getTableOffset()}),!o),this.selector=new qe(i),this.overlayerCEl=m("div","".concat(be,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=m("div","".concat(be,"-overlayer")).child(this.overlayerCEl),this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el),this.table=new Bt(this.tableEl.el,i),nn.call(this),Mi.call(this),Ii.call(this,!1,0,0)}return Object(s["a"])(e,[{key:"loadData",value:function(e){return this.data.setData(e),Mi.call(this),this}},{key:"freeze",value:function(e,t){var i=this.data;return i.setFreeze(e,t),Mi.call(this),this}},{key:"undo",value:function(){this.data.undo(),Mi.call(this)}},{key:"redo",value:function(){this.data.redo(),Mi.call(this)}},{key:"reload",value:function(){return Mi.call(this),this}},{key:"getRect",value:function(){var e=this.data;return{width:e.viewWidth(),height:e.viewHeight()}}},{key:"getTableOffset",value:function(){var e=this.data,t=e.rows,i=e.cols,n=this.getRect(),r=n.width,a=n.height;return{width:r-i.indexWidth,height:a-t.height,left:i.indexWidth,top:t.height}}}]),e}(),an=(i("1ccf2"),function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(l["a"])(this,e);var n=t;"string"===typeof t&&(n=document.querySelector(t)),this.data=new ue("sheet1",i);var r=m("div","".concat(be)).on("contextmenu",(function(e){return e.preventDefault()}));n.appendChild(r.el),this.sheet=new rn(r,this.data)}return Object(s["a"])(e,[{key:"loadData",value:function(e){return this.sheet.loadData(e),this}},{key:"getData",value:function(){return this.data.getData()}},{key:"validate",value:function(){var e=this.data.validations;return e.errors.size<=0}},{key:"change",value:function(e){return this.data.change=e,this.getData(),this}}],[{key:"locale",value:function(e,t){K(e,t)}}]),e}()),ln=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new an(e,t)};window&&(window.x=window.x||{},window.x.spreadsheet=ln,window.x.spreadsheet.locale=function(e,t){return K(e,t)});var sn=an,on=i("7504"),cn=i("1e45"),hn=i("12ec"),un=i("5b71"),fn=i("d7e7"),dn=i("cb9b"),vn=function(e){Object(o["a"])(i,e);var t=Object(c["a"])(i);function i(){var e;return Object(l["a"])(this,i),e=t.apply(this,arguments),e.fileTypeForm={viewName:"",linkId:"",path:"",sheetName:"",titleLine:"",startLine:"",endLine:"",dictFlag:1},e.rules={viewName:[{required:!0,message:"请填写视图名称",trigger:"blur"}],linkId:[{required:!0,message:"请选择文档库连接器",trigger:"change"}],path:[{required:!0,message:"请填写文件路径",trigger:"blur"}],sheetName:[{required:!0,message:"请填写sheet名称",trigger:"blur"}]},e.linkList=[],e.parameterTable=[{id:1,code:"",name:"",type:"",required:"",defaultValue:"",addButton:!0,edits:[0,1,1,1,1,1,0]}],e.isCompatible="",e.fieldTable=[],e.testloading=!1,e.paramsActions=[{title:"测试查询",icon:"stack-line",onClick:e.testQueryButton}],e.sheet=null,e.updateId="",e.testList=[],e.cellLocation={},e.cellList=[],e.excelData={styles:[{bgcolor:"#f4f5f8",textwrap:!0,color:"#900b09",border:{right:["thin","#000000"],left:["thin","#0366d6"]}},{textwrap:!1,bgcolor:"#366092",color:"#fff",align:"center",width:200},{textwrap:!1,bgcolor:"#c5d9f1",color:"#000",align:"center",width:200},{bgcolor:"#ffffff",color:"#000",align:"center"},{bgcolor:"#dce6f1",color:"#000",align:"center"}],rows:{0:{cells:{0:{text:"test1"},1:{text:"test2"}}},1:{cells:{0:{text:"rows2-test1"},1:{text:"rows3-test2"}}}}},e.dialogVisible=!1,e.actionsList=[{icon:"",type:"primary",onClick:e.addSure,title:"确定"},{icon:"",type:"",onClick:e.addCancel,title:"取消"}],e.testParameterDialog=!1,e.testParameterRules={},e.testParameterList=[],e}return Object(s["a"])(i,[{key:"created",value:function(){this.linkQuery();var e=this.$route.query.id;e&&this.dataViewDetail()}},{key:"initExcel",value:function(){this.sheet=new sn("#spreadsheet-execl",{view:{width:function(){return 1e3},height:function(){return 240}},rows:{len:10,height:20},col:{len:26,width:100,indexWidth:60,minWidth:50}}).loadData(this.excelData)}},{key:"linkQuery",value:function(){var e=this;Object(dn["o"])({page:1,limit:1e4,type:"2"}).then((function(t){var i=t.data;e.linkList=i.rows}))}},{key:"testQueryButton",value:function(){if(!this.fileTypeForm.linkId)return this.$message.error("请选择文档库连接器"),!1;if(!this.fileTypeForm.path)return this.$message.error("请填写文件路径"),!1;if(!this.fileTypeForm.sheetName)return this.$message.error("请填写sheet名称"),!1;if(this.parameterTable.length>0&&this.parameterTable[0].code)this.testParameterDialog=!0;else{var e=Object(a["a"])(Object(a["a"])({},this.fileTypeForm),{},{filePath:this.fileTypeForm.path});this.queryExcelInfo(e)}}},{key:"changeValue",value:function(e,t){this.testParameterList.forEach((function(e){e.code===t.code&&("1"===e.required&&""===e.value?e.showMsg=!0:e.showMsg=!1)}))}},{key:"handleTestQuery",value:function(){this.testloading=!0;var e=[];if(this.$refs.advance["spread"].model)for(var t in this.$refs.advance["spread"].model)e.push({code:t,value:this.$refs.advance["spread"].model[t]});else e=[];var i=Object(a["a"])(Object(a["a"])({},this.fileTypeForm),{},{filePath:this.fileTypeForm.path,queryParams:e});this.queryExcelInfo(i)}},{key:"queryExcelInfo",value:function(e){var t=this;this.testloading=!0,Object(dn["l"])(e).then((function(e){if(t.testloading=!1,t.testParameterDialog=!1,e.data){t.excelData=e.data;var i=document.getElementById("spreadsheet-execl");null!==i&&(i.innerHTML=""),t.initExcel(),t.$message.success("测试查询成功")}else t.$message.error("测试查询失败："+e.error.message)}))}},{key:"testParameterCancel",value:function(){this.$refs.advance["spread"].model="",this.testParameterDialog=!1}},{key:"createLink",value:function(){this.dialogVisible=!0}},{key:"handelSure",value:function(e){var t=this;Object(dn["a"])(e).then((function(e){e.data?(t.fileTypeForm.linkId=e.data.linkId,t.$message.success("文档连接器添加成功"),t.dialogVisible=!1,t.linkQuery()):t.$message.error("文档库连接器新增失败："+e.error.message)}))}},{key:"handelCancel",value:function(){this.dialogVisible=!1}},{key:"addCancel",value:function(){var e=this.$refs.fileTypeForm;e.resetFields(),this.$router.push("/sysSupport/dataService/viewDateManagent")}},{key:"dataViewDetail",value:function(){var e=this;this.isCompatible=this.$route.query.isCompatible,this.updateId=this.$route.query.id;var t=this.$route.query.id;Object(dn["d"])(t).then((function(t){var i=t.data;e.fileTypeForm.viewName=i.name,e.fileTypeForm.titleLine=i.titleLine,e.fileTypeForm.linkId=i.linkId,e.fileTypeForm.path=i.path,e.fileTypeForm.startLine=i.startLine,e.fileTypeForm.endLine=i.endLine,e.fileTypeForm.sheetName=i.sheetName,e.fileTypeForm.dictFlag=i.dictFlag,i.queryParams&&(e.parameterTable=i.queryParams),e.fieldTable=i.fields}))}},{key:"addSure",value:function(){var e=this,t=this.$refs.fileTypeForm;t.validate((function(i){var n=!1;if(i&&(e.fieldTable=e.$refs.treeLists["treeDataList"],console.log(" this.fieldTable",e.fieldTable),e.parameterTable=e.$refs.parameViewTable["parameterData"],n=Object(un["a"])(e.parameterTable,e.fieldTable),console.log("checkFlag",n),!1===n)){var r={name:e.fileTypeForm.viewName,type:0,kind:2,dictFlag:e.fileTypeForm.dictFlag,linkId:e.fileTypeForm.linkId,path:e.fileTypeForm.path,fields:e.fieldTable,sheetName:e.fileTypeForm.sheetName,titleLine:e.fileTypeForm.titleLine,startLine:e.fileTypeForm.startLine,endLine:e.fileTypeForm.endLine};e.parameterTable.length>0&&e.parameterTable[0].code?r.queryParams=e.parameterTable:r.queryParams=[],"0"===e.isCompatible&&e.updateId||"1"===e.isCompatible&&e.updateId?(r.id=e.updateId,r.isCompatible=e.isCompatible,Object(dn["t"])(r).then((function(i){i.data;var n=i.error;n?e.$message.error("保存失败:"+n.message):(e.$message.success("保存成功"),t.resetFields(),e.$router.back())}))):Object(dn["c"])(r).then((function(i){i.data;var n=i.error;n?e.$message.error("保存失败:"+n.message):(e.$message.success("保存成功"),t.resetFields(),e.$router.back())}))}}))}}]),i}(u["e"]);vn=Object(h["a"])([Object(u["a"])({components:{parameView:hn["a"],createDialog:cn["a"],testEditor:on["a"],treeTableList:fn["a"]}})],vn);var gn=vn,pn=gn,yn=(i("1d34"),i("2877")),mn=Object(yn["a"])(pn,n,r,!1,null,null,null);t["default"]=mn.exports},b680:function(e,t,i){"use strict";var n=i("23e7"),r=i("a691"),a=i("408a"),l=i("1148"),s=i("d039"),o=1..toFixed,c=Math.floor,h=function(e,t,i){return 0===t?i:t%2===1?h(e,t-1,i*e):h(e*e,t/2,i)},u=function(e){var t=0,i=e;while(i>=4096)t+=12,i/=4096;while(i>=2)t+=1,i/=2;return t},f=o&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){o.call({})}));n({target:"Number",proto:!0,forced:f},{toFixed:function(e){var t,i,n,s,o=a(this),f=r(e),d=[0,0,0,0,0,0],v="",g="0",p=function(e,t){var i=-1,n=t;while(++i<6)n+=e*d[i],d[i]=n%1e7,n=c(n/1e7)},y=function(e){var t=6,i=0;while(--t>=0)i+=d[t],d[t]=c(i/e),i=i%e*1e7},m=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==d[e]){var i=String(d[e]);t=""===t?i:t+l.call("0",7-i.length)+i}return t};if(f<0||f>20)throw RangeError("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return String(o);if(o<0&&(v="-",o=-o),o>1e-21)if(t=u(o*h(2,69,1))-69,i=t<0?o*h(2,-t,1):o/h(2,t,1),i*=4503599627370496,t=52-t,t>0){p(0,i),n=f;while(n>=7)p(1e7,0),n-=7;p(h(10,n,1),0),n=t-1;while(n>=23)y(1<<23),n-=23;y(1<<n),p(1,1),y(2),g=m()}else p(0,i),p(1<<-t,0),g=m()+l.call("0",f);return f>0?(s=g.length,g=v+(s<=f?"0."+l.call("0",f-s)+g:g.slice(0,s-f)+"."+g.slice(s-f))):g=v+g,g}})},bb2f:function(e,t,i){var n=i("d039");e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},cb29:function(e,t,i){var n=i("23e7"),r=i("81d5"),a=i("44d2");n({target:"Array",proto:!0},{fill:r}),a("fill")},cc71:function(e,t,i){"use strict";var n=i("23e7"),r=i("857a"),a=i("af03");n({target:"String",proto:!0,forced:a("bold")},{bold:function(){return r(this,"b","","")}})},d58f:function(e,t,i){var n=i("1c0b"),r=i("7b0b"),a=i("44ad"),l=i("50c4"),s=function(e){return function(t,i,s,o){n(i);var c=r(t),h=a(c),u=l(c.length),f=e?u-1:0,d=e?-1:1;if(s<2)while(1){if(f in h){o=h[f],f+=d;break}if(f+=d,e?f<0:u<=f)throw TypeError("Reduce of empty array with no initial value")}for(;e?f>=0:u>f;f+=d)f in h&&(o=i(o,h[f],f,c));return o}};e.exports={left:s(!1),right:s(!0)}},f183:function(e,t,i){var n=i("d012"),r=i("861d"),a=i("5135"),l=i("9bf2").f,s=i("90e3"),o=i("bb2f"),c=s("meta"),h=0,u=Object.isExtensible||function(){return!0},f=function(e){l(e,c,{value:{objectID:"O"+ ++h,weakData:{}}})},d=function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,c)){if(!u(e))return"F";if(!t)return"E";f(e)}return e[c].objectID},v=function(e,t){if(!a(e,c)){if(!u(e))return!0;if(!t)return!1;f(e)}return e[c].weakData},g=function(e){return o&&p.REQUIRED&&u(e)&&!a(e,c)&&f(e),e},p=e.exports={REQUIRED:!1,fastKey:d,getWeakData:v,onFreeze:g};n[c]=!0}}]);
//# sourceMappingURL=chunk-19ddb668.2915ab0d.js.map